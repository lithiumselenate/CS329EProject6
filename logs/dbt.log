[0m04:47:32.242830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2552235510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25513c61d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25513c6170>]}


============================== 04:47:32.246851 | e8e2d86f-24c8-4e47-bc00-2459b4f79e56 ==============================
[0m04:47:32.246851 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:47:32.247863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:47:32.257726 [info ] [MainThread]: dbt version: 1.9.4
[0m04:47:32.258538 [info ] [MainThread]: python version: 3.10.16
[0m04:47:32.259277 [info ] [MainThread]: python path: /opt/conda/bin/python3.10
[0m04:47:32.259926 [info ] [MainThread]: os info: Linux-5.10.0-34-cloud-amd64-x86_64-with-glibc2.31
[0m04:47:32.264521 [info ] [MainThread]: Using profiles dir at /home/jupyter/.dbt
[0m04:47:32.265311 [info ] [MainThread]: Using profiles.yml file at /home/jupyter/.dbt/profiles.yml
[0m04:47:32.265985 [info ] [MainThread]: Using dbt_project.yml file at /home/jupyter/cs329e_xh/dbt_project.yml
[0m04:47:32.410500 [info ] [MainThread]: Configuration:
[0m04:47:32.411385 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m04:47:32.412304 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:47:32.412906 [info ] [MainThread]: Required dependencies:
[0m04:47:32.413566 [debug] [MainThread]: Executing "git --help"
[0m04:47:32.416445 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:47:32.417221 [debug] [MainThread]: STDERR: "b''"
[0m04:47:32.417738 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m04:47:32.418250 [info ] [MainThread]: Connection test skipped since no profile was found
[0m04:47:32.418856 [info ] [MainThread]: [31m1 check failed:[0m
[0m04:47:32.419459 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'cs329e-xh'


[0m04:47:32.420831 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.25579834, "process_in_blocks": "0", "process_kernel_time": 0.091965, "process_mem_max_rss": "95428", "process_out_blocks": "16", "process_user_time": 1.940329}
[0m04:47:32.421515 [debug] [MainThread]: Command `dbt debug` failed at 04:47:32.421374 after 0.26 seconds
[0m04:47:32.422239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2552235510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2551c120e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25513c6140>]}
[0m04:47:32.422880 [debug] [MainThread]: Flushing usage events
[0m04:47:32.584513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:50:20.796649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d41655a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d34d23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d34d2380>]}


============================== 04:50:20.802729 | 4d4cf5eb-5411-4732-bef0-8b0a869b4d0a ==============================
[0m04:50:20.802729 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:50:20.803801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:50:20.808669 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'cs329e-xh'
[0m04:50:20.810233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.10197304, "process_in_blocks": "16", "process_kernel_time": 0.084119, "process_mem_max_rss": "92580", "process_out_blocks": "8", "process_user_time": 1.908677}
[0m04:50:20.811029 [debug] [MainThread]: Command `dbt run` failed at 04:50:20.810877 after 0.10 seconds
[0m04:50:20.811690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d41655a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d34d26e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d34d1540>]}
[0m04:50:20.812447 [debug] [MainThread]: Flushing usage events
[0m04:50:20.986138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:05:30.657872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ad7d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d99f2a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d99f2a680>]}


============================== 05:05:30.662016 | 1e3de867-7c00-47fc-bf0e-4f5d9dfbb424 ==============================
[0m05:05:30.662016 [info ] [MainThread]: Running with dbt=1.9.4
[0m05:05:30.663145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:05:30.667614 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'cs329e-xh'
[0m05:05:30.669307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09438872, "process_in_blocks": "0", "process_kernel_time": 0.096003, "process_mem_max_rss": "92504", "process_out_blocks": "8", "process_user_time": 1.863395}
[0m05:05:30.670095 [debug] [MainThread]: Command `dbt run` failed at 05:05:30.669938 after 0.10 seconds
[0m05:05:30.670715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ad7d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d99f2a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d99f2bf40>]}
[0m05:05:30.671359 [debug] [MainThread]: Flushing usage events
[0m05:05:30.807607 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:03.236772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78135e95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781276e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781276e380>]}


============================== 11:38:03.248416 | 06aa912d-cb1b-4222-ba94-25a4290878fd ==============================
[0m11:38:03.248416 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:38:03.249684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:38:05.500049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06aa912d-cb1b-4222-ba94-25a4290878fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781477aef0>]}
[0m11:38:05.606537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06aa912d-cb1b-4222-ba94-25a4290878fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7812809150>]}
[0m11:38:05.607683 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:38:05.826995 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:38:05.828180 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:38:05.828952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06aa912d-cb1b-4222-ba94-25a4290878fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7812b77c70>]}
[0m11:38:05.930306 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "generate_schema_name" in the project "cs329e_xh".
   To fix this error, rename or remove one of the following macros:
      - macros/.ipynb_checkpoints/generate_schema_name-checkpoint.sql
      - macros/generate_schema_name.sql
[0m11:38:05.931631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.827518, "process_in_blocks": "192", "process_kernel_time": 0.471061, "process_mem_max_rss": "247476", "process_out_blocks": "16", "process_user_time": 4.677748}
[0m11:38:05.932511 [debug] [MainThread]: Command `dbt run` failed at 11:38:05.932344 after 2.83 seconds
[0m11:38:05.933365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78135e95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f786a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f786afb0>]}
[0m11:38:05.934108 [debug] [MainThread]: Flushing usage events
[0m11:38:06.076066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:05.264506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3f9255d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3eaaa3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3eaaa380>]}


============================== 11:41:05.269116 | e1c93d97-ef22-4580-b662-083215d03735 ==============================
[0m11:41:05.269116 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:41:05.270193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:41:07.141426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1c93d97-ef22-4580-b662-083215d03735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e40acaef0>]}
[0m11:41:07.233657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1c93d97-ef22-4580-b662-083215d03735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3f7f5060>]}
[0m11:41:07.234826 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:41:07.413634 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:41:07.414793 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:41:07.415589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1c93d97-ef22-4580-b662-083215d03735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e23bfb490>]}
[0m11:41:07.452272 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "generate_schema_name" in the project "cs329e_xh".
   To fix this error, rename or remove one of the following macros:
      - macros/.ipynb_checkpoints/generate_schema_name-checkpoint.sql
      - macros/generate_schema_name.sql
[0m11:41:07.453679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.279615, "process_in_blocks": "0", "process_kernel_time": 0.412669, "process_mem_max_rss": "249844", "process_out_blocks": "16", "process_user_time": 4.182254}
[0m11:41:07.454494 [debug] [MainThread]: Command `dbt run` failed at 11:41:07.454332 after 2.28 seconds
[0m11:41:07.455136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3f9255d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e23b9aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e23b9afe0>]}
[0m11:41:07.455790 [debug] [MainThread]: Flushing usage events
[0m11:41:07.596105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:26.977227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dc7d9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dbb46380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dbb46320>]}


============================== 11:42:26.981291 | 6ee06e4d-204f-4859-9bf9-038328622c9e ==============================
[0m11:42:26.981291 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:42:26.982212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:42:28.868608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ee06e4d-204f-4859-9bf9-038328622c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dc0ba7d0>]}
[0m11:42:28.962540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ee06e4d-204f-4859-9bf9-038328622c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dbef0be0>]}
[0m11:42:28.963725 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:42:29.153543 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:42:29.155036 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:42:29.155981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ee06e4d-204f-4859-9bf9-038328622c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c0c76fb0>]}
[0m11:42:30.932511 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "cs329e_xh_raw_company_data".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("cs329e_xh_raw", "company_data").
  
  To fix this, change the name of one of these resources:
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/.ipynb_checkpoints/schema-checkpoint.yml)
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/schema.yml)
[0m11:42:30.933880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.041229, "process_in_blocks": "480", "process_kernel_time": 0.487273, "process_mem_max_rss": "255964", "process_out_blocks": "16", "process_user_time": 5.834143}
[0m11:42:30.934750 [debug] [MainThread]: Command `dbt run` failed at 11:42:30.934583 after 4.04 seconds
[0m11:42:30.935398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dc7d9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41b3e07e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41b3e06950>]}
[0m11:42:30.936124 [debug] [MainThread]: Flushing usage events
[0m11:42:31.107456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:26.528193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89cfbd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89c1423e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89c142380>]}


============================== 11:43:26.532409 | a541d983-2bb5-4c3b-8de1-e48712b56730 ==============================
[0m11:43:26.532409 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:43:26.533336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:43:28.416481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89c513220>]}
[0m11:43:28.509393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89c60b310>]}
[0m11:43:28.510568 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:43:28.697219 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:43:28.698620 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:43:28.699351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8812a7010>]}
[0m11:43:30.505413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.cs329e_xh.mrt
- models.cs329e_xh.int
[0m11:43:30.529991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8804b9f60>]}
[0m11:43:30.660509 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m11:43:30.663463 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m11:43:30.682571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8804bbac0>]}
[0m11:43:30.683779 [info ] [MainThread]: Found 9 models, 9 sources, 492 macros
[0m11:43:30.684900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89d60dea0>]}
[0m11:43:30.688321 [info ] [MainThread]: 
[0m11:43:30.689523 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:43:30.690486 [info ] [MainThread]: 
[0m11:43:30.691836 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:43:30.700881 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m11:43:30.702071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:30.866187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now create_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m11:43:30.867333 [debug] [ThreadPool]: Creating schema "database: "silken-fortress-448205-p9"
schema: "dbt_cs329e_xh_stg"
"
[0m11:43:30.887484 [debug] [ThreadPool]: On create_silken-fortress-448205-p9_dbt_cs329e_xh_stg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "connection_name": "create_silken-fortress-448205-p9_dbt_cs329e_xh_stg"} */
create schema if not exists `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`
  
[0m11:43:30.888902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:31.166509 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e7f6d46c-be28-48b0-bd7a-fab4ffbf3df5&page=queryresults
[0m11:43:31.947115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m11:43:31.948247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:32.154673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8804b9540>]}
[0m11:43:32.156259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:32.185378 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_data
[0m11:43:32.186754 [debug] [Thread-2 (]: Began running node model.cs329e_xh.employer_details
[0m11:43:32.188189 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_cs329e_xh_stg.company_data .................... [RUN]
[0m11:43:32.189811 [debug] [Thread-3 (]: Began running node model.cs329e_xh.h1b_sentiment_analysis
[0m11:43:32.190786 [debug] [Thread-4 (]: Began running node model.cs329e_xh.lca_appendix
[0m11:43:32.192139 [info ] [Thread-2 (]: 2 of 9 START sql table model dbt_cs329e_xh_stg.employer_details ................ [RUN]
[0m11:43:32.193353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.company_data)
[0m11:43:32.194397 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis .......... [RUN]
[0m11:43:32.195804 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_cs329e_xh_stg.lca_appendix .................... [RUN]
[0m11:43:32.197579 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.cs329e_xh.employer_details'
[0m11:43:32.198592 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_data
[0m11:43:32.199983 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.h1b_sentiment_analysis'
[0m11:43:32.201226 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.lca_appendix'
[0m11:43:32.202354 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.employer_details
[0m11:43:32.214104 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.h1b_sentiment_analysis
[0m11:43:32.227921 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_data"
[0m11:43:32.229350 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.lca_appendix
[0m11:43:32.235329 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.employer_details"
[0m11:43:32.244395 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m11:43:32.251560 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.lca_appendix"
[0m11:43:32.253099 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.employer_details
[0m11:43:32.255616 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.h1b_sentiment_analysis
[0m11:43:32.256790 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_data
[0m11:43:32.263384 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.lca_appendix
[0m11:43:32.335299 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m11:43:32.336426 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.employer_details"
[0m11:43:32.340498 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_data"
[0m11:43:32.345858 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.lca_appendix"
[0m11:43:32.349034 [debug] [Thread-3 (]: On model.cs329e_xh.h1b_sentiment_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.h1b_sentiment_analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
      
    
    

    OPTIONS()
    as (
      
with stg_senti as (
select * 
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`h1b_sentiment_analysis`
)
select * from stg_senti
    );
  
[0m11:43:32.350398 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:43:32.351642 [debug] [Thread-4 (]: On model.cs329e_xh.lca_appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_appendix as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_appendix`
)
select * from stg_lca_appendix
    );
  
[0m11:43:32.355458 [debug] [Thread-2 (]: On model.cs329e_xh.employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details`
      
    
    

    OPTIONS()
    as (
      
with stg_employer_details_1 as (
select
    * except (`tax id`,`line by line` ),
    lpad(cast(cast(`tax id` as int64) as string), 4, '0') as tax_id,
    CAST(REPLACE(`line by line`, ',', '') AS INT64) AS employer_no
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`employer_details`
),
stg_employer_details as (
    select
    employer_no,
    `fiscal year   ` as fiscal_year,
    `employer petitioner name` as employer_petitioner_name,
    tax_id as tax_id,
    `industry naics code` as naics_code,
    `petitioner city` as petitioner_city,
    `petitioner state` as petitioner_state,
    `petitioner zip code` as petitioner_zip_code,
    `initial approval` as initial_approval,
    `initial denial` as initial_denial,
    `continuing approval` as continuing_approval,
    `continuing denial` as continuing_denial,
    _data_source, _load_time
from stg_employer_details_1
) 
select * from stg_employer_details
    );
  
[0m11:43:32.356713 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:43:32.357883 [debug] [Thread-1 (]: On model.cs329e_xh.company_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
      
    
    

    OPTIONS()
    as (
      
with stg_company_data as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`company_data`
)
select * from stg_company_data
    );
  
[0m11:43:32.359008 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:43:32.363337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:32.948413 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:83e3677a-1711-4f71-a618-d4eff0bf48b0&page=queryresults
[0m11:43:32.954822 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:dc78c895-5af2-414c-b7a2-1e374351ad60&page=queryresults
[0m11:43:32.959403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:697927c6-546b-4782-a690-0c6d35ab4aa2&page=queryresults
[0m11:43:32.963074 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0204602e-96db-47f8-b6ef-f6afe8a102dc&page=queryresults
[0m11:43:35.005378 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88050f580>]}
[0m11:43:35.006381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880490850>]}
[0m11:43:35.007961 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_cs329e_xh_stg.lca_appendix ............... [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.80s]
[0m11:43:35.009824 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_cs329e_xh_stg.company_data ............... [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.81s]
[0m11:43:35.011411 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.lca_appendix
[0m11:43:35.012681 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_data
[0m11:43:35.013714 [debug] [Thread-4 (]: Began running node model.cs329e_xh.lca_disclosure
[0m11:43:35.014896 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_worksites
[0m11:43:35.016210 [info ] [Thread-4 (]: 5 of 9 START sql table model dbt_cs329e_xh_stg.lca_disclosure .................. [RUN]
[0m11:43:35.017650 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_cs329e_xh_stg.lca_worksites ................... [RUN]
[0m11:43:35.018946 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_appendix, now model.cs329e_xh.lca_disclosure)
[0m11:43:35.019941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_data, now model.cs329e_xh.lca_worksites)
[0m11:43:35.020826 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.lca_disclosure
[0m11:43:35.021663 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_worksites
[0m11:43:35.028039 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.lca_disclosure"
[0m11:43:35.033829 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_worksites"
[0m11:43:35.035578 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.lca_disclosure
[0m11:43:35.040984 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.lca_disclosure"
[0m11:43:35.042230 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_worksites
[0m11:43:35.049206 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_worksites"
[0m11:43:35.050803 [debug] [Thread-4 (]: On model.cs329e_xh.lca_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
      
    
    

    OPTIONS()
    as (
      
with s as (
SELECT
    * EXCEPT (received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage, total_worksite_locations),
    SAFE_CAST(received_date AS DATETIME) AS received_date,
    SAFE_CAST(decision_date AS DATETIME) AS decision_date,
    SAFE_CAST(original_cert_date AS DATETIME) AS original_cert_date,
    
    SAFE_CAST(total_worker_positions AS INT64) AS total_worker_positions,
    SAFE_CAST(new_employment AS INT64) AS new_employment,
    SAFE_CAST(continued_employment AS INT64) AS continued_employment,
    SAFE_CAST(change_previous_employment AS INT64) AS change_previous_employment,
    SAFE_CAST(new_concurrent_employment AS INT64) AS new_concurrent_employment,
    SAFE_CAST(change_employer AS INT64) AS change_employer,
    SAFE_CAST(amended_petition AS INT64) AS amended_petition,
    SAFE_CAST(worksite_workers AS INT64) AS worksite_workers,
    SAFE_CAST(total_worksite_locations AS INT64) AS total_worksite_locations,

    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_from, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_from,
    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_to, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_to,
    SAFE_CAST(REGEXP_REPLACE(prevailing_wage, r'[\$,]', '') AS FLOAT64) AS prevailing_wage

FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_disclosure`
select * from s
    );
  
[0m11:43:35.051912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:43:35.052804 [debug] [Thread-1 (]: On model.cs329e_xh.lca_worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_worksites as (
select * except(worksite_workers, pw_other_year),
        cast(worksite_workers as int64) as worksite_workers,
        cast(pw_other_year as int64) as pw_other_year
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_worksites`
)
select * from stg_lca_worksites
    );
  
[0m11:43:35.056728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:35.161731 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87b7d2fe0>]}
[0m11:43:35.162976 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis ..... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.96s]
[0m11:43:35.164229 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.h1b_sentiment_analysis
[0m11:43:35.165048 [debug] [Thread-3 (]: Began running node model.cs329e_xh.pw_disclosure
[0m11:43:35.166128 [info ] [Thread-3 (]: 7 of 9 START sql table model dbt_cs329e_xh_stg.pw_disclosure ................... [RUN]
[0m11:43:35.167276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.h1b_sentiment_analysis, now model.cs329e_xh.pw_disclosure)
[0m11:43:35.167936 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.pw_disclosure
[0m11:43:35.173153 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.pw_disclosure"
[0m11:43:35.174222 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.pw_disclosure
[0m11:43:35.179041 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.pw_disclosure"
[0m11:43:35.180157 [debug] [Thread-3 (]: On model.cs329e_xh.pw_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.pw_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
      
    
    

    OPTIONS()
    as (
      
with temp as (
select 
    * except(required_experience_months, required_training_months, alt_training_months, alt_experience_months),
    cast(required_training_months as int64) as required_training_months,
    cast(required_experience_months as int64) as required_experience_months,
    cast(alt_training_months as int64) as alt_training_months,
    cast(alt_experience_months as int64) as alt_experience_months
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`pw_disclosure`
),
stg_pw_disclosure as (
    select 
    * except(bls_area),
    SPLIT(bls_area, ',')[SAFE_OFFSET(0)] AS bls_city,
    IFNULL(SPLIT(bls_area, ',')[SAFE_OFFSET(1)], '') AS bls_state
from temp)
select * from stg_pw_disclosure
    );
  
[0m11:43:35.180918 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:43:35.232423 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f87a141f-3b51-4134-b1a3-492170cd1fbb&page=queryresults
[0m11:43:35.233461 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f87a141f-3b51-4134-b1a3-492170cd1fbb&page=queryresults
[0m11:43:35.309578 [debug] [Thread-4 (]: Database Error in model lca_disclosure (models/stg/lca_disclosure.sql)
  Syntax error: Expected ")" but got keyword SELECT at [36:1]
  compiled code at target/run/cs329e_xh/models/stg/lca_disclosure.sql
[0m11:43:35.310695 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8786a1ed0>]}
[0m11:43:35.311830 [error] [Thread-4 (]: 5 of 9 ERROR creating sql table model dbt_cs329e_xh_stg.lca_disclosure ......... [[31mERROR[0m in 0.29s]
[0m11:43:35.312957 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.lca_disclosure
[0m11:43:35.313822 [debug] [Thread-4 (]: Began running node model.cs329e_xh.single_registrations
[0m11:43:35.314732 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.lca_disclosure' to be skipped because of status 'error'.  Reason: Database Error in model lca_disclosure (models/stg/lca_disclosure.sql)
  Syntax error: Expected ")" but got keyword SELECT at [36:1]
  compiled code at target/run/cs329e_xh/models/stg/lca_disclosure.sql.
[0m11:43:35.315857 [info ] [Thread-4 (]: 8 of 9 START sql table model dbt_cs329e_xh_stg.single_registrations ............ [RUN]
[0m11:43:35.318071 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_disclosure, now model.cs329e_xh.single_registrations)
[0m11:43:35.318768 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.single_registrations
[0m11:43:35.324487 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.single_registrations"
[0m11:43:35.325571 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.single_registrations
[0m11:43:35.330250 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.single_registrations"
[0m11:43:35.331297 [debug] [Thread-4 (]: On model.cs329e_xh.single_registrations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.single_registrations"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
      
    
    

    OPTIONS()
    as (
      
with t1 as (
create or replace table cs329e_xh_stg.temp as
select
    case bcn when '(b)(6)' THEN NULL ELSE bcn END AS bcn,
    case receipt_number when '(b)(6)' THEN NULL ELSE receipt_number END AS receipt_number,
    case ben_date_of_birth when '(b)(6)' THEN NULL ELSE ben_date_of_birth END AS ben_date_of_birth,
    case dol_eta_case_number when '(b)(6)' THEN NULL ELSE dol_eta_case_number END AS dol_eta_case_number,
    *
EXCEPT (bcn, receipt_number, ben_date_of_birth, dol_eta_case_number)
FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`single_registrations`
WHERE bcn != '(b)(3) (b)(6) (b)(7)(c)'
)
, t2 as (select * except(bcn, receipt_number, ben_date_of_birth, dol_eta_case_number, t_u_vawa_flag)
FROM t1)
select * from t2
    );
  
[0m11:43:35.332054 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:43:35.445630 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:16fe78fa-dc06-4111-8c06-05673aee7ec0&page=queryresults
[0m11:43:35.446923 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:16fe78fa-dc06-4111-8c06-05673aee7ec0&page=queryresults
[0m11:43:35.449810 [debug] [Thread-4 (]: Database Error in model single_registrations (models/stg/single_registrations.sql)
  Syntax error: Unexpected keyword CREATE at [15:1]
  compiled code at target/run/cs329e_xh/models/stg/single_registrations.sql
[0m11:43:35.450990 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87858c700>]}
[0m11:43:35.452173 [error] [Thread-4 (]: 8 of 9 ERROR creating sql table model dbt_cs329e_xh_stg.single_registrations ... [[31mERROR[0m in 0.13s]
[0m11:43:35.453241 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.single_registrations
[0m11:43:35.454294 [debug] [Thread-4 (]: Began running node model.cs329e_xh.wage_summary
[0m11:43:35.455353 [info ] [Thread-4 (]: 9 of 9 START sql table model dbt_cs329e_xh_stg.wage_summary .................... [RUN]
[0m11:43:35.456472 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.single_registrations' to be skipped because of status 'error'.  Reason: Database Error in model single_registrations (models/stg/single_registrations.sql)
  Syntax error: Unexpected keyword CREATE at [15:1]
  compiled code at target/run/cs329e_xh/models/stg/single_registrations.sql.
[0m11:43:35.457419 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.single_registrations, now model.cs329e_xh.wage_summary)
[0m11:43:35.458555 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.wage_summary
[0m11:43:35.464287 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.wage_summary"
[0m11:43:35.465375 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.wage_summary
[0m11:43:35.472180 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.wage_summary"
[0m11:43:35.473371 [debug] [Thread-4 (]: On model.cs329e_xh.wage_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
      
    
    

    OPTIONS()
    as (
      
with stg_wage_summary as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`wage_summary`
)
select * from stg_wage_summary
    );
  
[0m11:43:35.474174 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:43:35.564999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:332a69e9-a07c-460c-87a4-ee758b0c6e9e&page=queryresults
[0m11:43:35.625591 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b6d35762-824c-4dc9-b1c5-d7e457d914a3&page=queryresults
[0m11:43:35.935662 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f0603a20-3e66-460b-95a6-91040ef5677a&page=queryresults
[0m11:43:35.979091 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8803ebf40>]}
[0m11:43:35.980398 [info ] [Thread-2 (]: 2 of 9 OK created sql table model dbt_cs329e_xh_stg.employer_details ........... [[32mCREATE TABLE (61.5k rows, 9.3 MiB processed)[0m in 3.78s]
[0m11:43:35.981652 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.employer_details
[0m11:43:37.964673 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87858c400>]}
[0m11:43:37.965991 [info ] [Thread-4 (]: 9 of 9 OK created sql table model dbt_cs329e_xh_stg.wage_summary ............... [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.51s]
[0m11:43:37.967449 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.wage_summary
[0m11:43:42.375327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87858c400>]}
[0m11:43:42.376602 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_cs329e_xh_stg.lca_worksites .............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 7.36s]
[0m11:43:42.378012 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_worksites
[0m11:43:48.260433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a541d983-2bb5-4c3b-8de1-e48712b56730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8803ebf10>]}
[0m11:43:48.261741 [info ] [Thread-3 (]: 7 of 9 OK created sql table model dbt_cs329e_xh_stg.pw_disclosure .............. [[32mCREATE TABLE (237.9k rows, 372.8 MiB processed)[0m in 13.09s]
[0m11:43:48.263088 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.pw_disclosure
[0m11:43:48.265918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:48.267139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:48.267752 [debug] [MainThread]: Connection 'model.cs329e_xh.lca_worksites' was properly closed.
[0m11:43:48.268258 [debug] [MainThread]: Connection 'model.cs329e_xh.employer_details' was properly closed.
[0m11:43:48.268773 [debug] [MainThread]: Connection 'model.cs329e_xh.pw_disclosure' was properly closed.
[0m11:43:48.269369 [debug] [MainThread]: Connection 'model.cs329e_xh.wage_summary' was properly closed.
[0m11:43:48.270071 [info ] [MainThread]: 
[0m11:43:48.270818 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 17.58 seconds (17.58s).
[0m11:43:48.273785 [debug] [MainThread]: Command end result
[0m11:43:48.469535 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m11:43:48.472149 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m11:43:48.482191 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m11:43:48.482894 [info ] [MainThread]: 
[0m11:43:48.483695 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:43:48.484611 [info ] [MainThread]: 
[0m11:43:48.485559 [error] [MainThread]:   Database Error in model lca_disclosure (models/stg/lca_disclosure.sql)
  Syntax error: Expected ")" but got keyword SELECT at [36:1]
  compiled code at target/run/cs329e_xh/models/stg/lca_disclosure.sql
[0m11:43:48.486257 [info ] [MainThread]: 
[0m11:43:48.487195 [error] [MainThread]:   Database Error in model single_registrations (models/stg/single_registrations.sql)
  Syntax error: Unexpected keyword CREATE at [15:1]
  compiled code at target/run/cs329e_xh/models/stg/single_registrations.sql
[0m11:43:48.487936 [info ] [MainThread]: 
[0m11:43:48.488764 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m11:43:48.489959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 22.044735, "process_in_blocks": "696", "process_kernel_time": 0.51016, "process_mem_max_rss": "269632", "process_out_blocks": "3384", "process_user_time": 6.901541}
[0m11:43:48.490690 [debug] [MainThread]: Command `dbt run` failed at 11:43:48.490537 after 22.05 seconds
[0m11:43:48.491314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89cfbd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89d291ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8804f7850>]}
[0m11:43:48.491987 [debug] [MainThread]: Flushing usage events
[0m11:43:48.662744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:58.417956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc20c955a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc1fe1a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc1fe1a380>]}


============================== 11:44:58.422478 | 3e47c5bc-ce70-414f-b210-f7c109051e41 ==============================
[0m11:44:58.422478 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:44:58.423435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:45:00.305810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc20475f00>]}
[0m11:45:00.401071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc1feb4430>]}
[0m11:45:00.402303 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:45:00.589092 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:45:00.761757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m11:45:00.762816 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/single_registrations-checkpoint.sql
[0m11:45:00.763540 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/lca_disclosure-checkpoint.sql
[0m11:45:00.764184 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/stg/single_registrations.sql
[0m11:45:00.764857 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/stg/lca_disclosure.sql
[0m11:45:01.183612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.cs329e_xh.mrt
- models.cs329e_xh.int
[0m11:45:01.207006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04b1d540>]}
[0m11:45:01.340043 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m11:45:01.342709 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m11:45:01.360327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04d1ece0>]}
[0m11:45:01.361347 [info ] [MainThread]: Found 11 models, 9 sources, 492 macros
[0m11:45:01.362095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04d1ebc0>]}
[0m11:45:01.365662 [info ] [MainThread]: 
[0m11:45:01.366454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:45:01.367130 [info ] [MainThread]: 
[0m11:45:01.368094 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:45:01.377450 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m11:45:01.378897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:01.567449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m11:45:01.568434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:01.756529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc221dab90>]}
[0m11:45:01.757508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:01.762606 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_data
[0m11:45:01.764267 [info ] [Thread-1 (]: 1 of 11 START sql table model dbt_cs329e_xh_stg.company_data ................... [RUN]
[0m11:45:01.765891 [debug] [Thread-2 (]: Began running node model.cs329e_xh.employer_details
[0m11:45:01.767035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.company_data)
[0m11:45:01.768100 [debug] [Thread-3 (]: Began running node model.cs329e_xh.h1b_sentiment_analysis
[0m11:45:01.769222 [info ] [Thread-2 (]: 2 of 11 START sql table model dbt_cs329e_xh_stg.employer_details ............... [RUN]
[0m11:45:01.770220 [debug] [Thread-4 (]: Began running node model.cs329e_xh.lca_appendix
[0m11:45:01.770917 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_data
[0m11:45:01.771863 [info ] [Thread-3 (]: 3 of 11 START sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis ......... [RUN]
[0m11:45:01.773013 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.cs329e_xh.employer_details'
[0m11:45:01.774002 [info ] [Thread-4 (]: 4 of 11 START sql table model dbt_cs329e_xh_stg.lca_appendix ................... [RUN]
[0m11:45:01.796378 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.h1b_sentiment_analysis'
[0m11:45:01.797934 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_data"
[0m11:45:01.799249 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.employer_details
[0m11:45:01.800570 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.lca_appendix'
[0m11:45:01.801791 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.h1b_sentiment_analysis
[0m11:45:01.808501 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_data
[0m11:45:01.809664 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.employer_details"
[0m11:45:01.810587 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.lca_appendix
[0m11:45:01.816629 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m11:45:01.851082 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.lca_appendix"
[0m11:45:01.859257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:01.860648 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.employer_details
[0m11:45:01.869672 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:45:01.870646 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.h1b_sentiment_analysis
[0m11:45:01.872856 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.lca_appendix
[0m11:45:01.880488 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:45:01.885407 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:45:02.063111 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.lca_appendix"
[0m11:45:02.065057 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_data"
[0m11:45:02.067411 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.employer_details"
[0m11:45:02.070078 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m11:45:02.072021 [debug] [Thread-4 (]: On model.cs329e_xh.lca_appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_appendix as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_appendix`
)
select * from stg_lca_appendix
    );
  
[0m11:45:02.073639 [debug] [Thread-1 (]: On model.cs329e_xh.company_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
      
    
    

    OPTIONS()
    as (
      
with stg_company_data as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`company_data`
)
select * from stg_company_data
    );
  
[0m11:45:02.075126 [debug] [Thread-2 (]: On model.cs329e_xh.employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details`
      
    
    

    OPTIONS()
    as (
      
with stg_employer_details_1 as (
select
    * except (`tax id`,`line by line` ),
    lpad(cast(cast(`tax id` as int64) as string), 4, '0') as tax_id,
    CAST(REPLACE(`line by line`, ',', '') AS INT64) AS employer_no
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`employer_details`
),
stg_employer_details as (
    select
    employer_no,
    `fiscal year   ` as fiscal_year,
    `employer petitioner name` as employer_petitioner_name,
    tax_id as tax_id,
    `industry naics code` as naics_code,
    `petitioner city` as petitioner_city,
    `petitioner state` as petitioner_state,
    `petitioner zip code` as petitioner_zip_code,
    `initial approval` as initial_approval,
    `initial denial` as initial_denial,
    `continuing approval` as continuing_approval,
    `continuing denial` as continuing_denial,
    _data_source, _load_time
from stg_employer_details_1
) 
select * from stg_employer_details
    );
  
[0m11:45:02.078520 [debug] [Thread-3 (]: On model.cs329e_xh.h1b_sentiment_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.h1b_sentiment_analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
      
    
    

    OPTIONS()
    as (
      
with stg_senti as (
select * 
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`h1b_sentiment_analysis`
)
select * from stg_senti
    );
  
[0m11:45:02.317082 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6849dfb6-a3e4-44ba-a5be-258ed45076b1&page=queryresults
[0m11:45:02.449298 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a6112936-63d6-4bc2-877a-dda6c0844a70&page=queryresults
[0m11:45:02.500896 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:548fbeeb-14fa-458e-97f4-f51342b03e05&page=queryresults
[0m11:45:02.506226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6cd1a0e0-c3c1-481c-ba4d-6e0893ab3d7d&page=queryresults
[0m11:45:04.530392 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04d1f2b0>]}
[0m11:45:04.531788 [info ] [Thread-3 (]: 3 of 11 OK created sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis .... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.73s]
[0m11:45:04.533290 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.h1b_sentiment_analysis
[0m11:45:04.534451 [debug] [Thread-3 (]: Began running node model.cs329e_xh.lca_disclosure
[0m11:45:04.536169 [info ] [Thread-3 (]: 5 of 11 START sql table model dbt_cs329e_xh_stg.lca_disclosure ................. [RUN]
[0m11:45:04.537221 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.h1b_sentiment_analysis, now model.cs329e_xh.lca_disclosure)
[0m11:45:04.538755 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.lca_disclosure
[0m11:45:04.544561 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.lca_disclosure"
[0m11:45:04.545712 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.lca_disclosure
[0m11:45:04.551835 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.lca_disclosure"
[0m11:45:04.553096 [debug] [Thread-3 (]: On model.cs329e_xh.lca_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
      
    
    

    OPTIONS()
    as (
      
with s as (
SELECT
    * EXCEPT (received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage, total_worksite_locations),
    SAFE_CAST(received_date AS DATETIME) AS received_date,
    SAFE_CAST(decision_date AS DATETIME) AS decision_date,
    SAFE_CAST(original_cert_date AS DATETIME) AS original_cert_date,
    
    SAFE_CAST(total_worker_positions AS INT64) AS total_worker_positions,
    SAFE_CAST(new_employment AS INT64) AS new_employment,
    SAFE_CAST(continued_employment AS INT64) AS continued_employment,
    SAFE_CAST(change_previous_employment AS INT64) AS change_previous_employment,
    SAFE_CAST(new_concurrent_employment AS INT64) AS new_concurrent_employment,
    SAFE_CAST(change_employer AS INT64) AS change_employer,
    SAFE_CAST(amended_petition AS INT64) AS amended_petition,
    SAFE_CAST(worksite_workers AS INT64) AS worksite_workers,
    SAFE_CAST(total_worksite_locations AS INT64) AS total_worksite_locations,

    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_from, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_from,
    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_to, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_to,
    SAFE_CAST(REGEXP_REPLACE(prevailing_wage, r'[\$,]', '') AS FLOAT64) AS prevailing_wage

FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_disclosure`
    )
select * from s
    );
  
[0m11:45:04.554181 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:45:04.758545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04d1fa60>]}
[0m11:45:04.760860 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dbt_cs329e_xh_stg.company_data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.99s]
[0m11:45:04.762978 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_data
[0m11:45:04.765220 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_disclosure-checkpoint
[0m11:45:04.767207 [info ] [Thread-1 (]: 6 of 11 START sql table model dbt_cs329e_xh_stg.lca_disclosure-checkpoint ...... [RUN]
[0m11:45:04.772496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_data, now model.cs329e_xh.lca_disclosure-checkpoint)
[0m11:45:04.774230 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_disclosure-checkpoint
[0m11:45:04.784192 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_disclosure-checkpoint"
[0m11:45:04.786140 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_disclosure-checkpoint
[0m11:45:04.794301 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_disclosure-checkpoint"
[0m11:45:04.796247 [debug] [Thread-1 (]: On model.cs329e_xh.lca_disclosure-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_disclosure-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure-checkpoint`
      
    
    

    OPTIONS()
    as (
      
with s as (
SELECT
    * EXCEPT (received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage, total_worksite_locations),
    SAFE_CAST(received_date AS DATETIME) AS received_date,
    SAFE_CAST(decision_date AS DATETIME) AS decision_date,
    SAFE_CAST(original_cert_date AS DATETIME) AS original_cert_date,
    
    SAFE_CAST(total_worker_positions AS INT64) AS total_worker_positions,
    SAFE_CAST(new_employment AS INT64) AS new_employment,
    SAFE_CAST(continued_employment AS INT64) AS continued_employment,
    SAFE_CAST(change_previous_employment AS INT64) AS change_previous_employment,
    SAFE_CAST(new_concurrent_employment AS INT64) AS new_concurrent_employment,
    SAFE_CAST(change_employer AS INT64) AS change_employer,
    SAFE_CAST(amended_petition AS INT64) AS amended_petition,
    SAFE_CAST(worksite_workers AS INT64) AS worksite_workers,
    SAFE_CAST(total_worksite_locations AS INT64) AS total_worksite_locations,

    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_from, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_from,
    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_to, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_to,
    SAFE_CAST(REGEXP_REPLACE(prevailing_wage, r'[\$,]', '') AS FLOAT64) AS prevailing_wage

FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_disclosure`
    )
select * from s
    );
  
[0m11:45:04.797842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:04.924843 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6e66f31d-80f4-4cf4-a6bd-e3282c3459f6&page=queryresults
[0m11:45:04.970429 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04258070>]}
[0m11:45:04.971799 [info ] [Thread-4 (]: 4 of 11 OK created sql table model dbt_cs329e_xh_stg.lca_appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 3.17s]
[0m11:45:04.973711 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.lca_appendix
[0m11:45:04.974656 [debug] [Thread-4 (]: Began running node model.cs329e_xh.lca_worksites
[0m11:45:04.976109 [info ] [Thread-4 (]: 7 of 11 START sql table model dbt_cs329e_xh_stg.lca_worksites .................. [RUN]
[0m11:45:04.977218 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_appendix, now model.cs329e_xh.lca_worksites)
[0m11:45:04.978157 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.lca_worksites
[0m11:45:04.983970 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.lca_worksites"
[0m11:45:04.985108 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.lca_worksites
[0m11:45:04.989534 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:45:05.006093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:98d16f4e-f911-49cd-92e8-a89114c289bf&page=queryresults
[0m11:45:05.255950 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.lca_worksites"
[0m11:45:05.257195 [debug] [Thread-4 (]: On model.cs329e_xh.lca_worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_worksites as (
select * except(worksite_workers, pw_other_year),
        cast(worksite_workers as int64) as worksite_workers,
        cast(pw_other_year as int64) as pw_other_year
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_worksites`
)
select * from stg_lca_worksites
    );
  
[0m11:45:05.498194 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc042cef20>]}
[0m11:45:05.499409 [info ] [Thread-2 (]: 2 of 11 OK created sql table model dbt_cs329e_xh_stg.employer_details .......... [[32mCREATE TABLE (61.5k rows, 9.3 MiB processed)[0m in 3.73s]
[0m11:45:05.500713 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.employer_details
[0m11:45:05.501563 [debug] [Thread-2 (]: Began running node model.cs329e_xh.pw_disclosure
[0m11:45:05.502573 [info ] [Thread-2 (]: 8 of 11 START sql table model dbt_cs329e_xh_stg.pw_disclosure .................. [RUN]
[0m11:45:05.503666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.employer_details, now model.cs329e_xh.pw_disclosure)
[0m11:45:05.504323 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.pw_disclosure
[0m11:45:05.509866 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.pw_disclosure"
[0m11:45:05.510854 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.pw_disclosure
[0m11:45:05.517229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:45:05.560529 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:58418286-3573-4bb8-8644-dcc69793e659&page=queryresults
[0m11:45:05.694619 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.pw_disclosure"
[0m11:45:05.695900 [debug] [Thread-2 (]: On model.cs329e_xh.pw_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.pw_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
      
    
    

    OPTIONS()
    as (
      
with temp as (
select 
    * except(required_experience_months, required_training_months, alt_training_months, alt_experience_months),
    cast(required_training_months as int64) as required_training_months,
    cast(required_experience_months as int64) as required_experience_months,
    cast(alt_training_months as int64) as alt_training_months,
    cast(alt_experience_months as int64) as alt_experience_months
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`pw_disclosure`
),
stg_pw_disclosure as (
    select 
    * except(bls_area),
    SPLIT(bls_area, ',')[SAFE_OFFSET(0)] AS bls_city,
    IFNULL(SPLIT(bls_area, ',')[SAFE_OFFSET(1)], '') AS bls_state
from temp)
select * from stg_pw_disclosure
    );
  
[0m11:45:05.979863 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a9fe3ad0-eb30-489b-8bb9-812342b40541&page=queryresults
[0m11:45:12.070351 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04b1eb30>]}
[0m11:45:12.071635 [info ] [Thread-4 (]: 7 of 11 OK created sql table model dbt_cs329e_xh_stg.lca_worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 7.09s]
[0m11:45:12.072753 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.lca_worksites
[0m11:45:12.073968 [debug] [Thread-4 (]: Began running node model.cs329e_xh.single_registrations
[0m11:45:12.075131 [info ] [Thread-4 (]: 9 of 11 START sql table model dbt_cs329e_xh_stg.single_registrations ........... [RUN]
[0m11:45:12.076215 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_worksites, now model.cs329e_xh.single_registrations)
[0m11:45:12.076899 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.single_registrations
[0m11:45:12.082401 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.single_registrations"
[0m11:45:12.083498 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.single_registrations
[0m11:45:12.088883 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.single_registrations"
[0m11:45:12.090076 [debug] [Thread-4 (]: On model.cs329e_xh.single_registrations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.single_registrations"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
      
    
    

    OPTIONS()
    as (
      
with t1 as (
select
    case bcn when '(b)(6)' THEN NULL ELSE bcn END AS bcn,
    case receipt_number when '(b)(6)' THEN NULL ELSE receipt_number END AS receipt_number,
    case ben_date_of_birth when '(b)(6)' THEN NULL ELSE ben_date_of_birth END AS ben_date_of_birth,
    case dol_eta_case_number when '(b)(6)' THEN NULL ELSE dol_eta_case_number END AS dol_eta_case_number,
    *
EXCEPT (bcn, receipt_number, ben_date_of_birth, dol_eta_case_number)
FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`single_registrations`
WHERE bcn != '(b)(3) (b)(6) (b)(7)(c)'
)
, t2 as (select * except(bcn, receipt_number, ben_date_of_birth, dol_eta_case_number, t_u_vawa_flag)
FROM t1)
select * from t2
    );
  
[0m11:45:12.090852 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:45:12.439172 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f9e59c57-8908-47f9-88f3-bfc946b3faec&page=queryresults
[0m11:45:15.433847 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc20f6fc70>]}
[0m11:45:15.435017 [info ] [Thread-3 (]: 5 of 11 OK created sql table model dbt_cs329e_xh_stg.lca_disclosure ............ [[32mCREATE TABLE (561.0k rows, 485.1 MiB processed)[0m in 10.90s]
[0m11:45:15.436232 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.lca_disclosure
[0m11:45:15.437002 [debug] [Thread-3 (]: Began running node model.cs329e_xh.single_registrations-checkpoint
[0m11:45:15.438024 [info ] [Thread-3 (]: 10 of 11 START sql table model dbt_cs329e_xh_stg.single_registrations-checkpoint  [RUN]
[0m11:45:15.439028 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_disclosure, now model.cs329e_xh.single_registrations-checkpoint)
[0m11:45:15.439668 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.single_registrations-checkpoint
[0m11:45:15.444795 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.single_registrations-checkpoint"
[0m11:45:15.445842 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.single_registrations-checkpoint
[0m11:45:15.450435 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.single_registrations-checkpoint"
[0m11:45:15.451683 [debug] [Thread-3 (]: On model.cs329e_xh.single_registrations-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.single_registrations-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations-checkpoint`
      
    
    

    OPTIONS()
    as (
      
with t1 as (
select
    case bcn when '(b)(6)' THEN NULL ELSE bcn END AS bcn,
    case receipt_number when '(b)(6)' THEN NULL ELSE receipt_number END AS receipt_number,
    case ben_date_of_birth when '(b)(6)' THEN NULL ELSE ben_date_of_birth END AS ben_date_of_birth,
    case dol_eta_case_number when '(b)(6)' THEN NULL ELSE dol_eta_case_number END AS dol_eta_case_number,
    *
EXCEPT (bcn, receipt_number, ben_date_of_birth, dol_eta_case_number)
FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`single_registrations`
WHERE bcn != '(b)(3) (b)(6) (b)(7)(c)'
)
, t2 as (select * except(bcn, receipt_number, ben_date_of_birth, dol_eta_case_number, t_u_vawa_flag)
FROM t1)
select * from t2
    );
  
[0m11:45:15.452428 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:45:15.714829 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f205a4bc-b826-4ee5-b587-82016b128391&page=queryresults
[0m11:45:15.961449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfc650820>]}
[0m11:45:15.962683 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dbt_cs329e_xh_stg.lca_disclosure-checkpoint . [[32mCREATE TABLE (561.0k rows, 485.1 MiB processed)[0m in 11.19s]
[0m11:45:15.963988 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_disclosure-checkpoint
[0m11:45:15.964747 [debug] [Thread-1 (]: Began running node model.cs329e_xh.wage_summary
[0m11:45:15.965684 [info ] [Thread-1 (]: 11 of 11 START sql table model dbt_cs329e_xh_stg.wage_summary .................. [RUN]
[0m11:45:15.966747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_disclosure-checkpoint, now model.cs329e_xh.wage_summary)
[0m11:45:15.967381 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.wage_summary
[0m11:45:15.974302 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.wage_summary"
[0m11:45:15.975371 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.wage_summary
[0m11:45:15.979854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:16.133161 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.wage_summary"
[0m11:45:16.134467 [debug] [Thread-1 (]: On model.cs329e_xh.wage_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
      
    
    

    OPTIONS()
    as (
      
with stg_wage_summary as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`wage_summary`
)
select * from stg_wage_summary
    );
  
[0m11:45:16.422841 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b8e44c66-806d-4e4f-b6ec-495984dcbe1d&page=queryresults
[0m11:45:18.561300 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04b1e170>]}
[0m11:45:18.562595 [info ] [Thread-4 (]: 9 of 11 OK created sql table model dbt_cs329e_xh_stg.single_registrations ...... [[32mCREATE TABLE (350.1k rows, 78.4 MiB processed)[0m in 6.49s]
[0m11:45:18.563709 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.single_registrations
[0m11:45:18.624046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04b1fca0>]}
[0m11:45:18.625243 [info ] [Thread-1 (]: 11 of 11 OK created sql table model dbt_cs329e_xh_stg.wage_summary ............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.66s]
[0m11:45:18.626337 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.wage_summary
[0m11:45:19.298746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc042cef20>]}
[0m11:45:19.299955 [info ] [Thread-2 (]: 8 of 11 OK created sql table model dbt_cs329e_xh_stg.pw_disclosure ............. [[32mCREATE TABLE (237.9k rows, 372.8 MiB processed)[0m in 13.80s]
[0m11:45:19.301241 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.pw_disclosure
[0m11:45:21.464206 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e47c5bc-ce70-414f-b210-f7c109051e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc04b1f940>]}
[0m11:45:21.465547 [info ] [Thread-3 (]: 10 of 11 OK created sql table model dbt_cs329e_xh_stg.single_registrations-checkpoint  [[32mCREATE TABLE (350.1k rows, 78.4 MiB processed)[0m in 6.03s]
[0m11:45:21.466790 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.single_registrations-checkpoint
[0m11:45:21.469827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:21.471037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:21.471651 [debug] [MainThread]: Connection 'model.cs329e_xh.wage_summary' was properly closed.
[0m11:45:21.472206 [debug] [MainThread]: Connection 'model.cs329e_xh.pw_disclosure' was properly closed.
[0m11:45:21.472912 [debug] [MainThread]: Connection 'model.cs329e_xh.single_registrations-checkpoint' was properly closed.
[0m11:45:21.473505 [debug] [MainThread]: Connection 'model.cs329e_xh.single_registrations' was properly closed.
[0m11:45:21.474242 [info ] [MainThread]: 
[0m11:45:21.474878 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 20.11 seconds (20.11s).
[0m11:45:21.478158 [debug] [MainThread]: Command end result
[0m11:45:21.672045 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m11:45:21.674891 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m11:45:21.686721 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m11:45:21.687434 [info ] [MainThread]: 
[0m11:45:21.688262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:21.689522 [info ] [MainThread]: 
[0m11:45:21.690274 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:45:21.691515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.355131, "process_in_blocks": "0", "process_kernel_time": 0.573647, "process_mem_max_rss": "267472", "process_out_blocks": "3496", "process_user_time": 5.803889}
[0m11:45:21.692354 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:21.692192 after 23.36 seconds
[0m11:45:21.693026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc20c955a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc210f8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc23bd3b50>]}
[0m11:45:21.693757 [debug] [MainThread]: Flushing usage events
[0m11:45:21.863859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:56.698638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bf7d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795b1023b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795b102350>]}


============================== 23:57:56.710524 | 61be4ab5-2861-4f62-98a3-175da337d6e9 ==============================
[0m23:57:56.710524 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:57:56.711683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models int', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:58:03.391196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61be4ab5-2861-4f62-98a3-175da337d6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795b6960b0>]}
[0m23:58:03.488517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61be4ab5-2861-4f62-98a3-175da337d6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795b19c9d0>]}
[0m23:58:03.489640 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:58:03.723592 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:58:04.191394 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 30 files added, 0 files changed.
[0m23:58:04.192461 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m23:58:04.193113 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m23:58:04.193732 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m23:58:04.194332 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/h1b_sentiment_analysis-checkpoint.sql
[0m23:58:04.194867 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m23:58:04.195404 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/lca_appendix-checkpoint.sql
[0m23:58:04.195934 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/company_data-checkpoint.sql
[0m23:58:04.196466 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/PW_Disclosure.sql
[0m23:58:04.196998 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m23:58:04.197556 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Single_Registration.sql
[0m23:58:04.198180 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Single_Registration-checkpoint.sql
[0m23:58:04.198736 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m23:58:04.199250 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Company_Data.sql
[0m23:58:04.199787 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Sentiment_Analysis.sql
[0m23:58:04.200294 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Wage_Summary.sql
[0m23:58:04.200826 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/temp_emp.sql
[0m23:58:04.201349 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m23:58:04.201944 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/lca_worksites-checkpoint.sql
[0m23:58:04.202502 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/LCA_Disclosure.sql
[0m23:58:04.203086 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/pw_disclosure-checkpoint.sql
[0m23:58:04.203623 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Appendix-checkpoint.sql
[0m23:58:04.204161 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Sentiment_Analysis-checkpoint.sql
[0m23:58:04.204713 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/Employer_Detail.sql
[0m23:58:04.205242 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/employer_details-checkpoint.sql
[0m23:58:04.206090 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/LCA_Worksites.sql
[0m23:58:04.206711 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Disclosure-checkpoint.sql
[0m23:58:04.207262 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/temp_employer_details.sql
[0m23:58:04.207845 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/matching.py
[0m23:58:04.208413 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/LCA_Appendix.sql
[0m23:58:04.209048 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/schema-checkpoint.yml
[0m23:58:04.209567 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/stg/.ipynb_checkpoints/single_registrations-checkpoint.sql
[0m23:58:04.754686 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "cs329e_xh_raw_company_data".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("cs329e_xh_raw", "company_data").
  
  To fix this, change the name of one of these resources:
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/.ipynb_checkpoints/schema-checkpoint.yml)
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/schema.yml)
[0m23:58:04.756497 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.156379, "process_in_blocks": "257440", "process_kernel_time": 0.769045, "process_mem_max_rss": "259956", "process_out_blocks": "24", "process_user_time": 5.098152}
[0m23:58:04.757268 [debug] [MainThread]: Command `dbt run` failed at 23:58:04.757117 after 8.16 seconds
[0m23:58:04.757928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bf7d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793f621060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793f6e7190>]}
[0m23:58:04.758665 [debug] [MainThread]: Flushing usage events
[0m23:58:04.903668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:42.070725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb42e515d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb41fb23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb41fb2380>]}


============================== 00:00:42.074577 | 274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c ==============================
[0m00:00:42.074577 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:00:42.075419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:00:43.819054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb41f757e0>]}
[0m00:00:43.906059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb42d1d060>]}
[0m00:00:43.907165 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:00:44.084108 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:00:44.247859 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 16 files added, 0 files changed.
[0m00:00:44.248851 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Sentiment_Analysis.sql
[0m00:00:44.249473 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/temp_emp.sql
[0m00:00:44.250130 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Company_Data.sql
[0m00:00:44.250714 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/LCA_Appendix.sql
[0m00:00:44.251242 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/PW_Disclosure.sql
[0m00:00:44.251775 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m00:00:44.252317 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Wage_Summary.sql
[0m00:00:44.252861 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/matching.py
[0m00:00:44.253400 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m00:00:44.253992 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/Employer_Detail.sql
[0m00:00:44.254569 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Single_Registration.sql
[0m00:00:44.255093 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m00:00:44.255700 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/LCA_Disclosure.sql
[0m00:00:44.256231 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/LCA_Worksites.sql
[0m00:00:44.256767 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m00:00:44.257284 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/temp_employer_details.sql
[0m00:00:44.257771 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/stg/.ipynb_checkpoints/lca_disclosure-checkpoint.sql
[0m00:00:44.258333 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/stg/.ipynb_checkpoints/single_registrations-checkpoint.sql
[0m00:00:44.687782 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:00:44.709985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26cb4130>]}
[0m00:00:44.834120 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:00:44.838403 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:00:44.921743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26eb0940>]}
[0m00:00:44.922749 [info ] [MainThread]: Found 25 models, 9 sources, 492 macros
[0m00:00:44.923690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26eb1840>]}
[0m00:00:44.928105 [info ] [MainThread]: 
[0m00:00:44.928901 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:44.929582 [info ] [MainThread]: 
[0m00:00:44.930635 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:00:44.939250 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:00:44.940395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:44.941873 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:00:44.942801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:45.771400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now create_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:00:45.772534 [debug] [ThreadPool]: Creating schema "database: "silken-fortress-448205-p9"
schema: "dbt_cs329e_xh_int"
"
[0m00:00:45.786629 [debug] [ThreadPool]: On create_silken-fortress-448205-p9_dbt_cs329e_xh_int: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "connection_name": "create_silken-fortress-448205-p9_dbt_cs329e_xh_int"} */
create schema if not exists `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`
  
[0m00:00:45.787450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:46.092472 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4ef05ecc-2780-43e0-a5ab-67e73308f42d&page=queryresults
[0m00:00:46.997937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:00:46.999028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m00:00:46.999924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:47.000657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:47.245964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4437fa00>]}
[0m00:00:47.246998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:47.262252 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_data
[0m00:00:47.263241 [debug] [Thread-2 (]: Began running node model.cs329e_xh.employer_details
[0m00:00:47.264319 [info ] [Thread-1 (]: 1 of 19 START sql table model dbt_cs329e_xh_stg.company_data ................... [RUN]
[0m00:00:47.265468 [debug] [Thread-3 (]: Began running node model.cs329e_xh.h1b_sentiment_analysis
[0m00:00:47.267409 [debug] [Thread-4 (]: Began running node model.cs329e_xh.lca_appendix
[0m00:00:47.266755 [info ] [Thread-2 (]: 2 of 19 START sql table model dbt_cs329e_xh_stg.employer_details ............... [RUN]
[0m00:00:47.268770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.company_data)
[0m00:00:47.269691 [info ] [Thread-3 (]: 3 of 19 START sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis ......... [RUN]
[0m00:00:47.270919 [info ] [Thread-4 (]: 4 of 19 START sql table model dbt_cs329e_xh_stg.lca_appendix ................... [RUN]
[0m00:00:47.271843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.employer_details)
[0m00:00:47.272576 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_data
[0m00:00:47.273557 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.h1b_sentiment_analysis'
[0m00:00:47.274602 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.lca_appendix'
[0m00:00:47.275419 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.employer_details
[0m00:00:47.286638 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.h1b_sentiment_analysis
[0m00:00:47.289225 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_data"
[0m00:00:47.290228 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.lca_appendix
[0m00:00:47.295634 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.employer_details"
[0m00:00:47.300762 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m00:00:47.306141 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.lca_appendix"
[0m00:00:47.308831 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.h1b_sentiment_analysis
[0m00:00:47.314940 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_data
[0m00:00:47.336759 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.lca_appendix
[0m00:00:47.348477 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.employer_details
[0m00:00:47.358267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:00:47.357574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:47.363051 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:00:47.367146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:47.539013 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.lca_appendix"
[0m00:00:47.540924 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m00:00:47.544954 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_data"
[0m00:00:47.546896 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.employer_details"
[0m00:00:47.549919 [debug] [Thread-4 (]: On model.cs329e_xh.lca_appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_appendix as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_appendix`
)
select * from stg_lca_appendix
    );
  
[0m00:00:47.551005 [debug] [Thread-1 (]: On model.cs329e_xh.company_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
      
    
    

    OPTIONS()
    as (
      
with stg_company_data as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`company_data`
)
select * from stg_company_data
    );
  
[0m00:00:47.551950 [debug] [Thread-3 (]: On model.cs329e_xh.h1b_sentiment_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.h1b_sentiment_analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
      
    
    

    OPTIONS()
    as (
      
with stg_senti as (
select * 
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`h1b_sentiment_analysis`
)
select * from stg_senti
    );
  
[0m00:00:47.554798 [debug] [Thread-2 (]: On model.cs329e_xh.employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details`
      
    
    

    OPTIONS()
    as (
      
with stg_employer_details_1 as (
select
    * except (`tax id`,`line by line` ),
    lpad(cast(cast(`tax id` as int64) as string), 4, '0') as tax_id,
    CAST(REPLACE(`line by line`, ',', '') AS INT64) AS employer_no
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`employer_details`
),
stg_employer_details as (
    select
    employer_no,
    `fiscal year   ` as fiscal_year,
    `employer petitioner name` as employer_petitioner_name,
    tax_id as tax_id,
    `industry naics code` as naics_code,
    `petitioner city` as petitioner_city,
    `petitioner state` as petitioner_state,
    `petitioner zip code` as petitioner_zip_code,
    `initial approval` as initial_approval,
    `initial denial` as initial_denial,
    `continuing approval` as continuing_approval,
    `continuing denial` as continuing_denial,
    _data_source, _load_time
from stg_employer_details_1
) 
select * from stg_employer_details
    );
  
[0m00:00:47.956918 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f6bbb05c-d00e-445e-9dfc-f0819fa99e47&page=queryresults
[0m00:00:47.959664 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fa37ec99-206c-4103-bc86-3efdd25af464&page=queryresults
[0m00:00:47.963067 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:58c58d35-5bd0-4c00-ad15-b2fe9eac60f2&page=queryresults
[0m00:00:47.994994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f4855c01-58a1-441c-bc63-831e1ca60386&page=queryresults
[0m00:00:49.979705 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26d1dea0>]}
[0m00:00:49.980631 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26548430>]}
[0m00:00:49.982067 [info ] [Thread-4 (]: 4 of 19 OK created sql table model dbt_cs329e_xh_stg.lca_appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.70s]
[0m00:00:49.983690 [info ] [Thread-3 (]: 3 of 19 OK created sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis .... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.70s]
[0m00:00:49.985061 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.lca_appendix
[0m00:00:49.986119 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.h1b_sentiment_analysis
[0m00:00:49.986932 [debug] [Thread-4 (]: Began running node model.cs329e_xh.lca_disclosure
[0m00:00:49.988066 [debug] [Thread-3 (]: Began running node model.cs329e_xh.lca_worksites
[0m00:00:49.989308 [info ] [Thread-4 (]: 5 of 19 START sql table model dbt_cs329e_xh_stg.lca_disclosure ................. [RUN]
[0m00:00:49.990525 [info ] [Thread-3 (]: 6 of 19 START sql table model dbt_cs329e_xh_stg.lca_worksites .................. [RUN]
[0m00:00:49.991597 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_appendix, now model.cs329e_xh.lca_disclosure)
[0m00:00:49.992529 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.h1b_sentiment_analysis, now model.cs329e_xh.lca_worksites)
[0m00:00:49.993277 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.lca_disclosure
[0m00:00:49.994063 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.lca_worksites
[0m00:00:50.001323 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.lca_disclosure"
[0m00:00:50.006851 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.lca_worksites"
[0m00:00:50.008369 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.lca_disclosure
[0m00:00:50.012408 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:50.013259 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.lca_worksites
[0m00:00:50.019075 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:50.098417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26532590>]}
[0m00:00:50.099641 [info ] [Thread-1 (]: 1 of 19 OK created sql table model dbt_cs329e_xh_stg.company_data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.83s]
[0m00:00:50.100960 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_data
[0m00:00:50.101815 [debug] [Thread-1 (]: Began running node model.cs329e_xh.pw_disclosure
[0m00:00:50.103088 [info ] [Thread-1 (]: 7 of 19 START sql table model dbt_cs329e_xh_stg.pw_disclosure .................. [RUN]
[0m00:00:50.104160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_data, now model.cs329e_xh.pw_disclosure)
[0m00:00:50.104870 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.pw_disclosure
[0m00:00:50.110534 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.pw_disclosure"
[0m00:00:50.111971 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.pw_disclosure
[0m00:00:50.116119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:50.141194 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.lca_worksites"
[0m00:00:50.142751 [debug] [Thread-3 (]: On model.cs329e_xh.lca_worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_worksites as (
select * except(worksite_workers, pw_other_year),
        cast(worksite_workers as int64) as worksite_workers,
        cast(pw_other_year as int64) as pw_other_year
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_worksites`
)
select * from stg_lca_worksites
    );
  
[0m00:00:50.146978 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.lca_disclosure"
[0m00:00:50.148339 [debug] [Thread-4 (]: On model.cs329e_xh.lca_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
      
    
    

    OPTIONS()
    as (
      
with s as (
SELECT
    * EXCEPT (received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage, total_worksite_locations),
    SAFE_CAST(received_date AS DATETIME) AS received_date,
    SAFE_CAST(decision_date AS DATETIME) AS decision_date,
    SAFE_CAST(original_cert_date AS DATETIME) AS original_cert_date,
    
    SAFE_CAST(total_worker_positions AS INT64) AS total_worker_positions,
    SAFE_CAST(new_employment AS INT64) AS new_employment,
    SAFE_CAST(continued_employment AS INT64) AS continued_employment,
    SAFE_CAST(change_previous_employment AS INT64) AS change_previous_employment,
    SAFE_CAST(new_concurrent_employment AS INT64) AS new_concurrent_employment,
    SAFE_CAST(change_employer AS INT64) AS change_employer,
    SAFE_CAST(amended_petition AS INT64) AS amended_petition,
    SAFE_CAST(worksite_workers AS INT64) AS worksite_workers,
    SAFE_CAST(total_worksite_locations AS INT64) AS total_worksite_locations,

    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_from, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_from,
    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_to, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_to,
    SAFE_CAST(REGEXP_REPLACE(prevailing_wage, r'[\$,]', '') AS FLOAT64) AS prevailing_wage

FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_disclosure`
    )
select * from s
    );
  
[0m00:00:50.252339 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.pw_disclosure"
[0m00:00:50.253691 [debug] [Thread-1 (]: On model.cs329e_xh.pw_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.pw_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
      
    
    

    OPTIONS()
    as (
      
with temp as (
select 
    * except(required_experience_months, required_training_months, alt_training_months, alt_experience_months),
    cast(required_training_months as int64) as required_training_months,
    cast(required_experience_months as int64) as required_experience_months,
    cast(alt_training_months as int64) as alt_training_months,
    cast(alt_experience_months as int64) as alt_experience_months
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`pw_disclosure`
),
stg_pw_disclosure as (
    select 
    * except(bls_area),
    SPLIT(bls_area, ',')[SAFE_OFFSET(0)] AS bls_city,
    IFNULL(SPLIT(bls_area, ',')[SAFE_OFFSET(1)], '') AS bls_state
from temp)
select * from stg_pw_disclosure
    );
  
[0m00:00:50.507827 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:975c88b9-585e-487e-b621-d70d01f29ae9&page=queryresults
[0m00:00:50.529937 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb25051bd0>]}
[0m00:00:50.531884 [info ] [Thread-2 (]: 2 of 19 OK created sql table model dbt_cs329e_xh_stg.employer_details .......... [[32mCREATE TABLE (61.5k rows, 9.3 MiB processed)[0m in 3.26s]
[0m00:00:50.533313 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.employer_details
[0m00:00:50.534321 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:136f502c-68a6-43ca-bad3-934dc7364664&page=queryresults
[0m00:00:50.535097 [debug] [Thread-2 (]: Began running node model.cs329e_xh.single_registrations
[0m00:00:50.537792 [info ] [Thread-2 (]: 8 of 19 START sql table model dbt_cs329e_xh_stg.single_registrations ........... [RUN]
[0m00:00:50.538705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.employer_details, now model.cs329e_xh.single_registrations)
[0m00:00:50.539369 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.single_registrations
[0m00:00:50.545805 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.single_registrations"
[0m00:00:50.546821 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.single_registrations
[0m00:00:50.550657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:50.564949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d9e82e65-3532-4a1c-97b7-5030256f7bad&page=queryresults
[0m00:00:50.682399 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.single_registrations"
[0m00:00:50.683647 [debug] [Thread-2 (]: On model.cs329e_xh.single_registrations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.single_registrations"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
      
    
    

    OPTIONS()
    as (
      
with t1 as (
select
    case bcn when '(b)(6)' THEN NULL ELSE bcn END AS bcn,
    case receipt_number when '(b)(6)' THEN NULL ELSE receipt_number END AS receipt_number,
    case ben_date_of_birth when '(b)(6)' THEN NULL ELSE ben_date_of_birth END AS ben_date_of_birth,
    case dol_eta_case_number when '(b)(6)' THEN NULL ELSE dol_eta_case_number END AS dol_eta_case_number,
    *
EXCEPT (bcn, receipt_number, ben_date_of_birth, dol_eta_case_number)
FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`single_registrations`
WHERE bcn != '(b)(3) (b)(6) (b)(7)(c)'
)
, t2 as (select * except(bcn, receipt_number, ben_date_of_birth, dol_eta_case_number, t_u_vawa_flag)
FROM t1)
select * from t2
    );
  
[0m00:00:51.036098 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a65891da-ca1b-4981-8472-801415ef6800&page=queryresults
[0m00:00:55.295000 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb25051bd0>]}
[0m00:00:55.296176 [info ] [Thread-2 (]: 8 of 19 OK created sql table model dbt_cs329e_xh_stg.single_registrations ...... [[32mCREATE TABLE (350.1k rows, 78.4 MiB processed)[0m in 4.76s]
[0m00:00:55.297480 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.single_registrations
[0m00:00:55.298287 [debug] [Thread-2 (]: Began running node model.cs329e_xh.wage_summary
[0m00:00:55.299572 [info ] [Thread-2 (]: 9 of 19 START sql table model dbt_cs329e_xh_stg.wage_summary ................... [RUN]
[0m00:00:55.300679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.single_registrations, now model.cs329e_xh.wage_summary)
[0m00:00:55.301343 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.wage_summary
[0m00:00:55.306670 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.wage_summary"
[0m00:00:55.307674 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.wage_summary
[0m00:00:55.311517 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:55.434733 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.wage_summary"
[0m00:00:55.435910 [debug] [Thread-2 (]: On model.cs329e_xh.wage_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
      
    
    

    OPTIONS()
    as (
      
with stg_wage_summary as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`wage_summary`
)
select * from stg_wage_summary
    );
  
[0m00:00:55.859161 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aada2055-f1e2-4d55-8b0f-e44a2b59edcd&page=queryresults
[0m00:00:57.344180 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb265492d0>]}
[0m00:00:57.345420 [info ] [Thread-3 (]: 6 of 19 OK created sql table model dbt_cs329e_xh_stg.lca_worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 7.35s]
[0m00:00:57.346848 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.lca_worksites
[0m00:00:57.347580 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:00:57.348918 [info ] [Thread-3 (]: 10 of 19 START sql table model dbt_cs329e_xh_int.LCA_Appendix .................. [RUN]
[0m00:00:57.350040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_worksites, now model.cs329e_xh.LCA_Appendix)
[0m00:00:57.350726 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:00:57.355645 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:00:57.356660 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:00:57.361239 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:00:57.362371 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:00:57.363097 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:57.917974 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb265497b0>]}
[0m00:00:57.919214 [info ] [Thread-2 (]: 9 of 19 OK created sql table model dbt_cs329e_xh_stg.wage_summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.62s]
[0m00:00:57.920562 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.wage_summary
[0m00:00:57.921421 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:00:57.922725 [info ] [Thread-2 (]: 11 of 19 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............ [RUN]
[0m00:00:57.923746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.wage_summary, now model.cs329e_xh.Sentiment_Analysis)
[0m00:00:57.924395 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:00:57.930790 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:00:57.931750 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:00:57.936123 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:00:57.937999 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bada18f1-ab5f-4bd6-8196-032ba9a61031&page=queryresults
[0m00:00:57.940265 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:00:57.941316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:58.443089 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b3e76837-9438-4f9c-9e6a-433801abc9b7&page=queryresults
[0m00:00:59.762239 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb245e5c00>]}
[0m00:00:59.763452 [info ] [Thread-3 (]: 10 of 19 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix ............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.41s]
[0m00:00:59.764597 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:00:59.765379 [debug] [Thread-3 (]: Began running node model.cs329e_xh.Company_Data
[0m00:00:59.766255 [info ] [Thread-3 (]: 12 of 19 START sql table model dbt_cs329e_xh_int.Company_Data .................. [RUN]
[0m00:00:59.767303 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.Company_Data)
[0m00:00:59.767971 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:00:59.773210 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:00:59.774222 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:00:59.778796 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:00:59.779801 [debug] [Thread-3 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:00:59.780512 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:01:00.465495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb25176f50>]}
[0m00:01:00.467035 [info ] [Thread-2 (]: 11 of 19 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ....... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.54s]
[0m00:01:00.468530 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:01:00.469309 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:01:00.470201 [info ] [Thread-2 (]: 13 of 19 START sql table model dbt_cs329e_xh_int.Single_Registration ........... [RUN]
[0m00:01:00.471455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:01:00.472134 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:01:00.477817 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:01:00.478808 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:01:00.483662 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:01:00.484742 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:01:00.485512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:01:00.564604 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:359ab035-57a3-48b9-9055-32ca0820b9d2&page=queryresults
[0m00:01:00.934290 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c8495bf1-a47f-4b0a-bb83-373a51b88a75&page=queryresults
[0m00:01:01.197612 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb251638b0>]}
[0m00:01:01.198923 [info ] [Thread-4 (]: 5 of 19 OK created sql table model dbt_cs329e_xh_stg.lca_disclosure ............ [[32mCREATE TABLE (561.0k rows, 485.1 MiB processed)[0m in 11.21s]
[0m00:01:01.200100 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.lca_disclosure
[0m00:01:01.200959 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:01:01.201790 [info ] [Thread-4 (]: 14 of 19 START sql table model dbt_cs329e_xh_int.LCA_Worksites ................. [RUN]
[0m00:01:01.202958 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_disclosure, now model.cs329e_xh.LCA_Worksites)
[0m00:01:01.203661 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:01:01.358260 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:01:01.359273 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:01:01.363729 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:01:01.364756 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except row_id
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:01:01.365512 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:01:01.476001 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:68fd1914-054e-4dd6-b2f2-9beac8d0584b&page=queryresults
[0m00:01:01.477023 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:68fd1914-054e-4dd6-b2f2-9beac8d0584b&page=queryresults
[0m00:01:01.517855 [debug] [Thread-4 (]: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:01:01.518998 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2472e1d0>]}
[0m00:01:01.520095 [error] [Thread-4 (]: 14 of 19 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ........ [[31mERROR[0m in 0.32s]
[0m00:01:01.521201 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:01:01.521977 [debug] [Thread-4 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:01:01.523070 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql.
[0m00:01:01.524438 [info ] [Thread-4 (]: 15 of 19 START sql table model dbt_cs329e_xh_int.Wage_Summary .................. [RUN]
[0m00:01:01.526550 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Wage_Summary)
[0m00:01:01.527229 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:01:01.532239 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:01:01.533157 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:01:01.537954 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:01:01.538993 [debug] [Thread-4 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1;
)
select * from ws2
    );
  
[0m00:01:01.539770 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:01:01.662560 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:92df443d-76dc-4c9f-9b4b-fd5c3025dacd&page=queryresults
[0m00:01:01.663575 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:92df443d-76dc-4c9f-9b4b-fd5c3025dacd&page=queryresults
[0m00:01:01.666104 [debug] [Thread-4 (]: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:01:01.667130 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb25050700>]}
[0m00:01:01.668292 [error] [Thread-4 (]: 15 of 19 ERROR creating sql table model dbt_cs329e_xh_int.Wage_Summary ......... [[31mERROR[0m in 0.14s]
[0m00:01:01.669426 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:01:01.670220 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:01:01.671141 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.Wage_Summary' to be skipped because of status 'error'.  Reason: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql.
[0m00:01:01.672022 [info ] [Thread-4 (]: 16 of 19 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................ [RUN]
[0m00:01:01.673383 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.LCA_Disclosure)
[0m00:01:01.674104 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:01:01.679010 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:01:01.680013 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:01:01.685540 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:01:01.686742 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:01:01.687543 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:01:02.237897 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fbfba4d0-dd20-4edf-abc4-977f360f5ba9&page=queryresults
[0m00:01:02.560617 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb24783250>]}
[0m00:01:02.561872 [info ] [Thread-3 (]: 12 of 19 OK created sql table model dbt_cs329e_xh_int.Company_Data ............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.79s]
[0m00:01:02.563231 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:01:03.408494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26549060>]}
[0m00:01:03.409743 [info ] [Thread-1 (]: 7 of 19 OK created sql table model dbt_cs329e_xh_stg.pw_disclosure ............. [[32mCREATE TABLE (237.9k rows, 372.8 MiB processed)[0m in 13.30s]
[0m00:01:03.411192 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.pw_disclosure
[0m00:01:03.412712 [debug] [Thread-3 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:01:03.413724 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m00:01:03.414962 [info ] [Thread-3 (]: 17 of 19 START sql table model dbt_cs329e_xh_int.PW_Disclosure ................. [RUN]
[0m00:01:03.416435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.pw_disclosure, now model.cs329e_xh.temp_emp)
[0m00:01:03.417402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.PW_Disclosure)
[0m00:01:03.418379 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:01:03.419183 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:01:03.424910 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:01:03.432843 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:01:03.434549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:03.435433 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:01:03.437239 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:01:03.444901 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:01:03.446180 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:01:03.447904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:01:03.448671 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:01:03.449605 [debug] [Thread-3 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
).
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:01:03.455858 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:01:03.456763 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:01:03.460660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:03.462196 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:01:03.463062 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:01:03.463896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:01:03.465202 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:01:03.476290 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:01:03.477506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:03.479099 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:01:03.479850 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:01:03.480752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:01:03.482507 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:01:03.495426 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:01:03.496474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:03.497993 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:01:03.498710 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m00:01:03.499583 [info ] [Thread-1 (]: 18 of 19 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m00:01:03.500649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:01:03.501294 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m00:01:03.564204 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:01:03.565388 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m00:01:03.580655 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:01:03.583486 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d31d9389-6bbc-4bc4-8bae-11354b5c62e4&page=queryresults
[0m00:01:03.585013 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d31d9389-6bbc-4bc4-8bae-11354b5c62e4&page=queryresults
[0m00:01:03.586553 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:01:03.589104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:03.590496 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:01:03.592300 [debug] [Thread-3 (]: Database Error in model PW_Disclosure (models/int/PW_Disclosure.sql)
  Syntax error: Unexpected "." at [18:2]
  compiled code at target/run/cs329e_xh/models/int/PW_Disclosure.sql
[0m00:01:03.593303 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26509f90>]}
[0m00:01:03.594619 [error] [Thread-3 (]: 17 of 19 ERROR creating sql table model dbt_cs329e_xh_int.PW_Disclosure ........ [[31mERROR[0m in 0.18s]
[0m00:01:03.595926 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:01:03.597090 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.PW_Disclosure' to be skipped because of status 'error'.  Reason: Database Error in model PW_Disclosure (models/int/PW_Disclosure.sql)
  Syntax error: Unexpected "." at [18:2]
  compiled code at target/run/cs329e_xh/models/int/PW_Disclosure.sql.
[0m00:01:03.604550 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:01:03.605894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb270b9ba0>]}
[0m00:01:03.607057 [error] [Thread-1 (]: 18 of 19 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 0.11s]
[0m00:01:03.608271 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m00:01:03.609423 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:01:03.610673 [debug] [Thread-3 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:01:03.611823 [info ] [Thread-3 (]: 19 of 19 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:01:03.613013 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:01:08.258868 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26509f90>]}
[0m00:01:08.260062 [info ] [Thread-2 (]: 13 of 19 OK created sql table model dbt_cs329e_xh_int.Single_Registration ...... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 7.79s]
[0m00:01:08.261179 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:01:12.085681 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274e3a8a-8c2e-4fc1-a6b2-3fda415c6c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26cb56c0>]}
[0m00:01:12.086962 [info ] [Thread-4 (]: 16 of 19 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ........... [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.41s]
[0m00:01:12.088212 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:01:12.090660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:01:12.091756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:12.092297 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:01:12.092804 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:01:12.093279 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:01:12.093771 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m00:01:12.094544 [info ] [MainThread]: 
[0m00:01:12.095146 [info ] [MainThread]: Finished running 19 table models in 0 hours 0 minutes and 27.16 seconds (27.16s).
[0m00:01:12.100146 [debug] [MainThread]: Command end result
[0m00:01:12.144166 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:01:12.146920 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:01:12.157967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:01:12.158725 [info ] [MainThread]: 
[0m00:01:12.159385 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:01:12.160101 [info ] [MainThread]: 
[0m00:01:12.160848 [error] [MainThread]:   Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:01:12.161447 [info ] [MainThread]: 
[0m00:01:12.162227 [error] [MainThread]:   Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:01:12.162809 [info ] [MainThread]: 
[0m00:01:12.163552 [error] [MainThread]:   Database Error in model PW_Disclosure (models/int/PW_Disclosure.sql)
  Syntax error: Unexpected "." at [18:2]
  compiled code at target/run/cs329e_xh/models/int/PW_Disclosure.sql
[0m00:01:12.164160 [info ] [MainThread]: 
[0m00:01:12.164846 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m00:01:12.165487 [info ] [MainThread]: 
[0m00:01:12.166193 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=4 SKIP=1 TOTAL=19
[0m00:01:12.167213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 30.17533, "process_in_blocks": "3800", "process_kernel_time": 0.482014, "process_mem_max_rss": "271236", "process_out_blocks": "4008", "process_user_time": 5.947506}
[0m00:01:12.167927 [debug] [MainThread]: Command `dbt run` failed at 00:01:12.167779 after 30.18 seconds
[0m00:01:12.168560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb42e515d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26c4add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26c49b70>]}
[0m00:01:12.169211 [debug] [MainThread]: Flushing usage events
[0m00:01:12.337300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:57.667818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178de0d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178cf6e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178cf6e380>]}


============================== 00:03:57.671794 | 7adcc44e-f5d5-45fd-9420-8228c81795c1 ==============================
[0m00:03:57.671794 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:03:57.672854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models int', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:03:59.409562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178ef8aef0>]}
[0m00:03:59.494769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178d009330>]}
[0m00:03:59.495857 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:03:59.671247 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:03:59.841133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m00:03:59.842188 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m00:03:59.842831 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:03:59.843365 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:03:59.843992 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/PW_Disclosure.sql
[0m00:04:00.215770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:04:00.237225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1771c58100>]}
[0m00:04:00.369950 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:04:00.372472 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:04:00.391088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1771c59b70>]}
[0m00:04:00.392073 [info ] [MainThread]: Found 28 models, 9 sources, 492 macros
[0m00:04:00.392789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178d34d3c0>]}
[0m00:04:00.396175 [info ] [MainThread]: 
[0m00:04:00.396945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:04:00.397712 [info ] [MainThread]: 
[0m00:04:00.398783 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:04:00.406564 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:04:00.407460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:00.602873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:04:00.604073 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m00:04:00.604921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:00.605606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:00.776670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178f33ba00>]}
[0m00:04:00.777699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:04:00.782314 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:04:00.783458 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:04:00.784520 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:04:00.785725 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:04:00.786792 [info ] [Thread-2 (]: 2 of 13 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:04:00.790899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m00:04:00.788763 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:04:00.789730 [info ] [Thread-3 (]: 3 of 13 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:04:00.791583 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:04:00.787951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m00:04:00.792558 [info ] [Thread-4 (]: 4 of 13 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:04:00.793727 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:04:00.806130 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:04:00.807011 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:04:00.808103 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:04:00.808909 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:04:00.815146 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:04:00.816048 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:04:00.820809 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:04:00.821693 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:04:00.826515 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:04:00.827390 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:04:00.844268 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:04:00.851570 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:04:00.856154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:00.856945 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:04:00.861348 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:04:00.913593 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:04:00.915059 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except row_id
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:04:00.915858 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:04:01.019052 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:04:01.020230 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:04:01.029221 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:04:01.030480 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:04:01.041722 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:04:01.042978 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:04:01.051512 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:436fcd43-0037-4ffd-b2b6-c3d11ec2f066&page=queryresults
[0m00:04:01.052480 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:436fcd43-0037-4ffd-b2b6-c3d11ec2f066&page=queryresults
[0m00:04:01.056732 [debug] [Thread-4 (]: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:04:01.060042 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178e0e1ff0>]}
[0m00:04:01.061212 [error] [Thread-4 (]: 4 of 13 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ......... [[31mERROR[0m in 0.25s]
[0m00:04:01.062283 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:04:01.063069 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:04:01.063925 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql.
[0m00:04:01.064804 [info ] [Thread-4 (]: 5 of 13 START sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint ....... [RUN]
[0m00:04:01.066721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.LCA_Worksites-checkpoint)
[0m00:04:01.067381 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:04:01.072363 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:04:01.073446 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:04:01.078241 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:04:01.079382 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites-checkpoint`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except row_id
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:04:01.080155 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:04:01.210973 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b86c0769-0e14-4468-8ccc-437b700edac7&page=queryresults
[0m00:04:01.211978 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b86c0769-0e14-4468-8ccc-437b700edac7&page=queryresults
[0m00:04:01.214502 [debug] [Thread-4 (]: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:04:01.215498 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177034bee0>]}
[0m00:04:01.216913 [error] [Thread-4 (]: 5 of 13 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint  [[31mERROR[0m in 0.15s]
[0m00:04:01.218013 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:04:01.218729 [debug] [Thread-4 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:04:01.219613 [info ] [Thread-4 (]: 6 of 13 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:04:01.220648 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites-checkpoint' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql.
[0m00:04:01.221434 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites-checkpoint, now model.cs329e_xh.PW_Disclosure)
[0m00:04:01.222329 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:04:01.227239 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:04:01.228310 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:04:01.233438 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:04:01.234655 [debug] [Thread-4 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:04:01.235474 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:04:01.337419 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b182f10f-1a37-419f-a1d2-06a00b8f6fa2&page=queryresults
[0m00:04:01.412916 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0d3df08c-c89d-4330-ad3f-de095bc0d8a8&page=queryresults
[0m00:04:01.435840 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4ea90a81-a006-473c-ac36-fcafb336303e&page=queryresults
[0m00:04:01.620720 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4c4e50c3-d25d-4b0b-8d62-271cd511cb62&page=queryresults
[0m00:04:03.486648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178d461d50>]}
[0m00:04:03.487887 [info ] [Thread-2 (]: 2 of 13 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.70s]
[0m00:04:03.489280 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:04:03.490135 [debug] [Thread-2 (]: Began running node model.cs329e_xh.PW_Disclosure-checkpoint
[0m00:04:03.491138 [info ] [Thread-2 (]: 7 of 13 START sql table model dbt_cs329e_xh_int.PW_Disclosure-checkpoint ....... [RUN]
[0m00:04:03.492114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.PW_Disclosure-checkpoint)
[0m00:04:03.492825 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.PW_Disclosure-checkpoint
[0m00:04:03.497577 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure-checkpoint"
[0m00:04:03.498639 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.PW_Disclosure-checkpoint
[0m00:04:03.503004 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure-checkpoint"
[0m00:04:03.506458 [debug] [Thread-2 (]: On model.cs329e_xh.PW_Disclosure-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure-checkpoint`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:04:03.507663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17704259c0>]}
[0m00:04:03.508465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:04:03.509965 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.72s]
[0m00:04:03.514064 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:04:03.515038 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:04:03.515895 [info ] [Thread-1 (]: 8 of 13 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:04:03.517344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m00:04:03.518108 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:04:03.522699 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:04:03.523856 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:04:03.528279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:03.662485 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:04:03.663690 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:04:03.843233 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:83fc7386-0255-47f2-8680-1ec3e180d153&page=queryresults
[0m00:04:03.994781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f617a8f0-be89-4161-96cc-6bf26aeee8c6&page=queryresults
[0m00:04:05.965394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17704259c0>]}
[0m00:04:05.966699 [info ] [Thread-1 (]: 8 of 13 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.45s]
[0m00:04:05.968010 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:04:05.968810 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:04:05.969762 [info ] [Thread-1 (]: 9 of 13 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:04:05.970881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:04:05.971499 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:04:05.976531 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:04:05.977547 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:04:05.983223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:06.083496 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:04:06.084726 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:04:06.523898 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3ee93925-5d1a-4a30-a9a2-d32b17eb79cc&page=queryresults
[0m00:04:12.187161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1771e70490>]}
[0m00:04:12.188361 [info ] [Thread-1 (]: 9 of 13 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.22s]
[0m00:04:12.189717 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:04:12.190654 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:04:12.191621 [info ] [Thread-1 (]: 10 of 13 START sql table model dbt_cs329e_xh_int.Wage_Summary .................. [RUN]
[0m00:04:12.192618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.Wage_Summary)
[0m00:04:12.193271 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:04:12.198153 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:04:12.199121 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:04:12.203569 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:04:12.204642 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1;
)
select * from ws2
    );
  
[0m00:04:12.205388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:12.334819 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:20282eff-4966-455e-8c96-5f29e757506a&page=queryresults
[0m00:04:12.335801 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:20282eff-4966-455e-8c96-5f29e757506a&page=queryresults
[0m00:04:12.338296 [debug] [Thread-1 (]: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:04:12.339917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1769486230>]}
[0m00:04:12.341113 [error] [Thread-1 (]: 10 of 13 ERROR creating sql table model dbt_cs329e_xh_int.Wage_Summary ......... [[31mERROR[0m in 0.15s]
[0m00:04:12.342395 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:04:12.343134 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:04:12.346232 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.Wage_Summary' to be skipped because of status 'error'.  Reason: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql.
[0m00:04:12.347290 [info ] [Thread-1 (]: 11 of 13 START sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint ....... [RUN]
[0m00:04:12.348736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.Wage_Summary-checkpoint)
[0m00:04:12.349379 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:04:12.354281 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:04:12.355197 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:04:12.359930 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:04:12.361097 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary-checkpoint`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1;
)
select * from ws2
    );
  
[0m00:04:12.362149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:12.426167 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0566d30e-2908-4525-a632-542bfc194c33&page=queryresults
[0m00:04:12.427127 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0566d30e-2908-4525-a632-542bfc194c33&page=queryresults
[0m00:04:12.429479 [debug] [Thread-1 (]: Database Error in model Wage_Summary-checkpoint (models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:04:12.430439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1771c73760>]}
[0m00:04:12.431479 [error] [Thread-1 (]: 11 of 13 ERROR creating sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint  [[31mERROR[0m in 0.08s]
[0m00:04:12.432758 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:04:12.433416 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m00:04:12.434268 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.Wage_Summary-checkpoint' to be skipped because of status 'error'.  Reason: Database Error in model Wage_Summary-checkpoint (models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql.
[0m00:04:12.435146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary-checkpoint, now model.cs329e_xh.temp_emp)
[0m00:04:12.436066 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:04:12.443304 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:04:12.444357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:12.445850 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:04:12.446539 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:04:12.447638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:04:12.448287 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:04:12.453762 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:04:12.454753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:12.456148 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:04:12.456825 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:04:12.457681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:04:12.458326 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:04:12.468563 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:04:12.469608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:12.471116 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:04:12.471783 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:04:12.472644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:04:12.473393 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:04:12.483463 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:04:12.484831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:12.486344 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:04:12.487023 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m00:04:12.488059 [info ] [Thread-1 (]: 12 of 13 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m00:04:12.488900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:04:12.489549 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m00:04:12.555318 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178ed7c220>]}
[0m00:04:12.556171 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:04:12.557562 [info ] [Thread-3 (]: 3 of 13 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 11.76s]
[0m00:04:12.559224 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:04:12.560031 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m00:04:12.576311 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:04:12.577905 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:04:12.579035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:12.580269 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:04:12.581945 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:04:12.583018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17703d2230>]}
[0m00:04:12.584086 [error] [Thread-1 (]: 12 of 13 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 0.09s]
[0m00:04:12.585096 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m00:04:12.586058 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:04:12.587241 [debug] [Thread-3 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:04:12.588141 [info ] [Thread-3 (]: 13 of 13 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:04:12.589052 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:04:14.734721 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1770355150>]}
[0m00:04:14.735988 [info ] [Thread-4 (]: 6 of 13 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 13.51s]
[0m00:04:14.737176 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:04:18.503935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7adcc44e-f5d5-45fd-9420-8228c81795c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178d461d50>]}
[0m00:04:18.505201 [info ] [Thread-2 (]: 7 of 13 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure-checkpoint .. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 15.01s]
[0m00:04:18.506445 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.PW_Disclosure-checkpoint
[0m00:04:18.508672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:04:18.509768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:18.510525 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:04:18.511046 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure-checkpoint' was properly closed.
[0m00:04:18.511554 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m00:04:18.512049 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:04:18.512725 [info ] [MainThread]: 
[0m00:04:18.513305 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 18.11 seconds (18.11s).
[0m00:04:18.516917 [debug] [MainThread]: Command end result
[0m00:04:18.559654 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:04:18.562232 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:04:18.572738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:04:18.573441 [info ] [MainThread]: 
[0m00:04:18.574272 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m00:04:18.575148 [info ] [MainThread]: 
[0m00:04:18.576032 [error] [MainThread]:   Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:04:18.576738 [info ] [MainThread]: 
[0m00:04:18.577533 [error] [MainThread]:   Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:04:18.578269 [info ] [MainThread]: 
[0m00:04:18.579217 [error] [MainThread]:   Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:04:18.579909 [info ] [MainThread]: 
[0m00:04:18.580747 [error] [MainThread]:   Database Error in model Wage_Summary-checkpoint (models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:04:18.581443 [info ] [MainThread]: 
[0m00:04:18.582276 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m00:04:18.582980 [info ] [MainThread]: 
[0m00:04:18.583706 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=5 SKIP=1 TOTAL=13
[0m00:04:18.584851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.99653, "process_in_blocks": "0", "process_kernel_time": 0.510506, "process_mem_max_rss": "271468", "process_out_blocks": "3912", "process_user_time": 5.348207}
[0m00:04:18.585604 [debug] [MainThread]: Command `dbt run` failed at 00:04:18.585452 after 21.00 seconds
[0m00:04:18.586281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178de0d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1771cbcd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178dcd2680>]}
[0m00:04:18.586931 [debug] [MainThread]: Flushing usage events
[0m00:04:18.754024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:23.836741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4b7cd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a95a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a95a680>]}


============================== 00:12:23.840854 | 0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3 ==============================
[0m00:12:23.840854 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:12:23.842011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models int', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:12:25.582258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a8f1c90>]}
[0m00:12:25.668763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4ae02260>]}
[0m00:12:25.669901 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:12:25.846613 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:12:26.017415 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m00:12:26.018524 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/pw_disclosure-checkpoint.sql
[0m00:12:26.019094 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:12:26.019576 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:12:26.020066 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m00:12:26.383493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:12:26.404101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2f636230>]}
[0m00:12:26.522956 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:12:26.525564 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:12:26.543286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2f657940>]}
[0m00:12:26.544311 [info ] [MainThread]: Found 26 models, 9 sources, 492 macros
[0m00:12:26.545068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2f6578e0>]}
[0m00:12:26.548489 [info ] [MainThread]: 
[0m00:12:26.549272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:12:26.550043 [info ] [MainThread]: 
[0m00:12:26.551038 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:12:26.558688 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:12:26.559605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:26.769193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m00:12:26.770565 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m00:12:26.771365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:26.772044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:26.943353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4ad2efe0>]}
[0m00:12:26.944292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:26.948955 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:12:26.949737 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:12:26.950704 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:12:26.951895 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:12:26.952834 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:12:26.953973 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:12:26.954940 [info ] [Thread-3 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:12:26.955935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m00:12:26.956827 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:12:26.957855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m00:12:26.958736 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:12:26.959431 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:12:26.960268 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:12:26.960950 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:12:26.961657 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:12:26.972878 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:12:26.974789 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:12:26.980915 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:12:26.985638 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:12:26.990302 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:12:26.991838 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:12:26.992696 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:12:26.998954 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:12:27.016016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:27.016998 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:12:27.021095 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:27.025346 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:12:27.074033 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:12:27.076444 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except row_id
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:12:27.077760 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:12:27.187167 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:12:27.188405 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:12:27.192600 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:12:27.194195 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:12:27.207772 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b1beae71-dfb9-4789-b264-80871e7d8f60&page=queryresults
[0m00:12:27.208763 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b1beae71-dfb9-4789-b264-80871e7d8f60&page=queryresults
[0m00:12:27.213522 [debug] [Thread-4 (]: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:12:27.216452 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4baa3c70>]}
[0m00:12:27.217769 [error] [Thread-4 (]: 4 of 10 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ......... [[31mERROR[0m in 0.25s]
[0m00:12:27.218868 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:12:27.219587 [debug] [Thread-4 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:12:27.220621 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql.
[0m00:12:27.221581 [info ] [Thread-4 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:12:27.224587 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m00:12:27.225343 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:12:27.227291 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:12:27.233275 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:12:27.234679 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:12:27.235570 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:12:27.240056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:27.364042 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:12:27.365246 [debug] [Thread-4 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:12:27.545724 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:238a657b-2eb9-4250-8c06-e7efef10bb72&page=queryresults
[0m00:12:27.549084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d1c0ae1a-4071-456f-afd9-e4502c22e234&page=queryresults
[0m00:12:27.640786 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5a94a684-2e96-4fb8-afc3-378d247b5d5f&page=queryresults
[0m00:12:27.647349 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:50638ee4-d029-46ef-baa9-7beb18575195&page=queryresults
[0m00:12:29.333093 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a9c98a0>]}
[0m00:12:29.334456 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.38s]
[0m00:12:29.336329 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:12:29.337149 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:12:29.338229 [info ] [Thread-2 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:12:29.339225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.Sentiment_Analysis)
[0m00:12:29.339876 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:12:29.344516 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:12:29.345473 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:12:29.350534 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:29.355899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4c73c1f0>]}
[0m00:12:29.357200 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.40s]
[0m00:12:29.358461 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:12:29.359411 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:12:29.360590 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:12:29.361559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Single_Registration)
[0m00:12:29.362238 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:12:29.367545 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:12:29.369153 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:12:29.373034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:29.504892 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:12:29.507059 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:12:29.508494 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:12:29.509418 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:12:29.839279 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a17f07b8-33ef-46cf-9245-c938a1c4bcc5&page=queryresults
[0m00:12:29.846697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1a4810a0-d37b-4b41-806c-a06ef86e663a&page=queryresults
[0m00:12:34.596211 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a9c98a0>]}
[0m00:12:34.597470 [info ] [Thread-2 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 5.26s]
[0m00:12:34.599326 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:12:34.600120 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:12:34.601156 [info ] [Thread-2 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:12:34.602143 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Wage_Summary)
[0m00:12:34.602778 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:12:34.607706 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:12:34.608696 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:12:34.613127 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:12:34.614192 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1;
)
select * from ws2
    );
  
[0m00:12:34.614917 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:34.724443 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2b688cf5-f4f3-4848-8177-d6bd794cfcae&page=queryresults
[0m00:12:34.725443 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2b688cf5-f4f3-4848-8177-d6bd794cfcae&page=queryresults
[0m00:12:34.727918 [debug] [Thread-2 (]: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:12:34.728902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e06d38ac0>]}
[0m00:12:34.730017 [error] [Thread-2 (]: 8 of 10 ERROR creating sql table model dbt_cs329e_xh_int.Wage_Summary .......... [[31mERROR[0m in 0.13s]
[0m00:12:34.731025 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:12:34.731712 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m00:12:34.732641 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.Wage_Summary' to be skipped because of status 'error'.  Reason: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql.
[0m00:12:34.733592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_emp)
[0m00:12:34.734642 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:12:34.740534 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:12:34.741586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:34.743370 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:12:34.744098 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:12:34.745197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:12:34.745920 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:12:34.753013 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:12:34.754127 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:34.755966 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:12:34.756662 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:12:34.757566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:12:34.758213 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:12:34.768185 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:12:34.769328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:34.770924 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:12:34.771645 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:12:34.772738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:12:34.773436 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:12:34.783811 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:12:34.784967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:34.786565 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:12:34.787280 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m00:12:34.788091 [info ] [Thread-2 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m00:12:34.789436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:12:34.790193 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching
[0m00:12:34.851088 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:12:34.852234 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching
[0m00:12:34.867925 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:12:34.869252 [debug] [Thread-2 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:12:34.870483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:34.871703 [error] [Thread-2 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:12:34.873472 [debug] [Thread-2 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:12:34.874597 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2f61ac50>]}
[0m00:12:34.875687 [error] [Thread-2 (]: 9 of 10 ERROR creating python table model dbt_cs329e_xh_int.matching ........... [[31mERROR[0m in 0.09s]
[0m00:12:34.876900 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.matching
[0m00:12:34.877908 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:12:34.878957 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:12:34.879655 [info ] [Thread-2 (]: 10 of 10 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:12:34.880433 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:12:36.451604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4c73c1f0>]}
[0m00:12:36.452830 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 7.09s]
[0m00:12:36.454178 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:12:39.283970 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2db98d90>]}
[0m00:12:39.285198 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 12.33s]
[0m00:12:39.286351 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:12:39.672556 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0181bda9-f0e9-49f5-8b22-04dfa8fbf0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4c73c1f0>]}
[0m00:12:39.673807 [info ] [Thread-4 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.45s]
[0m00:12:39.675058 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:12:39.677704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:12:39.679011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:39.679632 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:12:39.680159 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:12:39.680668 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m00:12:39.681156 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:12:39.681891 [info ] [MainThread]: 
[0m00:12:39.682627 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 13.13 seconds (13.13s).
[0m00:12:39.686159 [debug] [MainThread]: Command end result
[0m00:12:39.729486 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:12:39.732166 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:12:39.742121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:12:39.742817 [info ] [MainThread]: 
[0m00:12:39.743605 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:12:39.744450 [info ] [MainThread]: 
[0m00:12:39.745262 [error] [MainThread]:   Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:12:39.746002 [info ] [MainThread]: 
[0m00:12:39.746810 [error] [MainThread]:   Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:12:39.747529 [info ] [MainThread]: 
[0m00:12:39.748296 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m00:12:39.748992 [info ] [MainThread]: 
[0m00:12:39.749764 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=1 TOTAL=10
[0m00:12:39.750879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.993287, "process_in_blocks": "0", "process_kernel_time": 0.518586, "process_mem_max_rss": "269600", "process_out_blocks": "3784", "process_user_time": 5.164809}
[0m00:12:39.751578 [debug] [MainThread]: Command `dbt run` failed at 00:12:39.751430 after 15.99 seconds
[0m00:12:39.752200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4b7cd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2ec7bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4b692620>]}
[0m00:12:39.752877 [debug] [MainThread]: Flushing usage events
[0m00:12:39.920422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:13:33.057914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585cf59540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585c0de350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585c0de2f0>]}


============================== 00:13:33.061733 | a7fe4586-346a-4b18-9594-4a4c10603b0e ==============================
[0m00:13:33.061733 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:13:33.062909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models int', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:13:34.858319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585e0eae60>]}
[0m00:13:34.946600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585ccd60e0>]}
[0m00:13:34.947731 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:13:35.122386 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:13:35.292310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:13:35.293343 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:13:35.660499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:13:35.682295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5840dda680>]}
[0m00:13:35.801580 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:13:35.804206 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:13:35.821964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5840dd8190>]}
[0m00:13:35.822867 [info ] [MainThread]: Found 27 models, 9 sources, 492 macros
[0m00:13:35.823552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5840fe4100>]}
[0m00:13:35.826774 [info ] [MainThread]: 
[0m00:13:35.827425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:13:35.828024 [info ] [MainThread]: 
[0m00:13:35.828943 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:35.837247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:13:35.838229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:36.091785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:13:36.092957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:36.094058 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m00:13:36.096592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:36.233655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585c571120>]}
[0m00:13:36.234651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:13:36.239505 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:13:36.240445 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:13:36.241457 [info ] [Thread-1 (]: 1 of 11 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:13:36.242703 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:13:36.243509 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:13:36.244455 [info ] [Thread-2 (]: 2 of 11 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:13:36.245550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m00:13:36.246498 [info ] [Thread-3 (]: 3 of 11 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:13:36.247613 [info ] [Thread-4 (]: 4 of 11 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:13:36.248521 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m00:13:36.249249 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:13:36.250193 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:13:36.251114 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:13:36.251819 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:13:36.264407 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:13:36.265318 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:13:36.266151 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:13:36.272212 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:13:36.277058 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:13:36.281804 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:13:36.282651 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:13:36.284027 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:13:36.284775 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:13:36.328305 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:13:36.330709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:36.341928 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:13:36.348959 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:13:36.391314 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:13:36.393296 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except row_id
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:13:36.394387 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:13:36.510048 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:13:36.511241 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:13:36.517037 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:13:36.518188 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:13:36.524052 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7e64e907-66db-4151-b81b-1f418ce751e4&page=queryresults
[0m00:13:36.524984 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7e64e907-66db-4151-b81b-1f418ce751e4&page=queryresults
[0m00:13:36.529240 [debug] [Thread-4 (]: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:13:36.534127 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:13:36.534951 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585d230550>]}
[0m00:13:36.536439 [error] [Thread-4 (]: 4 of 11 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ......... [[31mERROR[0m in 0.28s]
[0m00:13:36.537651 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:13:36.538432 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:13:36.539385 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql.
[0m00:13:36.540356 [info ] [Thread-4 (]: 5 of 11 START sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint ....... [RUN]
[0m00:13:36.542549 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:13:36.543443 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.LCA_Worksites-checkpoint)
[0m00:13:36.545924 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:13:36.551268 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:13:36.552289 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:13:36.557289 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:13:36.558427 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites-checkpoint`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except row_id
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:13:36.559211 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:13:36.685072 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4667e0d4-dac4-46f6-b8d4-90f221dcfdf1&page=queryresults
[0m00:13:36.686113 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4667e0d4-dac4-46f6-b8d4-90f221dcfdf1&page=queryresults
[0m00:13:36.688586 [debug] [Thread-4 (]: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:13:36.689551 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58404bc9d0>]}
[0m00:13:36.690699 [error] [Thread-4 (]: 5 of 11 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint  [[31mERROR[0m in 0.15s]
[0m00:13:36.691835 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:13:36.692529 [debug] [Thread-4 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:13:36.693413 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites-checkpoint' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql.
[0m00:13:36.694339 [info ] [Thread-4 (]: 6 of 11 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:13:36.695574 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites-checkpoint, now model.cs329e_xh.PW_Disclosure)
[0m00:13:36.696215 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:13:36.701531 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:13:36.702591 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:13:36.706914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:13:36.825035 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a404cc0b-3f23-4cf3-ada5-caf88109343f&page=queryresults
[0m00:13:36.833512 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:13:36.834804 [debug] [Thread-4 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:13:36.880440 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:815679d8-16c2-4366-8405-b5902ea352f9&page=queryresults
[0m00:13:36.903992 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9ed8ddfb-1077-4a66-9e82-dc394ad9cfb3&page=queryresults
[0m00:13:37.143422 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cb03ae3c-ac50-4da2-9f2a-6480d12d32ba&page=queryresults
[0m00:13:39.161937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585c179810>]}
[0m00:13:39.163181 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.92s]
[0m00:13:39.164242 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:13:39.165062 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:13:39.166143 [info ] [Thread-1 (]: 7 of 11 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:13:39.166977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m00:13:39.167738 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:13:39.172376 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:13:39.173293 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:13:39.177208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:39.323621 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:13:39.324811 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:13:39.609900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:645fdc3d-f461-49f5-bd5b-7eece98e1110&page=queryresults
[0m00:13:40.087947 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f584056df00>]}
[0m00:13:40.089145 [info ] [Thread-2 (]: 2 of 11 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 3.84s]
[0m00:13:40.090896 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:13:40.091699 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:13:40.092760 [info ] [Thread-2 (]: 8 of 11 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:13:40.093810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.Single_Registration)
[0m00:13:40.094515 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:13:40.099340 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:13:40.100222 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:13:40.103970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:13:40.216273 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:13:40.217528 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:13:40.544875 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7aac3e92-07eb-4414-b995-c1873bcd78e0&page=queryresults
[0m00:13:41.583934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58405314e0>]}
[0m00:13:41.585132 [info ] [Thread-1 (]: 7 of 11 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.42s]
[0m00:13:41.586356 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:13:41.587167 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:13:41.588260 [info ] [Thread-1 (]: 9 of 11 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:13:41.589160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Wage_Summary)
[0m00:13:41.589884 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:13:41.594822 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:13:41.595821 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:13:41.602057 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:13:41.603194 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1;
)
select * from ws2
    );
  
[0m00:13:41.604226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:41.717206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aefdba9d-bb23-443c-9b8a-d4d088c8f4a7&page=queryresults
[0m00:13:41.718222 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aefdba9d-bb23-443c-9b8a-d4d088c8f4a7&page=queryresults
[0m00:13:41.720533 [debug] [Thread-1 (]: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:13:41.721487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5840513a00>]}
[0m00:13:41.722763 [error] [Thread-1 (]: 9 of 11 ERROR creating sql table model dbt_cs329e_xh_int.Wage_Summary .......... [[31mERROR[0m in 0.13s]
[0m00:13:41.723892 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:13:41.724661 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m00:13:41.725503 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.Wage_Summary' to be skipped because of status 'error'.  Reason: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql.
[0m00:13:41.726368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_emp)
[0m00:13:41.727407 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:13:41.732771 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:13:41.733738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:41.735199 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:13:41.736015 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:13:41.736981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:13:41.737860 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:13:41.743378 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:13:41.744342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:41.745738 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:13:41.746440 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:13:41.747129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:13:41.747742 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:13:41.757710 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:13:41.758839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:41.760307 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:13:41.760990 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:13:41.762097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:13:41.762739 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:13:41.772957 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:13:41.774112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:41.775865 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:13:41.776541 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m00:13:41.777491 [info ] [Thread-1 (]: 10 of 11 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m00:13:41.778363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:13:41.779010 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m00:13:41.842362 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:13:41.843687 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m00:13:41.858196 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:13:41.859523 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:13:41.860689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:41.861934 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:13:41.863678 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:13:41.864731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5840d98640>]}
[0m00:13:41.865772 [error] [Thread-1 (]: 10 of 11 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 0.09s]
[0m00:13:41.866793 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m00:13:41.867720 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:13:41.868776 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:13:41.869489 [info ] [Thread-1 (]: 11 of 11 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:13:41.870289 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:13:46.563497 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585ded4190>]}
[0m00:13:46.564689 [info ] [Thread-3 (]: 3 of 11 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.31s]
[0m00:13:46.566012 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:13:47.066497 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5840530eb0>]}
[0m00:13:47.067748 [info ] [Thread-2 (]: 8 of 11 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.97s]
[0m00:13:47.069110 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:13:49.207742 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fe4586-346a-4b18-9594-4a4c10603b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58404bd990>]}
[0m00:13:49.209002 [info ] [Thread-4 (]: 6 of 11 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.51s]
[0m00:13:49.210392 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:13:49.212801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:13:49.213995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:49.214686 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:13:49.215232 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:13:49.215793 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m00:13:49.216290 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:13:49.216983 [info ] [MainThread]: 
[0m00:13:49.217583 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 13.39 seconds (13.39s).
[0m00:13:49.220582 [debug] [MainThread]: Command end result
[0m00:13:49.263945 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:13:49.266843 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:13:49.276889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:13:49.277565 [info ] [MainThread]: 
[0m00:13:49.278263 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:13:49.278938 [info ] [MainThread]: 
[0m00:13:49.279615 [error] [MainThread]:   Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:13:49.280213 [info ] [MainThread]: 
[0m00:13:49.280884 [error] [MainThread]:   Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  EXCEPT must be followed by ALL, DISTINCT, or "(" at [14:14]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:13:49.281464 [info ] [MainThread]: 
[0m00:13:49.282148 [error] [MainThread]:   Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got identifier `job count` at [19:5]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:13:49.282728 [info ] [MainThread]: 
[0m00:13:49.283357 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m00:13:49.283938 [info ] [MainThread]: 
[0m00:13:49.284535 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=1 TOTAL=11
[0m00:13:49.285487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.309565, "process_in_blocks": "0", "process_kernel_time": 0.503329, "process_mem_max_rss": "272384", "process_out_blocks": "3848", "process_user_time": 5.24217}
[0m00:13:49.286220 [debug] [MainThread]: Command `dbt run` failed at 00:13:49.286068 after 16.31 seconds
[0m00:13:49.286848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585cf59540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5840e32200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f585ce22980>]}
[0m00:13:49.287485 [debug] [MainThread]: Flushing usage events
[0m00:13:49.475820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:17.293289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9214b95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92063e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92063e380>]}


============================== 00:16:17.297268 | 21063949-891b-4c93-ac60-c835f5fcbce1 ==============================
[0m00:16:17.297268 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:16:17.298248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models int', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:19.071283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa920bb6170>]}
[0m00:16:19.157878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa920b0e290>]}
[0m00:16:19.158970 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:16:19.337024 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:16:19.519050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m00:16:19.520079 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:16:19.520792 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Wage_Summary.sql
[0m00:16:19.521734 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:16:19.522462 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/LCA_Worksites.sql
[0m00:16:19.902818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:16:19.925242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa905334130>]}
[0m00:16:20.048264 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:16:20.051143 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:16:20.069564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa905335a80>]}
[0m00:16:20.070569 [info ] [MainThread]: Found 28 models, 9 sources, 492 macros
[0m00:16:20.071256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9053359c0>]}
[0m00:16:20.074812 [info ] [MainThread]: 
[0m00:16:20.075490 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:16:20.076090 [info ] [MainThread]: 
[0m00:16:20.077004 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:16:20.084891 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:16:20.085879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:20.259879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:16:20.261290 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m00:16:20.262091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:20.262923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:20.420080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa922a0ba00>]}
[0m00:16:20.421038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:20.425164 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:16:20.426047 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:16:20.427058 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:16:20.427937 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:16:20.428865 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:16:20.429876 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:16:20.430907 [info ] [Thread-3 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:16:20.431931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m00:16:20.432823 [info ] [Thread-4 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:16:20.433727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m00:16:20.434693 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:16:20.435418 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:16:20.436257 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:16:20.436937 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:16:20.437633 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:16:20.448877 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:16:20.451403 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:16:20.457868 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:16:20.462727 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:16:20.467823 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:16:20.469676 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:16:20.470636 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:16:20.471680 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:16:20.482957 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:16:20.500391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:20.505719 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:16:20.510227 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:16:20.557621 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:16:20.559819 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except(row_id)
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:16:20.560827 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:16:20.668708 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:16:20.669970 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:16:20.674572 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:16:20.677302 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:16:20.678443 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:16:20.681136 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:16:20.684956 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1b40d053-5d87-4539-a99e-192123852f8c&page=queryresults
[0m00:16:20.685938 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1b40d053-5d87-4539-a99e-192123852f8c&page=queryresults
[0m00:16:20.690197 [debug] [Thread-4 (]: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:16:20.692884 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92178dff0>]}
[0m00:16:20.694087 [error] [Thread-4 (]: 4 of 12 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ......... [[31mERROR[0m in 0.25s]
[0m00:16:20.695135 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:16:20.695824 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:16:20.696684 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql.
[0m00:16:20.697711 [info ] [Thread-4 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint ....... [RUN]
[0m00:16:20.699678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.LCA_Worksites-checkpoint)
[0m00:16:20.700334 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:16:20.705623 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:16:20.706771 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:16:20.711237 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:16:20.712219 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites-checkpoint`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except(row_id)
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:16:20.712906 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:16:20.855096 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a13d51ce-1951-4b5c-84b1-9cc4866e120f&page=queryresults
[0m00:16:20.856122 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a13d51ce-1951-4b5c-84b1-9cc4866e120f&page=queryresults
[0m00:16:20.858567 [debug] [Thread-4 (]: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:16:20.859616 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90423cc70>]}
[0m00:16:20.860873 [error] [Thread-4 (]: 5 of 12 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint  [[31mERROR[0m in 0.16s]
[0m00:16:20.861927 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:16:20.862640 [debug] [Thread-4 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:16:20.863535 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites-checkpoint' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql.
[0m00:16:20.864615 [info ] [Thread-4 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:16:20.866031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites-checkpoint, now model.cs329e_xh.PW_Disclosure)
[0m00:16:20.866711 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:16:20.871630 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:16:20.872541 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:16:20.876327 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:16:20.974787 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cea2825a-1a87-4047-b789-b8d8835ffad8&page=queryresults
[0m00:16:20.990255 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4de0b0ea-da39-4aa2-a7f1-7ee1dc08bad3&page=queryresults
[0m00:16:20.997409 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:16:20.998661 [debug] [Thread-4 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:16:21.058363 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d41b933e-8d36-4ed0-b6b0-c6fe788bbb4b&page=queryresults
[0m00:16:21.302728 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fd7b7269-2ccf-44c9-b955-6915b1d9b89b&page=queryresults
[0m00:16:22.832678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa922450220>]}
[0m00:16:22.833990 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.40s]
[0m00:16:22.835361 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:16:22.836135 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:16:22.837170 [info ] [Thread-1 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:16:22.838202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m00:16:22.838859 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:16:22.843603 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:16:22.845521 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:16:22.852402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:22.972091 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa904320370>]}
[0m00:16:22.974088 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.54s]
[0m00:16:22.976232 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:16:22.977265 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:16:22.978467 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:16:22.979534 [info ] [Thread-2 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:16:22.980644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.Single_Registration)
[0m00:16:22.981461 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:16:22.982202 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:16:22.989536 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:16:22.990843 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:16:22.994798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:16:23.120593 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:16:23.121975 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:16:23.352137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ec7f6bcb-413c-460d-85eb-c8c9ce47fb27&page=queryresults
[0m00:16:23.481533 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bec1d687-6c4b-49ca-93e5-920d40910ad9&page=queryresults
[0m00:16:26.513004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa922450220>]}
[0m00:16:26.514252 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 3.67s]
[0m00:16:26.515571 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:16:26.516353 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:16:26.517469 [info ] [Thread-1 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:16:26.518572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Wage_Summary)
[0m00:16:26.519243 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:16:26.524269 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:16:26.525317 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:16:26.531939 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:16:26.533096 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1;
)
select * from ws2
    );
  
[0m00:16:26.533892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:26.652310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:64cf67ee-9d2b-43af-8044-fdb0375f6ce8&page=queryresults
[0m00:16:26.653291 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:64cf67ee-9d2b-43af-8044-fdb0375f6ce8&page=queryresults
[0m00:16:26.655685 [debug] [Thread-1 (]: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got ";" at [32:18]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:16:26.656601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fcb95cc0>]}
[0m00:16:26.657673 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model dbt_cs329e_xh_int.Wage_Summary .......... [[31mERROR[0m in 0.14s]
[0m00:16:26.658816 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:16:26.659496 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:16:26.660350 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.Wage_Summary' to be skipped because of status 'error'.  Reason: Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got ";" at [32:18]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql.
[0m00:16:26.661261 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint ....... [RUN]
[0m00:16:26.662536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.Wage_Summary-checkpoint)
[0m00:16:26.663202 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:16:26.668036 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:16:26.669016 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:16:26.674038 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:16:26.675090 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary-checkpoint`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1;
)
select * from ws2
    );
  
[0m00:16:26.675822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:26.805773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d0f23423-0fb5-42ca-a654-8746f579d6bb&page=queryresults
[0m00:16:26.806850 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d0f23423-0fb5-42ca-a654-8746f579d6bb&page=queryresults
[0m00:16:26.809219 [debug] [Thread-1 (]: Database Error in model Wage_Summary-checkpoint (models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql)
  Syntax error: Expected ")" but got ";" at [32:18]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:16:26.810198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa904167790>]}
[0m00:16:26.811351 [error] [Thread-1 (]: 10 of 12 ERROR creating sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint  [[31mERROR[0m in 0.15s]
[0m00:16:26.812333 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:16:26.812996 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m00:16:26.813734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary-checkpoint, now model.cs329e_xh.temp_emp)
[0m00:16:26.814652 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.Wage_Summary-checkpoint' to be skipped because of status 'error'.  Reason: Database Error in model Wage_Summary-checkpoint (models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql)
  Syntax error: Expected ")" but got ";" at [32:18]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql.
[0m00:16:26.815437 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:16:26.821152 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:16:26.822276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:26.823787 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:16:26.824465 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:16:26.825182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:16:26.825795 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:16:26.831872 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:16:26.833115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:26.834631 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:16:26.835338 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:16:26.836244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:16:26.836879 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:16:26.847360 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:16:26.848462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:26.850079 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:16:26.850995 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:16:26.851767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:16:26.852774 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:16:26.864239 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:16:26.865293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:26.866802 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:16:26.867461 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m00:16:26.868384 [info ] [Thread-1 (]: 11 of 12 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m00:16:26.869226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:16:26.869914 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m00:16:26.931221 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:16:26.932381 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m00:16:26.948348 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:16:26.949761 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:16:26.951078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:26.952297 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:16:26.953996 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:16:26.955098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fca72500>]}
[0m00:16:26.956150 [error] [Thread-1 (]: 11 of 12 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 0.09s]
[0m00:16:26.957144 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m00:16:26.958180 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:16:26.959290 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:16:26.959996 [info ] [Thread-1 (]: 12 of 12 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:16:26.960860 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:16:29.680052 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90430b5e0>]}
[0m00:16:29.681243 [info ] [Thread-2 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.70s]
[0m00:16:29.682445 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:16:30.748662 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa920bb5510>]}
[0m00:16:30.749899 [info ] [Thread-3 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.31s]
[0m00:16:30.751207 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:16:32.180782 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21063949-891b-4c93-ac60-c835f5fcbce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90423dc30>]}
[0m00:16:32.182130 [info ] [Thread-4 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 11.31s]
[0m00:16:32.184011 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:16:32.186492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:32.187642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:32.188218 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:16:32.188737 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:16:32.189212 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m00:16:32.189700 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:16:32.190470 [info ] [MainThread]: 
[0m00:16:32.191165 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 12.11 seconds (12.11s).
[0m00:16:32.194607 [debug] [MainThread]: Command end result
[0m00:16:32.238853 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:16:32.241395 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:16:32.251486 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:16:32.252176 [info ] [MainThread]: 
[0m00:16:32.253020 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m00:16:32.253901 [info ] [MainThread]: 
[0m00:16:32.254745 [error] [MainThread]:   Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:16:32.255442 [info ] [MainThread]: 
[0m00:16:32.256207 [error] [MainThread]:   Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:16:32.256897 [info ] [MainThread]: 
[0m00:16:32.257649 [error] [MainThread]:   Database Error in model Wage_Summary (models/int/Wage_Summary.sql)
  Syntax error: Expected ")" but got ";" at [32:18]
  compiled code at target/run/cs329e_xh/models/int/Wage_Summary.sql
[0m00:16:32.258358 [info ] [MainThread]: 
[0m00:16:32.259120 [error] [MainThread]:   Database Error in model Wage_Summary-checkpoint (models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql)
  Syntax error: Expected ")" but got ";" at [32:18]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:16:32.259823 [info ] [MainThread]: 
[0m00:16:32.260565 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m00:16:32.261236 [info ] [MainThread]: 
[0m00:16:32.261981 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=5 SKIP=1 TOTAL=12
[0m00:16:32.263049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.057783, "process_in_blocks": "0", "process_kernel_time": 0.485411, "process_mem_max_rss": "271092", "process_out_blocks": "3888", "process_user_time": 5.351346}
[0m00:16:32.263904 [debug] [MainThread]: Command `dbt run` failed at 00:16:32.263695 after 15.06 seconds
[0m00:16:32.264609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9214b95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa920b8cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa921382680>]}
[0m00:16:32.265263 [debug] [MainThread]: Flushing usage events
[0m00:16:32.450563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:17:33.308113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8550a455d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854fdb23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854fdb2380>]}


============================== 00:17:33.312048 | 6ae8b182-5b64-4ead-8da5-6fce13edcd77 ==============================
[0m00:17:33.312048 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:17:33.312923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models int', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:17:35.062466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8551dbaef0>]}
[0m00:17:35.148960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8550b11060>]}
[0m00:17:35.150078 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:17:35.326600 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:17:35.496631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:17:35.497746 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:17:35.498537 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Wage_Summary.sql
[0m00:17:35.869202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:17:35.890787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8534a90130>]}
[0m00:17:36.012942 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:17:36.015536 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:17:36.032816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8534ca0c70>]}
[0m00:17:36.033733 [info ] [MainThread]: Found 28 models, 9 sources, 492 macros
[0m00:17:36.034428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8534ca11b0>]}
[0m00:17:36.037640 [info ] [MainThread]: 
[0m00:17:36.038367 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:17:36.038980 [info ] [MainThread]: 
[0m00:17:36.039902 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:17:36.047931 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:17:36.048922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:36.238203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:17:36.239514 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m00:17:36.240384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:36.241092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:36.390833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855030d630>]}
[0m00:17:36.391713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:36.395627 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:17:36.396425 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:17:36.397467 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:17:36.398400 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:17:36.399186 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:17:36.400295 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:17:36.401411 [info ] [Thread-3 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:17:36.402610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m00:17:36.403526 [info ] [Thread-4 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:17:36.404556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m00:17:36.405441 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:17:36.406220 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:17:36.407112 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:17:36.407807 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:17:36.408477 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:17:36.419680 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:17:36.422068 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:17:36.428271 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:17:36.432971 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:17:36.437793 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:17:36.439187 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:17:36.440506 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:17:36.441539 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:17:36.459076 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:17:36.466052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:36.470274 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:36.474476 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:17:36.520618 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:17:36.524746 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except(row_id)
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:17:36.526316 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:17:36.645280 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:17:36.646544 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:17:36.651102 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:17:36.652177 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:17:36.662321 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:17:36.663488 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:17:36.676424 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:839ddf60-0401-47e8-82d2-5325fa3daa50&page=queryresults
[0m00:17:36.677447 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:839ddf60-0401-47e8-82d2-5325fa3daa50&page=queryresults
[0m00:17:36.682279 [debug] [Thread-4 (]: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:17:36.685136 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8550d15ff0>]}
[0m00:17:36.686469 [error] [Thread-4 (]: 4 of 12 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ......... [[31mERROR[0m in 0.28s]
[0m00:17:36.687583 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:17:36.688351 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:17:36.689240 [info ] [Thread-4 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint ....... [RUN]
[0m00:17:36.690240 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql.
[0m00:17:36.691547 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.LCA_Worksites-checkpoint)
[0m00:17:36.693164 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:17:36.698676 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:17:36.699771 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:17:36.704708 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:17:36.706164 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites-checkpoint`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except(row_id)
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:17:36.707064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:17:36.836145 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9ee22a8b-a8aa-4737-8133-f5125b9dd40c&page=queryresults
[0m00:17:36.837188 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9ee22a8b-a8aa-4737-8133-f5125b9dd40c&page=queryresults
[0m00:17:36.839880 [debug] [Thread-4 (]: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:17:36.840912 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8534188c10>]}
[0m00:17:36.842171 [error] [Thread-4 (]: 5 of 12 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint  [[31mERROR[0m in 0.15s]
[0m00:17:36.843255 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:17:36.844008 [debug] [Thread-4 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:17:36.844857 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites-checkpoint' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql.
[0m00:17:36.845762 [info ] [Thread-4 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:17:36.846965 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites-checkpoint, now model.cs329e_xh.PW_Disclosure)
[0m00:17:36.847611 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:17:36.852521 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:17:36.853503 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:17:36.857465 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:17:36.975756 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:17:36.977009 [debug] [Thread-4 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:17:37.012178 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:75e0e239-0dc5-4c86-ac52-972ec95dfa46&page=queryresults
[0m00:17:37.016185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8ee44381-1e99-4891-aac4-98e34ceaa771&page=queryresults
[0m00:17:37.101091 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:61dd085a-0dab-4683-891b-c1dfff411f2f&page=queryresults
[0m00:17:37.369561 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bc03af12-1f7d-47f5-9f01-f84281ec9caf&page=queryresults
[0m00:17:38.782201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854fe518a0>]}
[0m00:17:38.783472 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.38s]
[0m00:17:38.784740 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:17:38.785496 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:17:38.786549 [info ] [Thread-1 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:17:38.787520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m00:17:38.788158 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:17:38.792800 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:17:38.793757 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:17:38.797690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:38.940416 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:17:38.941667 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:17:39.007127 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85342001f0>]}
[0m00:17:39.008509 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.60s]
[0m00:17:39.009724 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:17:39.010627 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:17:39.011685 [info ] [Thread-2 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:17:39.012609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.Single_Registration)
[0m00:17:39.013258 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:17:39.018294 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:17:39.019306 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:17:39.023250 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:39.152324 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:17:39.153588 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:17:39.284125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:72fc3781-9f0b-4bb6-93ab-025231e14599&page=queryresults
[0m00:17:39.463844 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e96ce479-c7f4-4873-8c0d-9534ee918df8&page=queryresults
[0m00:17:40.974633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854fe518a0>]}
[0m00:17:40.975833 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.19s]
[0m00:17:40.977092 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:17:40.977808 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:17:40.978948 [info ] [Thread-1 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:17:40.979989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Wage_Summary)
[0m00:17:40.980631 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:17:40.986970 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:17:40.987986 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:17:40.992407 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:17:40.993537 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:17:40.994324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:41.374740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:15695fcc-b2e0-4cc2-8007-5d17d776f555&page=queryresults
[0m00:17:43.346640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854fe518a0>]}
[0m00:17:43.347895 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.37s]
[0m00:17:43.349195 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:17:43.349992 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:17:43.350989 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint ....... [RUN]
[0m00:17:43.352010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.Wage_Summary-checkpoint)
[0m00:17:43.352645 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:17:43.357564 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:17:43.358582 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:17:43.363206 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:17:43.364411 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary-checkpoint`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:17:43.365342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:43.626866 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2c6bd005-cf20-42b2-83b8-be824be796a8&page=queryresults
[0m00:17:45.575768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8534aa5510>]}
[0m00:17:45.577031 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint .. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.22s]
[0m00:17:45.578418 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:17:45.579173 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m00:17:45.580211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary-checkpoint, now model.cs329e_xh.temp_emp)
[0m00:17:45.580917 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:17:45.586626 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:17:45.587645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:45.589083 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:17:45.590599 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:17:45.591665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:17:45.592439 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:17:45.598461 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:17:45.602889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:45.604443 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:17:45.605164 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:17:45.606083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:17:45.606702 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:17:45.618596 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:17:45.619746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:45.621270 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:17:45.622019 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:17:45.622759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:17:45.623411 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:17:45.633479 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:17:45.634844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:45.636396 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:17:45.637104 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m00:17:45.638015 [info ] [Thread-1 (]: 11 of 12 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m00:17:45.639172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:17:45.639883 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m00:17:45.701267 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:17:45.702502 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m00:17:45.717058 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:17:45.721816 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855108dea0>]}
[0m00:17:45.723192 [info ] [Thread-3 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 9.32s]
[0m00:17:45.724561 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:17:45.726028 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:17:45.726997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:45.728746 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:17:45.730686 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:17:45.731925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f853425fdc0>]}
[0m00:17:45.732984 [error] [Thread-1 (]: 11 of 12 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 0.09s]
[0m00:17:45.734119 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m00:17:45.735008 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:17:45.736027 [debug] [Thread-3 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:17:45.736792 [info ] [Thread-3 (]: 12 of 12 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:17:45.737586 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:17:45.965953 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85342001f0>]}
[0m00:17:45.967136 [info ] [Thread-2 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.95s]
[0m00:17:45.968244 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:17:49.329410 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ae8b182-5b64-4ead-8da5-6fce13edcd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8534aa7a60>]}
[0m00:17:49.330704 [info ] [Thread-4 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.48s]
[0m00:17:49.331749 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:17:49.334130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:49.335294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:49.335880 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:17:49.336390 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:17:49.336895 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m00:17:49.337397 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:17:49.338134 [info ] [MainThread]: 
[0m00:17:49.338752 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 13.30 seconds (13.30s).
[0m00:17:49.341905 [debug] [MainThread]: Command end result
[0m00:17:49.385812 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:17:49.388716 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:17:49.399081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:17:49.399773 [info ] [MainThread]: 
[0m00:17:49.400427 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:17:49.401177 [info ] [MainThread]: 
[0m00:17:49.401914 [error] [MainThread]:   Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:17:49.402550 [info ] [MainThread]: 
[0m00:17:49.403224 [error] [MainThread]:   Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:17:49.403822 [info ] [MainThread]: 
[0m00:17:49.404513 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m00:17:49.405223 [info ] [MainThread]: 
[0m00:17:49.405963 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=1 TOTAL=12
[0m00:17:49.407021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.180542, "process_in_blocks": "0", "process_kernel_time": 0.46954, "process_mem_max_rss": "270788", "process_out_blocks": "3880", "process_user_time": 5.352247}
[0m00:17:49.407721 [debug] [MainThread]: Command `dbt run` failed at 00:17:49.407561 after 16.18 seconds
[0m00:17:49.408349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8550a455d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8534a7dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852c162fe0>]}
[0m00:17:49.409017 [debug] [MainThread]: Flushing usage events
[0m00:17:49.601025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:01.316671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6561739570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656089a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656089a320>]}


============================== 00:18:01.320523 | 51f4d77b-0034-46c0-aea3-0d706cbd30cf ==============================
[0m00:18:01.320523 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:18:01.321417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models int', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:18:03.103890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560e12620>]}
[0m00:18:03.195034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560ec7310>]}
[0m00:18:03.196205 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:18:03.401906 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:18:03.579683 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m00:18:03.580625 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:18:03.581194 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:18:03.692125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:18:03.715554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65455fa3e0>]}
[0m00:18:03.843323 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:18:03.845955 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:18:03.863329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6545789b10>]}
[0m00:18:03.864265 [info ] [MainThread]: Found 26 models, 9 sources, 492 macros
[0m00:18:03.864964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654578ab90>]}
[0m00:18:03.868045 [info ] [MainThread]: 
[0m00:18:03.868761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:18:03.869520 [info ] [MainThread]: 
[0m00:18:03.870555 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:18:03.878124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:18:03.878978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:04.048238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m00:18:04.049735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m00:18:04.050499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:04.051340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:04.445120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560de9630>]}
[0m00:18:04.446464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:04.452300 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:18:04.453309 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:18:04.454243 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:18:04.456315 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:18:04.456991 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:18:04.457914 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:18:04.459071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m00:18:04.460246 [info ] [Thread-3 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:18:04.461494 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:18:04.462767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m00:18:04.463601 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:18:04.464811 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:18:04.465932 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:18:04.466951 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:18:04.483359 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:18:04.491847 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:18:04.493090 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:18:04.497971 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:18:04.505479 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:18:04.512993 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:18:04.514047 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:18:04.515001 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:18:04.526952 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:18:04.560413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:18:04.559096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:04.567487 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:18:04.568815 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:18:04.619031 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:18:04.620536 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except(row_id)
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    t.*  
FROM lw t
)
select * from int_lw
    );
  
[0m00:18:04.621304 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:18:04.688582 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:18:04.690378 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:18:04.739030 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:18:04.740212 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:18:04.755860 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ecacbbba-ded9-46d7-a1c7-d9a5a22758e4&page=queryresults
[0m00:18:04.756892 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ecacbbba-ded9-46d7-a1c7-d9a5a22758e4&page=queryresults
[0m00:18:04.761256 [debug] [Thread-4 (]: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:18:04.763986 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6561a0c5b0>]}
[0m00:18:04.765183 [error] [Thread-4 (]: 4 of 10 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ......... [[31mERROR[0m in 0.30s]
[0m00:18:04.766422 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:18:04.767153 [debug] [Thread-4 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:18:04.768174 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql.
[0m00:18:04.769107 [info ] [Thread-4 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:18:04.771498 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m00:18:04.772174 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:18:04.777506 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:18:04.778580 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:18:04.783037 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:18:04.802806 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:18:04.804500 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:18:04.951192 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:18:04.952976 [debug] [Thread-4 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:18:04.972476 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:89647ee8-af34-474a-ad92-d1c09dd477cf&page=queryresults
[0m00:18:05.114372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eeb23e7a-f37d-41a5-a520-7fee854ef351&page=queryresults
[0m00:18:05.167137 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0333bab1-8b34-4186-95f3-6ec53b00c588&page=queryresults
[0m00:18:05.246369 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1808fea5-6694-4d81-aa8a-e63e2ca170ef&page=queryresults
[0m00:18:07.127847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560935840>]}
[0m00:18:07.129083 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.67s]
[0m00:18:07.130235 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:18:07.131176 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:18:07.131988 [info ] [Thread-1 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:18:07.133059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m00:18:07.133708 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:18:07.138377 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:18:07.139321 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:18:07.143265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.257540 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:18:07.258781 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:18:07.579812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a2447252-ea76-4a81-b2a4-aa0d992b2c4f&page=queryresults
[0m00:18:09.561887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560935840>]}
[0m00:18:09.563103 [info ] [Thread-1 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.43s]
[0m00:18:09.564420 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:18:09.565254 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:18:09.566253 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:18:09.567225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:18:09.567879 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:18:09.572651 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:18:09.573663 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:18:09.577606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:09.713551 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:18:09.714800 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:18:10.028431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6359e109-f3d3-4b68-83b7-b9d88c1a9b58&page=queryresults
[0m00:18:15.851718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65455faa10>]}
[0m00:18:15.852891 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.28s]
[0m00:18:15.854044 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:18:15.854885 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:18:15.855939 [info ] [Thread-1 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:18:15.856880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.Wage_Summary)
[0m00:18:15.857523 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:18:15.863993 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:18:15.864963 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:18:15.868696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:15.978894 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:18:15.980085 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:18:16.066138 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65626a81c0>]}
[0m00:18:16.067358 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 11.60s]
[0m00:18:16.068498 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:18:16.069288 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp
[0m00:18:16.070098 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.temp_emp)
[0m00:18:16.070888 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:18:16.076359 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:18:16.077353 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:18:16.078841 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:18:16.079520 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:18:16.080407 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:18:16.081371 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:18:16.087230 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:18:16.088406 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:18:16.089945 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:18:16.090681 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:18:16.091451 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:18:16.092223 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:18:16.102450 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:18:16.103529 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:18:16.105034 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:18:16.105755 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:18:16.106957 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:18:16.107722 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:18:16.117897 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:18:16.119010 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:18:16.120525 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:18:16.121229 [debug] [Thread-3 (]: Began running node model.cs329e_xh.matching
[0m00:18:16.122245 [info ] [Thread-3 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m00:18:16.123109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:18:16.123785 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.matching
[0m00:18:16.186246 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:18:16.187417 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.matching
[0m00:18:16.202192 [debug] [Thread-3 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:18:16.203532 [debug] [Thread-3 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:18:16.204729 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:18:16.206208 [error] [Thread-3 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:18:16.208035 [debug] [Thread-3 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:18:16.209202 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65455fa3e0>]}
[0m00:18:16.210397 [error] [Thread-3 (]: 9 of 10 ERROR creating python table model dbt_cs329e_xh_int.matching ........... [[31mERROR[0m in 0.09s]
[0m00:18:16.211436 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.matching
[0m00:18:16.212334 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:18:16.213472 [debug] [Thread-3 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:18:16.214279 [info ] [Thread-3 (]: 10 of 10 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:18:16.215170 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:18:16.246705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:36b25c22-f4c6-49bb-bf77-a60435ee6797&page=queryresults
[0m00:18:17.716109 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6561a0c5b0>]}
[0m00:18:17.717315 [info ] [Thread-4 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.94s]
[0m00:18:17.718648 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:18:18.492463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f4d77b-0034-46c0-aea3-0d706cbd30cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65443da410>]}
[0m00:18:18.493638 [info ] [Thread-1 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.64s]
[0m00:18:18.494975 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:19:05.255027 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:19:05.375916 [error] [MainThread]: CANCEL query model.cs329e_xh.Wage_Summary ...................................... [[31mCANCEL[0m]
[0m00:19:05.376786 [error] [MainThread]: CANCEL query model.cs329e_xh.LCA_Appendix ...................................... [[31mCANCEL[0m]
[0m00:19:05.377615 [error] [MainThread]: CANCEL query model.cs329e_xh.matching .......................................... [[31mCANCEL[0m]
[0m00:19:05.378360 [error] [MainThread]: CANCEL query model.cs329e_xh.PW_Disclosure ..................................... [[31mCANCEL[0m]
[0m00:19:05.379155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:17.344847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:17.345926 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m00:19:17.346531 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Appendix' was properly closed.
[0m00:19:17.347031 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:19:17.347518 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:19:17.348197 [info ] [MainThread]: 
[0m00:19:17.348956 [info ] [MainThread]: Finished running 9 table models in 0 hours 1 minutes and 13.48 seconds (73.48s).
[0m00:19:17.349990 [error] [MainThread]: Encountered an error:

[0m00:19:17.388132 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/opt/conda/lib/python3.10/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 445, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 404, in _cancel_connections
    pool.join()
  File "/opt/conda/lib/python3.10/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/opt/conda/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m00:19:17.389632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 76.15257, "process_in_blocks": "272", "process_kernel_time": 0.480283, "process_mem_max_rss": "269152", "process_out_blocks": "2656", "process_user_time": 5.203691}
[0m00:19:17.390480 [debug] [MainThread]: Command `dbt run` failed at 00:19:17.390290 after 76.15 seconds
[0m00:19:17.391117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6561739570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654578ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653d6a6590>]}
[0m00:19:17.391778 [debug] [MainThread]: Flushing usage events
[0m00:19:17.589406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:36.742829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07a9aed5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07a8c723e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07a8c72380>]}


============================== 00:20:36.746761 | 2ccf293a-ae5f-4bb8-9170-7232feddb62d ==============================
[0m00:20:36.746761 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:20:36.747815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models int', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:20:38.487621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aac92ef0>]}
[0m00:20:38.574126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07a8d0d330>]}
[0m00:20:38.575236 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:20:38.748710 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:20:38.918466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:20:38.919497 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:20:38.920220 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/LCA_Worksites.sql
[0m00:20:39.286836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:20:39.308726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078d956890>]}
[0m00:20:39.428775 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:20:39.431378 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:20:39.448788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078d9555d0>]}
[0m00:20:39.449674 [info ] [MainThread]: Found 27 models, 9 sources, 492 macros
[0m00:20:39.450460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078d955690>]}
[0m00:20:39.453701 [info ] [MainThread]: 
[0m00:20:39.454577 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:20:39.455341 [info ] [MainThread]: 
[0m00:20:39.456338 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:20:39.464028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:20:39.464933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:39.656972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:20:39.658312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m00:20:39.659026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:39.659884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:40.347268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa0caaa0>]}
[0m00:20:40.348242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:20:40.352827 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:20:40.353679 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:20:40.354637 [info ] [Thread-1 (]: 1 of 11 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:20:40.355766 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:20:40.356691 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:20:40.357558 [info ] [Thread-2 (]: 2 of 11 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:20:40.358681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m00:20:40.359700 [info ] [Thread-3 (]: 3 of 11 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:20:40.361041 [info ] [Thread-4 (]: 4 of 11 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:20:40.362501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m00:20:40.363420 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:20:40.364769 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:20:40.365958 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:20:40.367015 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:20:40.383535 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:20:40.386465 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:20:40.387446 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:20:40.394529 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:20:40.401859 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:20:40.409751 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:20:40.411033 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:20:40.412599 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:20:40.418781 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:20:40.429260 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:20:40.465744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:40.470987 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:20:40.477232 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:40.522234 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:20:40.523956 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except(row_id)
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:20:40.524920 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:20:40.639227 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:20:40.640952 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:20:40.651573 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6ea764b1-164f-4431-8493-0badcbb1fdd6&page=queryresults
[0m00:20:40.652637 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6ea764b1-164f-4431-8493-0badcbb1fdd6&page=queryresults
[0m00:20:40.657209 [debug] [Thread-4 (]: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:20:40.663263 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:20:40.665856 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:20:40.667191 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07a9dc1ff0>]}
[0m00:20:40.669121 [error] [Thread-4 (]: 4 of 11 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ......... [[31mERROR[0m in 0.29s]
[0m00:20:40.670646 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:20:40.671698 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:20:40.674400 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:20:40.675615 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:20:40.676863 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql.
[0m00:20:40.679898 [info ] [Thread-4 (]: 5 of 11 START sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint ....... [RUN]
[0m00:20:40.682906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.LCA_Worksites-checkpoint)
[0m00:20:40.684062 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:20:40.691889 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:20:40.693573 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:20:40.701197 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:20:40.702851 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites-checkpoint`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except(row_id)
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
)
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:20:40.703957 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:20:40.832530 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2626939c-ca16-4b1f-8bca-3487d95cd2b7&page=queryresults
[0m00:20:40.833930 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2626939c-ca16-4b1f-8bca-3487d95cd2b7&page=queryresults
[0m00:20:40.837288 [debug] [Thread-4 (]: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:20:40.838739 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07855a3df0>]}
[0m00:20:40.840251 [error] [Thread-4 (]: 5 of 11 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint  [[31mERROR[0m in 0.16s]
[0m00:20:40.841645 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:20:40.842662 [debug] [Thread-4 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:20:40.843599 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites-checkpoint' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql.
[0m00:20:40.844485 [info ] [Thread-4 (]: 6 of 11 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:20:40.845782 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites-checkpoint, now model.cs329e_xh.PW_Disclosure)
[0m00:20:40.846458 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:20:40.851480 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:20:40.852392 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:20:40.856351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:20:40.967105 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:20:40.968917 [debug] [Thread-4 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:20:40.979658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:67f50dc3-66a7-49d2-941b-c924dcd84e30&page=queryresults
[0m00:20:40.997097 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fbc31e56-6b27-495a-8af5-8be86b3038d0&page=queryresults
[0m00:20:41.018260 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c491c1d2-b2d0-4127-934e-d764acb5f004&page=queryresults
[0m00:20:41.307060 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f7cd686f-f932-44c1-b060-a34af0526975&page=queryresults
[0m00:20:42.763948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078d99e3e0>]}
[0m00:20:42.765071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078c0ecd30>]}
[0m00:20:42.766483 [info ] [Thread-2 (]: 2 of 11 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.40s]
[0m00:20:42.768011 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.41s]
[0m00:20:42.769184 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:20:42.770237 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:20:42.771069 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:20:42.772079 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:20:42.773172 [info ] [Thread-2 (]: 7 of 11 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:20:42.774287 [info ] [Thread-1 (]: 8 of 11 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:20:42.775270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.Sentiment_Analysis)
[0m00:20:42.776220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Single_Registration)
[0m00:20:42.777063 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:20:42.777763 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:20:42.782750 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:20:42.788268 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:20:42.790006 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:20:42.790848 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:20:42.794947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:42.798902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:42.924487 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:20:42.925870 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:20:42.930152 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:20:42.931535 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:20:43.216600 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:88bf3542-4d32-4364-8dec-2e79a77596f3&page=queryresults
[0m00:20:43.271902 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:88e98c00-1bef-4c56-883a-3ccbb7a3d993&page=queryresults
[0m00:20:45.227357 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078d1a6dd0>]}
[0m00:20:45.228546 [info ] [Thread-2 (]: 7 of 11 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.45s]
[0m00:20:45.229641 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:20:45.230498 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:20:45.231474 [info ] [Thread-2 (]: 9 of 11 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:20:45.232415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Wage_Summary)
[0m00:20:45.233055 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:20:45.238079 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:20:45.239062 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:20:45.244741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:45.363539 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:20:45.364724 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:20:45.687542 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9fceeb14-f43a-44fc-bdf3-f4c21cf900ce&page=queryresults
[0m00:20:47.950446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078d99e3e0>]}
[0m00:20:47.951685 [info ] [Thread-2 (]: 9 of 11 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.72s]
[0m00:20:47.953400 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:20:47.954186 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m00:20:47.955008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_emp)
[0m00:20:47.955868 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:20:47.961653 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:20:47.962742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:47.964157 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:20:47.964870 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:20:47.965778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:20:47.966688 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:20:47.972063 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:20:47.973154 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:47.974825 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:20:47.975522 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:20:47.976246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:20:47.976996 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:20:47.987142 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:20:47.988242 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:47.989714 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:20:47.990501 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:20:47.991549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:20:47.992298 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:20:48.002418 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:20:48.003486 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:48.004932 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:20:48.005612 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m00:20:48.006607 [info ] [Thread-2 (]: 10 of 11 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m00:20:48.007453 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:20:48.008174 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching
[0m00:20:48.070457 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:20:48.071601 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching
[0m00:20:48.085938 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:20:48.087283 [debug] [Thread-2 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:20:48.088463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:48.089630 [error] [Thread-2 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:20:48.091416 [debug] [Thread-2 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:20:48.092472 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0785172140>]}
[0m00:20:48.093524 [error] [Thread-2 (]: 10 of 11 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 0.08s]
[0m00:20:48.094616 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.matching
[0m00:20:48.095554 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:20:48.096596 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:20:48.097286 [info ] [Thread-2 (]: 11 of 11 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:20:48.098086 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:20:49.842026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078d954b80>]}
[0m00:20:49.843241 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 7.07s]
[0m00:20:49.844479 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:20:50.335585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078d956d70>]}
[0m00:20:50.336769 [info ] [Thread-3 (]: 3 of 11 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 9.97s]
[0m00:20:50.337912 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:20:53.633544 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccf293a-ae5f-4bb8-9170-7232feddb62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078db60c40>]}
[0m00:20:53.635057 [info ] [Thread-4 (]: 6 of 11 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.79s]
[0m00:20:53.636259 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:20:53.638861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:20:53.640112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:53.640704 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:20:53.641202 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:20:53.641704 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m00:20:53.642272 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:20:53.642957 [info ] [MainThread]: 
[0m00:20:53.643689 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 14.19 seconds (14.19s).
[0m00:20:53.646928 [debug] [MainThread]: Command end result
[0m00:20:53.689265 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:20:53.691841 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:20:53.701924 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:20:53.702595 [info ] [MainThread]: 
[0m00:20:53.703331 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:20:53.704058 [info ] [MainThread]: 
[0m00:20:53.704809 [error] [MainThread]:   Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:20:53.705422 [info ] [MainThread]: 
[0m00:20:53.706217 [error] [MainThread]:   Database Error in model LCA_Worksites-checkpoint (models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql)
  Syntax error: Unexpected identifier "int_lw" at [17:1]
  compiled code at target/run/cs329e_xh/models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:20:53.706810 [info ] [MainThread]: 
[0m00:20:53.707533 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m00:20:53.708135 [info ] [MainThread]: 
[0m00:20:53.708789 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=1 TOTAL=11
[0m00:20:53.709781 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.046785, "process_in_blocks": "0", "process_kernel_time": 0.465892, "process_mem_max_rss": "271700", "process_out_blocks": "3832", "process_user_time": 5.346251}
[0m00:20:53.710527 [debug] [MainThread]: Command `dbt run` failed at 00:20:53.710378 after 17.05 seconds
[0m00:20:53.711149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07a9aed5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078d8e0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07a99b6680>]}
[0m00:20:53.711792 [debug] [MainThread]: Flushing usage events
[0m00:20:53.880436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:22:16.569799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7931d600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a784a2440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a784a23e0>]}


============================== 00:22:16.573688 | 907515f0-2cc7-457f-9d5f-caf34ae8eb56 ==============================
[0m00:22:16.573688 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:22:16.574623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models int', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:22:18.316286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a78465360>]}
[0m00:22:18.401966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a78ac6ec0>]}
[0m00:22:18.403049 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:22:18.577790 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:22:18.745401 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m00:22:18.746333 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:22:18.747101 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/LCA_Worksites.sql
[0m00:22:19.105088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:22:19.126368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5d19e350>]}
[0m00:22:19.245532 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:22:19.248084 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:22:19.265490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5d3b1ba0>]}
[0m00:22:19.266422 [info ] [MainThread]: Found 26 models, 9 sources, 492 macros
[0m00:22:19.267186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5d3b1ea0>]}
[0m00:22:19.270413 [info ] [MainThread]: 
[0m00:22:19.271154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:22:19.271877 [info ] [MainThread]: 
[0m00:22:19.272892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:22:19.281433 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:22:19.282432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:19.471883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:22:19.473305 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m00:22:19.474031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:19.474902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:19.599180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a78a1ae30>]}
[0m00:22:19.600092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:22:19.603996 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:22:19.604847 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:22:19.606809 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:22:19.605916 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:22:19.608117 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:22:19.608987 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:22:19.610008 [info ] [Thread-3 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:22:19.611015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m00:22:19.611972 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:22:19.612865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m00:22:19.613751 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:22:19.614578 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:22:19.615457 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:22:19.616173 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:22:19.616842 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:22:19.628079 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:22:19.630205 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:22:19.636693 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:22:19.641190 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:22:19.645939 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:22:19.647594 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:22:19.648702 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:22:19.665085 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:22:19.671302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:19.675733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:19.676717 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:22:19.680704 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:22:19.731268 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:22:19.733469 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select * except(row_id)
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:22:19.734409 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:22:19.833562 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:22:19.834789 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:22:19.839193 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:22:19.840499 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:22:19.854104 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:22:19.855237 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:22:20.095380 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7837a33e-452b-40f6-8457-31f2ec7fb263&page=queryresults
[0m00:22:20.177949 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7837a33e-452b-40f6-8457-31f2ec7fb263&page=queryresults
[0m00:22:20.182412 [debug] [Thread-4 (]: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Column row_id in SELECT * EXCEPT list does not exist at [14:21]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:22:20.185162 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5c7f43d0>]}
[0m00:22:20.186404 [error] [Thread-4 (]: 4 of 10 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ......... [[31mERROR[0m in 0.57s]
[0m00:22:20.187442 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:22:20.188145 [debug] [Thread-4 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:22:20.189070 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Column row_id in SELECT * EXCEPT list does not exist at [14:21]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql.
[0m00:22:20.190140 [info ] [Thread-4 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:22:20.192156 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m00:22:20.192831 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:22:20.198164 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:22:20.199301 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:22:20.203616 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:22:20.207044 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9b4f690f-c7cb-4ec1-beff-08a0b4462052&page=queryresults
[0m00:22:20.213181 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:898e0dbc-9eee-4625-a382-4d1a32f5a47b&page=queryresults
[0m00:22:20.312544 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8caf7cfb-277c-4593-b03f-0b69ff9c4ac5&page=queryresults
[0m00:22:20.329479 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:22:20.330829 [debug] [Thread-4 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:22:20.728420 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:948115ab-3ea7-4021-a9fc-ebefbeb7b91f&page=queryresults
[0m00:22:22.054835 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a789b1ab0>]}
[0m00:22:22.056052 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.44s]
[0m00:22:22.057862 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:22:22.058608 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:22:22.059711 [info ] [Thread-2 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:22:22.060591 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.Sentiment_Analysis)
[0m00:22:22.061217 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:22:22.065737 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:22:22.066681 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:22:22.071424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:22.195341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5d18b400>]}
[0m00:22:22.196521 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.58s]
[0m00:22:22.197737 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:22:22.198495 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:22:22.199477 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:22:22.200469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Single_Registration)
[0m00:22:22.201096 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:22:22.206081 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:22:22.207069 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:22:22.211195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:22.215356 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:22:22.216651 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:22:22.348654 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:22:22.349951 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:22:22.521271 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a617f885-e8b5-452c-9060-b6d8bd5db48e&page=queryresults
[0m00:22:22.716634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a14eca64-deab-441f-8991-e5be065753d9&page=queryresults
[0m00:22:24.498926 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a789b1ab0>]}
[0m00:22:24.500137 [info ] [Thread-2 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.44s]
[0m00:22:24.501392 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:22:24.502179 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:22:24.503137 [info ] [Thread-2 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:22:24.504101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Wage_Summary)
[0m00:22:24.504745 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:22:24.509541 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:22:24.510571 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:22:24.514396 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:24.635916 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:22:24.637156 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:22:24.978947 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:93686c54-27ff-4f12-be0e-c9043abce435&page=queryresults
[0m00:22:26.932283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5d19e8f0>]}
[0m00:22:26.933478 [info ] [Thread-2 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.43s]
[0m00:22:26.934688 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:22:26.935400 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m00:22:26.936301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_emp)
[0m00:22:26.937014 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:22:26.942633 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:22:26.943689 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:26.945335 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:22:26.946071 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:22:26.946951 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:22:26.947813 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:22:26.954881 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:22:26.955958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:26.957436 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:22:26.958140 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:22:26.958965 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:22:26.959573 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:22:26.969240 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:22:26.970402 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:26.972046 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:22:26.972731 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:22:26.973749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:22:26.974455 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:22:26.983856 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:22:26.984879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:26.986334 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:22:26.987004 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m00:22:26.987930 [info ] [Thread-2 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m00:22:26.988746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:22:26.989412 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching
[0m00:22:27.048892 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:22:27.050089 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching
[0m00:22:27.066203 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:22:27.069422 [debug] [Thread-2 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:22:27.070830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:27.072156 [error] [Thread-2 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:22:27.073872 [debug] [Thread-2 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:22:27.074913 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5c133a30>]}
[0m00:22:27.075940 [error] [Thread-2 (]: 9 of 10 ERROR creating python table model dbt_cs329e_xh_int.matching ........... [[31mERROR[0m in 0.09s]
[0m00:22:27.076924 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.matching
[0m00:22:27.077905 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:22:27.079001 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:22:27.079693 [info ] [Thread-2 (]: 10 of 10 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:22:27.080469 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:22:28.485243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5c22b1f0>]}
[0m00:22:28.486509 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.28s]
[0m00:22:28.487620 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:22:30.658978 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7a2b4250>]}
[0m00:22:30.660169 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 11.05s]
[0m00:22:30.661302 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:22:36.503137 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907515f0-2cc7-457f-9d5f-caf34ae8eb56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5c7f6530>]}
[0m00:22:36.504361 [info ] [Thread-4 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 16.31s]
[0m00:22:36.505479 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:22:36.508024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:22:36.509317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:36.509992 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:22:36.510551 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:22:36.511053 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m00:22:36.511531 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:22:36.512204 [info ] [MainThread]: 
[0m00:22:36.512907 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 17.24 seconds (17.24s).
[0m00:22:36.515928 [debug] [MainThread]: Command end result
[0m00:22:36.558282 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:22:36.560976 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:22:36.571190 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:22:36.571894 [info ] [MainThread]: 
[0m00:22:36.572755 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:22:36.573608 [info ] [MainThread]: 
[0m00:22:36.574476 [error] [MainThread]:   Database Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  Column row_id in SELECT * EXCEPT list does not exist at [14:21]
  compiled code at target/run/cs329e_xh/models/int/LCA_Worksites.sql
[0m00:22:36.575183 [info ] [MainThread]: 
[0m00:22:36.575989 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m00:22:36.576694 [info ] [MainThread]: 
[0m00:22:36.577433 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m00:22:36.578542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.087664, "process_in_blocks": "0", "process_kernel_time": 0.425284, "process_mem_max_rss": "271204", "process_out_blocks": "3784", "process_user_time": 5.259762}
[0m00:22:36.579250 [debug] [MainThread]: Command `dbt run` failed at 00:22:36.579102 after 20.09 seconds
[0m00:22:36.579883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7931d600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5d1bc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a791c5090>]}
[0m00:22:36.580533 [debug] [MainThread]: Flushing usage events
[0m00:22:36.783573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:43.783304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f35999570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f34b32650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f34b326b0>]}


============================== 00:23:43.787299 | b3eef988-c801-40ca-ae99-c88e0d4c0535 ==============================
[0m00:23:43.787299 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:23:43.788216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models int', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:45.578955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f35376050>]}
[0m00:23:45.667389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1a7d3c40>]}
[0m00:23:45.668560 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:23:45.839570 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:23:46.012883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:23:46.014065 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/LCA_Worksites.sql
[0m00:23:46.387373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:23:46.408252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f199d62f0>]}
[0m00:23:46.526358 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:23:46.528959 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:23:46.546318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f199e3640>]}
[0m00:23:46.547213 [info ] [MainThread]: Found 26 models, 9 sources, 492 macros
[0m00:23:46.547840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f199e3700>]}
[0m00:23:46.551159 [info ] [MainThread]: 
[0m00:23:46.551817 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:23:46.552421 [info ] [MainThread]: 
[0m00:23:46.553261 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:23:46.561274 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:23:46.562316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:46.758947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m00:23:46.760196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m00:23:46.761061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:46.761804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:46.889570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f350ae740>]}
[0m00:23:46.890615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:46.895202 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:23:46.896051 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:23:46.897026 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:23:46.898318 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:23:46.899800 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:23:46.899224 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:23:46.900897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m00:23:46.901782 [info ] [Thread-3 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:23:46.902935 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:23:46.903850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m00:23:46.904577 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:23:46.905449 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:23:46.906325 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:23:46.907038 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:23:46.919408 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:23:46.920330 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:23:46.921159 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:23:46.927512 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:23:46.932263 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:23:46.937215 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:23:46.938157 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:23:46.939866 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:23:46.940564 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:23:46.946615 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:23:46.963456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:46.967593 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:23:46.971531 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:23:47.018804 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:23:47.021267 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:23:47.022149 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:23:47.138809 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:23:47.140780 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:23:47.142076 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:23:47.142924 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:23:47.149233 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:23:47.150394 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:23:47.397258 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f0f396ef-48da-4027-b863-277371a13f6a&page=queryresults
[0m00:23:47.456639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:07ec48a1-61d9-479c-959d-b4203f51d42f&page=queryresults
[0m00:23:47.487460 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:817eda4e-38cd-46ce-83d3-033994f24ef6&page=queryresults
[0m00:23:47.504583 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eef83af2-a2b1-4e4b-872c-ce978c50de29&page=queryresults
[0m00:23:49.519899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f351e5e10>]}
[0m00:23:49.521122 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.62s]
[0m00:23:49.522561 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:23:49.523360 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:23:49.524405 [info ] [Thread-1 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:23:49.525555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.PW_Disclosure)
[0m00:23:49.526250 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:23:49.531309 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:23:49.532350 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:23:49.536306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:49.670878 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:23:49.672110 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:23:49.746565 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1921ea70>]}
[0m00:23:49.747792 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.84s]
[0m00:23:49.748899 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:23:49.749657 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:23:49.750741 [info ] [Thread-2 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:23:49.751653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.Sentiment_Analysis)
[0m00:23:49.752289 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:23:49.757225 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:23:49.758259 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:23:49.763531 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:23:49.885296 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:23:49.886566 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:23:50.005562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9995b942-4345-4b3c-b73a-2b6a52ef757b&page=queryresults
[0m00:23:50.110721 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:994e8f34-8c11-4d42-b612-b0df2762cc67&page=queryresults
[0m00:23:51.809218 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1921ea70>]}
[0m00:23:51.810491 [info ] [Thread-2 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.06s]
[0m00:23:51.811762 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:23:51.812594 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:23:51.813581 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:23:51.814660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:23:51.815290 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:23:51.820428 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:23:51.821423 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:23:51.825284 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:23:51.981400 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:23:51.982677 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:23:52.262562 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2aa3f60e-b47d-4802-bb4a-7709a7f395e7&page=queryresults
[0m00:23:56.301744 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f181a3ca0>]}
[0m00:23:56.302976 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 9.40s]
[0m00:23:56.304155 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:23:56.304897 [debug] [Thread-4 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:23:56.305884 [info ] [Thread-4 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:23:56.306819 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Wage_Summary)
[0m00:23:56.307453 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:23:56.312291 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:23:56.313214 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:23:56.317007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:23:56.456455 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:23:56.457637 [debug] [Thread-4 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:23:56.776100 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4c35393d-d92f-49f5-94c3-67852c7ea0ce&page=queryresults
[0m00:23:57.735047 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f350e3df0>]}
[0m00:23:57.736234 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.83s]
[0m00:23:57.737309 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:23:57.738083 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp
[0m00:23:57.738986 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.temp_emp)
[0m00:23:57.739654 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:23:57.744832 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:23:57.745778 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:23:57.747161 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:23:57.747807 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:23:57.748825 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:23:57.749463 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:23:57.756325 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:23:57.757366 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:23:57.758724 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:23:57.759360 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:23:57.760175 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:23:57.760797 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:23:57.770515 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:23:57.771557 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:23:57.773015 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:23:57.773701 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:23:57.774617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:23:57.775509 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:23:57.785557 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:23:57.786613 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:23:57.788041 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:23:57.788709 [debug] [Thread-3 (]: Began running node model.cs329e_xh.matching
[0m00:23:57.789594 [info ] [Thread-3 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m00:23:57.790740 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:23:57.791346 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.matching
[0m00:23:57.850379 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:23:57.851485 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.matching
[0m00:23:57.866808 [debug] [Thread-3 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:23:57.868147 [debug] [Thread-3 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:23:57.869265 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:23:57.870532 [error] [Thread-3 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply dataproc_region in profile to submit python job
[0m00:23:57.873089 [debug] [Thread-3 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m00:23:57.874194 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f113e5c60>]}
[0m00:23:57.875344 [error] [Thread-3 (]: 9 of 10 ERROR creating python table model dbt_cs329e_xh_int.matching ........... [[31mERROR[0m in 0.08s]
[0m00:23:57.876300 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.matching
[0m00:23:57.877224 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply dataproc_region in profile to submit python job.
[0m00:23:57.878947 [debug] [Thread-3 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:23:57.879604 [info ] [Thread-3 (]: 10 of 10 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:23:57.880333 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:23:58.461691 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f113ffeb0>]}
[0m00:23:58.462952 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.65s]
[0m00:23:58.464216 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:23:58.703631 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f181a3ca0>]}
[0m00:23:58.704779 [info ] [Thread-4 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.40s]
[0m00:23:58.706027 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:24:03.121557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eef988-c801-40ca-ae99-c88e0d4c0535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f181b2290>]}
[0m00:24:03.122892 [info ] [Thread-1 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 13.60s]
[0m00:24:03.124040 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:24:03.126387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:24:03.127814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:03.128686 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:24:03.129476 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:24:03.130288 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:24:03.131077 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m00:24:03.132059 [info ] [MainThread]: 
[0m00:24:03.132889 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 16.58 seconds (16.58s).
[0m00:24:03.136630 [debug] [MainThread]: Command end result
[0m00:24:03.326273 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:24:03.328786 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:24:03.338665 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:24:03.339333 [info ] [MainThread]: 
[0m00:24:03.340098 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:24:03.340977 [info ] [MainThread]: 
[0m00:24:03.341867 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m00:24:03.342583 [info ] [MainThread]: 
[0m00:24:03.343357 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m00:24:03.344471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 19.646685, "process_in_blocks": "0", "process_kernel_time": 0.453586, "process_mem_max_rss": "272120", "process_out_blocks": "3792", "process_user_time": 5.428381}
[0m00:24:03.345153 [debug] [MainThread]: Command `dbt run` failed at 00:24:03.345009 after 19.65 seconds
[0m00:24:03.345780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f35999570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f36c637c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f191ffd30>]}
[0m00:24:03.346508 [debug] [MainThread]: Flushing usage events
[0m00:24:03.546440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:42:31.114764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5757c7d630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5756fee3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5756fee380>]}


============================== 00:42:31.118655 | 780945e4-31e8-457d-86c3-59463f3fd79d ==============================
[0m00:42:31.118655 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:42:31.119630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model int', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:42:32.864568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57573ac7c0>]}
[0m00:42:32.955833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5757550880>]}
[0m00:42:32.957378 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:42:33.139250 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:42:33.296982 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:42:33.298030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575765fbe0>]}
[0m00:42:34.998186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:42:35.017874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573b5d0a00>]}
[0m00:42:35.135871 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:42:35.138433 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:42:35.155526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573b5cf400>]}
[0m00:42:35.156417 [info ] [MainThread]: Found 26 models, 9 sources, 492 macros
[0m00:42:35.157107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5758134c40>]}
[0m00:42:35.160206 [info ] [MainThread]: 
[0m00:42:35.160870 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:42:35.161492 [info ] [MainThread]: 
[0m00:42:35.162406 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:42:35.170559 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:42:35.171390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:35.372090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:42:35.373301 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m00:42:35.374200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:42:35.374940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:35.521487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5757552ad0>]}
[0m00:42:35.522467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:42:35.527281 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:42:35.528148 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:42:35.529166 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:42:35.530087 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:42:35.531033 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:42:35.531942 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:42:35.533024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m00:42:35.534115 [info ] [Thread-3 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:42:35.535133 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:42:35.536103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m00:42:35.536811 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:42:35.537723 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:42:35.538648 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:42:35.539349 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:42:35.551747 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:42:35.552628 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:42:35.553475 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:42:35.558283 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:42:35.559652 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:42:35.564440 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:42:35.569083 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:42:35.593089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:42:35.594281 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:42:35.595406 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:42:35.597997 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:42:35.602447 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:42:35.606715 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:42:35.610871 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:42:35.776195 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:42:35.780237 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:42:35.782279 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:42:35.785271 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:42:35.786698 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:42:35.787817 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:42:35.789553 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:42:35.793552 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:42:36.161048 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:deb94201-a983-44b3-86b7-dfc1cee796c9&page=queryresults
[0m00:42:36.198251 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:80375024-0a2e-478b-9875-4d85bca41548&page=queryresults
[0m00:42:36.228269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f9c22884-5ca5-4546-af42-d38a3e9aef0f&page=queryresults
[0m00:42:36.239806 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c3fe1689-ff98-403b-b1dd-2266e383cc8b&page=queryresults
[0m00:42:38.129146 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573b5c2e90>]}
[0m00:42:38.129911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573b5c29e0>]}
[0m00:42:38.131239 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.59s]
[0m00:42:38.132684 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.60s]
[0m00:42:38.133998 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:42:38.135023 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:42:38.135847 [debug] [Thread-2 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:42:38.136818 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:42:38.137865 [info ] [Thread-2 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:42:38.138947 [info ] [Thread-1 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:42:38.139936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.PW_Disclosure)
[0m00:42:38.140756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m00:42:38.141471 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:42:38.142195 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:42:38.147467 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:42:38.152266 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:42:38.153551 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:42:38.154309 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:42:38.158309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:42:38.162203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:42:38.266680 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:42:38.267947 [debug] [Thread-2 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:42:38.312575 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:42:38.313767 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:42:38.636517 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f1562eac-6729-4001-aa43-784be108025d&page=queryresults
[0m00:42:38.660034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c6484ff2-810d-4be6-809a-0040df211fd1&page=queryresults
[0m00:42:40.360489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573bd84790>]}
[0m00:42:40.361708 [info ] [Thread-1 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.22s]
[0m00:42:40.363691 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:42:40.364453 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:42:40.365579 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:42:40.366551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:42:40.367202 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:42:40.372309 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:42:40.373283 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:42:40.379247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:42:40.536430 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:42:40.537722 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:42:40.887804 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c01dda12-16be-43a6-98bb-74b2b0ae88c2&page=queryresults
[0m00:42:45.067652 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573ab74f70>]}
[0m00:42:45.068850 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 9.53s]
[0m00:42:45.069986 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:42:45.070815 [debug] [Thread-3 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:42:45.071875 [info ] [Thread-3 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:42:45.072782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Wage_Summary)
[0m00:42:45.073415 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:42:45.078245 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:42:45.079182 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:42:45.083069 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:42:45.205628 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:42:45.206980 [debug] [Thread-3 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:42:45.523216 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5c7c669e-4e6a-45cb-b9c7-fe94cb215008&page=queryresults
[0m00:42:47.072611 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573b5c19f0>]}
[0m00:42:47.073817 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 11.53s]
[0m00:42:47.075055 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:42:47.075819 [debug] [Thread-4 (]: Began running node model.cs329e_xh.temp_emp
[0m00:42:47.076757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.temp_emp)
[0m00:42:47.077385 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:42:47.083121 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:42:47.084109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:42:47.085567 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:42:47.086285 [debug] [Thread-4 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:42:47.087412 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:42:47.088082 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:42:47.093412 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:42:47.094400 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:42:47.096180 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:42:47.096873 [debug] [Thread-4 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:42:47.097765 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:42:47.098699 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:42:47.110838 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:42:47.111927 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:42:47.113517 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:42:47.114239 [debug] [Thread-4 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:42:47.115448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:42:47.116145 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:42:47.126318 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:42:47.127455 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:42:47.129281 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:42:47.130078 [debug] [Thread-4 (]: Began running node model.cs329e_xh.matching
[0m00:42:47.131102 [info ] [Thread-4 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m00:42:47.132026 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:42:47.132790 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.matching
[0m00:42:47.193602 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:42:47.197989 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.matching
[0m00:42:47.213613 [debug] [Thread-4 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:42:47.215097 [debug] [Thread-4 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:42:47.216416 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:42:47.217710 [error] [Thread-4 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
Need to supply gcs_bucket in profile to submit python job
[0m00:42:47.220255 [debug] [Thread-4 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1680, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 99, in __init__
    super().__init__(parsed_model, credentials)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 30, in __init__
    raise ValueError(
ValueError: Need to supply gcs_bucket in profile to submit python job

[0m00:42:47.221417 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57574df070>]}
[0m00:42:47.222573 [error] [Thread-4 (]: 9 of 10 ERROR creating python table model dbt_cs329e_xh_int.matching ........... [[31mERROR[0m in 0.09s]
[0m00:42:47.223619 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.matching
[0m00:42:47.224625 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: Need to supply gcs_bucket in profile to submit python job.
[0m00:42:47.226497 [debug] [Thread-4 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:42:47.227232 [info ] [Thread-4 (]: 10 of 10 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:42:47.228097 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:42:47.378677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57593a6e30>]}
[0m00:42:47.379910 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 7.01s]
[0m00:42:47.381189 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:42:47.485619 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573b5c1630>]}
[0m00:42:47.486928 [info ] [Thread-3 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.41s]
[0m00:42:47.488105 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:42:53.047219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780945e4-31e8-457d-86c3-59463f3fd79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573b5433a0>]}
[0m00:42:53.048489 [info ] [Thread-2 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 14.91s]
[0m00:42:53.049585 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:42:53.052216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:42:53.053355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:42:53.053980 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:42:53.054502 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:42:53.055009 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m00:42:53.055506 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:42:53.056178 [info ] [MainThread]: 
[0m00:42:53.056817 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 17.89 seconds (17.89s).
[0m00:42:53.059670 [debug] [MainThread]: Command end result
[0m00:42:53.104832 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:42:53.107699 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:42:53.117870 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:42:53.118558 [info ] [MainThread]: 
[0m00:42:53.119353 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:42:53.120069 [info ] [MainThread]: 
[0m00:42:53.120837 [error] [MainThread]:   Need to supply gcs_bucket in profile to submit python job
[0m00:42:53.121997 [info ] [MainThread]: 
[0m00:42:53.122762 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m00:42:53.123852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 22.09383, "process_in_blocks": "0", "process_kernel_time": 0.499557, "process_mem_max_rss": "270876", "process_out_blocks": "3768", "process_user_time": 6.78416}
[0m00:42:53.124581 [debug] [MainThread]: Command `dbt run` failed at 00:42:53.124426 after 22.09 seconds
[0m00:42:53.125217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5757c7d630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5757d26770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573b64afe0>]}
[0m00:42:53.125945 [debug] [MainThread]: Flushing usage events
[0m00:42:53.291744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:44:41.325617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec09c5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efebfb4e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efebfb4e440>]}


============================== 00:44:41.329443 | d04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0 ==============================
[0m00:44:41.329443 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:44:41.330291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --model int', 'send_anonymous_usage_stats': 'True'}
[0m00:44:43.078658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efebff381c0>]}
[0m00:44:43.166690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efebfbe91e0>]}
[0m00:44:43.167826 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:44:43.343055 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:44:43.480888 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:44:43.481721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec01afbe0>]}
[0m00:44:45.194535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:44:45.213719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea414ca00>]}
[0m00:44:45.333237 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:44:45.335857 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:44:45.353323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efebffe98a0>]}
[0m00:44:45.354304 [info ] [MainThread]: Found 26 models, 9 sources, 492 macros
[0m00:44:45.355024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea4a833d0>]}
[0m00:44:45.358227 [info ] [MainThread]: 
[0m00:44:45.358908 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:44:45.359536 [info ] [MainThread]: 
[0m00:44:45.360433 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:44:45.369110 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:44:45.370189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:45.565306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m00:44:45.567448 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m00:44:45.568159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:45.569030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:45.707726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec00aead0>]}
[0m00:44:45.708667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:44:45.713221 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:44:45.714219 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:44:45.715250 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:44:45.716408 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:44:45.717362 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:44:45.718330 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:44:45.719420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m00:44:45.720433 [info ] [Thread-3 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:44:45.721393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m00:44:45.722304 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:44:45.723230 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:44:45.724343 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:44:45.725074 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:44:45.726020 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:44:45.738630 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:44:45.739547 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:44:45.744615 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:44:45.745585 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:44:45.750916 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:44:45.751883 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:44:45.757275 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:44:45.758392 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:44:45.782802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:45.783747 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:44:45.788333 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:44:45.791558 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:44:45.796166 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:44:45.802700 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:44:45.963389 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:44:45.965725 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:44:45.967492 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:44:45.969403 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:44:45.971170 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:44:45.972047 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:44:45.975536 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:44:45.978477 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:44:46.303417 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:51eab101-182f-4add-8abc-b3b7781ea0c2&page=queryresults
[0m00:44:46.331373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9a8fba34-283f-439c-82e4-3ad229ff240a&page=queryresults
[0m00:44:46.347765 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:32ad98d9-8032-4c7d-bc5b-003474be33a0&page=queryresults
[0m00:44:46.354293 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4f6399dd-4b03-4270-9a6a-8b315736f106&page=queryresults
[0m00:44:48.249475 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec0c96590>]}
[0m00:44:48.250243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea41229b0>]}
[0m00:44:48.251502 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.53s]
[0m00:44:48.254365 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:44:48.252906 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.53s]
[0m00:44:48.255760 [debug] [Thread-2 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:44:48.256900 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:44:48.257932 [info ] [Thread-2 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:44:48.258944 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:44:48.259892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.PW_Disclosure)
[0m00:44:48.260783 [info ] [Thread-1 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:44:48.261679 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:44:48.262495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m00:44:48.267734 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:44:48.268619 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:44:48.273782 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:44:48.274920 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:44:48.275695 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:44:48.279882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:48.284098 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:44:48.398262 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:44:48.400959 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:44:48.402179 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:44:48.404671 [debug] [Thread-2 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:44:48.758459 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fb7b03ef-0472-413d-aa14-b4e65717b408&page=queryresults
[0m00:44:48.856126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f3a76556-0ec3-4ff3-8da3-4acaf03313d8&page=queryresults
[0m00:44:50.575401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea41d2860>]}
[0m00:44:50.576724 [info ] [Thread-1 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.31s]
[0m00:44:50.578574 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:44:50.579352 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:44:50.580472 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:44:50.581425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:44:50.582092 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:44:50.587106 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:44:50.588086 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:44:50.594189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:50.722985 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:44:50.724477 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:44:50.931793 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:43633247-6480-4914-a0de-2830b63925a1&page=queryresults
[0m00:44:54.364830 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea4b145b0>]}
[0m00:44:54.366125 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 8.64s]
[0m00:44:54.367438 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:44:54.368247 [debug] [Thread-4 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:44:54.369241 [info ] [Thread-4 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:44:54.370444 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Wage_Summary)
[0m00:44:54.371078 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:44:54.375959 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:44:54.376951 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:44:54.380982 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:44:54.505027 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:44:54.506372 [debug] [Thread-4 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:44:54.830290 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c5f71316-72d8-47cd-8c3f-7fd517fd758c&page=queryresults
[0m00:44:54.858199 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea418cf10>]}
[0m00:44:54.859401 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 9.13s]
[0m00:44:54.860646 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:44:54.861393 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp
[0m00:44:54.862377 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.temp_emp)
[0m00:44:54.863021 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:44:54.868695 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:44:54.869647 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:44:54.871092 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:44:54.871757 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:44:54.872864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:44:54.873490 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:44:54.879249 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:44:54.880300 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:44:54.881699 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:44:54.882438 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:44:54.883301 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:44:54.884003 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:44:54.894226 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:44:54.896741 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:44:54.899319 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:44:54.900027 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:44:54.900813 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:44:54.901978 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:44:54.914304 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:44:54.915454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:44:54.916955 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:44:54.917708 [debug] [Thread-3 (]: Began running node model.cs329e_xh.matching
[0m00:44:54.918758 [info ] [Thread-3 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m00:44:54.919708 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:44:54.920474 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.matching
[0m00:44:54.981761 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:44:54.982951 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.matching
[0m00:44:54.997693 [debug] [Thread-3 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:44:54.999120 [debug] [Thread-3 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:44:55.125275 [debug] [Thread-3 (]: BigQuery adapter: Submitting batch job with id: ad00a304-a9b9-40c9-8e28-cb24ac867b69
[0m00:44:56.448529 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efebff9cfa0>]}
[0m00:44:56.449763 [info ] [Thread-4 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.08s]
[0m00:44:56.451129 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:44:57.085494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea41b5000>]}
[0m00:44:57.086777 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.50s]
[0m00:44:57.087882 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:45:02.745293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f94d5-e1bc-4e1f-ad4b-f42f7eaf13e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec0c96590>]}
[0m00:45:02.746598 [info ] [Thread-2 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 14.49s]
[0m00:45:02.747959 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:47:03.065157 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:47:03.068004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:03.182594 [error] [MainThread]: CANCEL query model.cs329e_xh.Single_Registration ............................... [[31mCANCEL[0m]
[0m00:47:03.183492 [error] [MainThread]: CANCEL query model.cs329e_xh.PW_Disclosure ..................................... [[31mCANCEL[0m]
[0m00:47:03.184414 [error] [MainThread]: CANCEL query model.cs329e_xh.matching .......................................... [[31mCANCEL[0m]
[0m00:47:03.185177 [error] [MainThread]: CANCEL query model.cs329e_xh.Wage_Summary ...................................... [[31mCANCEL[0m]
[0m00:47:03.185999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:04.261212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:04.262389 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:47:04.263027 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:47:04.263611 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:47:04.264125 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m00:47:04.264874 [info ] [MainThread]: 
[0m00:47:04.265717 [info ] [MainThread]: Finished running 8 table models in 0 hours 2 minutes and 18.90 seconds (138.90s).
[0m00:47:04.266770 [error] [MainThread]: Encountered an error:

[0m00:47:04.269230 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 330, in run_queue
    self.handle_job_queue(pool, callback)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 828, in handle_job_queue
    node = self.job_queue.get()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/conda/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 445, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 404, in _cancel_connections
    pool.join()
  File "/opt/conda/lib/python3.10/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/opt/conda/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m00:47:04.270546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 143.02548, "process_in_blocks": "10696", "process_kernel_time": 0.60716, "process_mem_max_rss": "279700", "process_out_blocks": "2624", "process_user_time": 6.805525}
[0m00:47:04.271272 [debug] [MainThread]: Command `dbt run` failed at 00:47:04.271125 after 143.03 seconds
[0m00:47:04.271941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec09c5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe9f6c8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe9f6ca6e0>]}
[0m00:47:04.272660 [debug] [MainThread]: Flushing usage events
[0m00:47:04.482142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:47:11.857696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4737529660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47366b24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47366b2470>]}


============================== 00:47:11.861569 | b54edd97-b04d-4a83-a64b-56351ad37b22 ==============================
[0m00:47:11.861569 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:47:11.862639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --model int', 'send_anonymous_usage_stats': 'True'}
[0m00:47:13.612639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4736d2b430>]}
[0m00:47:13.702418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4736cdac50>]}
[0m00:47:13.703530 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:47:13.888330 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:47:14.062299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:47:14.063014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:47:14.074186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:47:14.123054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471b41ffd0>]}
[0m00:47:14.246153 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:47:14.248703 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:47:14.266404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471b41d540>]}
[0m00:47:14.267303 [info ] [MainThread]: Found 26 models, 9 sources, 492 macros
[0m00:47:14.268030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471b41c850>]}
[0m00:47:14.271403 [info ] [MainThread]: 
[0m00:47:14.272180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:47:14.272915 [info ] [MainThread]: 
[0m00:47:14.273922 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:47:14.281818 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:47:14.282758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:14.459708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:47:14.460741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:47:14.461623 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m00:47:14.464117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:14.602958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4738a73340>]}
[0m00:47:14.603864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:47:14.608172 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:47:14.609038 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:47:14.609814 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:47:14.611525 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:47:14.610957 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:47:14.612718 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:47:14.613722 [info ] [Thread-3 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:47:14.614664 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:47:14.615919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m00:47:14.616718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m00:47:14.617579 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:47:14.618448 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:47:14.619304 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:47:14.620025 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:47:14.620730 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:47:14.621406 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:47:14.636159 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:47:14.641231 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:47:14.647956 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:47:14.652609 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:47:14.654190 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:47:14.655080 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:47:14.666772 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:47:14.672925 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:47:14.689057 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:47:14.690112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:14.694483 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:47:14.698617 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:47:14.876829 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:47:14.875025 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:47:14.880567 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:47:14.881931 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:47:14.883688 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:47:14.884684 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:47:14.887642 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:47:14.890681 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:47:15.233037 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4bbf324c-6ad4-4fa7-a8b7-adeac4514f86&page=queryresults
[0m00:47:15.240421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ff64e584-e41c-496e-8f02-b4c23613c041&page=queryresults
[0m00:47:15.245270 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:26658d4f-2c86-4a28-a1b0-c4374507824a&page=queryresults
[0m00:47:15.263057 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6c0faec4-0f44-475c-99a4-e0ec59af0ce6&page=queryresults
[0m00:47:17.001978 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471b3f88e0>]}
[0m00:47:17.003299 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.38s]
[0m00:47:17.005653 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:47:17.006598 [debug] [Thread-2 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:47:17.007792 [info ] [Thread-2 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:47:17.008752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.PW_Disclosure)
[0m00:47:17.009398 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:47:17.014390 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:47:17.015364 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:47:17.019374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:47:17.176244 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:47:17.177509 [debug] [Thread-2 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:47:17.509228 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c922d793-5165-4071-b41e-683580ed887b&page=queryresults
[0m00:47:18.131401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471b446f50>]}
[0m00:47:18.132641 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 3.52s]
[0m00:47:18.133949 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:47:18.134661 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:47:18.135604 [info ] [Thread-1 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:47:18.136560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m00:47:18.137187 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:47:18.142196 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:47:18.143126 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:47:18.146850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:18.270292 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:47:18.271515 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:47:18.594879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:706bcc84-4fe7-45cd-9940-549b3cd21bc9&page=queryresults
[0m00:47:20.570029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47035b7d90>]}
[0m00:47:20.571260 [info ] [Thread-1 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.43s]
[0m00:47:20.572405 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:47:20.573200 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:47:20.574315 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:47:20.575269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:47:20.575944 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:47:20.581398 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:47:20.582438 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:47:20.586327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:20.715495 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:47:20.716786 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:47:21.036563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d899474f-804e-417c-8b8e-d6da2e1f74f1&page=queryresults
[0m00:47:23.294242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471b3f8400>]}
[0m00:47:23.295473 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 8.68s]
[0m00:47:23.296813 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:47:23.297560 [debug] [Thread-4 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:47:23.298686 [info ] [Thread-4 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:47:23.299699 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Wage_Summary)
[0m00:47:23.300334 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:47:23.305325 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:47:23.306348 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:47:23.310299 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:47:23.441969 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:47:23.443152 [debug] [Thread-4 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:47:23.812457 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6e6f1d43-8a76-4093-b054-448893972294&page=queryresults
[0m00:47:24.266574 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47181dfc10>]}
[0m00:47:24.267818 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 9.65s]
[0m00:47:24.269109 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:47:24.269957 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp
[0m00:47:24.270910 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.temp_emp)
[0m00:47:24.271542 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:47:24.277305 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:47:24.278516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:24.280212 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:47:24.280967 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:47:24.282177 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:47:24.282881 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:47:24.289989 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:47:24.291081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:24.292528 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:47:24.293221 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:47:24.294029 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:47:24.294816 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:47:24.304734 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:47:24.305792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:24.307373 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:47:24.308276 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:47:24.309409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:47:24.310098 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:47:24.320011 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:47:24.321086 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:24.322642 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:47:24.323344 [debug] [Thread-3 (]: Began running node model.cs329e_xh.matching
[0m00:47:24.324211 [info ] [Thread-3 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m00:47:24.325375 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:47:24.326181 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.matching
[0m00:47:24.387114 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:47:24.388253 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.matching
[0m00:47:24.404401 [debug] [Thread-3 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:47:24.405697 [debug] [Thread-3 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:47:24.425439 [debug] [Thread-3 (]: BigQuery adapter: Submitting batch job with id: 9160bc69-4e14-4983-90e1-1e49d3d937cf
[0m00:47:26.734247 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4703449960>]}
[0m00:47:26.735471 [info ] [Thread-4 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 3.43s]
[0m00:47:26.736583 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:47:27.171736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47377d7e50>]}
[0m00:47:27.172891 [info ] [Thread-2 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 10.16s]
[0m00:47:27.173964 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:47:27.498121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470365efe0>]}
[0m00:47:27.499284 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.92s]
[0m00:47:27.500531 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:47:28.504642 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:28.506257 [error] [Thread-3 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
400 Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
[0m00:47:28.511541 [debug] [Thread-3 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1683, in submit_python_job
    submission_result = job_helper.submit(compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 120, in submit
    response: Batch = operation.result(polling=self._polling_retry)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.InvalidArgument: 400 Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.

[0m00:47:28.512811 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54edd97-b04d-4a83-a64b-56351ad37b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4703409480>]}
[0m00:47:28.513929 [error] [Thread-3 (]: 9 of 10 ERROR creating python table model dbt_cs329e_xh_int.matching ........... [[31mERROR[0m in 4.19s]
[0m00:47:28.515145 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.matching
[0m00:47:28.516119 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: 400 Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota..
[0m00:47:28.518973 [debug] [Thread-4 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:47:28.519719 [info ] [Thread-4 (]: 10 of 10 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:47:28.520430 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:47:28.522749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:28.523852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:28.524425 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:47:28.524940 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:47:28.525448 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:47:28.526011 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m00:47:28.526757 [info ] [MainThread]: 
[0m00:47:28.527389 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 14.25 seconds (14.25s).
[0m00:47:28.530273 [debug] [MainThread]: Command end result
[0m00:47:28.573594 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:47:28.576249 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:47:28.586554 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:47:28.587238 [info ] [MainThread]: 
[0m00:47:28.587990 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:47:28.588814 [info ] [MainThread]: 
[0m00:47:28.589632 [error] [MainThread]:   400 Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
[0m00:47:28.590407 [info ] [MainThread]: 
[0m00:47:28.591124 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m00:47:28.592200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.814997, "process_in_blocks": "352", "process_kernel_time": 0.610821, "process_mem_max_rss": "279408", "process_out_blocks": "2672", "process_user_time": 4.884283}
[0m00:47:28.592909 [debug] [MainThread]: Command `dbt run` failed at 00:47:28.592760 after 16.82 seconds
[0m00:47:28.593533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4737529660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4737990550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47181dd3c0>]}
[0m00:47:28.594242 [debug] [MainThread]: Flushing usage events
[0m00:47:28.738312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:49:18.894522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cd9b9540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ccd26350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ccd262f0>]}


============================== 00:49:18.898579 | 92d24f32-256f-4b05-92b8-8f82ad7e8fe9 ==============================
[0m00:49:18.898579 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:49:18.899498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model int', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:49:20.663932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ced2ee60>]}
[0m00:49:20.751063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cd9320e0>]}
[0m00:49:20.752184 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:49:20.929329 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:49:21.101128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:49:21.101916 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:49:21.113111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:49:21.162018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b1a5feb0>]}
[0m00:49:21.286486 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:49:21.289078 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:49:21.306963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b1a5d330>]}
[0m00:49:21.307934 [info ] [MainThread]: Found 26 models, 9 sources, 492 macros
[0m00:49:21.308742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b1a5e020>]}
[0m00:49:21.312124 [info ] [MainThread]: 
[0m00:49:21.312931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:49:21.313693 [info ] [MainThread]: 
[0m00:49:21.314774 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:49:21.322842 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:49:21.323762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:21.534572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m00:49:21.535815 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m00:49:21.536674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:49:21.537499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:21.717104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cf0de230>]}
[0m00:49:21.718148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:49:21.722908 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:49:21.723853 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:49:21.724862 [debug] [Thread-3 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:49:21.726733 [debug] [Thread-4 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:49:21.726097 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:49:21.728308 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:49:21.729710 [info ] [Thread-3 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:49:21.731200 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:49:21.732173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m00:49:21.733012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m00:49:21.734000 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Disclosure'
[0m00:49:21.734903 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.cs329e_xh.LCA_Worksites'
[0m00:49:21.735629 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:49:21.736322 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:49:21.737016 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:49:21.737686 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:49:21.752426 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:49:21.757415 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:49:21.763714 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:49:21.768363 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:49:21.770084 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:49:21.771258 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:49:21.772220 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:49:21.788715 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:49:21.800959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:21.806241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:49:21.810515 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:49:21.814574 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:49:21.972866 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:49:21.973897 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:49:21.975839 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:49:21.976809 [debug] [Thread-4 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:49:21.980169 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:49:21.981062 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:49:22.034765 [debug] [Thread-3 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:49:22.035948 [debug] [Thread-3 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:49:22.317969 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b2ffa7c3-9ee1-4ac7-aa39-f46a83b7b79f&page=queryresults
[0m00:49:22.366118 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:42076261-ecd7-4f28-8576-78af5a2408b4&page=queryresults
[0m00:49:22.383862 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d07ce55e-7fd5-48ec-ad74-03dfc5851b91&page=queryresults
[0m00:49:22.396447 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ee8edfd7-642e-4e33-a3a7-75323a3010d6&page=queryresults
[0m00:49:24.112571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ccdc5840>]}
[0m00:49:24.114030 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.38s]
[0m00:49:24.115878 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:49:24.116680 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:49:24.117713 [info ] [Thread-1 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:49:24.119457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.PW_Disclosure)
[0m00:49:24.120203 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:49:24.125298 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:49:24.128692 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b120b4f0>]}
[0m00:49:24.129928 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.40s]
[0m00:49:24.131143 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:49:24.132119 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:49:24.132863 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:49:24.137067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:24.138053 [info ] [Thread-2 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:49:24.141141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.Sentiment_Analysis)
[0m00:49:24.142069 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:49:24.146660 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:49:24.148017 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:49:24.152130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:49:24.279095 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:49:24.281069 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:49:24.284901 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:49:24.286368 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:49:24.576279 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:06afb0f4-f0e3-4962-bb13-3bf74a7177a5&page=queryresults
[0m00:49:24.626117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:68788b5e-f1e4-4057-966b-459df781f0bc&page=queryresults
[0m00:49:26.206932 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b120b4f0>]}
[0m00:49:26.208166 [info ] [Thread-2 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.07s]
[0m00:49:26.209336 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:49:26.210233 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:49:26.211291 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:49:26.212264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:49:26.212927 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:49:26.218359 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:49:26.219418 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:49:26.223497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:49:26.346967 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:49:26.348175 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:49:26.572239 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bcc212b1-d50e-473c-816e-ee0bb6a6a8fa&page=queryresults
[0m00:49:31.299274 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b1a5f0d0>]}
[0m00:49:31.300492 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 9.56s]
[0m00:49:31.301728 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:49:31.302771 [debug] [Thread-4 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:49:31.303882 [info ] [Thread-4 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:49:31.304791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Wage_Summary)
[0m00:49:31.305431 [debug] [Thread-4 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:49:31.310692 [debug] [Thread-4 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:49:31.311734 [debug] [Thread-4 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:49:31.315710 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:49:31.481015 [debug] [Thread-4 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:49:31.482258 [debug] [Thread-4 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:49:31.761997 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:598eb74b-2f30-428c-b26a-d6a59b595b69&page=queryresults
[0m00:49:32.638495 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b1227b50>]}
[0m00:49:32.639675 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.90s]
[0m00:49:32.640723 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:49:32.641532 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp
[0m00:49:32.642364 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.temp_emp)
[0m00:49:32.643812 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:49:32.649370 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:49:32.653531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:49:32.655380 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:49:32.656099 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:49:32.657237 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:49:32.658018 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:49:32.665515 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:49:32.666683 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:49:32.668130 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:49:32.668809 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:49:32.669647 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:49:32.670325 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:49:32.680352 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:49:32.681476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:49:32.683256 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:49:32.683998 [debug] [Thread-3 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:49:32.685062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:49:32.685749 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:49:32.696118 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:49:32.697221 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:49:32.698765 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:49:32.699447 [debug] [Thread-3 (]: Began running node model.cs329e_xh.matching
[0m00:49:32.700373 [info ] [Thread-3 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m00:49:32.701209 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:49:32.702012 [debug] [Thread-3 (]: Began compiling node model.cs329e_xh.matching
[0m00:49:32.762747 [debug] [Thread-3 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:49:32.763942 [debug] [Thread-3 (]: Began executing node model.cs329e_xh.matching
[0m00:49:32.780963 [debug] [Thread-3 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:49:32.784522 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a1cacc10>]}
[0m00:49:32.785901 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.57s]
[0m00:49:32.787183 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:49:32.788469 [debug] [Thread-3 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:49:32.807874 [debug] [Thread-3 (]: BigQuery adapter: Submitting batch job with id: e39d1436-2db9-4e45-9e9c-21d3dd949147
[0m00:49:33.696846 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a1cc2470>]}
[0m00:49:33.698084 [info ] [Thread-4 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.39s]
[0m00:49:33.699212 [debug] [Thread-4 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:49:36.781790 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:49:36.783354 [error] [Thread-3 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
400 Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
[0m00:49:36.786479 [debug] [Thread-3 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1683, in submit_python_job
    submission_result = job_helper.submit(compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 120, in submit
    response: Batch = operation.result(polling=self._polling_retry)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.InvalidArgument: 400 Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.

[0m00:49:36.787853 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a1b95570>]}
[0m00:49:36.789017 [error] [Thread-3 (]: 9 of 10 ERROR creating python table model dbt_cs329e_xh_int.matching ........... [[31mERROR[0m in 4.09s]
[0m00:49:36.790065 [debug] [Thread-3 (]: Finished running node model.cs329e_xh.matching
[0m00:49:36.791101 [debug] [Thread-7 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: 400 Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota..
[0m00:49:36.793198 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m00:49:36.794014 [info ] [Thread-2 (]: 10 of 10 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m00:49:36.794803 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m00:49:40.064617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d24f32-256f-4b05-92b8-8f82ad7e8fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cdc88550>]}
[0m00:49:40.066466 [info ] [Thread-1 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 15.95s]
[0m00:49:40.067920 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:49:40.070451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:49:40.071741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:49:40.072389 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:49:40.072933 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m00:49:40.073450 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:49:40.074016 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m00:49:40.074725 [info ] [MainThread]: 
[0m00:49:40.075374 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 18.76 seconds (18.76s).
[0m00:49:40.078296 [debug] [MainThread]: Command end result
[0m00:49:40.121080 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:49:40.124190 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:49:40.135026 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:49:40.135729 [info ] [MainThread]: 
[0m00:49:40.136456 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:49:40.137298 [info ] [MainThread]: 
[0m00:49:40.138099 [error] [MainThread]:   400 Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Insufficient 'CPUS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
[0m00:49:40.138759 [info ] [MainThread]: 
[0m00:49:40.139430 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m00:49:40.140446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 21.325752, "process_in_blocks": "0", "process_kernel_time": 0.56629, "process_mem_max_rss": "275668", "process_out_blocks": "2672", "process_user_time": 4.93916}
[0m00:49:40.141133 [debug] [MainThread]: Command `dbt run` failed at 00:49:40.140987 after 21.33 seconds
[0m00:49:40.141768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cd9b9540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b1c16d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cda5efb0>]}
[0m00:49:40.142523 [debug] [MainThread]: Flushing usage events
[0m00:49:40.315463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:13.440372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dfbf55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ded7a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ded7a3b0>]}


============================== 00:55:13.444215 | 48ad1a7f-a9fa-47a8-8255-2e089b7a5322 ==============================
[0m00:55:13.444215 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:55:13.445252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model int', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:15.207033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e0d9aec0>]}
[0m00:55:15.295359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ded7a440>]}
[0m00:55:15.296479 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:55:15.474100 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:55:15.645551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m00:55:15.646667 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m00:55:15.647290 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m00:55:16.018467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:55:16.039633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c3a68100>]}
[0m00:55:16.161290 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:55:16.163973 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:55:16.183599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1df1778b0>]}
[0m00:55:16.184637 [info ] [MainThread]: Found 28 models, 9 sources, 492 macros
[0m00:55:16.185513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dfe8b040>]}
[0m00:55:16.190202 [info ] [MainThread]: 
[0m00:55:16.191387 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:55:16.192270 [info ] [MainThread]: 
[0m00:55:16.193479 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:55:16.201489 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:55:16.202535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:16.389923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m00:55:16.391330 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m00:55:16.392029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:16.392781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:16.526455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e1146b90>]}
[0m00:55:16.527374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:16.531232 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:55:16.532067 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:55:16.533067 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:55:16.534341 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:55:16.535493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m00:55:16.536610 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m00:55:16.537333 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:55:16.538106 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:55:16.550558 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:55:16.556842 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:55:16.558183 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:55:16.558966 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:55:16.590238 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:16.591198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:16.751143 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:55:16.753086 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:55:16.754697 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:55:16.755572 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:55:17.115201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5358b19b-99e3-4a10-aa02-b80b8f28279d&page=queryresults
[0m00:55:17.144110 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:158890ad-fed8-41d9-a2a3-986ff2191660&page=queryresults
[0m00:55:18.879087 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dfecbc70>]}
[0m00:55:18.879929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c3a8ef50>]}
[0m00:55:18.881211 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.34s]
[0m00:55:18.882719 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.34s]
[0m00:55:18.883897 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:55:18.884871 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:55:18.885730 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:55:18.886527 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:55:18.887694 [info ] [Thread-2 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:55:18.888673 [info ] [Thread-1 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:55:18.889596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m00:55:18.890465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Worksites)
[0m00:55:18.891178 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:55:18.891875 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:55:18.896666 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:55:18.902263 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:55:18.903682 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:55:18.904399 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:55:18.908720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:18.912586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:19.022619 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:55:19.023833 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:55:19.044420 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:55:19.045597 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:55:19.331917 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fa92ee20-f78d-4b1a-97f7-1e77740e8f64&page=queryresults
[0m00:55:19.366031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9148f6a8-50da-4bc6-9487-4b568ea45350&page=queryresults
[0m00:55:29.025106 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c05dad70>]}
[0m00:55:29.026893 [info ] [Thread-2 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.14s]
[0m00:55:29.028448 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:55:29.029520 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:55:29.030990 [info ] [Thread-2 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint ....... [RUN]
[0m00:55:29.031850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.LCA_Worksites-checkpoint)
[0m00:55:29.032505 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:55:29.037504 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:55:29.038484 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:55:29.043041 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:55:29.044057 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites-checkpoint`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:55:29.044767 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:29.370020 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7518d55e-a7c9-4662-b716-d18ed8ca0281&page=queryresults
[0m00:55:29.574492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c3a8cd30>]}
[0m00:55:29.575694 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 10.68s]
[0m00:55:29.577173 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:55:29.577951 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:55:29.578923 [info ] [Thread-1 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:55:29.579905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m00:55:29.580567 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:55:29.587342 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:55:29.588369 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:55:29.592391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:29.759204 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:55:29.761018 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:55:30.078870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f424683f-f5a1-4b4b-9233-add7d8d86703&page=queryresults
[0m00:55:37.815642 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c0697c70>]}
[0m00:55:37.816911 [info ] [Thread-2 (]: 5 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint .. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 8.78s]
[0m00:55:37.818238 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:55:37.819035 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:55:37.820044 [info ] [Thread-2 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:55:37.821037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites-checkpoint, now model.cs329e_xh.Sentiment_Analysis)
[0m00:55:37.821676 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:55:37.826422 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:55:37.827406 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:55:37.831438 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:37.929278 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:55:37.930594 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:55:38.311108 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d077708d-b517-424d-afc1-1af400dfb857&page=queryresults
[0m00:55:39.955128 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c0697c70>]}
[0m00:55:39.956321 [info ] [Thread-2 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.13s]
[0m00:55:39.957546 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:55:39.958362 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:55:39.959336 [info ] [Thread-2 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:55:39.960314 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:55:39.960955 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:55:39.965878 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:55:39.966898 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:55:39.970905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:40.105319 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:55:40.107040 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:55:40.441124 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:435c9910-4b63-4565-b9dc-697fef99d99f&page=queryresults
[0m00:55:45.576599 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c0697c70>]}
[0m00:55:45.577804 [info ] [Thread-2 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 5.62s]
[0m00:55:45.579177 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:55:45.579974 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:55:45.580864 [info ] [Thread-2 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:55:45.582051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.Wage_Summary)
[0m00:55:45.582691 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:55:45.588946 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:55:45.590005 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:55:45.593945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:45.739861 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:55:45.741054 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:55:46.074871 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4b424e7a-665a-4c0e-ac02-c706d3175e9f&page=queryresults
[0m00:55:51.501791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c0697c70>]}
[0m00:55:51.503020 [info ] [Thread-2 (]: 9 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 5.92s]
[0m00:55:51.504286 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:55:51.505038 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:55:51.506026 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint ....... [RUN]
[0m00:55:51.507012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.Wage_Summary-checkpoint)
[0m00:55:51.507652 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:55:51.512527 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:55:51.513465 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:55:51.517245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:51.614308 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:55:51.615528 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary-checkpoint`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:55:51.955542 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9ffc9ace-4bbf-433b-8ff9-863e0232da6e&page=queryresults
[0m00:55:53.916271 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c0697c70>]}
[0m00:55:53.917442 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint .. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.41s]
[0m00:55:53.918647 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:55:53.919394 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m00:55:53.920280 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary-checkpoint, now model.cs329e_xh.temp_emp)
[0m00:55:53.921005 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:55:53.926548 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:55:53.927629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:53.929049 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:55:53.929715 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:55:53.930660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:55:53.931533 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:55:53.936919 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:55:53.937850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:53.939286 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:55:53.939999 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:55:53.940976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:55:53.941577 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:55:53.953148 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:55:53.954247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:53.955767 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:55:53.956454 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:55:53.957522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:55:53.958221 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:55:53.967930 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:55:53.968993 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:53.970578 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:55:53.971279 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m00:55:53.972216 [info ] [Thread-2 (]: 11 of 12 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m00:55:53.973033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:55:53.973784 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching
[0m00:55:54.034961 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:55:54.036111 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching
[0m00:55:54.050645 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:55:54.051958 [debug] [Thread-2 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:55:54.071378 [debug] [Thread-2 (]: BigQuery adapter: Submitting batch job with id: de230c2f-63f0-4681-9b07-fd682eb8349a
[0m00:55:54.775071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ad1a7f-a9fa-47a8-8255-2e089b7a5322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c04f4700>]}
[0m00:55:54.776329 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 25.20s]
[0m00:55:54.777480 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:57:59.564679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m00:57:59.566599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:58:00.170991 [error] [MainThread]: CANCEL query model.cs329e_xh.PW_Disclosure ..................................... [[31mCANCEL[0m]
[0m00:58:00.171852 [error] [MainThread]: CANCEL query model.cs329e_xh.matching .......................................... [[31mCANCEL[0m]
[0m00:58:00.172800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:58:05.314072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:05.314984 [debug] [MainThread]: Connection 'model.cs329e_xh.PW_Disclosure' was properly closed.
[0m00:58:05.316492 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m00:58:05.317252 [info ] [MainThread]: 
[0m00:58:05.318108 [info ] [MainThread]: Finished running 10 table models in 0 hours 2 minutes and 49.12 seconds (169.12s).
[0m00:58:05.318975 [error] [MainThread]: Encountered an error:

[0m00:58:05.321260 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 330, in run_queue
    self.handle_job_queue(pool, callback)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 828, in handle_job_queue
    node = self.job_queue.get()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/conda/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 445, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 404, in _cancel_connections
    pool.join()
  File "/opt/conda/lib/python3.10/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/opt/conda/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m00:58:05.322409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 171.96156, "process_in_blocks": "0", "process_kernel_time": 0.471653, "process_mem_max_rss": "279664", "process_out_blocks": "2712", "process_user_time": 5.561174}
[0m00:58:05.323303 [debug] [MainThread]: Command `dbt run` failed at 00:58:05.323101 after 171.96 seconds
[0m00:58:05.324088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dfbf55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c3a68e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c05c5360>]}
[0m00:58:05.324741 [debug] [MainThread]: Flushing usage events
[0m00:58:05.525265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:41.077722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2bbb15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2ad123e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2ad12380>]}


============================== 00:58:41.081918 | a4ff0ec2-3545-4949-91e5-e45a2414e2f9 ==============================
[0m00:58:41.081918 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:58:41.083158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --model int', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:58:42.839908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2b0f77c0>]}
[0m00:58:42.930081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2b0f7be0>]}
[0m00:58:42.931274 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:58:43.106982 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:58:43.280572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:58:43.281712 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m00:58:43.282546 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/matching.py
[0m00:58:43.660663 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m00:58:43.683544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0fb02ad0>]}
[0m00:58:43.805231 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m00:58:43.807945 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m00:58:43.825699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0fc0ec50>]}
[0m00:58:43.826744 [info ] [MainThread]: Found 28 models, 9 sources, 492 macros
[0m00:58:43.827448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0fc0c520>]}
[0m00:58:43.831003 [info ] [MainThread]: 
[0m00:58:43.831709 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:58:43.832338 [info ] [MainThread]: 
[0m00:58:43.833247 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:58:43.841363 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m00:58:43.842401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:44.061044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m00:58:44.062246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:44.063278 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m00:58:44.065819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:44.191239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2d0dfa00>]}
[0m00:58:44.192178 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:58:44.196005 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m00:58:44.197038 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m00:58:44.198020 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m00:58:44.198984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m00:58:44.200037 [info ] [Thread-2 (]: 2 of 13 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m00:58:44.201149 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m00:58:44.202480 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m00:58:44.215142 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m00:58:44.216018 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m00:58:44.221510 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m00:58:44.222544 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m00:58:44.234253 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m00:58:44.256970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:44.263339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:58:44.424051 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m00:58:44.424883 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m00:58:44.426281 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m00:58:44.427129 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m00:58:44.794900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aa266073-cf91-47b7-b426-172aae9cbe7e&page=queryresults
[0m00:58:44.812330 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:36a0e3ec-651c-4478-801c-8ace1b31c96d&page=queryresults
[0m00:58:46.558748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2b1fdd50>]}
[0m00:58:46.560051 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.36s]
[0m00:58:46.561192 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m00:58:46.562076 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m00:58:46.563108 [info ] [Thread-1 (]: 3 of 13 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m00:58:46.564153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Disclosure)
[0m00:58:46.564821 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m00:58:46.569675 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m00:58:46.573549 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m00:58:46.577856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:46.784556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0cf967a0>]}
[0m00:58:46.785815 [info ] [Thread-2 (]: 2 of 13 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.58s]
[0m00:58:46.787036 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m00:58:46.787897 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m00:58:46.788935 [info ] [Thread-2 (]: 4 of 13 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m00:58:46.790046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Worksites)
[0m00:58:46.790785 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m00:58:46.795510 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m00:58:46.796473 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m00:58:46.800503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:58:46.878164 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m00:58:46.879356 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m00:58:46.924750 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m00:58:46.926007 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:58:47.267084 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b619a0e3-2fd4-4998-8294-0bd36d1e18cc&page=queryresults
[0m00:58:47.309620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3fcdae38-e0aa-44fe-9930-971091c5381e&page=queryresults
[0m00:58:56.131931 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0cf80040>]}
[0m00:58:56.133121 [info ] [Thread-2 (]: 4 of 13 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 9.34s]
[0m00:58:56.134366 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m00:58:56.135143 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:58:56.136119 [info ] [Thread-2 (]: 5 of 13 START sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint ....... [RUN]
[0m00:58:56.137099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.LCA_Worksites-checkpoint)
[0m00:58:56.137737 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:58:56.142348 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:58:56.143262 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:58:56.147007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:58:56.209214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2b1fdd50>]}
[0m00:58:56.210498 [info ] [Thread-1 (]: 3 of 13 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 9.65s]
[0m00:58:56.211732 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m00:58:56.212448 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m00:58:56.213463 [info ] [Thread-1 (]: 6 of 13 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m00:58:56.214527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.PW_Disclosure)
[0m00:58:56.215158 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m00:58:56.220417 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m00:58:56.221499 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m00:58:56.225691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:56.270930 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m00:58:56.272131 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites-checkpoint`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m00:58:56.329488 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m00:58:56.330774 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m00:58:56.552820 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c93131d8-c9b1-46cd-8aff-13680ae3e2fb&page=queryresults
[0m00:58:56.654347 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:39fbcec2-373e-49b9-b2f9-55d88160addd&page=queryresults
[0m00:59:05.165011 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0cba7f70>]}
[0m00:59:05.166293 [info ] [Thread-2 (]: 5 of 13 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint .. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 9.03s]
[0m00:59:05.167427 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m00:59:05.168255 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m00:59:05.169233 [info ] [Thread-2 (]: 7 of 13 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m00:59:05.170371 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites-checkpoint, now model.cs329e_xh.Sentiment_Analysis)
[0m00:59:05.171004 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m00:59:05.175792 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:59:05.176749 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m00:59:05.182638 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:59:05.312980 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m00:59:05.314241 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m00:59:05.650548 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3d54e829-537d-405a-8563-c0fc284b0cc3&page=queryresults
[0m00:59:07.328417 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0cba7f70>]}
[0m00:59:07.329657 [info ] [Thread-2 (]: 7 of 13 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.16s]
[0m00:59:07.330976 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m00:59:07.331790 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m00:59:07.332903 [info ] [Thread-2 (]: 8 of 13 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m00:59:07.333785 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m00:59:07.334470 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m00:59:07.339420 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m00:59:07.340349 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m00:59:07.344199 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:59:07.484571 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m00:59:07.485806 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m00:59:07.778485 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6f878e6e-68f4-4e2b-a3d4-549ddecbb74e&page=queryresults
[0m00:59:08.795147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2be89ff0>]}
[0m00:59:08.796332 [info ] [Thread-1 (]: 6 of 13 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.58s]
[0m00:59:08.797625 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m00:59:08.798406 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m00:59:08.799381 [info ] [Thread-1 (]: 9 of 13 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m00:59:08.800324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.Wage_Summary)
[0m00:59:08.800948 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m00:59:08.805760 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m00:59:08.806743 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m00:59:08.810596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:08.915104 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m00:59:08.916282 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:59:09.238282 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1bfff3ee-c0d3-4669-af9a-de582b63f3db&page=queryresults
[0m00:59:11.146857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0cc36920>]}
[0m00:59:11.148057 [info ] [Thread-1 (]: 9 of 13 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.35s]
[0m00:59:11.149190 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m00:59:11.150162 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:59:11.151168 [info ] [Thread-1 (]: 10 of 13 START sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint ....... [RUN]
[0m00:59:11.152040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.Wage_Summary-checkpoint)
[0m00:59:11.152692 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:59:11.157530 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:59:11.158569 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:59:11.164045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:11.329177 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m00:59:11.330482 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary-checkpoint`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m00:59:11.674212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fbcaca7d-a70c-4085-b749-89c730fbdc99&page=queryresults
[0m00:59:13.565348 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0ca9d330>]}
[0m00:59:13.566658 [info ] [Thread-2 (]: 8 of 13 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.23s]
[0m00:59:13.567804 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m00:59:13.568682 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m00:59:13.569473 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.temp_emp)
[0m00:59:13.570326 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m00:59:13.576025 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m00:59:13.577240 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:59:13.578757 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m00:59:13.579447 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp-checkpoint
[0m00:59:13.580334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_emp-checkpoint)
[0m00:59:13.580994 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp-checkpoint
[0m00:59:13.586625 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp-checkpoint"
[0m00:59:13.587614 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:59:13.588984 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp-checkpoint
[0m00:59:13.589665 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m00:59:13.590633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp-checkpoint, now model.cs329e_xh.temp_employer_details)
[0m00:59:13.591246 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m00:59:13.601186 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m00:59:13.602334 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:59:13.603875 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m00:59:13.604591 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:59:13.605881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.temp_employer_details-checkpoint)
[0m00:59:13.606695 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:59:13.616516 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details-checkpoint"
[0m00:59:13.617612 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:59:13.619158 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details-checkpoint
[0m00:59:13.619859 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m00:59:13.620858 [info ] [Thread-2 (]: 11 of 13 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m00:59:13.621674 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details-checkpoint, now model.cs329e_xh.matching)
[0m00:59:13.622477 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching
[0m00:59:13.677147 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m00:59:13.678336 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching
[0m00:59:13.692940 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m00:59:13.696563 [debug] [Thread-2 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m00:59:13.716573 [debug] [Thread-2 (]: BigQuery adapter: Submitting batch job with id: acff61f7-641c-4c21-9a29-35c19cb76fb3
[0m00:59:13.871413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ff0ec2-3545-4949-91e5-e45a2414e2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0cc36920>]}
[0m00:59:13.872595 [info ] [Thread-1 (]: 10 of 13 OK created sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint .. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.72s]
[0m00:59:13.873656 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary-checkpoint
[0m00:59:13.874534 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching-checkpoint
[0m00:59:13.875713 [info ] [Thread-1 (]: 12 of 13 START python table model dbt_cs329e_xh_int.matching-checkpoint ........ [RUN]
[0m00:59:13.876625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary-checkpoint, now model.cs329e_xh.matching-checkpoint)
[0m00:59:13.877349 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching-checkpoint
[0m00:59:13.903235 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching-checkpoint"
[0m00:59:13.904302 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching-checkpoint
[0m00:59:13.909511 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching-checkpoint"
[0m00:59:13.910824 [debug] [Thread-1 (]: On model.cs329e_xh.matching-checkpoint: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching-checkpoint"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching-checkpoint'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching-checkpoint")

  
[0m00:59:13.912976 [debug] [Thread-1 (]: BigQuery adapter: Submitting batch job with id: 3421de71-e246-4a06-b1bc-32bd553c4791
[0m01:00:02.214944 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:00:02.217028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:02.718918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:03.112087 [error] [MainThread]: CANCEL query model.cs329e_xh.matching-checkpoint ............................... [[31mCANCEL[0m]
[0m01:00:03.113123 [error] [MainThread]: CANCEL query model.cs329e_xh.matching .......................................... [[31mCANCEL[0m]
[0m01:00:03.114172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:04.883651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:04.884720 [debug] [MainThread]: Connection 'model.cs329e_xh.matching-checkpoint' was properly closed.
[0m01:00:04.885291 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m01:00:04.886386 [info ] [MainThread]: 
[0m01:00:04.887192 [info ] [MainThread]: Finished running 10 table models in 0 hours 1 minutes and 21.05 seconds (81.05s).
[0m01:00:04.888210 [error] [MainThread]: Encountered an error:

[0m01:00:04.890708 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 330, in run_queue
    self.handle_job_queue(pool, callback)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 828, in handle_job_queue
    node = self.job_queue.get()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/conda/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 445, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 404, in _cancel_connections
    pool.join()
  File "/opt/conda/lib/python3.10/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/opt/conda/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m01:00:04.891934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 83.895874, "process_in_blocks": "0", "process_kernel_time": 0.537843, "process_mem_max_rss": "277424", "process_out_blocks": "2752", "process_user_time": 5.665209}
[0m01:00:04.892636 [debug] [MainThread]: Command `dbt run` failed at 01:00:04.892488 after 83.90 seconds
[0m01:00:04.893262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2bbb15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0caccb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0cacc5e0>]}
[0m01:00:04.893957 [debug] [MainThread]: Flushing usage events
[0m01:00:05.093802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:34.664518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e96f95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e887e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e887e380>]}


============================== 01:00:34.668775 | 466c939d-e886-41f2-8cbe-86f6eb876e9b ==============================
[0m01:00:34.668775 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:00:34.669871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --model int', 'send_anonymous_usage_stats': 'True'}
[0m01:00:36.447599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8ef5360>]}
[0m01:00:36.540034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8882e60>]}
[0m01:00:36.541177 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:00:36.715299 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:00:36.891167 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 0 files added, 0 files changed.
[0m01:00:36.892109 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m01:00:36.892673 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m01:00:36.893156 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m01:00:36.893631 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m01:00:37.005062 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:00:37.027518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cd605a20>]}
[0m01:00:37.153531 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:00:37.156184 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:00:37.173716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cd604c70>]}
[0m01:00:37.174756 [info ] [MainThread]: Found 24 models, 9 sources, 492 macros
[0m01:00:37.175459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cd604be0>]}
[0m01:00:37.178836 [info ] [MainThread]: 
[0m01:00:37.179768 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:00:37.180352 [info ] [MainThread]: 
[0m01:00:37.181271 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:00:37.189713 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:00:37.190925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:37.370912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:00:37.372077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:37.373164 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m01:00:37.375914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:37.502339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80eac3fa00>]}
[0m01:00:37.503265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:37.507467 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:00:37.508312 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:00:37.509295 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:00:37.510646 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:00:37.511693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m01:00:37.513594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m01:00:37.514428 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:00:37.515122 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:00:37.530104 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:00:37.535307 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:00:37.536769 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:00:37.537570 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:00:37.570435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:37.569510 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:37.743892 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:00:37.744934 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:00:37.746380 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:00:37.747270 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:00:37.996602 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e13b2b9a-136f-4799-be68-4519d70be3d8&page=queryresults
[0m01:00:38.017875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fb64aec7-4ea3-4b51-8a3f-fdfa2520b587&page=queryresults
[0m01:00:39.744027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8d7dd50>]}
[0m01:00:39.745298 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.23s]
[0m01:00:39.746680 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:00:39.747494 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:00:39.748533 [info ] [Thread-1 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:00:39.749485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Disclosure)
[0m01:00:39.750178 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:00:39.755022 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:00:39.756009 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:00:39.760006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:39.857056 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:00:39.858271 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:00:39.987751 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8deead0>]}
[0m01:00:39.989000 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.48s]
[0m01:00:39.990252 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:00:39.991022 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:00:39.991993 [info ] [Thread-2 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:00:39.992970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Worksites)
[0m01:00:39.993632 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:00:39.998481 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:00:39.999496 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:00:40.003365 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:40.138256 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:00:40.139495 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:00:40.190970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d3615f65-42f3-4fdb-a9cb-e48dd9306810&page=queryresults
[0m01:00:40.437613 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:39bf41c2-5b2b-4b00-80c3-ca8fa7e5e280&page=queryresults
[0m01:00:50.943970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8d7dd50>]}
[0m01:00:50.945183 [info ] [Thread-1 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 11.19s]
[0m01:00:50.946426 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:00:50.947449 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m01:00:50.948730 [info ] [Thread-1 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint ....... [RUN]
[0m01:00:50.949735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.LCA_Worksites-checkpoint)
[0m01:00:50.950466 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Worksites-checkpoint
[0m01:00:50.957074 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m01:00:50.958147 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Worksites-checkpoint
[0m01:00:50.962023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:51.068050 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites-checkpoint"
[0m01:00:51.069285 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites-checkpoint`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:00:51.325369 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6ae1385f-5fa9-4f20-ba71-44b0ad8e09ae&page=queryresults
[0m01:00:51.497971 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8deead0>]}
[0m01:00:51.499142 [info ] [Thread-2 (]: 4 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 11.50s]
[0m01:00:51.500370 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:00:51.501113 [debug] [Thread-2 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m01:00:51.502170 [info ] [Thread-2 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m01:00:51.503186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m01:00:51.503908 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m01:00:51.508692 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m01:00:51.509619 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m01:00:51.513545 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:51.637557 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m01:00:51.638815 [debug] [Thread-2 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m01:00:51.962992 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f2489e08-7685-49e2-b356-64cc03f463ef&page=queryresults
[0m01:00:57.846582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cd607940>]}
[0m01:00:57.847829 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites-checkpoint .. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 6.90s]
[0m01:00:57.848999 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Worksites-checkpoint
[0m01:00:57.849790 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m01:00:57.850917 [info ] [Thread-1 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m01:00:57.851782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites-checkpoint, now model.cs329e_xh.Sentiment_Analysis)
[0m01:00:57.852431 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m01:00:57.857408 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:00:57.858426 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m01:00:57.862472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:58.014089 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:00:58.015252 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m01:00:58.316196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:962b5537-6980-4433-8cde-bf916e17e7cb&page=queryresults
[0m01:01:00.197810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cd6079d0>]}
[0m01:01:00.199092 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.35s]
[0m01:01:00.200336 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m01:01:00.201159 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m01:01:00.202269 [info ] [Thread-1 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m01:01:00.203212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m01:01:00.203894 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m01:01:00.210966 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m01:01:00.212044 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m01:01:00.216157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:00.365174 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m01:01:00.366459 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m01:01:00.754417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a330fe43-7f09-42ee-a36d-04e12c42062a&page=queryresults
[0m01:01:03.575251 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cc14fd30>]}
[0m01:01:03.576479 [info ] [Thread-2 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.07s]
[0m01:01:03.577764 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m01:01:03.578528 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m01:01:03.579337 [info ] [Thread-2 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m01:01:03.580452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.Wage_Summary)
[0m01:01:03.581256 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m01:01:03.586271 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m01:01:03.587290 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m01:01:03.591372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:01:03.723789 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m01:01:03.724944 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:01:04.080775 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:39fbe1c1-d64f-473a-9d4d-691d536249b3&page=queryresults
[0m01:01:06.026209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8deead0>]}
[0m01:01:06.027498 [info ] [Thread-2 (]: 9 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.45s]
[0m01:01:06.028807 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m01:01:06.029570 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary-checkpoint
[0m01:01:06.030684 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint ....... [RUN]
[0m01:01:06.031775 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.Wage_Summary-checkpoint)
[0m01:01:06.032418 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary-checkpoint
[0m01:01:06.037516 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m01:01:06.038579 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary-checkpoint
[0m01:01:06.042809 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:01:06.189058 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary-checkpoint"
[0m01:01:06.190278 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary-checkpoint`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:01:06.463866 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:131a806f-f0be-45a1-8daf-59e0c96f2c5c&page=queryresults
[0m01:01:06.971478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8c705b0>]}
[0m01:01:06.972658 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.77s]
[0m01:01:06.973944 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m01:01:06.974715 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m01:01:06.975644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.temp_emp)
[0m01:01:06.976265 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m01:01:06.981539 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m01:01:06.982580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:06.984012 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m01:01:06.985181 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m01:01:06.986025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_employer_details)
[0m01:01:06.986666 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m01:01:06.996884 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m01:01:06.998044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:06.999718 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m01:01:07.000880 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m01:01:07.001732 [info ] [Thread-1 (]: 11 of 12 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m01:01:07.002805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.matching)
[0m01:01:07.003443 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m01:01:07.056968 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m01:01:07.058176 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m01:01:07.072758 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m01:01:07.074107 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m01:01:07.095840 [debug] [Thread-1 (]: BigQuery adapter: Submitting batch job with id: a04c32e3-14ec-4c0b-9a71-942bd1b64498
[0m01:01:08.480588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8deead0>]}
[0m01:01:08.481768 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary-checkpoint .. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.45s]
[0m01:01:08.482969 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary-checkpoint
[0m01:01:11.036856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:11.038459 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
400 Multiple validation errors:
 - Insufficient 'CPUS' quota. Requested 12.0, available 0.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
 - Insufficient 'CPUS_ALL_REGIONS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Multiple validation errors:
 - Insufficient 'CPUS' quota. Requested 12.0, available 0.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
 - Insufficient 'CPUS_ALL_REGIONS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
[0m01:01:11.041642 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1683, in submit_python_job
    submission_result = job_helper.submit(compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 120, in submit
    response: Batch = operation.result(polling=self._polling_retry)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.InvalidArgument: 400 Multiple validation errors:
 - Insufficient 'CPUS' quota. Requested 12.0, available 0.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
 - Insufficient 'CPUS_ALL_REGIONS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Multiple validation errors:
 - Insufficient 'CPUS' quota. Requested 12.0, available 0.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
 - Insufficient 'CPUS_ALL_REGIONS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.

[0m01:01:11.042979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466c939d-e886-41f2-8cbe-86f6eb876e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c662bf10>]}
[0m01:01:11.044094 [error] [Thread-1 (]: 11 of 12 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 4.04s]
[0m01:01:11.045136 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m01:01:11.046168 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: 400 Multiple validation errors:
 - Insufficient 'CPUS' quota. Requested 12.0, available 0.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
 - Insufficient 'CPUS_ALL_REGIONS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Multiple validation errors:
 - Insufficient 'CPUS' quota. Requested 12.0, available 0.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
 - Insufficient 'CPUS_ALL_REGIONS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota..
[0m01:01:11.049047 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m01:01:11.050179 [info ] [Thread-2 (]: 12 of 12 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m01:01:11.051418 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m01:01:11.053561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:01:11.054728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:11.055297 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary-checkpoint' was properly closed.
[0m01:01:11.055954 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m01:01:11.056777 [info ] [MainThread]: 
[0m01:01:11.057499 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 33.88 seconds (33.88s).
[0m01:01:11.060917 [debug] [MainThread]: Command end result
[0m01:01:11.102409 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:01:11.104964 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:01:11.115390 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:01:11.116087 [info ] [MainThread]: 
[0m01:01:11.116954 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:01:11.117788 [info ] [MainThread]: 
[0m01:01:11.118769 [error] [MainThread]:   400 Multiple validation errors:
 - Insufficient 'CPUS' quota. Requested 12.0, available 0.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
 - Insufficient 'CPUS_ALL_REGIONS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota. 3: Multiple validation errors:
 - Insufficient 'CPUS' quota. Requested 12.0, available 0.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
 - Insufficient 'CPUS_ALL_REGIONS' quota. Requested 12.0, available 8.0. Your resource request exceeds your available quota. See https://cloud.google.com/compute/resource-usage. Use https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota to request additional quota.
[0m01:01:11.119575 [info ] [MainThread]: 
[0m01:01:11.120311 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=1 TOTAL=12
[0m01:01:11.121503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 36.53771, "process_in_blocks": "0", "process_kernel_time": 0.514741, "process_mem_max_rss": "278132", "process_out_blocks": "3792", "process_user_time": 5.138009}
[0m01:01:11.122233 [debug] [MainThread]: Command `dbt run` failed at 01:01:11.122076 after 36.54 seconds
[0m01:01:11.122891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e96f95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e9b5c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e95c1c90>]}
[0m01:01:11.123586 [debug] [MainThread]: Flushing usage events
[0m01:01:11.296267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:03:25.157973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39460b9540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f394523e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f394523e2f0>]}


============================== 01:03:25.161690 | 3d72bc01-df85-4d20-92b2-268e3c29439a ==============================
[0m01:03:25.161690 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:03:25.162709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --model int', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:03:26.921815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a389090>]}
[0m01:03:27.008482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39457c92d0>]}
[0m01:03:27.009585 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:03:27.183743 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:03:27.353516 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m01:03:27.354461 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m01:03:27.355008 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m01:03:27.463719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:03:27.485505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3929fd0f70>]}
[0m01:03:27.608665 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:03:27.611296 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:03:27.628189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3929fd34c0>]}
[0m01:03:27.629076 [info ] [MainThread]: Found 22 models, 9 sources, 492 macros
[0m01:03:27.629756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3929fd3430>]}
[0m01:03:27.632981 [info ] [MainThread]: 
[0m01:03:27.633665 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:03:27.634312 [info ] [MainThread]: 
[0m01:03:27.635231 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:03:27.643242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:03:27.644144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:27.862842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:03:27.863935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:27.864829 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m01:03:27.867412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:28.050186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3929fd32b0>]}
[0m01:03:28.051276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:03:28.055796 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:03:28.056665 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:03:28.057652 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:03:28.058977 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:03:28.059953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m01:03:28.060826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m01:03:28.061603 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:03:28.062432 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:03:28.080533 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:03:28.085523 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:03:28.087092 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:03:28.087985 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:03:28.126902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:03:28.128398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:28.282309 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:03:28.283424 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:03:28.285024 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:03:28.285968 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:03:28.559841 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8e3e08a0-eaee-4d2e-a0f5-d79a81c22674&page=queryresults
[0m01:03:28.640154 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5412635b-3647-4f9f-ba10-bd3d2618acbb&page=queryresults
[0m01:03:30.418013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a1177c0>]}
[0m01:03:30.418914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3929f8b7c0>]}
[0m01:03:30.420147 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.36s]
[0m01:03:30.421897 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.36s]
[0m01:03:30.423110 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:03:30.424099 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:03:30.424898 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:03:30.425814 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:03:30.426961 [info ] [Thread-1 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:03:30.428141 [info ] [Thread-2 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:03:30.429177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Disclosure)
[0m01:03:30.430058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Worksites)
[0m01:03:30.430863 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:03:30.431594 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:03:30.436593 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:03:30.441639 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:03:30.442988 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:03:30.443792 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:03:30.448045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:30.452459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:03:30.571715 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:03:30.572871 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:03:30.588543 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:03:30.589690 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:03:30.907987 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7dd887c3-e2da-43ee-ace6-2da81da7e9d6&page=queryresults
[0m01:03:30.913740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a379164b-6511-4582-8ad0-09adb2c1fa63&page=queryresults
[0m01:03:38.970263 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3929fcf970>]}
[0m01:03:38.971493 [info ] [Thread-2 (]: 4 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 8.54s]
[0m01:03:38.972722 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:03:38.973418 [debug] [Thread-2 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m01:03:38.974525 [info ] [Thread-2 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m01:03:38.975588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m01:03:38.976280 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m01:03:38.981475 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m01:03:38.982468 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m01:03:38.987831 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:03:39.108770 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m01:03:39.110108 [debug] [Thread-2 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m01:03:39.404654 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1dce1710-d567-4424-91c0-b58e3324b4c8&page=queryresults
[0m01:03:40.614729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3946384550>]}
[0m01:03:40.615884 [info ] [Thread-1 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.19s]
[0m01:03:40.616953 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:03:40.618028 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m01:03:40.618984 [info ] [Thread-1 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m01:03:40.619817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m01:03:40.620431 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m01:03:40.625188 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:03:40.626187 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m01:03:40.630112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:40.736948 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:03:40.738174 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m01:03:41.200203 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d669f7f3-fbb5-4e23-9997-692243c0af2f&page=queryresults
[0m01:03:43.141025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a117a30>]}
[0m01:03:43.142282 [info ] [Thread-1 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.52s]
[0m01:03:43.143385 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m01:03:43.144225 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m01:03:43.145211 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m01:03:43.146149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m01:03:43.146872 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m01:03:43.151859 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m01:03:43.152812 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m01:03:43.156755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:43.276074 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m01:03:43.277301 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m01:03:43.669957 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:76160aa2-2537-4ce0-8adb-92ead433822a&page=queryresults
[0m01:03:49.826912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3946384550>]}
[0m01:03:49.828097 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.68s]
[0m01:03:49.829340 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m01:03:49.830410 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m01:03:49.831643 [info ] [Thread-1 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m01:03:49.832638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.Wage_Summary)
[0m01:03:49.833282 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m01:03:49.837841 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m01:03:49.838765 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m01:03:49.844205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:49.991625 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m01:03:49.992815 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:03:50.346614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:dd394889-1403-4c20-8b8f-2e2b5eaa2ea5&page=queryresults
[0m01:03:51.913506 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3928226920>]}
[0m01:03:51.914782 [info ] [Thread-2 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.94s]
[0m01:03:51.915923 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m01:03:51.916678 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m01:03:51.917562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.temp_emp)
[0m01:03:51.918234 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m01:03:51.923997 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m01:03:51.925042 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:03:51.926561 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m01:03:51.927640 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m01:03:51.928457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_employer_details)
[0m01:03:51.929092 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m01:03:51.939418 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m01:03:51.940540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:03:51.942068 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m01:03:51.943067 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m01:03:51.943922 [info ] [Thread-2 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m01:03:51.944876 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.matching)
[0m01:03:51.945516 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching
[0m01:03:51.998092 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m01:03:51.999284 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching
[0m01:03:52.015646 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m01:03:52.016945 [debug] [Thread-2 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m01:03:52.036233 [debug] [Thread-2 (]: BigQuery adapter: Submitting batch job with id: ae1b2742-4a66-4f6f-930b-eea0b4b241fc
[0m01:03:52.244597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d72bc01-df85-4d20-92b2-268e3c29439a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3946384550>]}
[0m01:03:52.245799 [info ] [Thread-1 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.41s]
[0m01:03:52.247141 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m01:07:05.927643 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:07:05.929730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:07:06.224323 [error] [MainThread]: CANCEL query model.cs329e_xh.Wage_Summary ...................................... [[31mCANCEL[0m]
[0m01:07:06.225280 [error] [MainThread]: CANCEL query model.cs329e_xh.matching .......................................... [[31mCANCEL[0m]
[0m01:07:06.226334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:07:08.267196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:08.268105 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m01:07:08.268644 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m01:07:08.269314 [info ] [MainThread]: 
[0m01:07:08.269972 [info ] [MainThread]: Finished running 8 table models in 0 hours 3 minutes and 40.63 seconds (220.63s).
[0m01:07:08.270887 [error] [MainThread]: Encountered an error:

[0m01:07:08.273302 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 330, in run_queue
    self.handle_job_queue(pool, callback)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 828, in handle_job_queue
    node = self.job_queue.get()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/conda/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 445, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 404, in _cancel_connections
    pool.join()
  File "/opt/conda/lib/python3.10/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/opt/conda/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m01:07:08.274498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 223.19554, "process_in_blocks": "0", "process_kernel_time": 0.559597, "process_mem_max_rss": "273928", "process_out_blocks": "2576", "process_user_time": 5.114719}
[0m01:07:08.275213 [debug] [MainThread]: Command `dbt run` failed at 01:07:08.275066 after 223.20 seconds
[0m01:07:08.275872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39460b9540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3929fd11e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39282123b0>]}
[0m01:07:08.276574 [debug] [MainThread]: Flushing usage events
[0m01:07:08.464742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:07:15.685276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abe9695a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abd922620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abd922680>]}


============================== 01:07:15.689309 | 6bd8f016-4320-4ea9-8d4c-296272236254 ==============================
[0m01:07:15.689309 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:07:15.690251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --model int', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:07:17.441363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abda77b50>]}
[0m01:07:17.529529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abe005cf0>]}
[0m01:07:17.530690 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:07:17.706413 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:07:17.874527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:07:17.875392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:07:17.886576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:07:17.935287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa2855690>]}
[0m01:07:18.058611 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:07:18.061178 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:07:18.079479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa2af5240>]}
[0m01:07:18.080432 [info ] [MainThread]: Found 22 models, 9 sources, 492 macros
[0m01:07:18.081099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa29cece0>]}
[0m01:07:18.084210 [info ] [MainThread]: 
[0m01:07:18.084906 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:07:18.085584 [info ] [MainThread]: 
[0m01:07:18.086543 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:07:18.094271 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:07:18.095179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:18.272038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:07:18.272862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:18.274739 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m01:07:18.275500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:18.445280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa2a2e0e0>]}
[0m01:07:18.446257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:07:18.450449 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:07:18.451267 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:07:18.452217 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:07:18.453350 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:07:18.454374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m01:07:18.455261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m01:07:18.456007 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:07:18.456674 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:07:18.474360 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:07:18.479151 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:07:18.480485 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:07:18.481280 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:07:18.508455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:07:18.515949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:18.669514 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:07:18.671347 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:07:18.672699 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:07:18.673525 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:07:18.949886 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d538cde6-f1b5-4f17-b4d3-60470abc54b2&page=queryresults
[0m01:07:18.999231 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fbd494b7-a776-49e5-b6c9-897fd180fb4e&page=queryresults
[0m01:07:20.744616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abdb898a0>]}
[0m01:07:20.745878 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.29s]
[0m01:07:20.747780 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:07:20.748598 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:07:20.749661 [info ] [Thread-1 (]: 3 of 10 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:07:20.750686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Disclosure)
[0m01:07:20.751387 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:07:20.756116 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:07:20.759412 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:07:20.763813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:20.879239 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:07:20.880443 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:07:20.927876 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa2af7b50>]}
[0m01:07:20.929062 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.47s]
[0m01:07:20.930376 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:07:20.931106 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:07:20.932070 [info ] [Thread-2 (]: 4 of 10 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:07:20.933086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Worksites)
[0m01:07:20.933740 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:07:20.939808 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:07:20.940843 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:07:20.944745 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:07:21.041754 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:07:21.042973 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:07:21.167251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4a8fd9f8-ebce-4d48-8caa-6a29ea9d550b&page=queryresults
[0m01:07:21.655513 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:63a4f37f-eb19-4d2b-bb66-470c0d25b333&page=queryresults
[0m01:07:29.262289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa2787a90>]}
[0m01:07:29.263513 [info ] [Thread-1 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 8.51s]
[0m01:07:29.264719 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:07:29.265434 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m01:07:29.266432 [info ] [Thread-1 (]: 5 of 10 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m01:07:29.267386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.PW_Disclosure)
[0m01:07:29.268045 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m01:07:29.273098 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m01:07:29.274124 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m01:07:29.278197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:29.411117 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m01:07:29.412298 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m01:07:29.768091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e85c4511-7068-43a0-a37e-63047347387f&page=queryresults
[0m01:07:30.905947 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa2785360>]}
[0m01:07:30.907229 [info ] [Thread-2 (]: 4 of 10 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 9.97s]
[0m01:07:30.908303 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:07:30.909006 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m01:07:30.909885 [info ] [Thread-2 (]: 6 of 10 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m01:07:30.910857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Sentiment_Analysis)
[0m01:07:30.911475 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m01:07:30.916133 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:07:30.917031 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m01:07:30.920925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:07:31.032795 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:07:31.034530 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m01:07:31.339109 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bca6697c-553a-4613-af43-89257e055b61&page=queryresults
[0m01:07:33.024585 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa2853190>]}
[0m01:07:33.025795 [info ] [Thread-2 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.11s]
[0m01:07:33.027019 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m01:07:33.027778 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m01:07:33.028790 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m01:07:33.029658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m01:07:33.030334 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m01:07:33.036654 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m01:07:33.037679 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m01:07:33.041682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:07:33.180325 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m01:07:33.181574 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m01:07:33.449163 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:927652f2-5393-426a-ab4d-430ea39fb867&page=queryresults
[0m01:07:39.940161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa03bb910>]}
[0m01:07:39.941357 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.91s]
[0m01:07:39.942562 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m01:07:39.943318 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m01:07:39.944281 [info ] [Thread-2 (]: 8 of 10 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m01:07:39.945149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.Wage_Summary)
[0m01:07:39.945775 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m01:07:39.950503 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m01:07:39.951432 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m01:07:39.955310 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:07:40.077527 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m01:07:40.078729 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:07:40.402081 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4fe88971-7b23-45d2-b0f9-3989eb76fc90&page=queryresults
[0m01:07:41.904502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abdb898a0>]}
[0m01:07:41.905735 [info ] [Thread-1 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.64s]
[0m01:07:41.907411 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m01:07:41.908206 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m01:07:41.909165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.temp_emp)
[0m01:07:41.909852 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m01:07:41.915317 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m01:07:41.916364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:41.917889 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m01:07:41.918999 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m01:07:41.919756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.temp_employer_details)
[0m01:07:41.920383 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m01:07:41.930540 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m01:07:41.931802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:41.933392 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m01:07:41.934564 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m01:07:41.935498 [info ] [Thread-1 (]: 9 of 10 START python table model dbt_cs329e_xh_int.matching .................... [RUN]
[0m01:07:41.936517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.matching)
[0m01:07:41.937180 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m01:07:41.993902 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m01:07:41.995025 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m01:07:42.009118 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m01:07:42.010421 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


with __dbt__cte__temp_emp as (

with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
),  __dbt__cte__temp_employer_details as (

WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join __dbt__cte__temp_emp as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
) import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    df = table.filter(table["tax_id"].isNotNull())
    # Takes too long to ask the LLM
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "__dbt__cte__temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m01:07:42.030240 [debug] [Thread-1 (]: BigQuery adapter: Submitting batch job with id: de56df71-74fb-428e-82b7-3af488dba62a
[0m01:07:44.152824 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa2af4460>]}
[0m01:07:44.154053 [info ] [Thread-2 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 4.21s]
[0m01:07:44.155169 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m01:12:08.895034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:08.896905 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
409 Job failed with message [SyntaxError: invalid syntax]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/de56df71-74fb-428e-82b7-3af488dba62a?project=silken-fortress-448205-p9
gcloud dataproc batches wait 'de56df71-74fb-428e-82b7-3af488dba62a' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/driveroutput.* 10: Job failed with message [SyntaxError: invalid syntax]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/de56df71-74fb-428e-82b7-3af488dba62a?project=silken-fortress-448205-p9
gcloud dataproc batches wait 'de56df71-74fb-428e-82b7-3af488dba62a' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/driveroutput.*
[0m01:12:08.900514 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1683, in submit_python_job
    submission_result = job_helper.submit(compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 120, in submit
    response: Batch = operation.result(polling=self._polling_retry)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Aborted: 409 Job failed with message [SyntaxError: invalid syntax]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/de56df71-74fb-428e-82b7-3af488dba62a?project=silken-fortress-448205-p9
gcloud dataproc batches wait 'de56df71-74fb-428e-82b7-3af488dba62a' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/driveroutput.* 10: Job failed with message [SyntaxError: invalid syntax]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/de56df71-74fb-428e-82b7-3af488dba62a?project=silken-fortress-448205-p9
gcloud dataproc batches wait 'de56df71-74fb-428e-82b7-3af488dba62a' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/driveroutput.*

[0m01:12:08.901928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd8f016-4320-4ea9-8d4c-296272236254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa025db40>]}
[0m01:12:08.903109 [error] [Thread-1 (]: 9 of 10 ERROR creating python table model dbt_cs329e_xh_int.matching ........... [[31mERROR[0m in 266.97s]
[0m01:12:08.904260 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m01:12:08.905295 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: 409 Job failed with message [SyntaxError: invalid syntax]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/de56df71-74fb-428e-82b7-3af488dba62a?project=silken-fortress-448205-p9
gcloud dataproc batches wait 'de56df71-74fb-428e-82b7-3af488dba62a' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/driveroutput.* 10: Job failed with message [SyntaxError: invalid syntax]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/de56df71-74fb-428e-82b7-3af488dba62a?project=silken-fortress-448205-p9
gcloud dataproc batches wait 'de56df71-74fb-428e-82b7-3af488dba62a' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/driveroutput.*.
[0m01:12:08.908563 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m01:12:08.909433 [info ] [Thread-2 (]: 10 of 10 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m01:12:08.910218 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m01:12:08.912169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:12:08.913209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:08.913757 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m01:12:08.914330 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m01:12:08.915042 [info ] [MainThread]: 
[0m01:12:08.915628 [info ] [MainThread]: Finished running 10 table models in 0 hours 4 minutes and 50.83 seconds (290.83s).
[0m01:12:08.918582 [debug] [MainThread]: Command end result
[0m01:12:08.961382 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:12:08.964076 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:12:08.973944 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:12:08.974629 [info ] [MainThread]: 
[0m01:12:08.975255 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:12:08.975924 [info ] [MainThread]: 
[0m01:12:08.976705 [error] [MainThread]:   409 Job failed with message [SyntaxError: invalid syntax]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/de56df71-74fb-428e-82b7-3af488dba62a?project=silken-fortress-448205-p9
gcloud dataproc batches wait 'de56df71-74fb-428e-82b7-3af488dba62a' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/driveroutput.* 10: Job failed with message [SyntaxError: invalid syntax]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/de56df71-74fb-428e-82b7-3af488dba62a?project=silken-fortress-448205-p9
gcloud dataproc batches wait 'de56df71-74fb-428e-82b7-3af488dba62a' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/00ebc9f9-2daf-4429-b476-2db6e10fbf32/jobs/srvls-batch-dc3416dc-c513-457f-a9f1-b845c92b675b/driveroutput.*
[0m01:12:08.977369 [info ] [MainThread]: 
[0m01:12:08.978244 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m01:12:08.979350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 293.374, "process_in_blocks": "0", "process_kernel_time": 0.653013, "process_mem_max_rss": "278872", "process_out_blocks": "2616", "process_user_time": 5.161963}
[0m01:12:08.980053 [debug] [MainThread]: Command `dbt run` failed at 01:12:08.979908 after 293.37 seconds
[0m01:12:08.980701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abe9695a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa2835120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abe832620>]}
[0m01:12:08.981328 [debug] [MainThread]: Flushing usage events
[0m01:12:09.170449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:15:35.930743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0123e81570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01230063b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0123006350>]}


============================== 01:15:35.934880 | a442b01a-6356-4958-ba72-6a1c94182f03 ==============================
[0m01:15:35.934880 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:15:35.935884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model int', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:15:37.708969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01235a6440>]}
[0m01:15:37.795714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01233d4c40>]}
[0m01:15:37.796807 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:15:37.972987 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:15:38.114384 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:15:38.115228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0123660cd0>]}
[0m01:15:39.795432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:15:39.815603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0107614130>]}
[0m01:15:39.934520 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:15:39.937082 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:15:39.954015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01241154e0>]}
[0m01:15:39.954898 [info ] [MainThread]: Found 22 models, 9 sources, 492 macros
[0m01:15:39.955543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0124115e40>]}
[0m01:15:39.958516 [info ] [MainThread]: 
[0m01:15:39.959143 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:15:39.959728 [info ] [MainThread]: 
[0m01:15:39.960618 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:15:39.968405 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:15:39.969321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:40.378911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:15:40.380286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m01:15:40.381022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:40.381814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:40.498825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01253d2ec0>]}
[0m01:15:40.499757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:15:40.503598 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:15:40.504389 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:15:40.505408 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:15:40.506684 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:15:40.507787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m01:15:40.508623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m01:15:40.509398 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:15:40.510146 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:15:40.525390 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:15:40.528132 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:15:40.529510 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:15:40.530409 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:15:40.558152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:15:40.563668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:40.740145 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:15:40.741417 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:15:40.742868 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:15:40.745462 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:15:41.097879 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:323027ec-a489-49bc-b935-c595bfc87a06&page=queryresults
[0m01:15:41.107922 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:572700c2-c7c6-4a5a-8f81-7ad4fea9b6ba&page=queryresults
[0m01:15:43.128873 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01075d3fd0>]}
[0m01:15:43.130190 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.62s]
[0m01:15:43.131371 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:15:43.132172 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:15:43.133154 [info ] [Thread-2 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:15:43.134088 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m01:15:43.134736 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:15:43.139575 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:15:43.140586 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:15:43.144682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:15:43.326938 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:15:43.328150 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:15:43.446510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01075d24a0>]}
[0m01:15:43.447690 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.94s]
[0m01:15:43.448911 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:15:43.449647 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:15:43.450667 [info ] [Thread-1 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:15:43.451629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Worksites)
[0m01:15:43.452254 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:15:43.457119 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:15:43.458209 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:15:43.462116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:43.607071 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:15:43.608261 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:15:43.823815 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8bc5ccac-1edf-486a-9fab-84d8281b0c67&page=queryresults
[0m01:15:43.979120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0b7f246b-50ed-4d8f-a3c4-bd6a967472d4&page=queryresults
[0m01:15:52.977529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01063c3910>]}
[0m01:15:52.978814 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 9.53s]
[0m01:15:52.980064 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:15:52.980837 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m01:15:52.981654 [info ] [Thread-1 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m01:15:52.982833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m01:15:52.983490 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m01:15:52.988575 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m01:15:52.989549 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m01:15:52.995419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:53.259928 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m01:15:53.261173 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m01:15:53.579573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:481dde47-011f-4bcf-9ff6-9feee49539b0&page=queryresults
[0m01:15:54.002815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01241545b0>]}
[0m01:15:54.004010 [info ] [Thread-2 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.87s]
[0m01:15:54.005169 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:15:54.005916 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m01:15:54.006709 [info ] [Thread-2 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m01:15:54.007705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m01:15:54.008331 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m01:15:54.012875 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:15:54.013770 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m01:15:54.017703 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:15:54.170631 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:15:54.171833 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m01:15:54.469129 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6d4a7a95-1eaf-4e5e-bc47-5f81dbc6dc49&page=queryresults
[0m01:15:56.197249 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0106382fe0>]}
[0m01:15:56.198650 [info ] [Thread-2 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.19s]
[0m01:15:56.199853 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m01:15:56.200669 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m01:15:56.201690 [info ] [Thread-2 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m01:15:56.202629 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m01:15:56.203273 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m01:15:56.208322 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m01:15:56.209373 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m01:15:56.213632 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:15:56.333340 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m01:15:56.334658 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m01:15:56.685601 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:51d60999-2982-4286-b54c-c41dc30be131&page=queryresults
[0m01:16:03.346458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0125026d70>]}
[0m01:16:03.347760 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 10.36s]
[0m01:16:03.348977 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m01:16:03.349782 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m01:16:03.350850 [info ] [Thread-1 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m01:16:03.351796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.Wage_Summary)
[0m01:16:03.352463 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m01:16:03.357331 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m01:16:03.358354 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m01:16:03.364238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:03.531930 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m01:16:03.533158 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:16:03.845949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:12a884f5-0765-4982-b4a3-3efff172d34e&page=queryresults
[0m01:16:05.124114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0107e1db10>]}
[0m01:16:05.125297 [info ] [Thread-2 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 8.92s]
[0m01:16:05.126415 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m01:16:05.127112 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m01:16:05.128194 [info ] [Thread-2 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.temp_emp ....................... [RUN]
[0m01:16:05.129182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.temp_emp)
[0m01:16:05.129859 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m01:16:05.135102 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m01:16:05.136069 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_emp
[0m01:16:05.140591 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m01:16:05.141599 [debug] [Thread-2 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein;
    );
  
[0m01:16:05.142387 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:16:05.280742 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d1f54dbf-5fcb-4ded-ae95-cc969738cb12&page=queryresults
[0m01:16:05.281735 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d1f54dbf-5fcb-4ded-ae95-cc969738cb12&page=queryresults
[0m01:16:05.285663 [debug] [Thread-2 (]: Database Error in model temp_emp (models/int/Employer_Details/temp_emp.sql)
  Syntax error: Expected ")" but got ";" at [22:51]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_emp.sql
[0m01:16:05.286703 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0107635b70>]}
[0m01:16:05.287808 [error] [Thread-2 (]: 9 of 12 ERROR creating sql table model dbt_cs329e_xh_int.temp_emp .............. [[31mERROR[0m in 0.16s]
[0m01:16:05.288793 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m01:16:05.289774 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.temp_emp' to be skipped because of status 'error'.  Reason: Database Error in model temp_emp (models/int/Employer_Details/temp_emp.sql)
  Syntax error: Expected ")" but got ";" at [22:51]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_emp.sql.
[0m01:16:05.291666 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m01:16:05.292397 [info ] [Thread-2 (]: 10 of 12 SKIP relation dbt_cs329e_xh_int.temp_employer_details ................. [[33mSKIP[0m]
[0m01:16:05.293156 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m01:16:05.294214 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m01:16:05.294915 [info ] [Thread-2 (]: 11 of 12 SKIP relation dbt_cs329e_xh_int.matching .............................. [[33mSKIP[0m]
[0m01:16:05.295635 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.matching
[0m01:16:05.296586 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m01:16:05.297214 [info ] [Thread-2 (]: 12 of 12 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m01:16:05.297974 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m01:16:05.742382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a442b01a-6356-4958-ba72-6a1c94182f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0107f9c100>]}
[0m01:16:05.743630 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.39s]
[0m01:16:05.745053 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m01:16:05.747496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:16:05.748673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:05.749248 [debug] [MainThread]: Connection 'model.cs329e_xh.temp_emp' was properly closed.
[0m01:16:05.749797 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m01:16:05.750607 [info ] [MainThread]: 
[0m01:16:05.751243 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 25.79 seconds (25.79s).
[0m01:16:05.754234 [debug] [MainThread]: Command end result
[0m01:16:05.797352 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:16:05.800050 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:16:05.810280 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:16:05.811040 [info ] [MainThread]: 
[0m01:16:05.811766 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:16:05.812459 [info ] [MainThread]: 
[0m01:16:05.813262 [error] [MainThread]:   Database Error in model temp_emp (models/int/Employer_Details/temp_emp.sql)
  Syntax error: Expected ")" but got ";" at [22:51]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_emp.sql
[0m01:16:05.813920 [info ] [MainThread]: 
[0m01:16:05.814588 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=3 TOTAL=12
[0m01:16:05.815604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 29.96631, "process_in_blocks": "0", "process_kernel_time": 0.487764, "process_mem_max_rss": "270560", "process_out_blocks": "3616", "process_user_time": 6.587568}
[0m01:16:05.816281 [debug] [MainThread]: Command `dbt run` failed at 01:16:05.816139 after 29.97 seconds
[0m01:16:05.816933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0123e81570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01241154e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0107614f70>]}
[0m01:16:05.817597 [debug] [MainThread]: Flushing usage events
[0m01:16:06.004977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:05.976347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352f2dd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352e4623e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352e462380>]}


============================== 01:17:05.980224 | 0987d8e5-7daf-4f2f-b585-28a6e92bc0f0 ==============================
[0m01:17:05.980224 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:17:05.981197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --model int', 'send_anonymous_usage_stats': 'True'}
[0m01:17:07.721194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352e89b040>]}
[0m01:17:07.809912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352ea86ec0>]}
[0m01:17:07.811032 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:17:07.983110 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:17:08.152258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:17:08.153343 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/temp_emp.sql
[0m01:17:08.516746 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:17:08.538713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3513138e50>]}
[0m01:17:08.660669 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:17:08.663332 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:17:08.681413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351332e440>]}
[0m01:17:08.682348 [info ] [MainThread]: Found 22 models, 9 sources, 492 macros
[0m01:17:08.682964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351332ffa0>]}
[0m01:17:08.686079 [info ] [MainThread]: 
[0m01:17:08.686760 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:17:08.687350 [info ] [MainThread]: 
[0m01:17:08.688208 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:17:08.696277 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:17:08.697269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:08.898479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:17:08.899666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m01:17:08.900516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:08.901244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:09.026511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3530823a00>]}
[0m01:17:09.027360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:17:09.031609 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:17:09.032432 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:17:09.033346 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:17:09.034490 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:17:09.035484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m01:17:09.036302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m01:17:09.037023 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:17:09.037995 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:17:09.050815 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:17:09.055688 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:17:09.057016 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:17:09.057798 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:17:09.092134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:09.100980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:17:09.258810 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:17:09.259887 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:17:09.261238 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:17:09.262751 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:17:09.629692 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ac50e0f7-8a7d-4c24-b47b-1d1e6429223e&page=queryresults
[0m01:17:09.687963 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3bba62a7-4575-42e3-a6d6-55fa8324eb93&page=queryresults
[0m01:17:11.439091 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351312beb0>]}
[0m01:17:11.440523 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.40s]
[0m01:17:11.441694 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:17:11.442549 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:17:11.443516 [info ] [Thread-2 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:17:11.444376 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m01:17:11.444994 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:17:11.449605 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:17:11.450626 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:17:11.454481 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:17:11.637533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35106b68f0>]}
[0m01:17:11.638764 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.60s]
[0m01:17:11.640042 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:17:11.640772 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:17:11.641784 [info ] [Thread-1 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:17:11.642744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Worksites)
[0m01:17:11.643371 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:17:11.647921 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:17:11.648800 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:17:11.652572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:11.657044 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:17:11.658222 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:17:11.750235 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:17:11.751449 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:17:11.970970 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:747306dd-a4da-4dd4-ab53-2c042f3ddc05&page=queryresults
[0m01:17:12.101371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2ec0107c-2a4a-4168-837f-339bc1454723&page=queryresults
[0m01:17:20.216530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351315b2e0>]}
[0m01:17:20.217818 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 8.57s]
[0m01:17:20.219059 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:17:20.219964 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m01:17:20.220822 [info ] [Thread-1 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m01:17:20.222000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m01:17:20.222749 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m01:17:20.227928 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m01:17:20.228977 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m01:17:20.233159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:20.381624 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m01:17:20.382893 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m01:17:20.664828 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:12ecb5e2-ae5b-4e25-9b11-797264825118&page=queryresults
[0m01:17:30.840961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35106b68f0>]}
[0m01:17:30.842243 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 10.62s]
[0m01:17:30.843545 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m01:17:30.844394 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m01:17:30.845535 [info ] [Thread-1 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m01:17:30.846636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m01:17:30.847319 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m01:17:30.852420 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:17:30.853422 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m01:17:30.859191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:31.001125 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:17:31.002424 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m01:17:31.247834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2f159275-46ee-42ff-ae0e-5d49795ba3bf&page=queryresults
[0m01:17:32.903104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351035c400>]}
[0m01:17:32.904260 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.06s]
[0m01:17:32.905546 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m01:17:32.906292 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m01:17:32.907239 [info ] [Thread-1 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m01:17:32.908218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m01:17:32.908867 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m01:17:32.913741 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m01:17:32.914758 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m01:17:32.918665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:33.048136 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m01:17:33.049403 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m01:17:33.405655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:54c9a04b-4d70-4763-8f60-e770df99a2ae&page=queryresults
[0m01:17:37.690734 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35131868f0>]}
[0m01:17:37.692045 [info ] [Thread-2 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 26.25s]
[0m01:17:37.693329 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:17:37.694129 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m01:17:37.695112 [info ] [Thread-2 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m01:17:37.696160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Wage_Summary)
[0m01:17:37.696811 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m01:17:37.701649 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m01:17:37.702768 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m01:17:37.706654 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:17:37.854435 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m01:17:37.855643 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:17:38.193109 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:87ae67a4-2bfa-4a36-b670-d0e112053266&page=queryresults
[0m01:17:40.141317 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3510428be0>]}
[0m01:17:40.142636 [info ] [Thread-2 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.45s]
[0m01:17:40.143817 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m01:17:40.144567 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m01:17:40.145566 [info ] [Thread-2 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.temp_emp ....................... [RUN]
[0m01:17:40.146450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_emp)
[0m01:17:40.147067 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m01:17:40.152427 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m01:17:40.153376 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_emp
[0m01:17:40.159687 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m01:17:40.160799 [debug] [Thread-2 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null;
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m01:17:40.161555 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:17:40.273359 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:801ffc05-4146-4fb1-a592-01cbfa7dea56&page=queryresults
[0m01:17:40.274433 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:801ffc05-4146-4fb1-a592-01cbfa7dea56&page=queryresults
[0m01:17:40.279008 [debug] [Thread-2 (]: Database Error in model temp_emp (models/int/Employer_Details/temp_emp.sql)
  Syntax error: Expected ")" but got ";" at [22:51]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_emp.sql
[0m01:17:40.280016 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3510429a80>]}
[0m01:17:40.281115 [error] [Thread-2 (]: 9 of 12 ERROR creating sql table model dbt_cs329e_xh_int.temp_emp .............. [[31mERROR[0m in 0.13s]
[0m01:17:40.282278 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m01:17:40.283213 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.temp_emp' to be skipped because of status 'error'.  Reason: Database Error in model temp_emp (models/int/Employer_Details/temp_emp.sql)
  Syntax error: Expected ")" but got ";" at [22:51]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_emp.sql.
[0m01:17:40.285080 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m01:17:40.285796 [info ] [Thread-2 (]: 10 of 12 SKIP relation dbt_cs329e_xh_int.temp_employer_details ................. [[33mSKIP[0m]
[0m01:17:40.286651 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m01:17:40.287634 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m01:17:40.288301 [info ] [Thread-2 (]: 11 of 12 SKIP relation dbt_cs329e_xh_int.matching .............................. [[33mSKIP[0m]
[0m01:17:40.289815 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.matching
[0m01:17:40.291313 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m01:17:40.292038 [info ] [Thread-2 (]: 12 of 12 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m01:17:40.294685 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m01:17:40.295845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0987d8e5-7daf-4f2f-b585-28a6e92bc0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3510352bc0>]}
[0m01:17:40.297245 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 7.39s]
[0m01:17:40.298293 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m01:17:40.300302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:17:40.301453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:40.302053 [debug] [MainThread]: Connection 'model.cs329e_xh.temp_emp' was properly closed.
[0m01:17:40.302568 [debug] [MainThread]: Connection 'model.cs329e_xh.Single_Registration' was properly closed.
[0m01:17:40.303234 [info ] [MainThread]: 
[0m01:17:40.303921 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 31.62 seconds (31.62s).
[0m01:17:40.306969 [debug] [MainThread]: Command end result
[0m01:17:40.347410 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:17:40.350093 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:17:40.360898 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:17:40.361586 [info ] [MainThread]: 
[0m01:17:40.362346 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:17:40.363205 [info ] [MainThread]: 
[0m01:17:40.364077 [error] [MainThread]:   Database Error in model temp_emp (models/int/Employer_Details/temp_emp.sql)
  Syntax error: Expected ")" but got ";" at [22:51]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_emp.sql
[0m01:17:40.364841 [info ] [MainThread]: 
[0m01:17:40.365590 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=3 TOTAL=12
[0m01:17:40.366741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 34.470955, "process_in_blocks": "0", "process_kernel_time": 0.477362, "process_mem_max_rss": "267672", "process_out_blocks": "3648", "process_user_time": 5.16326}
[0m01:17:40.367451 [debug] [MainThread]: Command `dbt run` failed at 01:17:40.367290 after 34.47 seconds
[0m01:17:40.368121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352f2dd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35130bc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351018bd30>]}
[0m01:17:40.368792 [debug] [MainThread]: Flushing usage events
[0m01:17:40.537740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:12.493589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa684619540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6835d2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6835d26e0>]}


============================== 01:18:12.497355 | c59bb751-ffc4-4034-b896-6de1abbd227f ==============================
[0m01:18:12.497355 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:18:12.498352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --model int', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:18:14.264327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683b6f970>]}
[0m01:18:14.351217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683dc62c0>]}
[0m01:18:14.352368 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:18:14.529392 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:18:14.697172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:18:14.698326 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/temp_emp.sql
[0m01:18:15.060956 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:18:15.082358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6684a4e20>]}
[0m01:18:15.201973 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:18:15.204554 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:18:15.222356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa668489870>]}
[0m01:18:15.223277 [info ] [MainThread]: Found 22 models, 9 sources, 492 macros
[0m01:18:15.224026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6684898a0>]}
[0m01:18:15.227249 [info ] [MainThread]: 
[0m01:18:15.227980 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:18:15.228622 [info ] [MainThread]: 
[0m01:18:15.229777 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:18:15.237977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:18:15.238859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:15.454779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:18:15.456014 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m01:18:15.456727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:15.457518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:15.626104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa685b5e230>]}
[0m01:18:15.627018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:15.630720 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:18:15.631503 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:18:15.632513 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:18:15.633886 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:18:15.634891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m01:18:15.635805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m01:18:15.636789 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:18:15.637493 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:18:15.650272 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:18:15.655074 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:18:15.656507 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:18:15.657248 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:18:15.692010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:15.700565 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:18:15.883739 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:18:15.887414 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:18:15.888853 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:18:15.891708 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:18:16.158868 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e696c110-68c9-49f4-a005-bc3934134f6d&page=queryresults
[0m01:18:16.241952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:23e20b27-730f-468d-bef8-680e02aeeccc&page=queryresults
[0m01:18:17.908274 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683839840>]}
[0m01:18:17.909537 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.27s]
[0m01:18:17.910852 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:18:17.911634 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:18:17.912467 [info ] [Thread-2 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:18:17.913517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m01:18:17.914318 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:18:17.919722 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:18:17.920735 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:18:17.924760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:18:18.064917 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:18:18.066178 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:18:18.197773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6687a1870>]}
[0m01:18:18.199104 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.56s]
[0m01:18:18.200179 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:18:18.200993 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:18:18.202050 [info ] [Thread-1 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:18:18.203082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Worksites)
[0m01:18:18.203746 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:18:18.209980 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:18:18.210997 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:18:18.214850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:18.353771 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:18:18.355129 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:18:18.383921 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a09dbc25-86d8-4011-a6e8-b0a78bb66534&page=queryresults
[0m01:18:18.626958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:60bd679f-44d0-4478-a74d-6c48db3d4e5a&page=queryresults
[0m01:18:25.884082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa666c2f730>]}
[0m01:18:25.885288 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 7.68s]
[0m01:18:25.886429 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:18:25.887250 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m01:18:25.888228 [info ] [Thread-1 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m01:18:25.889133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m01:18:25.889780 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m01:18:25.895143 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m01:18:25.896155 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m01:18:25.899989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:26.011501 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m01:18:26.012710 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m01:18:26.305749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6ad41f54-70fb-48a9-85c4-ee3f417cbfcc&page=queryresults
[0m01:18:26.823418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683839840>]}
[0m01:18:26.824565 [info ] [Thread-2 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 8.91s]
[0m01:18:26.825592 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:18:26.826476 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m01:18:26.827470 [info ] [Thread-2 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m01:18:26.828321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m01:18:26.829155 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m01:18:26.834110 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:18:26.835098 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m01:18:26.839120 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:18:26.978571 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:18:26.979719 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m01:18:27.264110 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a6a30f5a-f686-4b7d-84e1-1bded752df12&page=queryresults
[0m01:18:29.214829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa664efbe80>]}
[0m01:18:29.216034 [info ] [Thread-2 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.39s]
[0m01:18:29.217148 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m01:18:29.218012 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m01:18:29.219067 [info ] [Thread-2 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m01:18:29.219939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m01:18:29.220581 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m01:18:29.225642 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m01:18:29.226676 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m01:18:29.230614 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:18:29.350677 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m01:18:29.351849 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m01:18:29.717004 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5d2a2573-f0b8-4d38-924c-cadea7386586&page=queryresults
[0m01:18:36.551550 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa664efbe80>]}
[0m01:18:36.552758 [info ] [Thread-2 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 7.33s]
[0m01:18:36.554127 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m01:18:36.554893 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m01:18:36.555980 [info ] [Thread-2 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m01:18:36.556985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.Wage_Summary)
[0m01:18:36.557672 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m01:18:36.562741 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m01:18:36.563738 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m01:18:36.567805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:18:36.693070 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m01:18:36.694293 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:18:37.021723 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5f14797d-69e2-4993-abec-b4961e47a7a3&page=queryresults
[0m01:18:38.172291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6686a2dd0>]}
[0m01:18:38.173534 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 12.28s]
[0m01:18:38.174889 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m01:18:38.175934 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m01:18:38.176998 [info ] [Thread-1 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.temp_emp ....................... [RUN]
[0m01:18:38.178079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.temp_emp)
[0m01:18:38.178749 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m01:18:38.183923 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m01:18:38.184927 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_emp
[0m01:18:38.191646 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m01:18:38.192811 [debug] [Thread-1 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw)
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m01:18:38.193882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:38.313276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9a4aead2-27ee-47fb-8fce-0d041ee45710&page=queryresults
[0m01:18:38.314305 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9a4aead2-27ee-47fb-8fce-0d041ee45710&page=queryresults
[0m01:18:38.318895 [debug] [Thread-1 (]: Database Error in model temp_emp (models/int/Employer_Details/temp_emp.sql)
  Syntax error: Unexpected identifier "combined" at [32:1]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_emp.sql
[0m01:18:38.319915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa664f609a0>]}
[0m01:18:38.321057 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model dbt_cs329e_xh_int.temp_emp .............. [[31mERROR[0m in 0.14s]
[0m01:18:38.322241 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m01:18:38.323220 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.temp_emp' to be skipped because of status 'error'.  Reason: Database Error in model temp_emp (models/int/Employer_Details/temp_emp.sql)
  Syntax error: Unexpected identifier "combined" at [32:1]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_emp.sql.
[0m01:18:38.325087 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m01:18:38.325850 [info ] [Thread-1 (]: 10 of 12 SKIP relation dbt_cs329e_xh_int.temp_employer_details ................. [[33mSKIP[0m]
[0m01:18:38.326732 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m01:18:38.327779 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m01:18:38.328436 [info ] [Thread-1 (]: 11 of 12 SKIP relation dbt_cs329e_xh_int.matching .............................. [[33mSKIP[0m]
[0m01:18:38.329290 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m01:18:38.330325 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m01:18:38.330984 [info ] [Thread-1 (]: 12 of 12 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m01:18:38.331836 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m01:18:38.959084 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59bb751-ffc4-4034-b896-6de1abbd227f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa664efbe80>]}
[0m01:18:38.960294 [info ] [Thread-2 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.40s]
[0m01:18:38.961534 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m01:18:38.963711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:38.964923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:38.965479 [debug] [MainThread]: Connection 'model.cs329e_xh.Wage_Summary' was properly closed.
[0m01:18:38.966041 [debug] [MainThread]: Connection 'model.cs329e_xh.temp_emp' was properly closed.
[0m01:18:38.966710 [info ] [MainThread]: 
[0m01:18:38.967370 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 23.74 seconds (23.74s).
[0m01:18:38.970422 [debug] [MainThread]: Command end result
[0m01:18:39.010145 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:18:39.012651 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:18:39.022903 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:18:39.023639 [info ] [MainThread]: 
[0m01:18:39.024326 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:18:39.025020 [info ] [MainThread]: 
[0m01:18:39.025762 [error] [MainThread]:   Database Error in model temp_emp (models/int/Employer_Details/temp_emp.sql)
  Syntax error: Unexpected identifier "combined" at [32:1]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_emp.sql
[0m01:18:39.026406 [info ] [MainThread]: 
[0m01:18:39.027079 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=3 TOTAL=12
[0m01:18:39.028096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 26.616976, "process_in_blocks": "0", "process_kernel_time": 0.443393, "process_mem_max_rss": "269612", "process_out_blocks": "3632", "process_user_time": 5.156961}
[0m01:18:39.028786 [debug] [MainThread]: Command `dbt run` failed at 01:18:39.028637 after 26.62 seconds
[0m01:18:39.029400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa684619540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa668438d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683c6a410>]}
[0m01:18:39.030086 [debug] [MainThread]: Flushing usage events
[0m01:18:39.188770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:03.009171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0969ed1600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096923e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096923e3b0>]}


============================== 01:19:03.013160 | 8429806a-1b79-4218-8913-f78dabd98533 ==============================
[0m01:19:03.013160 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:19:03.014276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model int', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:19:04.795838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8429806a-1b79-4218-8913-f78dabd98533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0969241ab0>]}
[0m01:19:04.888430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8429806a-1b79-4218-8913-f78dabd98533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096982f4c0>]}
[0m01:19:04.889544 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:19:05.093750 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:19:05.267965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:19:05.268978 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m01:19:05.269694 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/temp_emp.sql
[0m01:19:05.646710 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:19:05.668450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8429806a-1b79-4218-8913-f78dabd98533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094df29450>]}
[0m01:19:05.791871 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:19:05.794552 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:19:05.812638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8429806a-1b79-4218-8913-f78dabd98533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094df297e0>]}
[0m01:19:05.813568 [info ] [MainThread]: Found 23 models, 9 sources, 492 macros
[0m01:19:05.814364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8429806a-1b79-4218-8913-f78dabd98533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094e386c50>]}
[0m01:19:05.817561 [info ] [MainThread]: 
[0m01:19:05.818415 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:19:05.819146 [info ] [MainThread]: 
[0m01:19:05.820154 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:19:05.828297 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:19:05.829248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:05.998208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:19:05.999344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:06.000438 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m01:19:06.003056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:06.129189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8429806a-1b79-4218-8913-f78dabd98533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096a35ef80>]}
[0m01:19:06.130102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:06.134264 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:19:06.135146 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:19:06.136062 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:19:06.137232 [info ] [Thread-2 (]: 2 of 13 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:19:06.138218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m01:19:06.139056 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m01:19:06.140002 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:19:06.140687 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:19:06.153012 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:19:06.157579 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:19:06.158915 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:19:06.159645 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:19:06.187899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:06.192601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:06.351556 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:19:06.353333 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:19:06.354650 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:19:06.355474 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:19:06.639242 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6d6496b7-d2cd-4272-aa12-df47fa1fd5b1&page=queryresults
[0m01:19:06.654057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:71053292-9f23-420e-84ac-9fa5b0c698f4&page=queryresults
[0m01:19:08.940182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8429806a-1b79-4218-8913-f78dabd98533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094df17d00>]}
[0m01:19:08.941537 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.80s]
[0m01:19:08.943245 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:19:08.944063 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:19:08.945226 [info ] [Thread-1 (]: 3 of 13 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:19:08.946280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Disclosure)
[0m01:19:08.946991 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:19:08.951830 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:19:08.952788 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:19:08.956756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:09.073248 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:19:09.074486 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:19:09.124042 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:19:09.382075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f3abe11c-d17a-4b6a-b47a-c7c587d49300&page=queryresults
[0m01:19:09.390053 [error] [MainThread]: CANCEL query model.cs329e_xh.LCA_Appendix ...................................... [[31mCANCEL[0m]
[0m01:19:09.390886 [error] [MainThread]: CANCEL query model.cs329e_xh.LCA_Disclosure .................................... [[31mCANCEL[0m]
[0m01:19:09.391768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:19:10.857196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:10.858151 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Appendix' was properly closed.
[0m01:19:10.858731 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m01:19:10.859355 [info ] [MainThread]: 
[0m01:19:10.860026 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m01:19:10.860871 [error] [MainThread]: Encountered an error:

[0m01:19:10.863239 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 330, in run_queue
    self.handle_job_queue(pool, callback)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 828, in handle_job_queue
    node = self.job_queue.get()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/conda/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 445, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 404, in _cancel_connections
    pool.join()
  File "/opt/conda/lib/python3.10/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/opt/conda/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m01:19:10.864337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.9370427, "process_in_blocks": "0", "process_kernel_time": 0.434356, "process_mem_max_rss": "266884", "process_out_blocks": "2384", "process_user_time": 4.861272}
[0m01:19:10.865059 [debug] [MainThread]: Command `dbt run` failed at 01:19:10.864909 after 7.94 seconds
[0m01:19:10.865698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0969ed1600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094deba6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094debb5b0>]}
[0m01:19:10.866406 [debug] [MainThread]: Flushing usage events
[0m01:19:10.907083 [debug] [Thread-2 (]: Runtime Error in model LCA_Appendix (models/int/LCA_Appendix.sql)
  connection never acquired for thread (52491, 139677930891008), have []
[0m01:19:10.908229 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8429806a-1b79-4218-8913-f78dabd98533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094c675750>]}
[0m01:19:11.030110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:11.031405 [error] [Thread-2 (]: 2 of 13 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Appendix .......... [[31mERROR[0m in 4.77s]
[0m01:19:19.004635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe435ead5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe435032410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4350323b0>]}


============================== 01:19:19.008401 | 7ae075d0-2712-475c-a3e1-6ba113a8933a ==============================
[0m01:19:19.008401 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:19:19.009261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --model int', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:19:20.761553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe434fbbb50>]}
[0m01:19:20.849546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe435549cf0>]}
[0m01:19:20.850731 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:19:21.028616 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:19:21.197790 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m01:19:21.198776 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m01:19:21.306916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:19:21.329020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419d71000>]}
[0m01:19:21.450063 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:19:21.452607 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:19:21.469244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419d735e0>]}
[0m01:19:21.470158 [info ] [MainThread]: Found 22 models, 9 sources, 492 macros
[0m01:19:21.470918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419d73580>]}
[0m01:19:21.473864 [info ] [MainThread]: 
[0m01:19:21.474603 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:19:21.475373 [info ] [MainThread]: 
[0m01:19:21.476364 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:19:21.484571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:19:21.485540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:21.677612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:19:21.679093 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m01:19:21.679826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:21.680587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:21.841704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4355b9570>]}
[0m01:19:21.842876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:21.846992 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:19:21.847793 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:19:21.848839 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:19:21.850092 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:19:21.851147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m01:19:21.851968 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m01:19:21.852736 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:19:21.853450 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:19:21.871018 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:19:21.874208 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:19:21.875720 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:19:21.887035 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:19:21.908387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:21.909535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:22.066446 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:19:22.068229 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:19:22.069670 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:19:22.070613 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:19:22.338148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7ec3fbed-3c10-4b1e-a96c-fc41cf6887ed&page=queryresults
[0m01:19:22.341321 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f57dd907-c801-4241-bc9d-d8801dba9830&page=queryresults
[0m01:19:24.073525 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4354a4ca0>]}
[0m01:19:24.074807 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.22s]
[0m01:19:24.075893 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:19:24.076739 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:19:24.077843 [info ] [Thread-2 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:19:24.079602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m01:19:24.080289 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:19:24.085135 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:19:24.087958 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:19:24.092168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:24.219267 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:19:24.220500 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:19:24.274515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4354a5ea0>]}
[0m01:19:24.275730 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.42s]
[0m01:19:24.277020 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:19:24.277769 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:19:24.278786 [info ] [Thread-1 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:19:24.279756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Worksites)
[0m01:19:24.280463 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:19:24.285383 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:19:24.286415 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:19:24.290494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:24.407220 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:19:24.408374 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:19:24.538698 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c9c0fa65-5ee6-42cc-8afc-7da974204250&page=queryresults
[0m01:19:24.719249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5e26a90b-1d3a-420d-bc78-3bb51912501c&page=queryresults
[0m01:19:33.222268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419d88f70>]}
[0m01:19:33.223551 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 8.94s]
[0m01:19:33.224882 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:19:33.225718 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m01:19:33.226878 [info ] [Thread-1 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m01:19:33.227969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m01:19:33.228636 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m01:19:33.234022 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m01:19:33.235087 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m01:19:33.239778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:33.352091 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m01:19:33.353330 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m01:19:33.676756 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d9bdfb90-012e-419c-8a35-2a181bf5226b&page=queryresults
[0m01:19:35.058626 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe436183c70>]}
[0m01:19:35.059790 [info ] [Thread-2 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.98s]
[0m01:19:35.061013 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:19:35.061771 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m01:19:35.062748 [info ] [Thread-2 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m01:19:35.063680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m01:19:35.064289 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m01:19:35.068877 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:19:35.069784 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m01:19:35.073630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:35.187886 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:19:35.189091 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m01:19:35.559022 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e84d14dd-2688-45e1-bd5c-01c150177890&page=queryresults
[0m01:19:39.021095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40af725c0>]}
[0m01:19:39.022346 [info ] [Thread-2 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 3.96s]
[0m01:19:39.023627 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m01:19:39.024360 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m01:19:39.025301 [info ] [Thread-2 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m01:19:39.026275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m01:19:39.026908 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m01:19:39.031679 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m01:19:39.032649 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m01:19:39.036625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:39.143462 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m01:19:39.144716 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m01:19:39.442439 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cbffa488-e36f-4672-8237-7077b2470f62&page=queryresults
[0m01:19:46.433581 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe436183c70>]}
[0m01:19:46.434841 [info ] [Thread-2 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 7.41s]
[0m01:19:46.435952 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m01:19:46.436767 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m01:19:46.437714 [info ] [Thread-2 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m01:19:46.438626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.Wage_Summary)
[0m01:19:46.439259 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m01:19:46.444083 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m01:19:46.445028 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m01:19:46.450719 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:46.571087 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m01:19:46.572301 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:19:46.882890 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:da81fac7-3a67-435f-9ee5-56a92ad1db58&page=queryresults
[0m01:19:47.168971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41a199270>]}
[0m01:19:47.170208 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 13.94s]
[0m01:19:47.171352 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m01:19:47.172214 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m01:19:47.173279 [info ] [Thread-1 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.temp_emp ....................... [RUN]
[0m01:19:47.174364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.temp_emp)
[0m01:19:47.175009 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m01:19:47.180309 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m01:19:47.181390 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_emp
[0m01:19:47.186794 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m01:19:47.187994 [debug] [Thread-1 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw),
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m01:19:47.188813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:47.461403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5ddb5dae-4d18-4b81-bf62-ea464f05dd92&page=queryresults
[0m01:19:48.798213 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe43648aa70>]}
[0m01:19:48.799427 [info ] [Thread-2 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.36s]
[0m01:19:48.800566 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m01:19:50.027216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40afaac50>]}
[0m01:19:50.028420 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dbt_cs329e_xh_int.temp_emp .................. [[32mCREATE TABLE (90.2k rows, 19.9 MiB processed)[0m in 2.85s]
[0m01:19:50.029498 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m01:19:50.031056 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m01:19:50.032182 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_cs329e_xh_int.temp_employer_details ......... [RUN]
[0m01:19:50.033209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_employer_details)
[0m01:19:50.033922 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m01:19:50.039222 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m01:19:50.040260 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_employer_details
[0m01:19:50.044898 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_employer_details"
[0m01:19:50.045971 [debug] [Thread-2 (]: On model.cs329e_xh.temp_employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_employer_details`
      
    
    

    OPTIONS()
    as (
      WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp` as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched;
    );
  
[0m01:19:50.046710 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:19:50.145940 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eabc6c6d-ea01-4b3a-bea8-a2c3a0c2aefe&page=queryresults
[0m01:19:50.146939 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eabc6c6d-ea01-4b3a-bea8-a2c3a0c2aefe&page=queryresults
[0m01:19:50.151222 [debug] [Thread-2 (]: Database Error in model temp_employer_details (models/int/Employer_Details/temp_employer_details.sql)
  Syntax error: Expected ")" but got ";" at [25:13]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_employer_details.sql
[0m01:19:50.152209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae075d0-2712-475c-a3e1-6ba113a8933a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40aff9ae0>]}
[0m01:19:50.153269 [error] [Thread-2 (]: 10 of 12 ERROR creating sql table model dbt_cs329e_xh_int.temp_employer_details  [[31mERROR[0m in 0.12s]
[0m01:19:50.154295 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m01:19:50.155185 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.temp_employer_details' to be skipped because of status 'error'.  Reason: Database Error in model temp_employer_details (models/int/Employer_Details/temp_employer_details.sql)
  Syntax error: Expected ")" but got ";" at [25:13]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_employer_details.sql.
[0m01:19:50.157229 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m01:19:50.158056 [info ] [Thread-1 (]: 11 of 12 SKIP relation dbt_cs329e_xh_int.matching .............................. [[33mSKIP[0m]
[0m01:19:50.158974 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m01:19:50.160181 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m01:19:50.160932 [info ] [Thread-2 (]: 12 of 12 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m01:19:50.162091 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m01:19:50.163880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:19:50.164915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:50.165453 [debug] [MainThread]: Connection 'model.cs329e_xh.temp_employer_details' was properly closed.
[0m01:19:50.166004 [debug] [MainThread]: Connection 'model.cs329e_xh.temp_emp' was properly closed.
[0m01:19:50.166691 [info ] [MainThread]: 
[0m01:19:50.167300 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 28.69 seconds (28.69s).
[0m01:19:50.170785 [debug] [MainThread]: Command end result
[0m01:19:50.212577 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:19:50.215311 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:19:50.225702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:19:50.226482 [info ] [MainThread]: 
[0m01:19:50.227233 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:19:50.227944 [info ] [MainThread]: 
[0m01:19:50.228711 [error] [MainThread]:   Database Error in model temp_employer_details (models/int/Employer_Details/temp_employer_details.sql)
  Syntax error: Expected ")" but got ";" at [25:13]
  compiled code at target/run/cs329e_xh/models/int/Employer_Details/temp_employer_details.sql
[0m01:19:50.229357 [info ] [MainThread]: 
[0m01:19:50.230114 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=2 TOTAL=12
[0m01:19:50.231248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 31.30664, "process_in_blocks": "0", "process_kernel_time": 0.512077, "process_mem_max_rss": "264852", "process_out_blocks": "3672", "process_user_time": 4.892966}
[0m01:19:50.231955 [debug] [MainThread]: Command `dbt run` failed at 01:19:50.231808 after 31.31 seconds
[0m01:19:50.232596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe435ead5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419f49720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe435d565f0>]}
[0m01:19:50.233246 [debug] [MainThread]: Flushing usage events
[0m01:19:50.418309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:13.277609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa5bc55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa4d26410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa4d263b0>]}


============================== 01:20:13.281643 | 411e811b-4cc1-43a4-953c-5b77fb5475cc ==============================
[0m01:20:13.281643 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:20:13.282715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --model int', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:20:15.084843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411e811b-4cc1-43a4-953c-5b77fb5475cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa50d1e70>]}
[0m01:20:15.171132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411e811b-4cc1-43a4-953c-5b77fb5475cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa6c66980>]}
[0m01:20:15.172234 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:20:15.347211 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:20:15.519088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:20:15.520137 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m01:20:15.520855 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/temp_employer_details.sql
[0m01:20:15.890671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:20:15.911898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411e811b-4cc1-43a4-953c-5b77fb5475cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf89a2d4b0>]}
[0m01:20:16.032503 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:20:16.035104 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:20:16.053523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411e811b-4cc1-43a4-953c-5b77fb5475cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf89a2d870>]}
[0m01:20:16.054485 [info ] [MainThread]: Found 23 models, 9 sources, 492 macros
[0m01:20:16.055190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411e811b-4cc1-43a4-953c-5b77fb5475cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf89a2ea70>]}
[0m01:20:16.058634 [info ] [MainThread]: 
[0m01:20:16.059543 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:20:16.060230 [info ] [MainThread]: 
[0m01:20:16.061221 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:20:16.069237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:20:16.070216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:16.263893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:20:16.265113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:16.266193 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m01:20:16.268905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:16.432911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411e811b-4cc1-43a4-953c-5b77fb5475cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa70f2b90>]}
[0m01:20:16.433953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:16.438277 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:20:16.439115 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:20:16.440084 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:20:16.441423 [info ] [Thread-2 (]: 2 of 13 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:20:16.442538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m01:20:16.443385 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m01:20:16.444121 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:20:16.445052 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:20:16.460474 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:20:16.462938 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:20:16.464656 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:20:16.465445 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:20:16.500029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:20:16.506353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:16.663730 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:20:16.664950 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:20:16.964796 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:317ca8e3-9d25-41c3-9b65-52600eaab253&page=queryresults
[0m01:20:17.262320 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:20:17.343189 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:20:17.370245 [error] [MainThread]: CANCEL query model.cs329e_xh.Company_Data ...................................... [[31mCANCEL[0m]
[0m01:20:17.371287 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:20:17.372079 [error] [MainThread]: CANCEL query model.cs329e_xh.LCA_Appendix ...................................... [[31mCANCEL[0m]
[0m01:20:17.374672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:17.657703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3c755918-7dba-4a24-b596-0f620075cb2e&page=queryresults
[0m01:20:18.948036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411e811b-4cc1-43a4-953c-5b77fb5475cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa5241d50>]}
[0m01:20:18.949286 [info ] [Thread-2 (]: 2 of 13 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.50s]
[0m01:20:18.950661 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:20:19.505521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411e811b-4cc1-43a4-953c-5b77fb5475cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa5241d50>]}
[0m01:20:19.506824 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 3.06s]
[0m01:20:19.507968 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:20:19.508763 [info ] [MainThread]: 
[0m01:20:19.509646 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m01:20:19.510407 [info ] [MainThread]: 
[0m01:20:19.511164 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m01:20:19.511872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:19.512448 [debug] [MainThread]: Connection 'model.cs329e_xh.Company_Data' was properly closed.
[0m01:20:19.512958 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Appendix' was properly closed.
[0m01:20:19.513478 [info ] [MainThread]: 
[0m01:20:19.514214 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m01:20:19.515151 [error] [MainThread]: Encountered an error:

[0m01:20:19.517076 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 330, in run_queue
    self.handle_job_queue(pool, callback)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 828, in handle_job_queue
    node = self.job_queue.get()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/conda/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m01:20:19.518264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.32773, "process_in_blocks": "0", "process_kernel_time": 0.456447, "process_mem_max_rss": "265648", "process_out_blocks": "2352", "process_user_time": 4.799996}
[0m01:20:19.518979 [debug] [MainThread]: Command `dbt run` failed at 01:20:19.518829 after 6.33 seconds
[0m01:20:19.519610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa5bc55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf89e97040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf89a2ebf0>]}
[0m01:20:19.520255 [debug] [MainThread]: Flushing usage events
[0m01:20:19.637074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:24.467091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e751c9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e7434e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e7434e2c0>]}


============================== 01:20:24.471112 | 4e44c974-9a79-4d30-92c1-b84439ef5538 ==============================
[0m01:20:24.471112 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:20:24.472185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model int', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:20:26.220791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e748e8520>]}
[0m01:20:26.306460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e748e83d0>]}
[0m01:20:26.307554 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:20:26.478887 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:20:26.648050 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m01:20:26.648936 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m01:20:26.757663 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:20:26.780230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e5908cf70>]}
[0m01:20:26.901912 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:20:26.904566 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:20:26.921563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e5908fa00>]}
[0m01:20:26.922510 [info ] [MainThread]: Found 22 models, 9 sources, 492 macros
[0m01:20:26.923249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e5908f970>]}
[0m01:20:26.926270 [info ] [MainThread]: 
[0m01:20:26.927000 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:20:26.927725 [info ] [MainThread]: 
[0m01:20:26.928718 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:20:26.936630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:20:26.937510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:27.133507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:20:27.135190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:27.136192 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m01:20:27.138725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:27.296240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e748c28c0>]}
[0m01:20:27.297159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:27.300721 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:20:27.301450 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:20:27.302499 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:20:27.303587 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:20:27.304627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m01:20:27.305419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.LCA_Appendix)
[0m01:20:27.306140 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:20:27.307188 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:20:27.322781 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:20:27.327772 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:20:27.329166 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:20:27.329937 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:20:27.361431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:27.362449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:20:27.534190 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:20:27.535334 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:20:27.536838 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:20:27.539562 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:20:27.823353 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8baedad7-547f-4835-a5fe-66e9005df69a&page=queryresults
[0m01:20:27.937315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7d71d3e7-acfb-4df2-9f99-da2a4b511fd3&page=queryresults
[0m01:20:29.721910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e7549a380>]}
[0m01:20:29.722735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e594b3a30>]}
[0m01:20:29.723944 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.41s]
[0m01:20:29.725455 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.42s]
[0m01:20:29.726806 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:20:29.727860 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:20:29.728772 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:20:29.729728 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:20:29.730814 [info ] [Thread-2 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:20:29.731825 [info ] [Thread-1 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:20:29.732841 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m01:20:29.733659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Worksites)
[0m01:20:29.734436 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:20:29.735109 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:20:29.739791 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:20:29.744226 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:20:29.745367 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:20:29.746113 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:20:29.750203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:29.754023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:20:29.865707 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:20:29.866945 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:20:29.871102 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:20:29.872144 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:20:30.170182 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:876e97a1-3e26-4750-9842-dcbed496efa7&page=queryresults
[0m01:20:30.176932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:562eb960-fb38-48cd-8cff-d2c360194e83&page=queryresults
[0m01:20:40.318069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e58437c70>]}
[0m01:20:40.319256 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 10.58s]
[0m01:20:40.320344 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:20:40.321144 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m01:20:40.322135 [info ] [Thread-1 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m01:20:40.323001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m01:20:40.323622 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m01:20:40.328678 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m01:20:40.329652 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m01:20:40.335447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:40.478471 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m01:20:40.479722 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m01:20:40.819117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c4056ed7-126e-451a-a61e-e6b84a986304&page=queryresults
[0m01:20:41.513051 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e7549a380>]}
[0m01:20:41.514313 [info ] [Thread-2 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 11.78s]
[0m01:20:41.515590 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:20:41.516362 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m01:20:41.517341 [info ] [Thread-2 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m01:20:41.518342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m01:20:41.518984 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m01:20:41.523616 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:20:41.524549 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m01:20:41.528445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:20:41.635698 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:20:41.636877 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m01:20:41.931587 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d2027c69-4c68-499a-8af7-414d904e09f5&page=queryresults
[0m01:20:43.609206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e5905aa40>]}
[0m01:20:43.610513 [info ] [Thread-2 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.09s]
[0m01:20:43.611644 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m01:20:43.612450 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m01:20:43.613429 [info ] [Thread-2 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m01:20:43.614368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m01:20:43.615030 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m01:20:43.619835 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m01:20:43.620824 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m01:20:43.624879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:20:43.726951 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m01:20:43.728203 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m01:20:43.982095 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:60859fe6-6886-4228-8e69-d0c7fdd84ff6&page=queryresults
[0m01:20:50.209145 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e5905aa40>]}
[0m01:20:50.210505 [info ] [Thread-2 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.59s]
[0m01:20:50.211827 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m01:20:50.212594 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m01:20:50.213460 [info ] [Thread-2 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m01:20:50.214671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.Wage_Summary)
[0m01:20:50.215298 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m01:20:50.220053 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m01:20:50.221085 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m01:20:50.226887 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:20:50.367908 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m01:20:50.369099 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:20:50.689252 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:41602d94-9139-43fb-b760-56dcda4a6d99&page=queryresults
[0m01:20:52.974625 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e7549a380>]}
[0m01:20:52.975770 [info ] [Thread-2 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.76s]
[0m01:20:52.977022 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m01:20:52.977767 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m01:20:52.978807 [info ] [Thread-2 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.temp_emp ....................... [RUN]
[0m01:20:52.979793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_emp)
[0m01:20:52.980484 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m01:20:52.985612 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m01:20:52.986622 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_emp
[0m01:20:52.990419 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:20:53.100976 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m01:20:53.102233 [debug] [Thread-2 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw),
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m01:20:53.367125 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5b22fcb2-429e-4ab9-af47-ee97a67194b3&page=queryresults
[0m01:20:54.828047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e590c8e80>]}
[0m01:20:54.829209 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 14.51s]
[0m01:20:54.830510 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m01:20:55.909955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e590f4550>]}
[0m01:20:55.911172 [info ] [Thread-2 (]: 9 of 12 OK created sql table model dbt_cs329e_xh_int.temp_emp .................. [[32mCREATE TABLE (90.2k rows, 19.9 MiB processed)[0m in 2.93s]
[0m01:20:55.912498 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m01:20:55.913713 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m01:20:55.914937 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_cs329e_xh_int.temp_employer_details ......... [RUN]
[0m01:20:55.916115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.temp_employer_details)
[0m01:20:55.917042 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m01:20:55.921874 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m01:20:55.922788 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_employer_details
[0m01:20:55.927101 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_employer_details"
[0m01:20:55.928046 [debug] [Thread-1 (]: On model.cs329e_xh.temp_employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_employer_details`
      
    
    

    OPTIONS()
    as (
      WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp` as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched
    );
  
[0m01:20:55.928742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:56.192338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:13daede1-9d15-4fee-945c-fcfdd91e3e41&page=queryresults
[0m01:21:00.611862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e58448ee0>]}
[0m01:21:00.613060 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_cs329e_xh_int.temp_employer_details .... [[32mCREATE TABLE (589.3k rows, 4.9 MiB processed)[0m in 4.70s]
[0m01:21:00.614315 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m01:21:00.615968 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m01:21:00.617082 [info ] [Thread-2 (]: 11 of 12 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m01:21:00.618103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.matching)
[0m01:21:00.618812 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching
[0m01:21:00.652928 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m01:21:00.654100 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching
[0m01:21:00.667437 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m01:21:00.668921 [debug] [Thread-2 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    current_dir = os.path.dirname(__file__)
    csv_path = os.path.join(current_dir, 'matched_results_full.csv')
    matching = pd.read_csv(csv_path, dtype={'tax_id': str, 'original_name': str, 'matched_candidate_name': str, 'matched_fein':str})
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "silken-fortress-448205-p9.dbt_cs329e_xh_int.temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m01:21:00.689015 [debug] [Thread-2 (]: BigQuery adapter: Submitting batch job with id: 523d8d91-9338-4f8d-9418-76a35d712cbd
[0m01:25:34.188406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:25:34.190300 [error] [Thread-2 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
409 Job failed with message [FileNotFoundError: [Errno 2] No such file or directory: '/var/dataproc/tmp/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/matched_results_full.csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/523d8d91-9338-4f8d-9418-76a35d712cbd?project=silken-fortress-448205-p9
gcloud dataproc batches wait '523d8d91-9338-4f8d-9418-76a35d712cbd' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/driveroutput.* 10: Job failed with message [FileNotFoundError: [Errno 2] No such file or directory: '/var/dataproc/tmp/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/matched_results_full.csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/523d8d91-9338-4f8d-9418-76a35d712cbd?project=silken-fortress-448205-p9
gcloud dataproc batches wait '523d8d91-9338-4f8d-9418-76a35d712cbd' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/driveroutput.*
[0m01:25:34.194121 [debug] [Thread-2 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1683, in submit_python_job
    submission_result = job_helper.submit(compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 120, in submit
    response: Batch = operation.result(polling=self._polling_retry)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Aborted: 409 Job failed with message [FileNotFoundError: [Errno 2] No such file or directory: '/var/dataproc/tmp/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/matched_results_full.csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/523d8d91-9338-4f8d-9418-76a35d712cbd?project=silken-fortress-448205-p9
gcloud dataproc batches wait '523d8d91-9338-4f8d-9418-76a35d712cbd' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/driveroutput.* 10: Job failed with message [FileNotFoundError: [Errno 2] No such file or directory: '/var/dataproc/tmp/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/matched_results_full.csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/523d8d91-9338-4f8d-9418-76a35d712cbd?project=silken-fortress-448205-p9
gcloud dataproc batches wait '523d8d91-9338-4f8d-9418-76a35d712cbd' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/driveroutput.*

[0m01:25:34.195690 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e44c974-9a79-4d30-92c1-b84439ef5538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e581b82e0>]}
[0m01:25:34.196912 [error] [Thread-2 (]: 11 of 12 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 273.58s]
[0m01:25:34.198168 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.matching
[0m01:25:34.199268 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: 409 Job failed with message [FileNotFoundError: [Errno 2] No such file or directory: '/var/dataproc/tmp/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/matched_results_full.csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/523d8d91-9338-4f8d-9418-76a35d712cbd?project=silken-fortress-448205-p9
gcloud dataproc batches wait '523d8d91-9338-4f8d-9418-76a35d712cbd' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/driveroutput.* 10: Job failed with message [FileNotFoundError: [Errno 2] No such file or directory: '/var/dataproc/tmp/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/matched_results_full.csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/523d8d91-9338-4f8d-9418-76a35d712cbd?project=silken-fortress-448205-p9
gcloud dataproc batches wait '523d8d91-9338-4f8d-9418-76a35d712cbd' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/driveroutput.*.
[0m01:25:34.201766 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m01:25:34.202697 [info ] [Thread-1 (]: 12 of 12 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m01:25:34.203638 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m01:25:34.205776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:25:34.206931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:34.207495 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m01:25:34.208029 [debug] [MainThread]: Connection 'model.cs329e_xh.temp_employer_details' was properly closed.
[0m01:25:34.208755 [info ] [MainThread]: 
[0m01:25:34.209465 [info ] [MainThread]: Finished running 12 table models in 0 hours 5 minutes and 7.28 seconds (307.28s).
[0m01:25:34.213123 [debug] [MainThread]: Command end result
[0m01:25:34.255665 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:25:34.258364 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:25:34.268589 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:25:34.269261 [info ] [MainThread]: 
[0m01:25:34.270096 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:25:34.270923 [info ] [MainThread]: 
[0m01:25:34.271792 [error] [MainThread]:   409 Job failed with message [FileNotFoundError: [Errno 2] No such file or directory: '/var/dataproc/tmp/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/matched_results_full.csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/523d8d91-9338-4f8d-9418-76a35d712cbd?project=silken-fortress-448205-p9
gcloud dataproc batches wait '523d8d91-9338-4f8d-9418-76a35d712cbd' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/driveroutput.* 10: Job failed with message [FileNotFoundError: [Errno 2] No such file or directory: '/var/dataproc/tmp/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/matched_results_full.csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/523d8d91-9338-4f8d-9418-76a35d712cbd?project=silken-fortress-448205-p9
gcloud dataproc batches wait '523d8d91-9338-4f8d-9418-76a35d712cbd' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/d2c2265d-c7a9-4742-af15-c507a1a24c7a/jobs/srvls-batch-b8007b53-90fa-4da3-97ca-d4b96197f66d/driveroutput.*
[0m01:25:34.272582 [info ] [MainThread]: 
[0m01:25:34.273306 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=1 TOTAL=12
[0m01:25:34.274409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 309.88834, "process_in_blocks": "0", "process_kernel_time": 0.672668, "process_mem_max_rss": "274768", "process_out_blocks": "3736", "process_user_time": 5.289279}
[0m01:25:34.275108 [debug] [MainThread]: Command `dbt run` failed at 01:25:34.274963 after 309.89 seconds
[0m01:25:34.275745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e751c9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e5841c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e5841c100>]}
[0m01:25:34.276394 [debug] [MainThread]: Flushing usage events
[0m01:25:34.474704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:33:04.290469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a476d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a38f2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a38f2320>]}


============================== 01:33:04.294262 | a42d5906-4351-4e78-ae2c-6d604761f454 ==============================
[0m01:33:04.294262 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:33:04.295180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:33:06.094824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a42d5906-4351-4e78-ae2c-6d604761f454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a3d9e1d0>]}
[0m01:33:06.182066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a42d5906-4351-4e78-ae2c-6d604761f454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a3f1b310>]}
[0m01:33:06.183162 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:33:06.358203 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:33:06.495561 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:33:06.496484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a42d5906-4351-4e78-ae2c-6d604761f454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a3f4d210>]}
[0m01:33:08.414433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:33:08.433424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a42d5906-4351-4e78-ae2c-6d604761f454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8883d1fa00>]}
[0m01:33:08.572570 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:33:08.575326 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:33:08.601006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a42d5906-4351-4e78-ae2c-6d604761f454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8883b1c520>]}
[0m01:33:08.602023 [info ] [MainThread]: Found 23 models, 1 seed, 9 sources, 492 macros
[0m01:33:08.602735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a42d5906-4351-4e78-ae2c-6d604761f454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8883a13880>]}
[0m01:33:08.605996 [info ] [MainThread]: 
[0m01:33:08.606729 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:33:08.607357 [info ] [MainThread]: 
[0m01:33:08.608270 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:33:08.610342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:33:08.611104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:08.807887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now create_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m01:33:08.808975 [debug] [ThreadPool]: Creating schema "database: "silken-fortress-448205-p9"
schema: "cs329e_xh_dbt"
"
[0m01:33:08.823001 [debug] [ThreadPool]: On create_silken-fortress-448205-p9_cs329e_xh_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "connection_name": "create_silken-fortress-448205-p9_cs329e_xh_dbt"} */
create schema if not exists `silken-fortress-448205-p9`.`cs329e_xh_dbt`
  
[0m01:33:08.823784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:08.998620 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a5f42283-dd49-48f3-aaf6-aca249e9edf0&page=queryresults
[0m01:33:09.770370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:33:09.771496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:09.772495 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m01:33:09.775167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:09.899084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m01:33:09.902216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:10.056678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a42d5906-4351-4e78-ae2c-6d604761f454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a3e462f0>]}
[0m01:33:10.057710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:33:10.061571 [debug] [Thread-1 (]: Began running node seed.cs329e_xh.matched_results_full
[0m01:33:10.062661 [info ] [Thread-1 (]: 1 of 1 START seed file cs329e_xh_dbt.matched_results_full ...................... [RUN]
[0m01:33:10.063888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now seed.cs329e_xh.matched_results_full)
[0m01:33:10.064555 [debug] [Thread-1 (]: Began compiling node seed.cs329e_xh.matched_results_full
[0m01:33:10.065159 [debug] [Thread-1 (]: Began executing node seed.cs329e_xh.matched_results_full
[0m01:33:11.276178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:13.532601 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:33:13.543116 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/impl.py", line 666, in load_dataframe
    self.connections.write_dataframe_to_table(
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 465, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 497, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "/opt/conda/lib/python3.10/site-packages/google/cloud/bigquery/job/base.py", line 966, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m01:33:13.546235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a42d5906-4351-4e78-ae2c-6d604761f454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a4a445b0>]}
[0m01:33:13.547316 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file cs329e_xh_dbt.matched_results_full .............. [[31mERROR[0m in 3.48s]
[0m01:33:13.548363 [debug] [Thread-1 (]: Finished running node seed.cs329e_xh.matched_results_full
[0m01:33:13.549649 [debug] [Thread-5 (]: Marking all children of 'seed.cs329e_xh.matched_results_full' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m01:33:13.552516 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:33:13.553765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:33:13.554469 [debug] [MainThread]: Connection 'seed.cs329e_xh.matched_results_full' was properly closed.
[0m01:33:13.555008 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int' was properly closed.
[0m01:33:13.555571 [info ] [MainThread]: 
[0m01:33:13.556154 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m01:33:13.557343 [debug] [MainThread]: Command end result
[0m01:33:13.603302 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:33:13.606002 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:33:13.614997 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:33:13.615674 [info ] [MainThread]: 
[0m01:33:13.616317 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:33:13.617106 [info ] [MainThread]: 
[0m01:33:13.617818 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:33:13.618481 [info ] [MainThread]: 
[0m01:33:13.619070 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:33:13.619983 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 9.412118, "process_in_blocks": "96", "process_kernel_time": 0.384725, "process_mem_max_rss": "315128", "process_out_blocks": "3440", "process_user_time": 7.762138}
[0m01:33:13.620659 [debug] [MainThread]: Command `dbt seed` failed at 01:33:13.620517 after 9.41 seconds
[0m01:33:13.621256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a476d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a4635600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8883c48e80>]}
[0m01:33:13.621907 [debug] [MainThread]: Flushing usage events
[0m01:33:13.796481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:34:13.260713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9161e59600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9160fe6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9160fe63b0>]}


============================== 01:34:13.264575 | 0ee787bf-59cf-46b0-b9c7-5ca20a4e21e4 ==============================
[0m01:34:13.264575 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:34:13.265452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m01:34:15.023466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ee787bf-59cf-46b0-b9c7-5ca20a4e21e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9161635390>]}
[0m01:34:15.110819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ee787bf-59cf-46b0-b9c7-5ca20a4e21e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9160fe6440>]}
[0m01:34:15.111907 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:34:15.288912 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:34:15.483829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:34:15.484928 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/matching.py
[0m01:34:15.485637 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m01:34:15.873714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:34:15.895774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ee787bf-59cf-46b0-b9c7-5ca20a4e21e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9145c288e0>]}
[0m01:34:16.031603 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:34:16.034268 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:34:16.051878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ee787bf-59cf-46b0-b9c7-5ca20a4e21e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9145ec6a10>]}
[0m01:34:16.052817 [info ] [MainThread]: Found 23 models, 1 seed, 9 sources, 492 macros
[0m01:34:16.053502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee787bf-59cf-46b0-b9c7-5ca20a4e21e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9145f98b20>]}
[0m01:34:16.056666 [info ] [MainThread]: 
[0m01:34:16.057332 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:34:16.057981 [info ] [MainThread]: 
[0m01:34:16.058845 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:34:16.060412 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:34:16.061154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:16.286998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:34:16.288256 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m01:34:16.289001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:16.289796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:16.413467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m01:34:16.416547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:16.532549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee787bf-59cf-46b0-b9c7-5ca20a4e21e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9163384f70>]}
[0m01:34:16.533599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:34:16.537644 [debug] [Thread-1 (]: Began running node seed.cs329e_xh.matched_results_full
[0m01:34:16.538699 [info ] [Thread-1 (]: 1 of 1 START seed file cs329e_xh_dbt.matched_results_full ...................... [RUN]
[0m01:34:16.539740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now seed.cs329e_xh.matched_results_full)
[0m01:34:16.540428 [debug] [Thread-1 (]: Began compiling node seed.cs329e_xh.matched_results_full
[0m01:34:16.541018 [debug] [Thread-1 (]: Began executing node seed.cs329e_xh.matched_results_full
[0m01:34:17.775966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:20.532157 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:34:20.535050 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/impl.py", line 666, in load_dataframe
    self.connections.write_dataframe_to_table(
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 465, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 497, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "/opt/conda/lib/python3.10/site-packages/google/cloud/bigquery/job/base.py", line 966, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m01:34:20.537991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee787bf-59cf-46b0-b9c7-5ca20a4e21e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9162ef27a0>]}
[0m01:34:20.538976 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file cs329e_xh_dbt.matched_results_full .............. [[31mERROR[0m in 4.00s]
[0m01:34:20.540239 [debug] [Thread-1 (]: Finished running node seed.cs329e_xh.matched_results_full
[0m01:34:20.541268 [debug] [Thread-5 (]: Marking all children of 'seed.cs329e_xh.matched_results_full' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m01:34:20.543917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:34:20.544986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:34:20.545543 [debug] [MainThread]: Connection 'seed.cs329e_xh.matched_results_full' was properly closed.
[0m01:34:20.546110 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int' was properly closed.
[0m01:34:20.546659 [info ] [MainThread]: 
[0m01:34:20.547250 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m01:34:20.548427 [debug] [MainThread]: Command end result
[0m01:34:20.590143 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:34:20.592704 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:34:20.602889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:34:20.603606 [info ] [MainThread]: 
[0m01:34:20.604403 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:34:20.605057 [info ] [MainThread]: 
[0m01:34:20.605870 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:34:20.606491 [info ] [MainThread]: 
[0m01:34:20.607184 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:34:20.608127 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 7.4279437, "process_in_blocks": "0", "process_kernel_time": 0.497335, "process_mem_max_rss": "308948", "process_out_blocks": "3440", "process_user_time": 6.132279}
[0m01:34:20.608819 [debug] [MainThread]: Command `dbt seed` failed at 01:34:20.608673 after 7.43 seconds
[0m01:34:20.609610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9161e59600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9146126500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9162efd090>]}
[0m01:34:20.610327 [debug] [MainThread]: Flushing usage events
[0m01:34:20.752979 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:38:18.057093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7521d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d741d6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d741d66b0>]}


============================== 01:38:18.061203 | 6301173c-3f7b-4026-9ef4-02e8ea141a12 ==============================
[0m01:38:18.061203 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:38:18.062170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:38:19.822773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6301173c-3f7b-4026-9ef4-02e8ea141a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d749fe050>]}
[0m01:38:19.909624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6301173c-3f7b-4026-9ef4-02e8ea141a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74895d50>]}
[0m01:38:19.910795 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:38:20.083697 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:38:20.246779 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:38:20.247773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6301173c-3f7b-4026-9ef4-02e8ea141a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d749fccd0>]}
[0m01:38:22.150921 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.cs329e_xh.mrt
- seeds.cs329e_xh.matched_results_full.column_types
[0m01:38:22.169410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6301173c-3f7b-4026-9ef4-02e8ea141a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5933d990>]}
[0m01:38:22.302612 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:38:22.305125 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:38:22.323257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6301173c-3f7b-4026-9ef4-02e8ea141a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d59113bb0>]}
[0m01:38:22.324177 [info ] [MainThread]: Found 24 models, 1 seed, 9 sources, 492 macros
[0m01:38:22.324816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6301173c-3f7b-4026-9ef4-02e8ea141a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d587f9630>]}
[0m01:38:22.327880 [info ] [MainThread]: 
[0m01:38:22.328553 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:38:22.329155 [info ] [MainThread]: 
[0m01:38:22.330075 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:38:22.332228 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:38:22.333040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:22.558857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m01:38:22.560062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m01:38:22.561020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:38:22.561720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:22.679866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:38:22.682936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:38:22.812828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6301173c-3f7b-4026-9ef4-02e8ea141a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d748fd510>]}
[0m01:38:22.813727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:38:22.817455 [debug] [Thread-1 (]: Began running node seed.cs329e_xh.matched_results_full
[0m01:38:22.818543 [info ] [Thread-1 (]: 1 of 1 START seed file cs329e_xh_dbt.matched_results_full ...................... [RUN]
[0m01:38:22.819624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now seed.cs329e_xh.matched_results_full)
[0m01:38:22.820348 [debug] [Thread-1 (]: Began compiling node seed.cs329e_xh.matched_results_full
[0m01:38:22.820965 [debug] [Thread-1 (]: Began executing node seed.cs329e_xh.matched_results_full
[0m01:38:24.068291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:25.996918 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:38:25.999856 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/impl.py", line 666, in load_dataframe
    self.connections.write_dataframe_to_table(
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 465, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 497, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "/opt/conda/lib/python3.10/site-packages/google/cloud/bigquery/job/base.py", line 966, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m01:38:26.002887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301173c-3f7b-4026-9ef4-02e8ea141a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d754f45b0>]}
[0m01:38:26.003951 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file cs329e_xh_dbt.matched_results_full .............. [[31mERROR[0m in 3.18s]
[0m01:38:26.005161 [debug] [Thread-1 (]: Finished running node seed.cs329e_xh.matched_results_full
[0m01:38:26.006326 [debug] [Thread-5 (]: Marking all children of 'seed.cs329e_xh.matched_results_full' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m01:38:26.009085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:38:26.010245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:38:26.010842 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt' was properly closed.
[0m01:38:26.011330 [debug] [MainThread]: Connection 'seed.cs329e_xh.matched_results_full' was properly closed.
[0m01:38:26.011884 [info ] [MainThread]: 
[0m01:38:26.012470 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m01:38:26.013540 [debug] [MainThread]: Command end result
[0m01:38:26.055393 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:38:26.057915 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:38:26.066744 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:38:26.067402 [info ] [MainThread]: 
[0m01:38:26.068051 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:38:26.068689 [info ] [MainThread]: 
[0m01:38:26.069494 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:38:26.070246 [info ] [MainThread]: 
[0m01:38:26.070975 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:38:26.072020 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 8.095912, "process_in_blocks": "0", "process_kernel_time": 0.516255, "process_mem_max_rss": "310524", "process_out_blocks": "3432", "process_user_time": 7.618597}
[0m01:38:26.072703 [debug] [MainThread]: Command `dbt seed` failed at 01:38:26.072561 after 8.10 seconds
[0m01:38:26.073323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7521d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d750e5600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d59282530>]}
[0m01:38:26.073999 [debug] [MainThread]: Flushing usage events
[0m01:38:26.246409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:38:50.195750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d50dc55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4fd7e620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4fd7e680>]}


============================== 01:38:50.199825 | 6d5c985f-12cb-48f8-96f1-1e5f39641d8d ==============================
[0m01:38:50.199825 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:38:50.200909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:38:51.954586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d5c985f-12cb-48f8-96f1-1e5f39641d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d503a6a70>]}
[0m01:38:52.041570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d5c985f-12cb-48f8-96f1-1e5f39641d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d50402500>]}
[0m01:38:52.042693 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:38:52.216924 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:38:52.409047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:38:52.409753 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:38:52.420750 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.cs329e_xh.mrt
- seeds.cs329e_xh.matched_results_full.column_types
[0m01:38:52.486970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d5c985f-12cb-48f8-96f1-1e5f39641d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d34c9c130>]}
[0m01:38:52.624287 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:38:52.626956 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:38:52.644563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d5c985f-12cb-48f8-96f1-1e5f39641d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d34e536d0>]}
[0m01:38:52.645478 [info ] [MainThread]: Found 24 models, 1 seed, 9 sources, 492 macros
[0m01:38:52.646247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5c985f-12cb-48f8-96f1-1e5f39641d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d34e22e30>]}
[0m01:38:52.649282 [info ] [MainThread]: 
[0m01:38:52.650026 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:38:52.650667 [info ] [MainThread]: 
[0m01:38:52.651573 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:38:52.653124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:38:52.653938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:52.860856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:38:52.862505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:38:52.863495 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m01:38:52.866176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:52.977955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m01:38:52.981969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:38:53.642096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5c985f-12cb-48f8-96f1-1e5f39641d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d5230ab90>]}
[0m01:38:53.643051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:38:53.646583 [debug] [Thread-1 (]: Began running node seed.cs329e_xh.matched_results_full
[0m01:38:53.647602 [info ] [Thread-1 (]: 1 of 1 START seed file cs329e_xh_dbt.matched_results_full ...................... [RUN]
[0m01:38:53.648553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now seed.cs329e_xh.matched_results_full)
[0m01:38:53.649421 [debug] [Thread-1 (]: Began compiling node seed.cs329e_xh.matched_results_full
[0m01:38:53.650108 [debug] [Thread-1 (]: Began executing node seed.cs329e_xh.matched_results_full
[0m01:38:54.731049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:56.441196 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:38:56.444038 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/impl.py", line 666, in load_dataframe
    self.connections.write_dataframe_to_table(
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 465, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 497, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "/opt/conda/lib/python3.10/site-packages/google/cloud/bigquery/job/base.py", line 966, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m01:38:56.446999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5c985f-12cb-48f8-96f1-1e5f39641d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d5109fc70>]}
[0m01:38:56.447962 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file cs329e_xh_dbt.matched_results_full .............. [[31mERROR[0m in 2.80s]
[0m01:38:56.448996 [debug] [Thread-1 (]: Finished running node seed.cs329e_xh.matched_results_full
[0m01:38:56.450036 [debug] [Thread-5 (]: Marking all children of 'seed.cs329e_xh.matched_results_full' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m01:38:56.452581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:38:56.453604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:38:56.454202 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt' was properly closed.
[0m01:38:56.454715 [debug] [MainThread]: Connection 'seed.cs329e_xh.matched_results_full' was properly closed.
[0m01:38:56.455234 [info ] [MainThread]: 
[0m01:38:56.455811 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m01:38:56.456960 [debug] [MainThread]: Command end result
[0m01:38:56.498909 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:38:56.501629 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:38:56.510842 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:38:56.511563 [info ] [MainThread]: 
[0m01:38:56.512223 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:38:56.513046 [info ] [MainThread]: 
[0m01:38:56.513778 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:38:56.514433 [info ] [MainThread]: 
[0m01:38:56.515159 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:38:56.516092 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 6.40089, "process_in_blocks": "0", "process_kernel_time": 0.531366, "process_mem_max_rss": "303092", "process_out_blocks": "2344", "process_user_time": 5.598644}
[0m01:38:56.516795 [debug] [MainThread]: Command `dbt seed` failed at 01:38:56.516643 after 6.40 seconds
[0m01:38:56.517429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d50dc55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d50c8dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d34cf7340>]}
[0m01:38:56.518130 [debug] [MainThread]: Flushing usage events
[0m01:38:56.661398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:42.367062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8dbe55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8cf523e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8cf52380>]}


============================== 01:43:42.371162 | 2cac3625-9e2e-403e-aa9f-ca9b89f1b9b9 ==============================
[0m01:43:42.371162 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:43:42.372044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:43:44.165677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cac3625-9e2e-403e-aa9f-ca9b89f1b9b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8cf14a30>]}
[0m01:43:44.255110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cac3625-9e2e-403e-aa9f-ca9b89f1b9b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf72615510>]}
[0m01:43:44.256240 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:43:44.430391 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:43:44.624020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:43:44.624754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:43:44.635503 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.cs329e_xh.mrt
- seeds.cs329e_xh.matched_results_full.column_types
[0m01:43:44.701655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cac3625-9e2e-403e-aa9f-ca9b89f1b9b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf71cb0130>]}
[0m01:43:44.839274 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:43:44.841794 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:43:44.859189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cac3625-9e2e-403e-aa9f-ca9b89f1b9b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf71c67850>]}
[0m01:43:44.860100 [info ] [MainThread]: Found 24 models, 1 seed, 9 sources, 492 macros
[0m01:43:44.860793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cac3625-9e2e-403e-aa9f-ca9b89f1b9b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf71e37160>]}
[0m01:43:44.863978 [info ] [MainThread]: 
[0m01:43:44.864656 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:43:44.865248 [info ] [MainThread]: 
[0m01:43:44.866190 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:43:44.867769 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:43:44.868639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:45.126505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:43:45.127636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:45.128644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m01:43:45.131432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:45.266542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m01:43:45.270462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:45.408676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cac3625-9e2e-403e-aa9f-ca9b89f1b9b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8f30ab90>]}
[0m01:43:45.409660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:43:45.413817 [debug] [Thread-1 (]: Began running node seed.cs329e_xh.matched_results_full
[0m01:43:45.415014 [info ] [Thread-1 (]: 1 of 1 START seed file cs329e_xh_dbt.matched_results_full ...................... [RUN]
[0m01:43:45.415967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now seed.cs329e_xh.matched_results_full)
[0m01:43:45.416758 [debug] [Thread-1 (]: Began compiling node seed.cs329e_xh.matched_results_full
[0m01:43:45.417358 [debug] [Thread-1 (]: Began executing node seed.cs329e_xh.matched_results_full
[0m01:43:46.501667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:48.234948 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:43:48.237923 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/impl.py", line 666, in load_dataframe
    self.connections.write_dataframe_to_table(
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 465, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/connections.py", line 497, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "/opt/conda/lib/python3.10/site-packages/google/cloud/bigquery/job/base.py", line 966, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m01:43:48.241043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cac3625-9e2e-403e-aa9f-ca9b89f1b9b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf71e76530>]}
[0m01:43:48.242200 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file cs329e_xh_dbt.matched_results_full .............. [[31mERROR[0m in 2.82s]
[0m01:43:48.243303 [debug] [Thread-1 (]: Finished running node seed.cs329e_xh.matched_results_full
[0m01:43:48.244317 [debug] [Thread-5 (]: Marking all children of 'seed.cs329e_xh.matched_results_full' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m01:43:48.247086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:43:48.248356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:48.248924 [debug] [MainThread]: Connection 'seed.cs329e_xh.matched_results_full' was properly closed.
[0m01:43:48.249434 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt' was properly closed.
[0m01:43:48.250050 [info ] [MainThread]: 
[0m01:43:48.250784 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m01:43:48.252132 [debug] [MainThread]: Command end result
[0m01:43:48.295086 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:43:48.297674 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:43:48.306886 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:43:48.307650 [info ] [MainThread]: 
[0m01:43:48.308492 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:43:48.309345 [info ] [MainThread]: 
[0m01:43:48.310246 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 51309; errors: 1; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5009 byte_offset_to_start_of_line: 260103 column_index: 3 column_name: "matched_fein" column_type: INT64 value: "null"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:43:48.310996 [info ] [MainThread]: 
[0m01:43:48.311741 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:43:48.312766 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 6.0275426, "process_in_blocks": "0", "process_kernel_time": 0.480784, "process_mem_max_rss": "305200", "process_out_blocks": "2344", "process_user_time": 5.718732}
[0m01:43:48.313445 [debug] [MainThread]: Command `dbt seed` failed at 01:43:48.313291 after 6.03 seconds
[0m01:43:48.314083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8dbe55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8dc8a5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8dc63d00>]}
[0m01:43:48.314744 [debug] [MainThread]: Flushing usage events
[0m01:43:48.447189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:34.856154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe229095d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe218c2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe218c26b0>]}


============================== 01:46:34.860244 | 6aa61f0e-8994-4d4a-a9fd-b61b014f7e09 ==============================
[0m01:46:34.860244 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:46:34.861267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:46:36.600966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6aa61f0e-8994-4d4a-a9fd-b61b014f7e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe21ef3160>]}
[0m01:46:36.688572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6aa61f0e-8994-4d4a-a9fd-b61b014f7e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe21e58cd0>]}
[0m01:46:36.689704 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:46:36.862931 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:46:37.025547 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:46:37.026457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6aa61f0e-8994-4d4a-a9fd-b61b014f7e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe220e90f0>]}
[0m01:46:38.929071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:46:38.948610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6aa61f0e-8994-4d4a-a9fd-b61b014f7e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe05ed1390>]}
[0m01:46:39.082715 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:46:39.085236 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:46:39.244528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6aa61f0e-8994-4d4a-a9fd-b61b014f7e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe05f5b820>]}
[0m01:46:39.245501 [info ] [MainThread]: Found 24 models, 1 seed, 9 sources, 492 macros
[0m01:46:39.246372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6aa61f0e-8994-4d4a-a9fd-b61b014f7e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe06130a30>]}
[0m01:46:39.249475 [info ] [MainThread]: 
[0m01:46:39.250302 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:46:39.251096 [info ] [MainThread]: 
[0m01:46:39.252115 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:46:39.253696 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:46:39.254607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:39.458674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:46:39.459900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m01:46:39.460764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:39.461443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:39.585746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:46:39.589494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:39.748147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6aa61f0e-8994-4d4a-a9fd-b61b014f7e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe23aaedd0>]}
[0m01:46:39.749071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:39.753346 [debug] [Thread-1 (]: Began running node seed.cs329e_xh.matched_results_full
[0m01:46:39.754429 [info ] [Thread-1 (]: 1 of 1 START seed file cs329e_xh_dbt.matched_results_full ...................... [RUN]
[0m01:46:39.755495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now seed.cs329e_xh.matched_results_full)
[0m01:46:39.756215 [debug] [Thread-1 (]: Began compiling node seed.cs329e_xh.matched_results_full
[0m01:46:39.756820 [debug] [Thread-1 (]: Began executing node seed.cs329e_xh.matched_results_full
[0m01:46:40.266685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:43.443228 [debug] [Thread-1 (]: On seed.cs329e_xh.matched_results_full: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "seed.cs329e_xh.matched_results_full"} */

    alter table `silken-fortress-448205-p9`.`cs329e_xh_dbt`.`matched_results_full` set OPTIONS()
  
[0m01:46:43.682528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1bdb48a0-0250-481c-9126-46d9985f6d95&page=queryresults
[0m01:46:43.944503 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.cs329e_xh.matched_results_full"
[0m01:46:43.972077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6aa61f0e-8994-4d4a-a9fd-b61b014f7e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe22bd1ff0>]}
[0m01:46:43.973085 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file cs329e_xh_dbt.matched_results_full .................. [[32mINSERT 51309[0m in 4.22s]
[0m01:46:43.974218 [debug] [Thread-1 (]: Finished running node seed.cs329e_xh.matched_results_full
[0m01:46:43.976790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:43.977958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:43.978510 [debug] [MainThread]: Connection 'seed.cs329e_xh.matched_results_full' was properly closed.
[0m01:46:43.979002 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt' was properly closed.
[0m01:46:43.979522 [info ] [MainThread]: 
[0m01:46:43.980158 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m01:46:43.981464 [debug] [MainThread]: Command end result
[0m01:46:44.025207 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:46:44.027891 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:46:44.036900 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:46:44.037549 [info ] [MainThread]: 
[0m01:46:44.038450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:46:44.039160 [info ] [MainThread]: 
[0m01:46:44.039942 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:46:44.041001 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 9.264192, "process_in_blocks": "0", "process_kernel_time": 0.479308, "process_mem_max_rss": "303204", "process_out_blocks": "3456", "process_user_time": 6.905891}
[0m01:46:44.041687 [debug] [MainThread]: Command `dbt seed` succeeded at 01:46:44.041529 after 9.27 seconds
[0m01:46:44.042357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe229095d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe05f5b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe05f0e020>]}
[0m01:46:44.043003 [debug] [MainThread]: Flushing usage events
[0m01:46:44.204416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:51.885500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd34ec15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3404e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3404e380>]}


============================== 01:46:51.889363 | c2d8fbae-360c-4b09-a9a4-8a29449cf996 ==============================
[0m01:46:51.889363 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:46:51.890367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --model int', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:46:53.638261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2d8fbae-360c-4b09-a9a4-8a29449cf996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd33fe9330>]}
[0m01:46:53.726451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2d8fbae-360c-4b09-a9a4-8a29449cf996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd340239d0>]}
[0m01:46:53.727581 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:46:53.900974 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:46:54.095739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:46:54.096451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:46:54.107378 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:46:54.174180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2d8fbae-360c-4b09-a9a4-8a29449cf996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd18d6c130>]}
[0m01:46:54.312579 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:46:54.315230 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:46:54.333086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2d8fbae-360c-4b09-a9a4-8a29449cf996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd18f09b40>]}
[0m01:46:54.334059 [info ] [MainThread]: Found 24 models, 1 seed, 9 sources, 492 macros
[0m01:46:54.334769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2d8fbae-360c-4b09-a9a4-8a29449cf996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd18f0b100>]}
[0m01:46:54.337900 [info ] [MainThread]: 
[0m01:46:54.338576 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:46:54.339180 [info ] [MainThread]: 
[0m01:46:54.340044 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:46:54.348256 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:46:54.349316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:54.529964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m01:46:54.531693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:54.532749 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m01:46:54.535314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:54.638345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:46:54.642140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:54.754644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2d8fbae-360c-4b09-a9a4-8a29449cf996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3456d570>]}
[0m01:46:54.755567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:54.759662 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:46:54.760483 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:46:54.761617 [info ] [Thread-1 (]: 1 of 14 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:46:54.762984 [info ] [Thread-2 (]: 2 of 14 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:46:54.764043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m01:46:54.764975 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now model.cs329e_xh.LCA_Appendix)
[0m01:46:54.765755 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:46:54.766566 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:46:54.789862 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:46:54.790633 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:46:54.792045 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:46:54.798074 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:46:54.827419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:54.835112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:46:54.985089 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:46:54.987016 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:46:54.988433 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:46:54.990988 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:46:55.278312 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b3cfd4a1-9edf-4c08-8adf-3f6b13e81157&page=queryresults
[0m01:46:55.337979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4a5ec15f-2d61-4df6-b916-0616b1997d0b&page=queryresults
[0m01:46:57.094832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d8fbae-360c-4b09-a9a4-8a29449cf996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd35157910>]}
[0m01:46:57.096102 [info ] [Thread-1 (]: 1 of 14 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.33s]
[0m01:46:57.097755 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:46:57.098562 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:46:57.099629 [info ] [Thread-1 (]: 3 of 14 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:46:57.100639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Disclosure)
[0m01:46:57.101285 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:46:57.106253 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:46:57.107286 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:46:57.112436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:57.230290 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:46:57.231521 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:46:57.356930 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:46:57.525749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ccda6fe0-b42b-402e-a2b2-d074cf61bc61&page=queryresults
[0m01:46:57.655829 [error] [MainThread]: CANCEL query model.cs329e_xh.LCA_Appendix ...................................... [[31mCANCEL[0m]
[0m01:46:57.656614 [error] [MainThread]: CANCEL query model.cs329e_xh.LCA_Disclosure .................................... [[31mCANCEL[0m]
[0m01:46:57.657461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:58.468275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:58.469246 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Appendix' was properly closed.
[0m01:46:58.469791 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m01:46:58.470546 [info ] [MainThread]: 
[0m01:46:58.471296 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m01:46:58.472137 [error] [MainThread]: Encountered an error:

[0m01:46:58.474443 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 330, in run_queue
    self.handle_job_queue(pool, callback)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 828, in handle_job_queue
    node = self.job_queue.get()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/conda/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 445, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 404, in _cancel_connections
    pool.join()
  File "/opt/conda/lib/python3.10/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/opt/conda/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m01:46:58.475550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.670639, "process_in_blocks": "0", "process_kernel_time": 0.478675, "process_mem_max_rss": "261588", "process_out_blocks": "1288", "process_user_time": 4.56257}
[0m01:46:58.476427 [debug] [MainThread]: Command `dbt run` failed at 01:46:58.476219 after 6.67 seconds
[0m01:46:58.477073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd34ec15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd180e0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd180e3b50>]}
[0m01:46:58.477769 [debug] [MainThread]: Flushing usage events
[0m01:46:58.594613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:47:10.968238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5f0d15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5e0863e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5e086380>]}


============================== 01:47:10.972089 | eb8e311b-f8a0-4bbb-8900-e0ac06b90f75 ==============================
[0m01:47:10.972089 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:47:10.972994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model int', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:47:12.707033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5e219330>]}
[0m01:47:12.793748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5e799c60>]}
[0m01:47:12.794883 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:47:12.969896 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:47:13.162162 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m01:47:13.163076 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m01:47:13.289137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:47:13.311462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd4300c130>]}
[0m01:47:13.449343 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:47:13.451901 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:47:13.469155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd4300d540>]}
[0m01:47:13.470116 [info ] [MainThread]: Found 23 models, 1 seed, 9 sources, 492 macros
[0m01:47:13.470862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd4300d5d0>]}
[0m01:47:13.474192 [info ] [MainThread]: 
[0m01:47:13.474865 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:47:13.475472 [info ] [MainThread]: 
[0m01:47:13.476359 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:47:13.484404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:47:13.485318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:13.685559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m01:47:13.686910 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m01:47:13.687640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:13.688517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:13.828009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:47:13.829319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:13.953656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5ef87a90>]}
[0m01:47:13.954652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:47:13.958544 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:47:13.959363 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:47:13.960283 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:47:13.961498 [info ] [Thread-2 (]: 2 of 13 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:47:13.962585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Company_Data)
[0m01:47:13.963447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.LCA_Appendix)
[0m01:47:13.964186 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:47:13.964952 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:47:13.979374 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:47:13.984686 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:47:13.986127 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:47:14.007962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:14.008880 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:47:14.015055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:47:14.185432 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:47:14.186520 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:47:14.187968 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:47:14.188788 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:47:14.420204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:787bc5b0-e82d-47d8-9cde-244bad761ec3&page=queryresults
[0m01:47:14.567854 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e490b516-b047-489d-b21e-906f2e25c1f0&page=queryresults
[0m01:47:16.150214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5e759ab0>]}
[0m01:47:16.151723 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.18s]
[0m01:47:16.152859 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:47:16.153668 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:47:16.155002 [info ] [Thread-1 (]: 3 of 13 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:47:16.155901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Disclosure)
[0m01:47:16.156548 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:47:16.161533 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:47:16.162488 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:47:16.166391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:16.274707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd42f7b4c0>]}
[0m01:47:16.275974 [info ] [Thread-2 (]: 2 of 13 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.31s]
[0m01:47:16.277274 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:47:16.278069 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:47:16.278907 [info ] [Thread-2 (]: 4 of 13 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:47:16.279861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Worksites)
[0m01:47:16.280770 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:47:16.286589 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:47:16.288653 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:47:16.289767 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:47:16.290576 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:47:16.296337 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:47:16.466120 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:47:16.467280 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:47:16.577987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5cda7a89-d684-49c5-82db-5891d05b93a0&page=queryresults
[0m01:47:16.580801 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:47:16.832959 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:acd1dc3b-9380-414a-8845-64dc705403b3&page=queryresults
[0m01:47:16.956066 [error] [MainThread]: CANCEL query model.cs329e_xh.LCA_Disclosure .................................... [[31mCANCEL[0m]
[0m01:47:16.957068 [error] [MainThread]: CANCEL query model.cs329e_xh.LCA_Worksites ..................................... [[31mCANCEL[0m]
[0m01:47:16.958004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:47:22.879154 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:47:22.880209 [debug] [Thread-1 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/silken-fortress-448205-p9/queries/5cda7a89-d684-49c5-82db-5891d05b93a0?maxResults=0&location=US&prettyPrint=false: Job execution was cancelled: User requested cancellation

Location: US
Job ID: 5cda7a89-d684-49c5-82db-5891d05b93a0

[0m01:47:22.913778 [debug] [Thread-1 (]: Runtime Error in model LCA_Disclosure (models/int/LCA_Disclosure.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/silken-fortress-448205-p9/queries/5cda7a89-d684-49c5-82db-5891d05b93a0?maxResults=0&location=US&prettyPrint=false: Job execution was cancelled: User requested cancellation
  
  Location: US
  Job ID: 5cda7a89-d684-49c5-82db-5891d05b93a0
  
[0m01:47:22.915057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd4031faf0>]}
[0m01:47:22.916213 [error] [Thread-1 (]: 3 of 13 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Disclosure ........ [[31mERROR[0m in 6.76s]
[0m01:47:22.917341 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:47:23.107118 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:47:23.107984 [debug] [Thread-2 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/silken-fortress-448205-p9/queries/acd1dc3b-9380-414a-8845-64dc705403b3?maxResults=0&location=US&prettyPrint=false: Job execution was cancelled: User requested cancellation

Location: US
Job ID: acd1dc3b-9380-414a-8845-64dc705403b3

[0m01:47:23.109987 [debug] [Thread-2 (]: Runtime Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/silken-fortress-448205-p9/queries/acd1dc3b-9380-414a-8845-64dc705403b3?maxResults=0&location=US&prettyPrint=false: Job execution was cancelled: User requested cancellation
  
  Location: US
  Job ID: acd1dc3b-9380-414a-8845-64dc705403b3
  
[0m01:47:23.110922 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb8e311b-f8a0-4bbb-8900-e0ac06b90f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd4031c1f0>]}
[0m01:47:23.111957 [error] [Thread-2 (]: 4 of 13 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ......... [[31mERROR[0m in 6.83s]
[0m01:47:23.112957 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:47:23.113761 [info ] [MainThread]: 
[0m01:47:23.114548 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m01:47:23.115158 [info ] [MainThread]: 
[0m01:47:23.115806 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:47:23.116460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:47:23.117007 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Disclosure' was properly closed.
[0m01:47:23.117490 [debug] [MainThread]: Connection 'model.cs329e_xh.LCA_Worksites' was properly closed.
[0m01:47:23.118136 [info ] [MainThread]: 
[0m01:47:23.118735 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.64 seconds (9.64s).
[0m01:47:23.119524 [error] [MainThread]: Encountered an error:

[0m01:47:23.121136 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 330, in run_queue
    self.handle_job_queue(pool, callback)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 828, in handle_job_queue
    node = self.job_queue.get()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/conda/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m01:47:23.122167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.23942, "process_in_blocks": "448", "process_kernel_time": 0.515888, "process_mem_max_rss": "263468", "process_out_blocks": "2408", "process_user_time": 4.663474}
[0m01:47:23.122873 [debug] [MainThread]: Command `dbt run` failed at 01:47:23.122725 after 12.24 seconds
[0m01:47:23.123499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5f0d15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd43045db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd43046080>]}
[0m01:47:23.124139 [debug] [MainThread]: Flushing usage events
[0m01:47:23.322976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:47:36.989328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4732f415d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4731ef63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4731ef6380>]}


============================== 01:47:36.993223 | ab9ff132-50fd-45ad-82d0-f6bdfefe9585 ==============================
[0m01:47:36.993223 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:47:36.994275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --model int', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:47:38.723470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47340d2ef0>]}
[0m01:47:38.810264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473273f520>]}
[0m01:47:38.811381 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:47:38.984766 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:47:39.177199 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m01:47:39.178210 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m01:47:39.304031 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cs329e_xh.mrt
[0m01:47:39.326240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716e60130>]}
[0m01:47:39.464302 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:47:39.466950 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:47:39.483911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716e51d80>]}
[0m01:47:39.484821 [info ] [MainThread]: Found 22 models, 1 seed, 9 sources, 492 macros
[0m01:47:39.485518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716e50af0>]}
[0m01:47:39.488564 [info ] [MainThread]: 
[0m01:47:39.489220 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:47:39.489861 [info ] [MainThread]: 
[0m01:47:39.490761 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:47:39.498611 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m01:47:39.499456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:39.651728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m01:47:39.652900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m01:47:39.653953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:39.654684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:39.773590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m01:47:39.777492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:39.902485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716e0c790>]}
[0m01:47:39.903390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:47:39.907037 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m01:47:39.908834 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m01:47:39.909937 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_cs329e_xh_int.Company_Data ................... [RUN]
[0m01:47:39.911198 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_cs329e_xh_int.LCA_Appendix ................... [RUN]
[0m01:47:39.912217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Company_Data)
[0m01:47:39.913027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now model.cs329e_xh.LCA_Appendix)
[0m01:47:39.913757 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m01:47:39.914565 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m01:47:39.929081 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m01:47:39.934269 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m01:47:39.935687 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m01:47:39.936448 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m01:47:39.963733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:47:39.968605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:40.121312 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m01:47:40.122298 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m01:47:40.123733 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
      
    
    

    OPTIONS()
    as (
      with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    );
  
[0m01:47:40.124476 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
      
    
    

    OPTIONS()
    as (
      with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    );
  
[0m01:47:40.415143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:68a5c987-2716-4dd9-96f7-f1909b27f0d6&page=queryresults
[0m01:47:40.520640 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0eb9ecef-6ec7-44d1-9a46-74ec090e01a5&page=queryresults
[0m01:47:42.225571 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47326508e0>]}
[0m01:47:42.226939 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.31s]
[0m01:47:42.228749 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m01:47:42.229577 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m01:47:42.230816 [info ] [Thread-2 (]: 3 of 12 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................. [RUN]
[0m01:47:42.231901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m01:47:42.232584 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m01:47:42.237223 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m01:47:42.238163 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m01:47:42.242062 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:47:42.298316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47171da1a0>]}
[0m01:47:42.299753 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_cs329e_xh_int.Company_Data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.39s]
[0m01:47:42.300898 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m01:47:42.301617 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m01:47:42.302650 [info ] [Thread-1 (]: 4 of 12 START sql table model dbt_cs329e_xh_int.LCA_Worksites .................. [RUN]
[0m01:47:42.303510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Worksites)
[0m01:47:42.304142 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m01:47:42.308641 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m01:47:42.309562 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m01:47:42.313427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:42.361999 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m01:47:42.363193 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
      
    
    

    OPTIONS()
    as (
      with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    );
  
[0m01:47:42.441661 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m01:47:42.442971 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
      
    
    

    OPTIONS()
    as (
      with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    );
  
[0m01:47:42.609798 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:11693dc6-81d0-4284-8434-6b99754dd4d3&page=queryresults
[0m01:47:42.852070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:03ca907a-90ac-49db-b292-c1ebb856da2a&page=queryresults
[0m01:47:53.626953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47143eb8e0>]}
[0m01:47:53.628143 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 11.32s]
[0m01:47:53.629210 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m01:47:53.629999 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m01:47:53.630965 [info ] [Thread-1 (]: 5 of 12 START sql table model dbt_cs329e_xh_int.PW_Disclosure .................. [RUN]
[0m01:47:53.631822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m01:47:53.632439 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m01:47:53.638928 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m01:47:53.639912 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m01:47:53.643691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:53.772647 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m01:47:53.773974 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m01:47:53.906188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716e800d0>]}
[0m01:47:53.907437 [info ] [Thread-2 (]: 3 of 12 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ............ [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 11.67s]
[0m01:47:53.908697 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m01:47:53.909537 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m01:47:53.910654 [info ] [Thread-2 (]: 6 of 12 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............. [RUN]
[0m01:47:53.911689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m01:47:53.912333 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m01:47:53.917107 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:47:53.918323 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m01:47:53.922574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:47:54.032384 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m01:47:54.033515 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
      
    
    

    OPTIONS()
    as (
      with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    );
  
[0m01:47:54.038462 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eeb66027-ed83-4600-a940-9ae9878f2d8d&page=queryresults
[0m01:47:54.352971 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e5e8a8f2-1e78-4f2e-a5a7-317bf87a2488&page=queryresults
[0m01:47:56.279414 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716e800d0>]}
[0m01:47:56.280578 [info ] [Thread-2 (]: 6 of 12 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ........ [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.37s]
[0m01:47:56.281725 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m01:47:56.282569 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m01:47:56.283606 [info ] [Thread-2 (]: 7 of 12 START sql table model dbt_cs329e_xh_int.Single_Registration ............ [RUN]
[0m01:47:56.284657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.Single_Registration)
[0m01:47:56.285279 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m01:47:56.290250 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m01:47:56.291173 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m01:47:56.295127 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:47:56.420160 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m01:47:56.421411 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
      
    
    

    OPTIONS()
    as (
      with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr
    );
  
[0m01:47:56.732898 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:14b34820-0da8-4b98-89ea-a578f2915ac1&page=queryresults
[0m01:48:02.390833 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716e800d0>]}
[0m01:48:02.392929 [info ] [Thread-2 (]: 7 of 12 OK created sql table model dbt_cs329e_xh_int.Single_Registration ....... [[32mCREATE TABLE (238.0k rows, 75.7 MiB processed)[0m in 6.11s]
[0m01:48:02.394851 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m01:48:02.396067 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m01:48:02.397887 [info ] [Thread-2 (]: 8 of 12 START sql table model dbt_cs329e_xh_int.Wage_Summary ................... [RUN]
[0m01:48:02.399240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.Wage_Summary)
[0m01:48:02.400322 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m01:48:02.410244 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m01:48:02.411996 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m01:48:02.418725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:48:02.545031 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m01:48:02.546848 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
      
    
    

    OPTIONS()
    as (
      with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    );
  
[0m01:48:02.976227 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0c6885e2-cc1d-48e2-99a8-a2c2e41d007d&page=queryresults
[0m01:48:04.160550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716e80220>]}
[0m01:48:04.161778 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............. [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 10.53s]
[0m01:48:04.163124 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m01:48:04.163856 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m01:48:04.164783 [info ] [Thread-1 (]: 9 of 12 START sql table model dbt_cs329e_xh_int.temp_emp ....................... [RUN]
[0m01:48:04.165698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.temp_emp)
[0m01:48:04.166351 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m01:48:04.171729 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m01:48:04.172692 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_emp
[0m01:48:04.176724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:04.305757 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m01:48:04.307045 [debug] [Thread-1 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw),
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m01:48:04.587714 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1b9139c7-1ac1-4cce-bb6c-f414931bc5b9&page=queryresults
[0m01:48:04.952687 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716e800d0>]}
[0m01:48:04.954440 [info ] [Thread-2 (]: 8 of 12 OK created sql table model dbt_cs329e_xh_int.Wage_Summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.55s]
[0m01:48:04.956084 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m01:48:07.104699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47141a7580>]}
[0m01:48:07.105943 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dbt_cs329e_xh_int.temp_emp .................. [[32mCREATE TABLE (90.2k rows, 19.9 MiB processed)[0m in 2.94s]
[0m01:48:07.107152 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m01:48:07.108670 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m01:48:07.109866 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_cs329e_xh_int.temp_employer_details ......... [RUN]
[0m01:48:07.110897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_employer_details)
[0m01:48:07.111556 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m01:48:07.116758 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m01:48:07.117757 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_employer_details
[0m01:48:07.121728 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:48:07.246999 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_employer_details"
[0m01:48:07.248183 [debug] [Thread-2 (]: On model.cs329e_xh.temp_employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_employer_details`
      
    
    

    OPTIONS()
    as (
      WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp` as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched
    );
  
[0m01:48:07.544490 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9145c419-ff4b-404c-995e-5470c9961c11&page=queryresults
[0m01:48:11.914887 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fffb06a0>]}
[0m01:48:11.916165 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_cs329e_xh_int.temp_employer_details .... [[32mCREATE TABLE (589.3k rows, 4.9 MiB processed)[0m in 4.80s]
[0m01:48:11.917280 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m01:48:11.919405 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m01:48:11.920491 [info ] [Thread-1 (]: 11 of 12 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m01:48:11.921361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.matching)
[0m01:48:11.922178 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m01:48:11.964123 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m01:48:11.965396 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m01:48:11.981508 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m01:48:11.982801 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    current_dir = os.path.dirname(__file__)
    matching = dbt.ref("matched_results_full")
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"matched_results_full": "silken-fortress-448205-p9.cs329e_xh_dbt.matched_results_full", "temp_employer_details": "silken-fortress-448205-p9.dbt_cs329e_xh_int.temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m01:48:12.003305 [debug] [Thread-1 (]: BigQuery adapter: Submitting batch job with id: 5978273b-3b04-4367-85ff-56bc7d4458d6
[0m01:52:56.582489 [debug] [Thread-1 (]: Execution status: OK in 284.6000061035156 seconds
[0m01:52:56.585385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:56.586847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46ffe3b3d0>]}
[0m01:52:56.587930 [info ] [Thread-1 (]: 11 of 12 OK created python table model dbt_cs329e_xh_int.matching .............. [[32mOK[0m in 284.67s]
[0m01:52:56.589077 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m01:52:56.590206 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m01:52:56.591473 [info ] [Thread-2 (]: 12 of 12 START sql table model dbt_cs329e_xh_int.Employer_Detail ............... [RUN]
[0m01:52:56.592435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.Employer_Detail)
[0m01:52:56.593066 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Employer_Detail
[0m01:52:56.598662 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Employer_Detail"
[0m01:52:56.599877 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Employer_Detail
[0m01:52:56.604432 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Employer_Detail"
[0m01:52:56.605454 [debug] [Thread-2 (]: On model.cs329e_xh.Employer_Detail: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Employer_Detail"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
      
    
    

    OPTIONS()
    as (
      with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp
    );
  
[0m01:52:56.606253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:52:56.993935 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f71f0eb2-4e6e-4e58-8733-40a1e74eea6b&page=queryresults
[0m01:52:59.304724 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9ff132-50fd-45ad-82d0-f6bdfefe9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46ffe3b0a0>]}
[0m01:52:59.305868 [info ] [Thread-2 (]: 12 of 12 OK created sql table model dbt_cs329e_xh_int.Employer_Detail .......... [[32mCREATE TABLE (28.9k rows, 10.8 MiB processed)[0m in 2.71s]
[0m01:52:59.307242 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m01:52:59.309380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:59.310492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:59.311011 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m01:52:59.311483 [debug] [MainThread]: Connection 'model.cs329e_xh.Employer_Detail' was properly closed.
[0m01:52:59.312112 [info ] [MainThread]: 
[0m01:52:59.312785 [info ] [MainThread]: Finished running 12 table models in 0 hours 5 minutes and 19.82 seconds (319.82s).
[0m01:52:59.316289 [debug] [MainThread]: Command end result
[0m01:52:59.355822 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m01:52:59.358665 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m01:52:59.368746 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m01:52:59.369432 [info ] [MainThread]: 
[0m01:52:59.370221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:52:59.371023 [info ] [MainThread]: 
[0m01:52:59.371766 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m01:52:59.372815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 322.463, "process_in_blocks": "0", "process_kernel_time": 0.578194, "process_mem_max_rss": "279824", "process_out_blocks": "3744", "process_user_time": 5.428183}
[0m01:52:59.373477 [debug] [MainThread]: Command `dbt run` succeeded at 01:52:59.373338 after 322.46 seconds
[0m01:52:59.374091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4732f415d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47340d2ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47170c0580>]}
[0m01:52:59.374728 [debug] [MainThread]: Flushing usage events
[0m01:52:59.563507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:37.726013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46f8a15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e8563e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e856380>]}


============================== 20:26:37.739126 | 396b624b-ce43-4f8e-9cd5-ab4b4ce7763f ==============================
[0m20:26:37.739126 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:26:37.740372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model mrt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:26:40.905912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '396b624b-ce43-4f8e-9cd5-ab4b4ce7763f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd470a32ef0>]}
[0m20:26:41.018615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '396b624b-ce43-4f8e-9cd5-ab4b4ce7763f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46eac1330>]}
[0m20:26:41.019840 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:26:41.251297 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:26:41.889311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 12 files added, 0 files changed.
[0m20:26:41.890379 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/soc_wage_level.sql
[0m20:26:41.891117 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m20:26:41.891681 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/city_approval_rate.sql
[0m20:26:41.892243 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/state_wage_level.sql
[0m20:26:41.892828 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/approval_rate_by_month.sql
[0m20:26:41.893416 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/company_approval_rate.sql
[0m20:26:41.894203 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/company_wage_level.sql
[0m20:26:41.894849 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/major_wage_level.sql
[0m20:26:41.895459 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/state_approval_rate.sql
[0m20:26:41.896027 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/wage_level_by_industry.sql
[0m20:26:41.896696 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m20:26:41.897309 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/industry_approval_rate.sql
[0m20:26:42.271198 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.cs329e_xh.company_approval_rate' (models/mrt/company_approval_rate.sql) depends on a node named 'Single_Registrations' which was not found
[0m20:26:42.272575 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.6579432, "process_in_blocks": "47352", "process_kernel_time": 0.779672, "process_mem_max_rss": "254688", "process_out_blocks": "16", "process_user_time": 5.181876}
[0m20:26:42.273529 [debug] [MainThread]: Command `dbt run` failed at 20:26:42.273342 after 4.66 seconds
[0m20:26:42.274216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46f8a15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4539d3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45374fe50>]}
[0m20:26:42.274892 [debug] [MainThread]: Flushing usage events
[0m20:26:42.453472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:51.600707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd76d09600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd75e96410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd75e963b0>]}


============================== 20:27:51.605924 | d4663181-88d9-4cf4-b98a-1f9119ffa3ad ==============================
[0m20:27:51.605924 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:27:51.607215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model mrt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:27:53.565364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4663181-88d9-4cf4-b98a-1f9119ffa3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd7632ff70>]}
[0m20:27:53.670551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4663181-88d9-4cf4-b98a-1f9119ffa3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd7644b4c0>]}
[0m20:27:53.671776 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:27:53.902569 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:27:54.149447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 19 files added, 0 files changed.
[0m20:27:54.150606 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/industry_approval_rate.sql
[0m20:27:54.151350 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/approval_rate_by_month.sql
[0m20:27:54.151974 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_approval_rate-checkpoint.sql
[0m20:27:54.152628 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/soc_wage_level.sql
[0m20:27:54.153203 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/wage_level_by_industry.sql
[0m20:27:54.153753 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/industry_approval_rate-checkpoint.sql
[0m20:27:54.154333 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m20:27:54.154878 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/state_wage_level.sql
[0m20:27:54.155410 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_approval_rate-checkpoint.sql
[0m20:27:54.155952 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/major_wage_level.sql
[0m20:27:54.156546 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_wage_level-checkpoint.sql
[0m20:27:54.157658 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/wage_level_by_industry-checkpoint.sql
[0m20:27:54.158463 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/city_approval_rate-checkpoint.sql
[0m20:27:54.159081 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_wage_level-checkpoint.sql
[0m20:27:54.159654 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/city_approval_rate.sql
[0m20:27:54.160472 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/company_approval_rate.sql
[0m20:27:54.161358 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/state_approval_rate.sql
[0m20:27:54.161959 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m20:27:54.162527 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/company_wage_level.sql
[0m20:27:54.780195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4663181-88d9-4cf4-b98a-1f9119ffa3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ab75ff0>]}
[0m20:27:54.948340 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:27:54.954081 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:27:55.022465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4663181-88d9-4cf4-b98a-1f9119ffa3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ab76bc0>]}
[0m20:27:55.023490 [info ] [MainThread]: Found 41 models, 1 seed, 9 sources, 492 macros
[0m20:27:55.024299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4663181-88d9-4cf4-b98a-1f9119ffa3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ab76dd0>]}
[0m20:27:55.029124 [info ] [MainThread]: 
[0m20:27:55.030066 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:27:55.030900 [info ] [MainThread]: 
[0m20:27:55.032003 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:27:55.042428 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:27:55.043423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:55.261058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now create_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:27:55.262611 [debug] [ThreadPool]: Creating schema "database: "silken-fortress-448205-p9"
schema: "dbt_cs329e_xh_mrt"
"
[0m20:27:55.279694 [debug] [ThreadPool]: On create_silken-fortress-448205-p9_dbt_cs329e_xh_mrt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "connection_name": "create_silken-fortress-448205-p9_dbt_cs329e_xh_mrt"} */
create schema if not exists `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`
  
[0m20:27:55.280615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:55.621031 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:95141ed1-68e7-4b52-b30e-22906498e8f3&page=queryresults
[0m20:27:56.585042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:27:56.586382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:56.587625 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m20:27:56.590982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:56.745348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m20:27:56.750562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:56.767816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m20:27:56.769541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:56.901766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4663181-88d9-4cf4-b98a-1f9119ffa3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd763de2f0>]}
[0m20:27:56.903271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:56.924687 [debug] [Thread-1 (]: Began running node model.cs329e_xh.approval_rate_by_month
[0m20:27:56.925716 [debug] [Thread-2 (]: Began running node model.cs329e_xh.city_approval_rate
[0m20:27:56.927015 [info ] [Thread-1 (]: 1 of 17 START sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ......... [RUN]
[0m20:27:56.928953 [info ] [Thread-2 (]: 2 of 17 START sql table model dbt_cs329e_xh_mrt.city_approval_rate ............. [RUN]
[0m20:27:56.930329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now model.cs329e_xh.approval_rate_by_month)
[0m20:27:56.931333 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.city_approval_rate)
[0m20:27:56.932272 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.approval_rate_by_month
[0m20:27:56.933275 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.city_approval_rate
[0m20:27:56.953234 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.approval_rate_by_month"
[0m20:27:56.952745 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.city_approval_rate"
[0m20:27:56.961778 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.approval_rate_by_month
[0m20:27:56.968366 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.city_approval_rate
[0m20:27:57.092623 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.approval_rate_by_month"
[0m20:27:57.093556 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.city_approval_rate"
[0m20:27:57.102107 [debug] [Thread-1 (]: On model.cs329e_xh.approval_rate_by_month: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.approval_rate_by_month"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`approval_rate_by_month`
      
    
    

    OPTIONS()
    as (
      WITH monthly_windows AS (
    SELECT 
        EXTRACT (YEAR FROM publication_date) AS year,
        EXTRACT(MONTH FROM publication_date) AS month,
        MAX(publication_date) AS latest_date
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
    GROUP BY year, month
),
approval_rate_monthly AS (

    SELECT 
        EXTRACT(YEAR FROM decision_date) AS year,
        EXTRACT(MONTH FROM decision_date) AS month,
        COUNT(CASE WHEN case_status = 'Certified' THEN 1 END) AS approved_count,
        COUNT(CASE WHEN case_status != 'Certified' THEN 1 END) AS denied_count,
        COUNT(*) AS total_applications
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    WHERE decision_date IS NOT NULL
    GROUP BY year, month
)
SELECT 
    a.month,
    m.latest_date,
    a.approved_count,
    a.denied_count,
    a.total_applications,
    ROUND(100.0 * a.approved_count / a.total_applications, 2) AS approval_rate
FROM approval_rate_monthly a
LEFT JOIN monthly_windows m
    ON a.month = m.month
ORDER BY a.month;
    );
  
[0m20:27:57.104494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:57.108140 [debug] [Thread-2 (]: On model.cs329e_xh.city_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.city_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`city_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_city AS city,
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_city, lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m20:27:57.110054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:27:57.231500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:44b784f7-5530-4121-949c-64cbe7ddee00&page=queryresults
[0m20:27:57.232665 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:44b784f7-5530-4121-949c-64cbe7ddee00&page=queryresults
[0m20:27:57.299390 [debug] [Thread-1 (]: Database Error in model approval_rate_by_month (models/mrt/approval_rate_by_month.sql)
  Syntax error: Expected ")" but got ";" at [43:17]
  compiled code at target/run/cs329e_xh/models/mrt/approval_rate_by_month.sql
[0m20:27:57.306285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4663181-88d9-4cf4-b98a-1f9119ffa3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd76fd57b0>]}
[0m20:27:57.307726 [error] [Thread-1 (]: 1 of 17 ERROR creating sql table model dbt_cs329e_xh_mrt.approval_rate_by_month  [[31mERROR[0m in 0.37s]
[0m20:27:57.309532 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.approval_rate_by_month
[0m20:27:57.310441 [debug] [Thread-1 (]: Began running node model.cs329e_xh.city_approval_rate-checkpoint
[0m20:27:57.311478 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.approval_rate_by_month' to be skipped because of status 'error'.  Reason: Database Error in model approval_rate_by_month (models/mrt/approval_rate_by_month.sql)
  Syntax error: Expected ")" but got ";" at [43:17]
  compiled code at target/run/cs329e_xh/models/mrt/approval_rate_by_month.sql.
[0m20:27:57.313218 [info ] [Thread-1 (]: 3 of 17 START sql table model dbt_cs329e_xh_mrt.city_approval_rate-checkpoint .. [RUN]
[0m20:27:57.315737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.approval_rate_by_month, now model.cs329e_xh.city_approval_rate-checkpoint)
[0m20:27:57.316675 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.city_approval_rate-checkpoint
[0m20:27:57.323398 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.city_approval_rate-checkpoint"
[0m20:27:57.324663 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.city_approval_rate-checkpoint
[0m20:27:57.331485 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.city_approval_rate-checkpoint"
[0m20:27:57.333001 [debug] [Thread-1 (]: On model.cs329e_xh.city_approval_rate-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.city_approval_rate-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`city_approval_rate-checkpoint`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_city AS city,
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_city, lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m20:27:57.333959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:57.648470 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:59081921-8dd7-4e25-8448-83755f8e2c26&page=queryresults
[0m20:27:57.848545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:33cd49b5-8d0c-454d-af69-1fb73a0c9d0f&page=queryresults
[0m20:28:00.515837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4663181-88d9-4cf4-b98a-1f9119ffa3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd76371e10>]}
[0m20:28:00.517334 [info ] [Thread-2 (]: 2 of 17 OK created sql table model dbt_cs329e_xh_mrt.city_approval_rate ........ [[32mCREATE TABLE (20.1k rows, 50.1 MiB processed)[0m in 3.58s]
[0m20:28:00.519334 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.city_approval_rate
[0m20:28:00.520757 [debug] [Thread-2 (]: Began running node model.cs329e_xh.company_approval_rate
[0m20:28:00.522846 [info ] [Thread-2 (]: 4 of 17 START sql table model dbt_cs329e_xh_mrt.company_approval_rate .......... [RUN]
[0m20:28:00.524480 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.city_approval_rate, now model.cs329e_xh.company_approval_rate)
[0m20:28:00.525389 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.company_approval_rate
[0m20:28:00.531422 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.company_approval_rate"
[0m20:28:00.532659 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.company_approval_rate
[0m20:28:00.538758 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.company_approval_rate"
[0m20:28:00.540226 [debug] [Thread-2 (]: On model.cs329e_xh.company_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`company_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
    COALESCE(sr.employer_name, cd.employer_name, ed.employer_petitioner_name) AS employer_name,
    COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) AS total_approved,
    COUNT(CASE WHEN sr.first_decision = 'Denied' THEN 1 END) AS total_denied,
    COUNT(*) AS total_applications,
    ROUND(
        (COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) * 100.0) / 
        NULLIF(COUNT(*), 0), 2
    ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration` sr
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed 
    ON sr.employer_name = ed.employer_petitioner_name
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd 
    ON sr.employer_name = cd.employer_name
GROUP BY employer_name
ORDER BY approval_rate DESC
    );
  
[0m20:28:00.541161 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:28:01.048288 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3e81e23f-10e8-41d4-8392-ca81f556f368&page=queryresults
[0m20:28:01.151443 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:28:01.846555 [error] [MainThread]: CANCEL query model.cs329e_xh.city_approval_rate-checkpoint ..................... [[31mCANCEL[0m]
[0m20:28:01.848668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4663181-88d9-4cf4-b98a-1f9119ffa3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5864a9e0>]}
[0m20:28:01.849986 [error] [MainThread]: CANCEL query model.cs329e_xh.company_approval_rate ............................. [[31mCANCEL[0m]
[0m20:28:01.853324 [info ] [Thread-1 (]: 3 of 17 OK created sql table model dbt_cs329e_xh_mrt.city_approval_rate-checkpoint  [[32mCREATE TABLE (20.1k rows, 50.1 MiB processed)[0m in 4.53s]
[0m20:28:01.854448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:01.856037 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.city_approval_rate-checkpoint
[0m20:28:02.521428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:02.522773 [debug] [MainThread]: Connection 'model.cs329e_xh.city_approval_rate-checkpoint' was properly closed.
[0m20:28:02.523447 [debug] [MainThread]: Connection 'model.cs329e_xh.company_approval_rate' was properly closed.
[0m20:28:02.524240 [info ] [MainThread]: 
[0m20:28:02.525451 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m20:28:02.526603 [error] [MainThread]: Encountered an error:

[0m20:28:02.564950 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/opt/conda/lib/python3.10/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 445, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 404, in _cancel_connections
    pool.join()
  File "/opt/conda/lib/python3.10/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/opt/conda/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m20:28:02.566912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.070347, "process_in_blocks": "3672", "process_kernel_time": 0.603395, "process_mem_max_rss": "269220", "process_out_blocks": "2744", "process_user_time": 5.891486}
[0m20:28:02.567823 [debug] [MainThread]: Command `dbt run` failed at 20:28:02.567622 after 11.07 seconds
[0m20:28:02.568565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd76d09600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ab74bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd597d45b0>]}
[0m20:28:02.569321 [debug] [MainThread]: Flushing usage events
[0m20:28:02.735555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:25.726391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61eaed600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61daa2440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61daa23e0>]}


============================== 20:28:25.730494 | 5c9dbebc-fd13-4756-9735-4924140ebb60 ==============================
[0m20:28:25.730494 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:28:25.732058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --model mrt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:28:27.818424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e0d71c0>]}
[0m20:28:27.914643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e2d0a30>]}
[0m20:28:27.916793 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:28:28.112531 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:28:28.329642 [debug] [MainThread]: Partial parsing enabled: 7 files deleted, 0 files added, 0 files changed.
[0m20:28:28.330776 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/city_approval_rate-checkpoint.sql
[0m20:28:28.331417 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/wage_level_by_industry-checkpoint.sql
[0m20:28:28.331968 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_approval_rate-checkpoint.sql
[0m20:28:28.332513 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_wage_level-checkpoint.sql
[0m20:28:28.333020 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/industry_approval_rate-checkpoint.sql
[0m20:28:28.333492 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_wage_level-checkpoint.sql
[0m20:28:28.333979 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_approval_rate-checkpoint.sql
[0m20:28:28.495766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa602a30130>]}
[0m20:28:28.650452 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:28:28.653222 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:28:28.678107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6029db880>]}
[0m20:28:28.679184 [info ] [MainThread]: Found 34 models, 1 seed, 9 sources, 492 macros
[0m20:28:28.679910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6029db850>]}
[0m20:28:28.684034 [info ] [MainThread]: 
[0m20:28:28.685419 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:28:28.686233 [info ] [MainThread]: 
[0m20:28:28.687422 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:28:28.695956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:28:28.697067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:28.906598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m20:28:28.908247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m20:28:28.909084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:28.910149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:29.027489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:28:29.028805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:29.050355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m20:28:29.055186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:29.210663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62003cf70>]}
[0m20:28:29.211751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:29.216470 [debug] [Thread-1 (]: Began running node model.cs329e_xh.approval_rate_by_month
[0m20:28:29.217406 [debug] [Thread-2 (]: Began running node model.cs329e_xh.city_approval_rate
[0m20:28:29.218535 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ......... [RUN]
[0m20:28:29.220092 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_cs329e_xh_mrt.city_approval_rate ............. [RUN]
[0m20:28:29.221595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now model.cs329e_xh.approval_rate_by_month)
[0m20:28:29.223305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.city_approval_rate)
[0m20:28:29.224301 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.approval_rate_by_month
[0m20:28:29.225254 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.city_approval_rate
[0m20:28:29.243552 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.approval_rate_by_month"
[0m20:28:29.250084 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.city_approval_rate"
[0m20:28:29.251881 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.approval_rate_by_month
[0m20:28:29.252875 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.city_approval_rate
[0m20:28:29.300491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:28:29.348836 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.approval_rate_by_month"
[0m20:28:29.350405 [debug] [Thread-1 (]: On model.cs329e_xh.approval_rate_by_month: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.approval_rate_by_month"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`approval_rate_by_month`
      
    
    

    OPTIONS()
    as (
      WITH monthly_windows AS (
    SELECT 
        EXTRACT (YEAR FROM publication_date) AS year,
        EXTRACT(MONTH FROM publication_date) AS month,
        MAX(publication_date) AS latest_date
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
    GROUP BY year, month
),
approval_rate_monthly AS (

    SELECT 
        EXTRACT(YEAR FROM decision_date) AS year,
        EXTRACT(MONTH FROM decision_date) AS month,
        COUNT(CASE WHEN case_status = 'Certified' THEN 1 END) AS approved_count,
        COUNT(CASE WHEN case_status != 'Certified' THEN 1 END) AS denied_count,
        COUNT(*) AS total_applications
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    WHERE decision_date IS NOT NULL
    GROUP BY year, month
)
SELECT 
    a.month,
    m.latest_date,
    a.approved_count,
    a.denied_count,
    a.total_applications,
    ROUND(100.0 * a.approved_count / a.total_applications, 2) AS approval_rate
FROM approval_rate_monthly a
LEFT JOIN monthly_windows m
    ON a.month = m.month
ORDER BY a.month;
    );
  
[0m20:28:29.351445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:29.462649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ea104afd-e1de-4861-9543-d52f0dfabb28&page=queryresults
[0m20:28:29.463875 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ea104afd-e1de-4861-9543-d52f0dfabb28&page=queryresults
[0m20:28:29.468565 [debug] [Thread-1 (]: Database Error in model approval_rate_by_month (models/mrt/approval_rate_by_month.sql)
  Syntax error: Expected ")" but got ";" at [43:17]
  compiled code at target/run/cs329e_xh/models/mrt/approval_rate_by_month.sql
[0m20:28:29.471550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61edb97b0>]}
[0m20:28:29.472950 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model dbt_cs329e_xh_mrt.approval_rate_by_month  [[31mERROR[0m in 0.25s]
[0m20:28:29.474071 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.approval_rate_by_month
[0m20:28:29.474862 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_approval_rate
[0m20:28:29.475852 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.approval_rate_by_month' to be skipped because of status 'error'.  Reason: Database Error in model approval_rate_by_month (models/mrt/approval_rate_by_month.sql)
  Syntax error: Expected ")" but got ";" at [43:17]
  compiled code at target/run/cs329e_xh/models/mrt/approval_rate_by_month.sql.
[0m20:28:29.476979 [info ] [Thread-1 (]: 3 of 10 START sql table model dbt_cs329e_xh_mrt.company_approval_rate .......... [RUN]
[0m20:28:29.479407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.approval_rate_by_month, now model.cs329e_xh.company_approval_rate)
[0m20:28:29.480344 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_approval_rate
[0m20:28:29.486309 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_approval_rate"
[0m20:28:29.487628 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_approval_rate
[0m20:28:29.492923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:29.552378 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.city_approval_rate"
[0m20:28:29.553772 [debug] [Thread-2 (]: On model.cs329e_xh.city_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.city_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`city_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_city AS city,
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_city, lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m20:28:29.660950 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_approval_rate"
[0m20:28:29.662221 [debug] [Thread-1 (]: On model.cs329e_xh.company_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`company_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
    COALESCE(sr.employer_name, cd.employer_name, ed.employer_petitioner_name) AS employer_name,
    COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) AS total_approved,
    COUNT(CASE WHEN sr.first_decision = 'Denied' THEN 1 END) AS total_denied,
    COUNT(*) AS total_applications,
    ROUND(
        (COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) * 100.0) / 
        NULLIF(COUNT(*), 0), 2
    ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration` sr
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed 
    ON sr.employer_name = ed.employer_petitioner_name
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd 
    ON sr.employer_name = cd.employer_name
GROUP BY employer_name
ORDER BY approval_rate DESC
    );
  
[0m20:28:29.890469 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:56277376-bccd-4823-81f9-00f1c95d162e&page=queryresults
[0m20:28:30.090212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4014f5bb-9a0d-4183-97a4-99ceed5412b0&page=queryresults
[0m20:28:32.484867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e175ab0>]}
[0m20:28:32.486496 [info ] [Thread-1 (]: 3 of 10 OK created sql table model dbt_cs329e_xh_mrt.company_approval_rate ..... [[32mCREATE TABLE (45.3k rows, 6.7 MiB processed)[0m in 3.01s]
[0m20:28:32.488182 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_approval_rate
[0m20:28:32.489131 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_wage_level
[0m20:28:32.490403 [info ] [Thread-1 (]: 4 of 10 START sql table model dbt_cs329e_xh_mrt.company_wage_level ............. [RUN]
[0m20:28:32.491882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_approval_rate, now model.cs329e_xh.company_wage_level)
[0m20:28:32.492825 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_wage_level
[0m20:28:32.499248 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_wage_level"
[0m20:28:32.500351 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_wage_level
[0m20:28:32.505625 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_wage_level"
[0m20:28:32.507103 [debug] [Thread-1 (]: On model.cs329e_xh.company_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`company_wage_level`
      
    
    

    OPTIONS()
    as (
      SELECT 
    COALESCE(ws.company_name, cd.employer_name, ed.employer_petitioner_name) AS employer_name,
    ROUND(AVG(ws.min_wage), 2) AS min_wage,
    ROUND(AVG(ws.max_wage), 2) AS max_wage,
    ROUND(AVG(ws.average_wage), 2) AS average_wage
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary` ws
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed 
    ON ws.company_name = ed.employer_petitioner_name
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd 
    ON ws.company_name = cd.employer_name
GROUP BY employer_name
ORDER BY average_wage DESC
    );
  
[0m20:28:32.508026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:32.565800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa602a3f940>]}
[0m20:28:32.567180 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_cs329e_xh_mrt.city_approval_rate ........ [[32mCREATE TABLE (20.1k rows, 50.1 MiB processed)[0m in 3.34s]
[0m20:28:32.568658 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.city_approval_rate
[0m20:28:32.569537 [debug] [Thread-2 (]: Began running node model.cs329e_xh.industry_approval_rate
[0m20:28:32.570671 [info ] [Thread-2 (]: 5 of 10 START sql table model dbt_cs329e_xh_mrt.industry_approval_rate ......... [RUN]
[0m20:28:32.571819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.city_approval_rate, now model.cs329e_xh.industry_approval_rate)
[0m20:28:32.572620 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.industry_approval_rate
[0m20:28:32.578783 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.industry_approval_rate"
[0m20:28:32.579776 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.industry_approval_rate
[0m20:28:32.584424 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.industry_approval_rate"
[0m20:28:32.585870 [debug] [Thread-2 (]: On model.cs329e_xh.industry_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.industry_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`industry_approval_rate`
      
    
    

    OPTIONS()
    as (
      WITH industry_data AS (
  SELECT
    sr.employer_name,
    -- Assign NAICS code: First use Employer_Detail, then fallback to SR
    COALESCE(SUBSTR(ed.naics_code, 1, 2), SUBSTR(sr.naics_code, 1, 2)) AS naics_code,
    CASE 
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '11' THEN '11 - Agriculture, Forestry, Fishing and Hunting'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '21' THEN '21 - Mining'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '22' THEN '22 - Utilities'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '23' THEN '23 - Construction'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) BETWEEN '31' AND '33' THEN '31-33 - Manufacturing'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '42' THEN '42 - Wholesale Trade'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) BETWEEN '44' AND '45' THEN '44-45 - Retail Trade'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) BETWEEN '48' AND '49' THEN '48-49 - Transportation and Warehousing'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '51' THEN '51 - Information'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '52' THEN '52 - Finance and Insurance'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '53' THEN '53 - Real Estate Rental and Leasing'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '54' THEN '54 - Professional, Scientific, and Technical Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '55' THEN '55 - Management of Companies and Enterprises'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '56' THEN '56 - Administrative and Support Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '61' THEN '61 - Educational Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '62' THEN '62 - Health Care and Social Assistance'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '71' THEN '71 - Arts, Entertainment, and Recreation'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '72' THEN '72 - Accommodation and Food Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '81' THEN '81 - Other Services (except Public Administration)'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '92' THEN '92 - Public Administration'
      ELSE 'Unclassified' 
    END AS industry,
    COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) AS approved,
    COUNT(CASE WHEN sr.first_decision = 'Denied' THEN 1 END) AS denied,
    COUNT(*) AS total
  FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration` sr
  LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed
    ON sr.employer_name = ed.employer_petitioner_name
  LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd
    ON sr.employer_name = cd.employer_name
  GROUP BY sr.employer_name, naics_code, industry
)
SELECT 
  industry,
  SUM(approved) AS total_approved,
  SUM(denied) AS total_denied,
  SUM(total) AS total_applications,
  ROUND(SUM(approved) / SUM(total) * 100, 2) AS approval_rate
FROM industry_data
GROUP BY industry
ORDER BY approval_rate DESC
    );
  
[0m20:28:32.586824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:28:33.038420 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a6ec7202-dfba-4ce9-a6f0-bb0a8c68c407&page=queryresults
[0m20:28:33.059906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a7ff18aa-a5f5-4dbf-8e2b-ed36302de862&page=queryresults
[0m20:28:35.173670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa602a836a0>]}
[0m20:28:35.175653 [info ] [Thread-1 (]: 4 of 10 OK created sql table model dbt_cs329e_xh_mrt.company_wage_level ........ [[32mCREATE TABLE (4.1k rows, 1.7 MiB processed)[0m in 2.68s]
[0m20:28:35.178032 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_wage_level
[0m20:28:35.178997 [debug] [Thread-1 (]: Began running node model.cs329e_xh.major_wage_level
[0m20:28:35.180507 [info ] [Thread-1 (]: 6 of 10 START sql table model dbt_cs329e_xh_mrt.major_wage_level ............... [RUN]
[0m20:28:35.181677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_wage_level, now model.cs329e_xh.major_wage_level)
[0m20:28:35.182473 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.major_wage_level
[0m20:28:35.188282 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.major_wage_level"
[0m20:28:35.189382 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.major_wage_level
[0m20:28:35.197895 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.major_wage_level"
[0m20:28:35.199116 [debug] [Thread-1 (]: On model.cs329e_xh.major_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.major_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`major_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH salary_by_field AS (
    SELECT 
        a.appx_a_field_of_study AS field_of_study,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE a.appx_a_field_of_study IS NOT NULL
)

SELECT 
    field_of_study,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM salary_by_field
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY field_of_study, wage_unit_of_pay
ORDER BY field_of_study, wage_unit_of_pay
    );
  
[0m20:28:35.200063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:35.454595 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5eba44670>]}
[0m20:28:35.456167 [info ] [Thread-2 (]: 5 of 10 OK created sql table model dbt_cs329e_xh_mrt.industry_approval_rate .... [[32mCREATE TABLE (21.0 rows, 8.3 MiB processed)[0m in 2.88s]
[0m20:28:35.458041 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.industry_approval_rate
[0m20:28:35.459473 [debug] [Thread-2 (]: Began running node model.cs329e_xh.soc_wage_level
[0m20:28:35.461119 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_cs329e_xh_mrt.soc_wage_level ................. [RUN]
[0m20:28:35.462637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.industry_approval_rate, now model.cs329e_xh.soc_wage_level)
[0m20:28:35.463637 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.soc_wage_level
[0m20:28:35.469535 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.soc_wage_level"
[0m20:28:35.470678 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.soc_wage_level
[0m20:28:35.478020 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.soc_wage_level"
[0m20:28:35.479296 [debug] [Thread-2 (]: On model.cs329e_xh.soc_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.soc_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`soc_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH job_salary AS (
    SELECT 
        l.soc_code,
        l.soc_title,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE l.soc_code IS NOT NULL AND l.soc_title IS NOT NULL
)

SELECT 
    soc_code,
    soc_title,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM job_salary
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY soc_code, soc_title, wage_unit_of_pay
ORDER BY avg_wage_from DESC
    );
  
[0m20:28:35.480499 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:28:35.637190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9096e0a1-e535-417a-aab6-c174d1ff2b22&page=queryresults
[0m20:28:35.959622 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e4ee7564-a847-4101-985a-3555fd22ac53&page=queryresults
[0m20:28:37.664023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa602a836a0>]}
[0m20:28:37.665382 [info ] [Thread-1 (]: 6 of 10 OK created sql table model dbt_cs329e_xh_mrt.major_wage_level .......... [[32mCREATE TABLE (87.0 rows, 19.6 MiB processed)[0m in 2.48s]
[0m20:28:37.666574 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.major_wage_level
[0m20:28:37.667378 [debug] [Thread-1 (]: Began running node model.cs329e_xh.state_approval_rate
[0m20:28:37.668467 [info ] [Thread-1 (]: 8 of 10 START sql table model dbt_cs329e_xh_mrt.state_approval_rate ............ [RUN]
[0m20:28:37.669351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.major_wage_level, now model.cs329e_xh.state_approval_rate)
[0m20:28:37.670267 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.state_approval_rate
[0m20:28:37.675787 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.state_approval_rate"
[0m20:28:37.676839 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.state_approval_rate
[0m20:28:37.681649 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.state_approval_rate"
[0m20:28:37.682770 [debug] [Thread-1 (]: On model.cs329e_xh.state_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m20:28:37.683575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:38.059258 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5eba44a30>]}
[0m20:28:38.060562 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_cs329e_xh_mrt.soc_wage_level ............ [[32mCREATE TABLE (55.0 rows, 41.3 MiB processed)[0m in 2.60s]
[0m20:28:38.061771 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.soc_wage_level
[0m20:28:38.062574 [debug] [Thread-2 (]: Began running node model.cs329e_xh.state_wage_level
[0m20:28:38.063669 [info ] [Thread-2 (]: 9 of 10 START sql table model dbt_cs329e_xh_mrt.state_wage_level ............... [RUN]
[0m20:28:38.064768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.soc_wage_level, now model.cs329e_xh.state_wage_level)
[0m20:28:38.065453 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.state_wage_level
[0m20:28:38.070955 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.state_wage_level"
[0m20:28:38.072008 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.state_wage_level
[0m20:28:38.078651 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.state_wage_level"
[0m20:28:38.079802 [debug] [Thread-2 (]: On model.cs329e_xh.state_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_wage_level`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  ROUND(AVG(ld.prevailing_wage), 2) AS avg_wage,
  ROUND(MAX(ld.prevailing_wage), 2) AS max_wage,
  ROUND(MIN(ld.prevailing_wage), 2) AS min_wage,
  COUNT(ld.case_number) AS total_cases
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
WHERE ld.prevailing_wage IS NOT NULL
AND LOWER(ld.pw_unit_of_pay) != 'hour'  -- Exclude hourly wage records
GROUP BY lw.worksite_state
ORDER BY avg_wage DESC
    );
  
[0m20:28:38.080644 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:28:38.134742 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:14dcaf15-fe66-4abf-ac97-e8d19fb44e24&page=queryresults
[0m20:28:38.545632 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:dce95ef4-71c2-43d4-8065-400254d0ada9&page=queryresults
[0m20:28:41.062511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e175ab0>]}
[0m20:28:41.063771 [info ] [Thread-1 (]: 8 of 10 OK created sql table model dbt_cs329e_xh_mrt.state_approval_rate ....... [[32mCREATE TABLE (55.0 rows, 41.5 MiB processed)[0m in 3.39s]
[0m20:28:41.065024 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.state_approval_rate
[0m20:28:41.065829 [debug] [Thread-1 (]: Began running node model.cs329e_xh.wage_level_by_industry
[0m20:28:41.066903 [info ] [Thread-1 (]: 10 of 10 START sql table model dbt_cs329e_xh_mrt.wage_level_by_industry ........ [RUN]
[0m20:28:41.068005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_approval_rate, now model.cs329e_xh.wage_level_by_industry)
[0m20:28:41.068721 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.wage_level_by_industry
[0m20:28:41.074476 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.wage_level_by_industry"
[0m20:28:41.075490 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.wage_level_by_industry
[0m20:28:41.080255 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.wage_level_by_industry"
[0m20:28:41.081547 [debug] [Thread-1 (]: On model.cs329e_xh.wage_level_by_industry: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_level_by_industry"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`wage_level_by_industry`
      
    
    

    OPTIONS()
    as (
      WITH industry_wages AS (
  SELECT
    CASE 
      WHEN SUBSTR(ed.naics_code, 1, 2) = '11' THEN '11 - Agriculture, Forestry, Fishing and Hunting'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '21' THEN '21 - Mining'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '22' THEN '22 - Utilities'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '23' THEN '23 - Construction'
      WHEN SUBSTR(ed.naics_code, 1, 2) BETWEEN '31' AND '33' THEN '31-33 - Manufacturing'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '42' THEN '42 - Wholesale Trade'
      WHEN SUBSTR(ed.naics_code, 1, 2) BETWEEN '44' AND '45' THEN '44-45 - Retail Trade'
      WHEN SUBSTR(ed.naics_code, 1, 2) BETWEEN '48' AND '49' THEN '48-49 - Transportation and Warehousing'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '51' THEN '51 - Information'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '52' THEN '52 - Finance and Insurance'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '53' THEN '53 - Real Estate Rental and Leasing'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '54' THEN '54 - Professional, Scientific, and Technical Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '55' THEN '55 - Management of Companies and Enterprises'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '56' THEN '56 - Administrative and Support Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '61' THEN '61 - Educational Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '62' THEN '62 - Health Care and Social Assistance'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '71' THEN '71 - Arts, Entertainment, and Recreation'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '72' THEN '72 - Accommodation and Food Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '81' THEN '81 - Other Services (except Public Administration)'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '92' THEN '92 - Public Administration'
      ELSE 'Unclassified'
    END AS industry,
    ROUND(AVG(ws.average_wage), 2) AS avg_wage,
    ROUND(MIN(ws.min_wage), 2) AS min_wage,
    ROUND(MAX(ws.max_wage), 2) AS max_wage
  FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary` ws
  LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed
    ON ws.company_name = ed.employer_petitioner_name
  WHERE ws.average_wage IS NOT NULL
  GROUP BY industry
)
SELECT
  industry,
  avg_wage,
  min_wage,
  max_wage
FROM industry_wages
ORDER BY avg_wage DESC
    );
  
[0m20:28:41.082413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:41.453048 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:034a4984-ee60-4819-8591-f48351565f3d&page=queryresults
[0m20:28:41.514657 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa602a6c5b0>]}
[0m20:28:41.518537 [info ] [Thread-2 (]: 9 of 10 OK created sql table model dbt_cs329e_xh_mrt.state_wage_level .......... [[32mCREATE TABLE (55.0 rows, 42.8 MiB processed)[0m in 3.45s]
[0m20:28:41.521014 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.state_wage_level
[0m20:28:48.815830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9dbebc-fd13-4756-9735-4924140ebb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5eba86c50>]}
[0m20:28:48.817176 [info ] [Thread-1 (]: 10 of 10 OK created sql table model dbt_cs329e_xh_mrt.wage_level_by_industry ... [[32mCREATE TABLE (21.0 rows, 2.7 MiB processed)[0m in 7.75s]
[0m20:28:48.818543 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.wage_level_by_industry
[0m20:28:48.820900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:48.822229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:48.822871 [debug] [MainThread]: Connection 'model.cs329e_xh.wage_level_by_industry' was properly closed.
[0m20:28:48.823432 [debug] [MainThread]: Connection 'model.cs329e_xh.state_wage_level' was properly closed.
[0m20:28:48.824163 [info ] [MainThread]: 
[0m20:28:48.825105 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 20.14 seconds (20.14s).
[0m20:28:48.828281 [debug] [MainThread]: Command end result
[0m20:28:48.874137 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:28:48.876793 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:28:48.887658 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:28:48.888375 [info ] [MainThread]: 
[0m20:28:48.889199 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:28:48.890047 [info ] [MainThread]: 
[0m20:28:48.890834 [error] [MainThread]:   Database Error in model approval_rate_by_month (models/mrt/approval_rate_by_month.sql)
  Syntax error: Expected ")" but got ";" at [43:17]
  compiled code at target/run/cs329e_xh/models/mrt/approval_rate_by_month.sql
[0m20:28:48.891453 [info ] [MainThread]: 
[0m20:28:48.892129 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m20:28:48.893450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 23.25364, "process_in_blocks": "0", "process_kernel_time": 0.601693, "process_mem_max_rss": "264552", "process_out_blocks": "3984", "process_user_time": 6.120215}
[0m20:28:48.894180 [debug] [MainThread]: Command `dbt run` failed at 20:28:48.894028 after 23.25 seconds
[0m20:28:48.894822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61eaed600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60299f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e995090>]}
[0m20:28:48.895513 [debug] [MainThread]: Flushing usage events
[0m20:28:49.087029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:06.607604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48ff9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b47fb2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b47fb2410>]}


============================== 20:29:06.612817 | 7faf83d1-905c-42d1-bce7-b2604bf34778 ==============================
[0m20:29:06.612817 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:29:06.614965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --model mrt', 'send_anonymous_usage_stats': 'True'}
[0m20:29:08.507198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b485df190>]}
[0m20:29:08.603187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b486f2ce0>]}
[0m20:29:08.604319 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:29:08.792453 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:29:08.996207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:29:08.997504 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/approval_rate_by_month-checkpoint.sql
[0m20:29:08.998257 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/mrt/approval_rate_by_month.sql
[0m20:29:09.450211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2ce88130>]}
[0m20:29:09.613162 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:29:09.615854 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:29:09.636032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2ce92bf0>]}
[0m20:29:09.637062 [info ] [MainThread]: Found 35 models, 1 seed, 9 sources, 492 macros
[0m20:29:09.637827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2ce905e0>]}
[0m20:29:09.641286 [info ] [MainThread]: 
[0m20:29:09.641998 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:29:09.642605 [info ] [MainThread]: 
[0m20:29:09.643548 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:29:09.652165 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:29:09.653232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:09.902332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m20:29:09.903751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m20:29:09.904489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:09.905386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:10.041773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m20:29:10.047081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:10.096627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:29:10.099762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:10.247894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4857df30>]}
[0m20:29:10.248921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:10.253797 [debug] [Thread-1 (]: Began running node model.cs329e_xh.approval_rate_by_month
[0m20:29:10.254784 [debug] [Thread-2 (]: Began running node model.cs329e_xh.approval_rate_by_month-checkpoint
[0m20:29:10.255949 [info ] [Thread-1 (]: 1 of 11 START sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ......... [RUN]
[0m20:29:10.257566 [info ] [Thread-2 (]: 2 of 11 START sql table model dbt_cs329e_xh_mrt.approval_rate_by_month-checkpoint  [RUN]
[0m20:29:10.258915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now model.cs329e_xh.approval_rate_by_month)
[0m20:29:10.260023 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now model.cs329e_xh.approval_rate_by_month-checkpoint)
[0m20:29:10.261158 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.approval_rate_by_month
[0m20:29:10.261998 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.approval_rate_by_month-checkpoint
[0m20:29:10.280969 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.approval_rate_by_month"
[0m20:29:10.278295 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.approval_rate_by_month-checkpoint"
[0m20:29:10.283399 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.approval_rate_by_month-checkpoint
[0m20:29:10.294732 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.approval_rate_by_month
[0m20:29:10.390137 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.approval_rate_by_month"
[0m20:29:10.386998 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.approval_rate_by_month-checkpoint"
[0m20:29:10.391898 [debug] [Thread-2 (]: On model.cs329e_xh.approval_rate_by_month-checkpoint: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.approval_rate_by_month-checkpoint"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`approval_rate_by_month-checkpoint`
      
    
    

    OPTIONS()
    as (
      WITH monthly_windows AS (
    SELECT 
        EXTRACT (YEAR FROM publication_date) AS year,
        EXTRACT(MONTH FROM publication_date) AS month,
        MAX(publication_date) AS latest_date
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
    GROUP BY year, month
),
approval_rate_monthly AS (

    SELECT 
        EXTRACT(YEAR FROM decision_date) AS year,
        EXTRACT(MONTH FROM decision_date) AS month,
        COUNT(CASE WHEN case_status = 'Certified' THEN 1 END) AS approved_count,
        COUNT(CASE WHEN case_status != 'Certified' THEN 1 END) AS denied_count,
        COUNT(*) AS total_applications
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    WHERE decision_date IS NOT NULL
    GROUP BY year, month
)
SELECT 
    a.month,
    m.latest_date,
    a.approved_count,
    a.denied_count,
    a.total_applications,
    ROUND(100.0 * a.approved_count / a.total_applications, 2) AS approval_rate
FROM approval_rate_monthly a
LEFT JOIN monthly_windows m
    ON a.month = m.month
ORDER BY a.month
    );
  
[0m20:29:10.392849 [debug] [Thread-1 (]: On model.cs329e_xh.approval_rate_by_month: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.approval_rate_by_month"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`approval_rate_by_month`
      
    
    

    OPTIONS()
    as (
      WITH monthly_windows AS (
    SELECT 
        EXTRACT (YEAR FROM publication_date) AS year,
        EXTRACT(MONTH FROM publication_date) AS month,
        MAX(publication_date) AS latest_date
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
    GROUP BY year, month
),
approval_rate_monthly AS (

    SELECT 
        EXTRACT(YEAR FROM decision_date) AS year,
        EXTRACT(MONTH FROM decision_date) AS month,
        COUNT(CASE WHEN case_status = 'Certified' THEN 1 END) AS approved_count,
        COUNT(CASE WHEN case_status != 'Certified' THEN 1 END) AS denied_count,
        COUNT(*) AS total_applications
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    WHERE decision_date IS NOT NULL
    GROUP BY year, month
)
SELECT 
    a.month,
    m.latest_date,
    a.approved_count,
    a.denied_count,
    a.total_applications,
    ROUND(100.0 * a.approved_count / a.total_applications, 2) AS approval_rate
FROM approval_rate_monthly a
LEFT JOIN monthly_windows m
    ON a.month = m.month
ORDER BY a.month
    );
  
[0m20:29:10.393772 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:10.394577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:10.763334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7757d7bd-afa8-45d1-a54c-d511376c3710&page=queryresults
[0m20:29:10.798299 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:56da170a-f8c9-40ad-90fe-c595869d1090&page=queryresults
[0m20:29:13.125700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48685a50>]}
[0m20:29:13.127062 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dbt_cs329e_xh_mrt.approval_rate_by_month .... [[32mCREATE TABLE (12.0 rows, 10.5 MiB processed)[0m in 2.86s]
[0m20:29:13.128498 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.approval_rate_by_month
[0m20:29:13.129616 [debug] [Thread-1 (]: Began running node model.cs329e_xh.city_approval_rate
[0m20:29:13.131229 [info ] [Thread-1 (]: 3 of 11 START sql table model dbt_cs329e_xh_mrt.city_approval_rate ............. [RUN]
[0m20:29:13.132433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.approval_rate_by_month, now model.cs329e_xh.city_approval_rate)
[0m20:29:13.133621 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.city_approval_rate
[0m20:29:13.140037 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.city_approval_rate"
[0m20:29:13.141810 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.city_approval_rate
[0m20:29:13.147456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:13.164879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2c62d390>]}
[0m20:29:13.166192 [info ] [Thread-2 (]: 2 of 11 OK created sql table model dbt_cs329e_xh_mrt.approval_rate_by_month-checkpoint  [[32mCREATE TABLE (12.0 rows, 10.5 MiB processed)[0m in 2.90s]
[0m20:29:13.167659 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.approval_rate_by_month-checkpoint
[0m20:29:13.168661 [debug] [Thread-2 (]: Began running node model.cs329e_xh.company_approval_rate
[0m20:29:13.169917 [info ] [Thread-2 (]: 4 of 11 START sql table model dbt_cs329e_xh_mrt.company_approval_rate .......... [RUN]
[0m20:29:13.171125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.approval_rate_by_month-checkpoint, now model.cs329e_xh.company_approval_rate)
[0m20:29:13.171834 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.company_approval_rate
[0m20:29:13.177870 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.company_approval_rate"
[0m20:29:13.179071 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.company_approval_rate
[0m20:29:13.186150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:13.282938 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.city_approval_rate"
[0m20:29:13.284187 [debug] [Thread-1 (]: On model.cs329e_xh.city_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.city_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`city_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_city AS city,
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_city, lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m20:29:13.326837 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.company_approval_rate"
[0m20:29:13.328057 [debug] [Thread-2 (]: On model.cs329e_xh.company_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`company_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
    COALESCE(sr.employer_name, cd.employer_name, ed.employer_petitioner_name) AS employer_name,
    COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) AS total_approved,
    COUNT(CASE WHEN sr.first_decision = 'Denied' THEN 1 END) AS total_denied,
    COUNT(*) AS total_applications,
    ROUND(
        (COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) * 100.0) / 
        NULLIF(COUNT(*), 0), 2
    ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration` sr
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed 
    ON sr.employer_name = ed.employer_petitioner_name
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd 
    ON sr.employer_name = cd.employer_name
GROUP BY employer_name
ORDER BY approval_rate DESC
    );
  
[0m20:29:13.632241 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c6cefcb5-0da9-432b-a9e5-63460f1a2e5e&page=queryresults
[0m20:29:13.654174 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6c89b6f7-15f4-44bb-b5b8-7dc7a60981fe&page=queryresults
[0m20:29:15.620001 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2c62d390>]}
[0m20:29:15.621359 [info ] [Thread-2 (]: 4 of 11 OK created sql table model dbt_cs329e_xh_mrt.company_approval_rate ..... [[32mCREATE TABLE (45.3k rows, 6.7 MiB processed)[0m in 2.45s]
[0m20:29:15.622764 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.company_approval_rate
[0m20:29:15.624005 [debug] [Thread-2 (]: Began running node model.cs329e_xh.company_wage_level
[0m20:29:15.625173 [info ] [Thread-2 (]: 5 of 11 START sql table model dbt_cs329e_xh_mrt.company_wage_level ............. [RUN]
[0m20:29:15.626273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_approval_rate, now model.cs329e_xh.company_wage_level)
[0m20:29:15.626995 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.company_wage_level
[0m20:29:15.632773 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.company_wage_level"
[0m20:29:15.633864 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.company_wage_level
[0m20:29:15.638707 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:15.778777 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.company_wage_level"
[0m20:29:15.779999 [debug] [Thread-2 (]: On model.cs329e_xh.company_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`company_wage_level`
      
    
    

    OPTIONS()
    as (
      SELECT 
    COALESCE(ws.company_name, cd.employer_name, ed.employer_petitioner_name) AS employer_name,
    ROUND(AVG(ws.min_wage), 2) AS min_wage,
    ROUND(AVG(ws.max_wage), 2) AS max_wage,
    ROUND(AVG(ws.average_wage), 2) AS average_wage
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary` ws
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed 
    ON ws.company_name = ed.employer_petitioner_name
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd 
    ON ws.company_name = cd.employer_name
GROUP BY employer_name
ORDER BY average_wage DESC
    );
  
[0m20:29:16.152012 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:81e4f1d1-7798-4d37-8999-0b0f2615dc02&page=queryresults
[0m20:29:16.793304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48685a50>]}
[0m20:29:16.794927 [info ] [Thread-1 (]: 3 of 11 OK created sql table model dbt_cs329e_xh_mrt.city_approval_rate ........ [[32mCREATE TABLE (20.1k rows, 50.1 MiB processed)[0m in 3.66s]
[0m20:29:16.796636 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.city_approval_rate
[0m20:29:16.797558 [debug] [Thread-1 (]: Began running node model.cs329e_xh.industry_approval_rate
[0m20:29:16.798756 [info ] [Thread-1 (]: 6 of 11 START sql table model dbt_cs329e_xh_mrt.industry_approval_rate ......... [RUN]
[0m20:29:16.799881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.city_approval_rate, now model.cs329e_xh.industry_approval_rate)
[0m20:29:16.800736 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.industry_approval_rate
[0m20:29:16.807313 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.industry_approval_rate"
[0m20:29:16.808498 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.industry_approval_rate
[0m20:29:16.812746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:16.957887 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.industry_approval_rate"
[0m20:29:16.959315 [debug] [Thread-1 (]: On model.cs329e_xh.industry_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.industry_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`industry_approval_rate`
      
    
    

    OPTIONS()
    as (
      WITH industry_data AS (
  SELECT
    sr.employer_name,
    -- Assign NAICS code: First use Employer_Detail, then fallback to SR
    COALESCE(SUBSTR(ed.naics_code, 1, 2), SUBSTR(sr.naics_code, 1, 2)) AS naics_code,
    CASE 
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '11' THEN '11 - Agriculture, Forestry, Fishing and Hunting'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '21' THEN '21 - Mining'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '22' THEN '22 - Utilities'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '23' THEN '23 - Construction'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) BETWEEN '31' AND '33' THEN '31-33 - Manufacturing'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '42' THEN '42 - Wholesale Trade'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) BETWEEN '44' AND '45' THEN '44-45 - Retail Trade'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) BETWEEN '48' AND '49' THEN '48-49 - Transportation and Warehousing'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '51' THEN '51 - Information'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '52' THEN '52 - Finance and Insurance'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '53' THEN '53 - Real Estate Rental and Leasing'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '54' THEN '54 - Professional, Scientific, and Technical Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '55' THEN '55 - Management of Companies and Enterprises'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '56' THEN '56 - Administrative and Support Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '61' THEN '61 - Educational Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '62' THEN '62 - Health Care and Social Assistance'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '71' THEN '71 - Arts, Entertainment, and Recreation'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '72' THEN '72 - Accommodation and Food Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '81' THEN '81 - Other Services (except Public Administration)'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '92' THEN '92 - Public Administration'
      ELSE 'Unclassified' 
    END AS industry,
    COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) AS approved,
    COUNT(CASE WHEN sr.first_decision = 'Denied' THEN 1 END) AS denied,
    COUNT(*) AS total
  FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration` sr
  LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed
    ON sr.employer_name = ed.employer_petitioner_name
  LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd
    ON sr.employer_name = cd.employer_name
  GROUP BY sr.employer_name, naics_code, industry
)
SELECT 
  industry,
  SUM(approved) AS total_approved,
  SUM(denied) AS total_denied,
  SUM(total) AS total_applications,
  ROUND(SUM(approved) / SUM(total) * 100, 2) AS approval_rate
FROM industry_data
GROUP BY industry
ORDER BY approval_rate DESC
    );
  
[0m20:29:17.285981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a1e57fa5-538c-4440-9806-c6373563fb71&page=queryresults
[0m20:29:18.132172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2c654490>]}
[0m20:29:18.133589 [info ] [Thread-2 (]: 5 of 11 OK created sql table model dbt_cs329e_xh_mrt.company_wage_level ........ [[32mCREATE TABLE (4.1k rows, 1.7 MiB processed)[0m in 2.51s]
[0m20:29:18.135625 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.company_wage_level
[0m20:29:18.136566 [debug] [Thread-2 (]: Began running node model.cs329e_xh.major_wage_level
[0m20:29:18.137718 [info ] [Thread-2 (]: 7 of 11 START sql table model dbt_cs329e_xh_mrt.major_wage_level ............... [RUN]
[0m20:29:18.139366 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_wage_level, now model.cs329e_xh.major_wage_level)
[0m20:29:18.140164 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.major_wage_level
[0m20:29:18.145906 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.major_wage_level"
[0m20:29:18.147015 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.major_wage_level
[0m20:29:18.152994 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:18.272640 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.major_wage_level"
[0m20:29:18.273902 [debug] [Thread-2 (]: On model.cs329e_xh.major_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.major_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`major_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH salary_by_field AS (
    SELECT 
        a.appx_a_field_of_study AS field_of_study,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE a.appx_a_field_of_study IS NOT NULL
)

SELECT 
    field_of_study,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM salary_by_field
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY field_of_study, wage_unit_of_pay
ORDER BY field_of_study, wage_unit_of_pay
    );
  
[0m20:29:18.631565 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a3b5ae0a-d609-4e7d-814c-6c3d86b39184&page=queryresults
[0m20:29:19.484124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2c128940>]}
[0m20:29:19.485433 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dbt_cs329e_xh_mrt.industry_approval_rate .... [[32mCREATE TABLE (21.0 rows, 8.3 MiB processed)[0m in 2.68s]
[0m20:29:19.486589 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.industry_approval_rate
[0m20:29:19.487661 [debug] [Thread-1 (]: Began running node model.cs329e_xh.soc_wage_level
[0m20:29:19.488902 [info ] [Thread-1 (]: 8 of 11 START sql table model dbt_cs329e_xh_mrt.soc_wage_level ................. [RUN]
[0m20:29:19.489883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.industry_approval_rate, now model.cs329e_xh.soc_wage_level)
[0m20:29:19.490545 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.soc_wage_level
[0m20:29:19.495774 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.soc_wage_level"
[0m20:29:19.496882 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.soc_wage_level
[0m20:29:19.501038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:19.629058 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.soc_wage_level"
[0m20:29:19.630273 [debug] [Thread-1 (]: On model.cs329e_xh.soc_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.soc_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`soc_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH job_salary AS (
    SELECT 
        l.soc_code,
        l.soc_title,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE l.soc_code IS NOT NULL AND l.soc_title IS NOT NULL
)

SELECT 
    soc_code,
    soc_title,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM job_salary
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY soc_code, soc_title, wage_unit_of_pay
ORDER BY avg_wage_from DESC
    );
  
[0m20:29:19.901125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aa68788b-ac75-4e73-9cdf-b4e111b06627&page=queryresults
[0m20:29:20.760175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2c654490>]}
[0m20:29:20.761478 [info ] [Thread-2 (]: 7 of 11 OK created sql table model dbt_cs329e_xh_mrt.major_wage_level .......... [[32mCREATE TABLE (87.0 rows, 19.6 MiB processed)[0m in 2.62s]
[0m20:29:20.762675 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.major_wage_level
[0m20:29:20.763563 [debug] [Thread-2 (]: Began running node model.cs329e_xh.state_approval_rate
[0m20:29:20.764922 [info ] [Thread-2 (]: 9 of 11 START sql table model dbt_cs329e_xh_mrt.state_approval_rate ............ [RUN]
[0m20:29:20.765897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.major_wage_level, now model.cs329e_xh.state_approval_rate)
[0m20:29:20.766570 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.state_approval_rate
[0m20:29:20.771821 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.state_approval_rate"
[0m20:29:20.772936 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.state_approval_rate
[0m20:29:20.777572 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:20.921958 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.state_approval_rate"
[0m20:29:20.923203 [debug] [Thread-2 (]: On model.cs329e_xh.state_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m20:29:21.397502 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a2289938-8bcb-4c2a-a1f3-db80b8b9a65b&page=queryresults
[0m20:29:21.854365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2d082560>]}
[0m20:29:21.855565 [info ] [Thread-1 (]: 8 of 11 OK created sql table model dbt_cs329e_xh_mrt.soc_wage_level ............ [[32mCREATE TABLE (55.0 rows, 41.3 MiB processed)[0m in 2.36s]
[0m20:29:21.856793 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.soc_wage_level
[0m20:29:21.857669 [debug] [Thread-1 (]: Began running node model.cs329e_xh.state_wage_level
[0m20:29:21.858784 [info ] [Thread-1 (]: 10 of 11 START sql table model dbt_cs329e_xh_mrt.state_wage_level .............. [RUN]
[0m20:29:21.860019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.soc_wage_level, now model.cs329e_xh.state_wage_level)
[0m20:29:21.860870 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.state_wage_level
[0m20:29:21.866869 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.state_wage_level"
[0m20:29:21.868031 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.state_wage_level
[0m20:29:21.874182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:22.001657 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.state_wage_level"
[0m20:29:22.002936 [debug] [Thread-1 (]: On model.cs329e_xh.state_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_wage_level`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  ROUND(AVG(ld.prevailing_wage), 2) AS avg_wage,
  ROUND(MAX(ld.prevailing_wage), 2) AS max_wage,
  ROUND(MIN(ld.prevailing_wage), 2) AS min_wage,
  COUNT(ld.case_number) AS total_cases
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
WHERE ld.prevailing_wage IS NOT NULL
AND LOWER(ld.pw_unit_of_pay) != 'hour'  -- Exclude hourly wage records
GROUP BY lw.worksite_state
ORDER BY avg_wage DESC
    );
  
[0m20:29:22.231524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:138128a4-aa01-4d37-8ce8-d807d006e66d&page=queryresults
[0m20:29:24.251174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2c154d90>]}
[0m20:29:24.252473 [info ] [Thread-2 (]: 9 of 11 OK created sql table model dbt_cs329e_xh_mrt.state_approval_rate ....... [[32mCREATE TABLE (55.0 rows, 41.5 MiB processed)[0m in 3.49s]
[0m20:29:24.253638 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.state_approval_rate
[0m20:29:24.254465 [debug] [Thread-2 (]: Began running node model.cs329e_xh.wage_level_by_industry
[0m20:29:24.255517 [info ] [Thread-2 (]: 11 of 11 START sql table model dbt_cs329e_xh_mrt.wage_level_by_industry ........ [RUN]
[0m20:29:24.256570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_approval_rate, now model.cs329e_xh.wage_level_by_industry)
[0m20:29:24.257268 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.wage_level_by_industry
[0m20:29:24.263236 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.wage_level_by_industry"
[0m20:29:24.264349 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.wage_level_by_industry
[0m20:29:24.268745 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:24.403625 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.wage_level_by_industry"
[0m20:29:24.404965 [debug] [Thread-2 (]: On model.cs329e_xh.wage_level_by_industry: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_level_by_industry"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`wage_level_by_industry`
      
    
    

    OPTIONS()
    as (
      WITH industry_wages AS (
  SELECT
    CASE 
      WHEN SUBSTR(ed.naics_code, 1, 2) = '11' THEN '11 - Agriculture, Forestry, Fishing and Hunting'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '21' THEN '21 - Mining'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '22' THEN '22 - Utilities'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '23' THEN '23 - Construction'
      WHEN SUBSTR(ed.naics_code, 1, 2) BETWEEN '31' AND '33' THEN '31-33 - Manufacturing'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '42' THEN '42 - Wholesale Trade'
      WHEN SUBSTR(ed.naics_code, 1, 2) BETWEEN '44' AND '45' THEN '44-45 - Retail Trade'
      WHEN SUBSTR(ed.naics_code, 1, 2) BETWEEN '48' AND '49' THEN '48-49 - Transportation and Warehousing'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '51' THEN '51 - Information'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '52' THEN '52 - Finance and Insurance'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '53' THEN '53 - Real Estate Rental and Leasing'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '54' THEN '54 - Professional, Scientific, and Technical Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '55' THEN '55 - Management of Companies and Enterprises'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '56' THEN '56 - Administrative and Support Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '61' THEN '61 - Educational Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '62' THEN '62 - Health Care and Social Assistance'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '71' THEN '71 - Arts, Entertainment, and Recreation'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '72' THEN '72 - Accommodation and Food Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '81' THEN '81 - Other Services (except Public Administration)'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '92' THEN '92 - Public Administration'
      ELSE 'Unclassified'
    END AS industry,
    ROUND(AVG(ws.average_wage), 2) AS avg_wage,
    ROUND(MIN(ws.min_wage), 2) AS min_wage,
    ROUND(MAX(ws.max_wage), 2) AS max_wage
  FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary` ws
  LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed
    ON ws.company_name = ed.employer_petitioner_name
  WHERE ws.average_wage IS NOT NULL
  GROUP BY industry
)
SELECT
  industry,
  avg_wage,
  min_wage,
  max_wage
FROM industry_wages
ORDER BY avg_wage DESC
    );
  
[0m20:29:24.709371 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:da9937c6-70f2-46e0-9483-675536c38c5e&page=queryresults
[0m20:29:25.032258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2d082560>]}
[0m20:29:25.033503 [info ] [Thread-1 (]: 10 of 11 OK created sql table model dbt_cs329e_xh_mrt.state_wage_level ......... [[32mCREATE TABLE (55.0 rows, 42.8 MiB processed)[0m in 3.17s]
[0m20:29:25.034653 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.state_wage_level
[0m20:29:26.959999 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7faf83d1-905c-42d1-bce7-b2604bf34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2d097b20>]}
[0m20:29:26.961315 [info ] [Thread-2 (]: 11 of 11 OK created sql table model dbt_cs329e_xh_mrt.wage_level_by_industry ... [[32mCREATE TABLE (21.0 rows, 2.7 MiB processed)[0m in 2.70s]
[0m20:29:26.962486 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.wage_level_by_industry
[0m20:29:26.965012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:26.966375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:26.967462 [debug] [MainThread]: Connection 'model.cs329e_xh.state_wage_level' was properly closed.
[0m20:29:26.968116 [debug] [MainThread]: Connection 'model.cs329e_xh.wage_level_by_industry' was properly closed.
[0m20:29:26.968943 [info ] [MainThread]: 
[0m20:29:26.969623 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 17.33 seconds (17.33s).
[0m20:29:26.973288 [debug] [MainThread]: Command end result
[0m20:29:27.022595 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:29:27.025354 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:29:27.037369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:29:27.038237 [info ] [MainThread]: 
[0m20:29:27.039050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:27.039774 [info ] [MainThread]: 
[0m20:29:27.040797 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:29:27.041969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.531515, "process_in_blocks": "0", "process_kernel_time": 0.501913, "process_mem_max_rss": "266872", "process_out_blocks": "4040", "process_user_time": 6.228829}
[0m20:29:27.042816 [debug] [MainThread]: Command `dbt run` succeeded at 20:29:27.042627 after 20.53 seconds
[0m20:29:27.043509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48ff9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b485df190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48ec7850>]}
[0m20:29:27.044230 [debug] [MainThread]: Flushing usage events
[0m20:29:27.243069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:37:58.836800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5cd715d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5c0de5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5c0de560>]}


============================== 18:37:58.842260 | 59e2b8db-5ef4-4fb2-a375-1d8c9f12609a ==============================
[0m18:37:58.842260 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:37:58.843360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select models/int/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:01.156036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59e2b8db-5ef4-4fb2-a375-1d8c9f12609a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5c5246d0>]}
[0m18:38:01.248610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59e2b8db-5ef4-4fb2-a375-1d8c9f12609a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5c17d510>]}
[0m18:38:01.249763 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:38:01.458772 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:38:01.926204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 25 files added, 0 files changed.
[0m18:38:01.927823 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/city_approval_rate-checkpoint.sql
[0m18:38:01.928939 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_wage_level-checkpoint.sql
[0m18:38:01.929915 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/industry_approval_rate-checkpoint.sql
[0m18:38:01.930906 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Sentiment_Analysis-checkpoint.sql
[0m18:38:01.931853 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m18:38:01.932994 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_approval_rate-checkpoint.sql
[0m18:38:01.933927 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Disclosure-checkpoint.sql
[0m18:38:01.934975 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Company_Data-checkpoint.sql
[0m18:38:01.937797 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/schema.yml
[0m18:38:01.939302 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/schema.yml
[0m18:38:01.942355 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/schema-checkpoint.yml
[0m18:38:01.943483 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/major_wage_level-checkpoint.sql
[0m18:38:01.944491 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m18:38:01.945472 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m18:38:01.946569 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/schema-checkpoint.yml
[0m18:38:01.947578 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/schema.yml
[0m18:38:01.948581 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/schema-checkpoint.yml
[0m18:38:01.949480 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m18:38:01.950413 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_approval_rate-checkpoint.sql
[0m18:38:01.951337 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Appendix-checkpoint.sql
[0m18:38:01.952460 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/soc_wage_level-checkpoint.sql
[0m18:38:01.953451 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m18:38:01.954424 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Single_Registration-checkpoint.sql
[0m18:38:01.955363 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_wage_level-checkpoint.sql
[0m18:38:01.956290 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/wage_level_by_industry-checkpoint.sql
[0m18:38:02.844027 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named Company_Data. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for Company_Data in one of these files:
   - models/int/.ipynb_checkpoints/schema-checkpoint.yml
  models/int/schema.yml
[0m18:38:02.845433 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.113053, "process_in_blocks": "47528", "process_kernel_time": 0.610199, "process_mem_max_rss": "261140", "process_out_blocks": "16", "process_user_time": 5.32702}
[0m18:38:02.846272 [debug] [MainThread]: Command `dbt test` failed at 18:38:02.846071 after 4.11 seconds
[0m18:38:02.846914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5cd715d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40545a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40546500>]}
[0m18:38:02.847697 [debug] [MainThread]: Flushing usage events
[0m18:38:03.205255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:37.880892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681fc0d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681ed925c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681ed92560>]}


============================== 18:39:37.884735 | 4fcece4e-aede-4dab-af81-875bbed91231 ==============================
[0m18:39:37.884735 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:39:37.885684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select models/int/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:39:39.769660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fcece4e-aede-4dab-af81-875bbed91231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6820db2ef0>]}
[0m18:39:39.868505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fcece4e-aede-4dab-af81-875bbed91231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681f3f18d0>]}
[0m18:39:39.870255 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:39:40.054839 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:39:40.285772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 24 files added, 0 files changed.
[0m18:39:40.287024 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_wage_level-checkpoint.sql
[0m18:39:40.287704 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/city_approval_rate-checkpoint.sql
[0m18:39:40.288268 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Sentiment_Analysis-checkpoint.sql
[0m18:39:40.288824 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/wage_level_by_industry-checkpoint.sql
[0m18:39:40.289739 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/soc_wage_level-checkpoint.sql
[0m18:39:40.290549 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/schema.yml
[0m18:39:40.291192 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/schema.yml
[0m18:39:40.291758 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m18:39:40.292301 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Appendix-checkpoint.sql
[0m18:39:40.292865 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Single_Registration-checkpoint.sql
[0m18:39:40.293481 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_approval_rate-checkpoint.sql
[0m18:39:40.294035 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/industry_approval_rate-checkpoint.sql
[0m18:39:40.294902 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m18:39:40.296584 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/schema.yml
[0m18:39:40.297206 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/major_wage_level-checkpoint.sql
[0m18:39:40.297795 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m18:39:40.298378 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m18:39:40.299000 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/schema-checkpoint.yml
[0m18:39:40.299646 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/schema-checkpoint.yml
[0m18:39:40.300197 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_approval_rate-checkpoint.sql
[0m18:39:40.300750 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m18:39:40.301307 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Company_Data-checkpoint.sql
[0m18:39:40.301897 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Disclosure-checkpoint.sql
[0m18:39:40.302487 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_wage_level-checkpoint.sql
[0m18:39:41.353807 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "cs329e_xh_raw_company_data".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("cs329e_xh_raw", "company_data").
  
  To fix this, change the name of one of these resources:
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/.ipynb_checkpoints/schema-checkpoint.yml)
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/schema.yml)
[0m18:39:41.355104 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.5682926, "process_in_blocks": "0", "process_kernel_time": 0.529802, "process_mem_max_rss": "260424", "process_out_blocks": "16", "process_user_time": 5.396108}
[0m18:39:41.356291 [debug] [MainThread]: Command `dbt test` failed at 18:39:41.356077 after 3.57 seconds
[0m18:39:41.357124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681fc0d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f680326aec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6803119510>]}
[0m18:39:41.357811 [debug] [MainThread]: Flushing usage events
[0m18:39:41.715410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:23.769338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2272d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a218b25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a218b2560>]}


============================== 18:40:23.773846 | df5f4c31-d0c3-4423-b14c-e36b88fc41bd ==============================
[0m18:40:23.773846 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:40:23.774783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select models/int/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:40:25.721928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df5f4c31-d0c3-4423-b14c-e36b88fc41bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a21e0cdc0>]}
[0m18:40:25.821869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df5f4c31-d0c3-4423-b14c-e36b88fc41bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a21de1d50>]}
[0m18:40:25.823057 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:40:26.025367 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:40:26.264157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 23 files added, 0 files changed.
[0m18:40:26.266518 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/schema.yml
[0m18:40:26.267327 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_wage_level-checkpoint.sql
[0m18:40:26.268017 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/schema.yml
[0m18:40:26.268614 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m18:40:26.269192 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/city_approval_rate-checkpoint.sql
[0m18:40:26.269745 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/soc_wage_level-checkpoint.sql
[0m18:40:26.270427 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/major_wage_level-checkpoint.sql
[0m18:40:26.270994 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m18:40:26.271538 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m18:40:26.272059 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_wage_level-checkpoint.sql
[0m18:40:26.272811 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/schema.yml
[0m18:40:26.273378 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_approval_rate-checkpoint.sql
[0m18:40:26.273903 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/wage_level_by_industry-checkpoint.sql
[0m18:40:26.274536 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Single_Registration-checkpoint.sql
[0m18:40:26.275115 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Sentiment_Analysis-checkpoint.sql
[0m18:40:26.275670 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/industry_approval_rate-checkpoint.sql
[0m18:40:26.276449 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/schema-checkpoint.yml
[0m18:40:26.277080 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m18:40:26.277662 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_approval_rate-checkpoint.sql
[0m18:40:26.278303 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m18:40:26.278909 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Company_Data-checkpoint.sql
[0m18:40:26.279465 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Disclosure-checkpoint.sql
[0m18:40:26.280010 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Appendix-checkpoint.sql
[0m18:40:27.386052 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "cs329e_xh_raw_approval_rate_by_month".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("cs329e_xh_raw", "approval_rate_by_month").
  
  To fix this, change the name of one of these resources:
  - source.cs329e_xh.cs329e_xh_raw.approval_rate_by_month (models/mrt/.ipynb_checkpoints/schema-checkpoint.yml)
  - source.cs329e_xh.cs329e_xh_raw.approval_rate_by_month (models/mrt/schema.yml)
[0m18:40:27.387557 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.7035108, "process_in_blocks": "0", "process_kernel_time": 0.471821, "process_mem_max_rss": "264804", "process_out_blocks": "24", "process_user_time": 5.640911}
[0m18:40:27.388476 [debug] [MainThread]: Command `dbt test` failed at 18:40:27.388305 after 3.70 seconds
[0m18:40:27.389130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2272d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a05d667d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a05d04d60>]}
[0m18:40:27.389816 [debug] [MainThread]: Flushing usage events
[0m18:40:27.769597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:04.737753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880be15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87fd665c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87fd66560>]}


============================== 18:41:04.741596 | ea98fb37-b959-4d34-9854-d247fb5199cd ==============================
[0m18:41:04.741596 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:41:04.742808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select models/int/', 'send_anonymous_usage_stats': 'True'}
[0m18:41:06.514238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea98fb37-b959-4d34-9854-d247fb5199cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe881d72ef0>]}
[0m18:41:06.605227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea98fb37-b959-4d34-9854-d247fb5199cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8803c4430>]}
[0m18:41:06.606361 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:41:06.790007 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:41:06.997342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 22 files added, 0 files changed.
[0m18:41:06.998463 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Disclosure-checkpoint.sql
[0m18:41:06.999123 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m18:41:06.999669 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Sentiment_Analysis-checkpoint.sql
[0m18:41:07.000201 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/major_wage_level-checkpoint.sql
[0m18:41:07.000726 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Single_Registration-checkpoint.sql
[0m18:41:07.001399 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/schema.yml
[0m18:41:07.001932 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Appendix-checkpoint.sql
[0m18:41:07.002560 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m18:41:07.003084 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_wage_level-checkpoint.sql
[0m18:41:07.003692 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/schema.yml
[0m18:41:07.004228 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/city_approval_rate-checkpoint.sql
[0m18:41:07.004753 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_approval_rate-checkpoint.sql
[0m18:41:07.005313 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_wage_level-checkpoint.sql
[0m18:41:07.005829 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/soc_wage_level-checkpoint.sql
[0m18:41:07.006389 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m18:41:07.006908 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/Company_Data-checkpoint.sql
[0m18:41:07.007439 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m18:41:07.007949 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m18:41:07.009569 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/schema.yml
[0m18:41:07.010148 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/industry_approval_rate-checkpoint.sql
[0m18:41:07.010818 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/wage_level_by_industry-checkpoint.sql
[0m18:41:07.011357 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_approval_rate-checkpoint.sql
[0m18:41:08.120759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea98fb37-b959-4d34-9854-d247fb5199cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe857d84bb0>]}
[0m18:41:08.316400 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m18:41:08.320397 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m18:41:08.525162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea98fb37-b959-4d34-9854-d247fb5199cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8642bcac0>]}
[0m18:41:08.526177 [info ] [MainThread]: Found 54 models, 1 seed, 29 data tests, 19 sources, 492 macros
[0m18:41:08.526970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea98fb37-b959-4d34-9854-d247fb5199cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8642bdc90>]}
[0m18:41:08.533690 [info ] [MainThread]: 
[0m18:41:08.534471 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:41:08.535094 [info ] [MainThread]: 
[0m18:41:08.536004 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:41:08.548026 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m18:41:08.549164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:08.550167 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m18:41:08.552037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:08.774666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m18:41:08.776084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:08.949015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m18:41:08.952250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:09.293540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea98fb37-b959-4d34-9854-d247fb5199cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe882127a00>]}
[0m18:41:09.294484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:09.305702 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m18:41:09.306512 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m18:41:09.307312 [info ] [Thread-1 (]: 1 of 29 START test not_null_Company_Data_employer_name ......................... [RUN]
[0m18:41:09.308329 [info ] [Thread-2 (]: 2 of 29 START test not_null_Employer_Detail_employer_petitioner_name ........... [RUN]
[0m18:41:09.309453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b)
[0m18:41:09.310302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227)
[0m18:41:09.311026 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m18:41:09.311734 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m18:41:09.339760 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m18:41:09.343576 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m18:41:09.347841 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m18:41:09.353957 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m18:41:09.395106 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m18:41:09.397112 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m18:41:09.402309 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
where employer_name is null



      
    ) dbt_internal_test
[0m18:41:09.403232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.405779 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_petitioner_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where employer_petitioner_name is null



      
    ) dbt_internal_test
[0m18:41:09.406620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:10.008255 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5aa47838-8d6f-484e-b3a1-acf29bae925a&page=queryresults
[0m18:41:10.080741 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b586522f-0ddd-4a24-b831-a8b7d8136f1b&page=queryresults
[0m18:41:10.459637 [info ] [Thread-1 (]: 1 of 29 PASS not_null_Company_Data_employer_name ............................... [[32mPASS[0m in 1.15s]
[0m18:41:10.461026 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m18:41:10.461780 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m18:41:10.462714 [info ] [Thread-1 (]: 3 of 29 START test not_null_Employer_Detail_fein ............................... [RUN]
[0m18:41:10.463599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b, now test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e)
[0m18:41:10.464227 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m18:41:10.471522 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e"
[0m18:41:10.472584 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m18:41:10.477769 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e"
[0m18:41:10.480736 [info ] [Thread-2 (]: 2 of 29 PASS not_null_Employer_Detail_employer_petitioner_name ................. [[32mPASS[0m in 1.17s]
[0m18:41:10.481679 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fein
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where fein is null



      
    ) dbt_internal_test
[0m18:41:10.482801 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m18:41:10.483719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:10.484578 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m18:41:10.487435 [info ] [Thread-2 (]: 4 of 29 START test not_null_LCA_Appendix_appx_a_date_of_degree ................. [RUN]
[0m18:41:10.488557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227, now test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155)
[0m18:41:10.489279 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m18:41:10.495789 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m18:41:10.497086 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m18:41:10.500986 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m18:41:10.501982 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appx_a_date_of_degree
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where appx_a_date_of_degree is null



      
    ) dbt_internal_test
[0m18:41:10.502753 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:10.938923 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8e5732e5-fe6b-4af3-a668-d1e1104ee084&page=queryresults
[0m18:41:10.950054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:42263b1e-81e0-4743-a1b7-c75cb210942e&page=queryresults
[0m18:41:11.295729 [info ] [Thread-1 (]: 3 of 29 PASS not_null_Employer_Detail_fein ..................................... [[32mPASS[0m in 0.83s]
[0m18:41:11.297695 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m18:41:11.298989 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m18:41:11.300423 [info ] [Thread-1 (]: 5 of 29 START test not_null_LCA_Appendix_case_number ........................... [RUN]
[0m18:41:11.303139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e, now test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b)
[0m18:41:11.304180 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m18:41:11.314752 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m18:41:11.318845 [info ] [Thread-2 (]: 4 of 29 PASS not_null_LCA_Appendix_appx_a_date_of_degree ....................... [[32mPASS[0m in 0.83s]
[0m18:41:11.319926 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m18:41:11.321368 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m18:41:11.328368 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m18:41:11.329706 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m18:41:11.331405 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where case_number is null



      
    ) dbt_internal_test
[0m18:41:11.332770 [info ] [Thread-2 (]: 6 of 29 START test not_null_LCA_Disclosure_case_number ......................... [RUN]
[0m18:41:11.334221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:11.335697 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155, now test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39)
[0m18:41:11.338896 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m18:41:11.346622 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m18:41:11.348574 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m18:41:11.357978 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m18:41:11.359724 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where case_number is null



      
    ) dbt_internal_test
[0m18:41:11.361865 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:11.821348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9cb23202-4fc1-4ab0-88dc-797cb35ac489&page=queryresults
[0m18:41:11.867729 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:11c44ea4-de38-4bbc-8e7e-e30161d7585a&page=queryresults
[0m18:41:12.195228 [info ] [Thread-1 (]: 5 of 29 PASS not_null_LCA_Appendix_case_number ................................. [[32mPASS[0m in 0.89s]
[0m18:41:12.196715 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m18:41:12.197524 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m18:41:12.198385 [info ] [Thread-1 (]: 7 of 29 START test not_null_LCA_Disclosure_decision_date ....................... [RUN]
[0m18:41:12.199386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b, now test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7)
[0m18:41:12.200029 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m18:41:12.207723 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"
[0m18:41:12.208733 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m18:41:12.212964 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"
[0m18:41:12.214343 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select decision_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where decision_date is null



      
    ) dbt_internal_test
[0m18:41:12.215444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:12.298972 [info ] [Thread-2 (]: 6 of 29 PASS not_null_LCA_Disclosure_case_number ............................... [[32mPASS[0m in 0.96s]
[0m18:41:12.300684 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m18:41:12.301824 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m18:41:12.302898 [info ] [Thread-2 (]: 8 of 29 START test not_null_LCA_Disclosure_employer_name ....................... [RUN]
[0m18:41:12.303917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39, now test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2)
[0m18:41:12.304744 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m18:41:12.311618 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m18:41:12.312595 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m18:41:12.317351 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m18:41:12.318590 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where employer_name is null



      
    ) dbt_internal_test
[0m18:41:12.319407 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:13.111117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:55d8c4a8-b2ef-4bf3-b305-bae280843cce&page=queryresults
[0m18:41:13.218246 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5cfcff59-7831-4789-b751-ea621428dd4c&page=queryresults
[0m18:41:13.476087 [info ] [Thread-1 (]: 7 of 29 PASS not_null_LCA_Disclosure_decision_date ............................. [[32mPASS[0m in 1.28s]
[0m18:41:13.477559 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m18:41:13.478377 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m18:41:13.479225 [info ] [Thread-1 (]: 9 of 29 START test not_null_LCA_Worksites_row_id ............................... [RUN]
[0m18:41:13.480158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7, now test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8)
[0m18:41:13.480803 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m18:41:13.487761 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m18:41:13.488702 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m18:41:13.494521 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m18:41:13.495860 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
where row_id is null



      
    ) dbt_internal_test
[0m18:41:13.496656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:13.615383 [info ] [Thread-2 (]: 8 of 29 PASS not_null_LCA_Disclosure_employer_name ............................. [[32mPASS[0m in 1.31s]
[0m18:41:13.616715 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m18:41:13.617458 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m18:41:13.618364 [info ] [Thread-2 (]: 10 of 29 START test not_null_Sentiment_Analysis_publication_date ............... [RUN]
[0m18:41:13.619302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2, now test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8)
[0m18:41:13.619923 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m18:41:13.626731 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m18:41:13.627737 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m18:41:13.632159 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m18:41:13.633355 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select publication_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
where publication_date is null



      
    ) dbt_internal_test
[0m18:41:13.634109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:13.966446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bc11e60d-3ee9-420e-b783-459c3d125c56&page=queryresults
[0m18:41:14.105322 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9e08ad45-7431-4c3e-995d-cdf8b07f0cd7&page=queryresults
[0m18:41:14.307047 [info ] [Thread-1 (]: 9 of 29 PASS not_null_LCA_Worksites_row_id ..................................... [[32mPASS[0m in 0.83s]
[0m18:41:14.308380 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m18:41:14.309124 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m18:41:14.310099 [info ] [Thread-1 (]: 11 of 29 START test not_null_Single_Registration_agent_first_name .............. [RUN]
[0m18:41:14.311060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8, now test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3)
[0m18:41:14.311703 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m18:41:14.317893 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m18:41:14.318784 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m18:41:14.322284 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m18:41:14.323208 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_first_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_first_name is null



      
    ) dbt_internal_test
[0m18:41:14.324095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:14.499541 [info ] [Thread-2 (]: 10 of 29 PASS not_null_Sentiment_Analysis_publication_date ..................... [[32mPASS[0m in 0.88s]
[0m18:41:14.500910 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m18:41:14.501696 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m18:41:14.502528 [info ] [Thread-2 (]: 12 of 29 START test not_null_Single_Registration_agent_last_name ............... [RUN]
[0m18:41:14.503408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8, now test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c)
[0m18:41:14.504038 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m18:41:14.510513 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m18:41:14.511424 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m18:41:14.517276 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m18:41:14.518304 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_last_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_last_name is null



      
    ) dbt_internal_test
[0m18:41:14.519003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:15.071684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b165bf9a-98cd-428d-b550-66a298ca417f&page=queryresults
[0m18:41:15.093641 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cfcf0a4b-381f-4215-967c-326232dea229&page=queryresults
[0m18:41:15.415039 [error] [Thread-1 (]: 11 of 29 FAIL 49 not_null_Single_Registration_agent_first_name ................. [[31mFAIL 49[0m in 1.10s]
[0m18:41:15.416435 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m18:41:15.417270 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m18:41:15.418213 [info ] [Thread-1 (]: 13 of 29 START test not_null_Single_Registration_ben_year_of_birth ............. [RUN]
[0m18:41:15.419335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3, now test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f)
[0m18:41:15.420024 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m18:41:15.427033 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m18:41:15.430576 [error] [Thread-2 (]: 12 of 29 FAIL 140 not_null_Single_Registration_agent_last_name ................. [[31mFAIL 140[0m in 0.93s]
[0m18:41:15.432560 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m18:41:15.433452 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m18:41:15.434620 [info ] [Thread-2 (]: 14 of 29 START test not_null_Single_Registration_employer_name ................. [RUN]
[0m18:41:15.435504 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m18:41:15.436462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c, now test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49)
[0m18:41:15.441161 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m18:41:15.442144 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m18:41:15.450852 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m18:41:15.452454 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ben_year_of_birth
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where ben_year_of_birth is null



      
    ) dbt_internal_test
[0m18:41:15.453308 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m18:41:15.454194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:15.458913 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m18:41:15.462124 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where employer_name is null



      
    ) dbt_internal_test
[0m18:41:15.463315 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:15.991644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:66f8230d-eb2e-4ba8-aa17-ff5d41816a91&page=queryresults
[0m18:41:16.046124 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8077c5ef-a639-4e94-86db-02d51baf82e5&page=queryresults
[0m18:41:16.345886 [info ] [Thread-1 (]: 13 of 29 PASS not_null_Single_Registration_ben_year_of_birth ................... [[32mPASS[0m in 0.93s]
[0m18:41:16.347312 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m18:41:16.348083 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m18:41:16.348964 [info ] [Thread-1 (]: 15 of 29 START test not_null_Single_Registration_gender ........................ [RUN]
[0m18:41:16.349999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f, now test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23)
[0m18:41:16.350732 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m18:41:16.357293 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m18:41:16.358349 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m18:41:16.364939 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m18:41:16.367558 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gender
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where gender is null



      
    ) dbt_internal_test
[0m18:41:16.368627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:16.398440 [error] [Thread-2 (]: 14 of 29 FAIL 1 not_null_Single_Registration_employer_name ..................... [[31mFAIL 1[0m in 0.96s]
[0m18:41:16.399881 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m18:41:16.400984 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m18:41:16.402369 [info ] [Thread-2 (]: 16 of 29 START test not_null_Single_Registration_mail_addr ..................... [RUN]
[0m18:41:16.403767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49, now test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3)
[0m18:41:16.404457 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m18:41:16.411625 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m18:41:16.412665 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m18:41:16.417068 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m18:41:16.418131 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mail_addr
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where mail_addr is null



      
    ) dbt_internal_test
[0m18:41:16.418900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:16.792669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c83b1a10-c7eb-4d40-ba84-a9fd8a39f0f2&page=queryresults
[0m18:41:17.006660 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8cbdc071-9e04-44f7-a34c-402aafa45896&page=queryresults
[0m18:41:17.151239 [info ] [Thread-1 (]: 15 of 29 PASS not_null_Single_Registration_gender .............................. [[32mPASS[0m in 0.80s]
[0m18:41:17.152596 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m18:41:17.153665 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m18:41:17.154947 [info ] [Thread-1 (]: 17 of 29 START test not_null_Wage_Summary_company_name ......................... [RUN]
[0m18:41:17.155864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23, now test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5)
[0m18:41:17.156582 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m18:41:17.163530 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m18:41:17.164609 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m18:41:17.170044 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m18:41:17.171275 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where company_name is null



      
    ) dbt_internal_test
[0m18:41:17.172021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:17.353033 [info ] [Thread-2 (]: 16 of 29 PASS not_null_Single_Registration_mail_addr ........................... [[32mPASS[0m in 0.95s]
[0m18:41:17.354851 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m18:41:17.355684 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m18:41:17.357025 [info ] [Thread-2 (]: 18 of 29 START test not_null_Wage_Summary_job_title ............................ [RUN]
[0m18:41:17.358089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3, now test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417)
[0m18:41:17.358814 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m18:41:17.366048 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m18:41:17.367117 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m18:41:17.373990 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m18:41:17.375332 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where job_title is null



      
    ) dbt_internal_test
[0m18:41:17.376369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:17.670616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:785e7182-b2f4-4386-895d-6399f1a2f5e0&page=queryresults
[0m18:41:17.739673 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:41473a5f-bc49-47cd-b812-98559df3e88a&page=queryresults
[0m18:41:18.072291 [info ] [Thread-1 (]: 17 of 29 PASS not_null_Wage_Summary_company_name ............................... [[32mPASS[0m in 0.92s]
[0m18:41:18.074432 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m18:41:18.075306 [debug] [Thread-1 (]: Began running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m18:41:18.076073 [info ] [Thread-1 (]: 19 of 29 START test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [RUN]
[0m18:41:18.077319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5, now test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6)
[0m18:41:18.078012 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m18:41:18.091350 [info ] [Thread-2 (]: 18 of 29 PASS not_null_Wage_Summary_job_title .................................. [[32mPASS[0m in 0.73s]
[0m18:41:18.092851 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m18:41:18.093971 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m18:41:18.095430 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m18:41:18.096394 [info ] [Thread-2 (]: 20 of 29 START test relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_  [RUN]
[0m18:41:18.097446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417, now test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531)
[0m18:41:18.098504 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m18:41:18.099238 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m18:41:18.108688 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"
[0m18:41:18.113907 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m18:41:18.115495 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m18:41:18.116568 [debug] [Thread-1 (]: On test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select employer_petitioner_name as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
    where employer_petitioner_name is not null
),

parent as (
    select employer_name as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:41:18.123314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:18.122228 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"
[0m18:41:18.127749 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select decision_date as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    where decision_date is not null
),

parent as (
    select publication_date as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:41:18.128595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:18.660377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b9d4f96f-9360-4414-9bc3-54b1c1551730&page=queryresults
[0m18:41:18.676760 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c9ac912c-d6ec-4a28-a8a3-4e1625a40172&page=queryresults
[0m18:41:18.984500 [error] [Thread-1 (]: 19 of 29 FAIL 26520 relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [[31mFAIL 26520[0m in 0.91s]
[0m18:41:18.986044 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m18:41:18.986935 [debug] [Thread-1 (]: Began running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m18:41:18.988149 [info ] [Thread-1 (]: 21 of 29 START test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [RUN]
[0m18:41:18.989306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6, now test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46)
[0m18:41:18.990017 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m18:41:18.999470 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m18:41:19.003116 [error] [Thread-2 (]: 20 of 29 FAIL 548660 relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_  [[31mFAIL 548660[0m in 0.91s]
[0m18:41:19.004780 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m18:41:19.005783 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m18:41:19.006731 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m18:41:19.007524 [info ] [Thread-2 (]: 22 of 29 START test unique_Company_Data_employer_name .......................... [RUN]
[0m18:41:19.012122 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m18:41:19.013148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531, now test.cs329e_xh.unique_Company_Data_employer_name.69805b71db)
[0m18:41:19.014509 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m18:41:19.028378 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m18:41:19.029529 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m18:41:19.030502 [debug] [Thread-1 (]: On test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select case_number as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
    where case_number is not null
),

parent as (
    select case_number as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:41:19.035509 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m18:41:19.036505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:19.039873 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Company_Data_employer_name.69805b71db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
  where employer_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:41:19.040666 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:19.523115 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1d3da8cf-9332-4310-9395-16755414fbd9&page=queryresults
[0m18:41:19.844245 [info ] [Thread-2 (]: 22 of 29 PASS unique_Company_Data_employer_name ................................ [[32mPASS[0m in 0.83s]
[0m18:41:19.846146 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m18:41:19.847347 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m18:41:19.848590 [info ] [Thread-2 (]: 23 of 29 START test unique_Employer_Detail_fein ................................ [RUN]
[0m18:41:19.849662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Company_Data_employer_name.69805b71db, now test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756)
[0m18:41:19.850379 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m18:41:19.857308 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756"
[0m18:41:19.858440 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m18:41:19.863394 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756"
[0m18:41:19.864497 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fein as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
  where fein is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:41:19.865290 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:20.153355 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c3d4749c-cdb1-44b0-b6fa-c07043a6fbcc&page=queryresults
[0m18:41:20.382589 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:425c5c06-7901-4a06-9bf1-e773992a480b&page=queryresults
[0m18:41:20.562699 [error] [Thread-1 (]: 21 of 29 FAIL 14201 relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [[31mFAIL 14201[0m in 1.57s]
[0m18:41:20.564393 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m18:41:20.565286 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m18:41:20.566451 [info ] [Thread-1 (]: 24 of 29 START test unique_LCA_Worksites_row_id ................................ [RUN]
[0m18:41:20.567622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46, now test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef)
[0m18:41:20.568435 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m18:41:20.575742 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m18:41:20.576756 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m18:41:20.580834 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m18:41:20.581925 [debug] [Thread-1 (]: On test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select row_id as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
  where row_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:41:20.582736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:20.723592 [info ] [Thread-2 (]: 23 of 29 PASS unique_Employer_Detail_fein ...................................... [[32mPASS[0m in 0.87s]
[0m18:41:20.725000 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m18:41:20.725778 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m18:41:20.726752 [info ] [Thread-2 (]: 25 of 29 START test unique_Sentiment_Analysis_publication_date ................. [RUN]
[0m18:41:20.727778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756, now test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e)
[0m18:41:20.728488 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m18:41:20.735252 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m18:41:20.736266 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m18:41:20.740327 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m18:41:20.741696 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select publication_date as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
  where publication_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:41:20.742621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:21.220082 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d70ded9a-8b4f-4878-9c37-d11e23cd1fc7&page=queryresults
[0m18:41:21.816163 [info ] [Thread-2 (]: 25 of 29 PASS unique_Sentiment_Analysis_publication_date ....................... [[32mPASS[0m in 1.09s]
[0m18:41:21.817624 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m18:41:21.818458 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m18:41:21.819457 [info ] [Thread-2 (]: 26 of 29 START test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [RUN]
[0m18:41:21.820357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e, now test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557)
[0m18:41:21.821023 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m18:41:21.834138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:21.857457 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:41:21.858584 [error] [Thread-2 (]: 26 of 29 ERROR unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [[31mERROR[0m in 0.04s]
[0m18:41:21.859676 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m18:41:21.860437 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m18:41:21.861102 [info ] [Thread-2 (]: 27 of 29 START test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [RUN]
[0m18:41:21.862256 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:41:21.863179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557, now test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4)
[0m18:41:21.865107 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m18:41:21.872987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:21.874878 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:41:21.875948 [error] [Thread-2 (]: 27 of 29 ERROR unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [[31mERROR[0m in 0.01s]
[0m18:41:21.876932 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m18:41:21.877634 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m18:41:21.878483 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:41:21.879268 [info ] [Thread-2 (]: 28 of 29 START test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [RUN]
[0m18:41:21.881335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4, now test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d)
[0m18:41:21.882015 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m18:41:21.889902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:21.891977 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:41:21.892957 [error] [Thread-2 (]: 28 of 29 ERROR unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [[31mERROR[0m in 0.01s]
[0m18:41:21.894062 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m18:41:21.894799 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m18:41:21.895578 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:41:21.896362 [info ] [Thread-2 (]: 29 of 29 START test unique_combination_of_columns_Wage_Summary_company_name__job_title  [RUN]
[0m18:41:21.897649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d, now test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194)
[0m18:41:21.898345 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m18:41:21.908755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:21.911104 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:41:21.912095 [error] [Thread-2 (]: 29 of 29 ERROR unique_combination_of_columns_Wage_Summary_company_name__job_title  [[31mERROR[0m in 0.01s]
[0m18:41:21.913057 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m18:41:21.913934 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:41:21.976276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:69bb45cf-fe2b-445e-8302-924054e3b24b&page=queryresults
[0m18:41:22.682958 [info ] [Thread-1 (]: 24 of 29 PASS unique_LCA_Worksites_row_id ...................................... [[32mPASS[0m in 2.12s]
[0m18:41:22.684605 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m18:41:22.687138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:22.688198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:22.688734 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef' was properly closed.
[0m18:41:22.689220 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' was properly closed.
[0m18:41:22.689990 [info ] [MainThread]: 
[0m18:41:22.690658 [info ] [MainThread]: Finished running 29 data tests in 0 hours 0 minutes and 14.15 seconds (14.15s).
[0m18:41:22.697048 [debug] [MainThread]: Command end result
[0m18:41:22.765500 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m18:41:22.768427 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m18:41:22.780348 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m18:41:22.781061 [info ] [MainThread]: 
[0m18:41:22.781765 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m18:41:22.782541 [info ] [MainThread]: 
[0m18:41:22.783391 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_agent_first_name (models/int/schema.yml)[0m
[0m18:41:22.784226 [error] [MainThread]:   Got 49 results, configured to fail if != 0
[0m18:41:22.784976 [info ] [MainThread]: 
[0m18:41:22.785752 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_agent_first_name.sql
[0m18:41:22.786478 [info ] [MainThread]: 
[0m18:41:22.787271 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_agent_last_name (models/int/schema.yml)[0m
[0m18:41:22.788262 [error] [MainThread]:   Got 140 results, configured to fail if != 0
[0m18:41:22.788936 [info ] [MainThread]: 
[0m18:41:22.789720 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_agent_last_name.sql
[0m18:41:22.790441 [info ] [MainThread]: 
[0m18:41:22.791208 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_employer_name (models/int/schema.yml)[0m
[0m18:41:22.791947 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:41:22.792574 [info ] [MainThread]: 
[0m18:41:22.793309 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_employer_name.sql
[0m18:41:22.793972 [info ] [MainThread]: 
[0m18:41:22.794934 [error] [MainThread]: [31mFailure in test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_ (models/int/Employer_Details/schema.yml)[0m
[0m18:41:22.795928 [error] [MainThread]:   Got 26520 results, configured to fail if != 0
[0m18:41:22.796613 [info ] [MainThread]: 
[0m18:41:22.797377 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/relationships_Employer_Detail_a803ce1d5c10b4dae7e1dc33e0f1a09b.sql
[0m18:41:22.798056 [info ] [MainThread]: 
[0m18:41:22.799564 [error] [MainThread]: [31mFailure in test relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_ (models/int/schema.yml)[0m
[0m18:41:22.800463 [error] [MainThread]:   Got 548660 results, configured to fail if != 0
[0m18:41:22.801088 [info ] [MainThread]: 
[0m18:41:22.801971 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Disclosure_5b656fbbb20356ebf0977db6de7595b5.sql
[0m18:41:22.802718 [info ] [MainThread]: 
[0m18:41:22.803496 [error] [MainThread]: [31mFailure in test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_ (models/int/schema.yml)[0m
[0m18:41:22.804239 [error] [MainThread]:   Got 14201 results, configured to fail if != 0
[0m18:41:22.804863 [info ] [MainThread]: 
[0m18:41:22.805620 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Worksites_a871b7806445a97e6fda9420f0740807.sql
[0m18:41:22.806326 [info ] [MainThread]: 
[0m18:41:22.807056 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:41:22.807734 [info ] [MainThread]: 
[0m18:41:22.808487 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:41:22.809159 [info ] [MainThread]: 
[0m18:41:22.809906 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:41:22.810636 [info ] [MainThread]: 
[0m18:41:22.811508 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:41:22.812284 [info ] [MainThread]: 
[0m18:41:22.813010 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=10 SKIP=0 TOTAL=29
[0m18:41:22.814483 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 18.15873, "process_in_blocks": "4640", "process_kernel_time": 0.542977, "process_mem_max_rss": "278188", "process_out_blocks": "5520", "process_user_time": 6.867926}
[0m18:41:22.815166 [debug] [MainThread]: Command `dbt test` failed at 18:41:22.815023 after 18.16 seconds
[0m18:41:22.815808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880be15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe857d32b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880a89b70>]}
[0m18:41:22.816465 [debug] [MainThread]: Flushing usage events
[0m18:41:23.218120 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:34.321094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f50fd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f4282560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f4282500>]}


============================== 19:37:34.324522 | 7b121ed0-4279-44c0-845a-a77d214c74a8 ==============================
[0m19:37:34.324522 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:37:34.325344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select models/int/', 'send_anonymous_usage_stats': 'True'}
[0m19:37:35.922856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b121ed0-4279-44c0-845a-a77d214c74a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f628eec0>]}
[0m19:37:36.006632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b121ed0-4279-44c0-845a-a77d214c74a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f4287790>]}
[0m19:37:36.007671 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:37:36.190769 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:37:36.428100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:37:36.429309 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/schema-checkpoint.yml
[0m19:37:36.430885 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/schema-checkpoint.yml
[0m19:37:36.542526 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named Employer_Detail. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for Employer_Detail in one of these files:
   - models/int/Employer_Details/.ipynb_checkpoints/schema-checkpoint.yml
  models/int/Employer_Details/schema.yml
[0m19:37:36.543677 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.2980504, "process_in_blocks": "0", "process_kernel_time": 0.480206, "process_mem_max_rss": "253592", "process_out_blocks": "8", "process_user_time": 3.849228}
[0m19:37:36.544423 [debug] [MainThread]: Command `dbt test` failed at 19:37:36.544279 after 2.30 seconds
[0m19:37:36.545049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f50fd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d8f60190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d8f60100>]}
[0m19:37:36.545672 [debug] [MainThread]: Flushing usage events
[0m19:37:36.919680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:13.531039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c25969570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c24cd6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c24cd64a0>]}


============================== 19:38:13.534509 | af65432d-48ab-4e68-86df-89870a340b7d ==============================
[0m19:38:13.534509 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:38:13.535504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select models/int/', 'send_anonymous_usage_stats': 'True'}
[0m19:38:15.112498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af65432d-48ab-4e68-86df-89870a340b7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c2521dd80>]}
[0m19:38:15.194846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af65432d-48ab-4e68-86df-89870a340b7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c24d754b0>]}
[0m19:38:15.195861 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:38:15.369630 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:38:15.641627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:38:15.643754 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/.ipynb_checkpoints/schema-checkpoint.yml
[0m19:38:15.752580 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named Company_Data. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for Company_Data in one of these files:
   - models/int/.ipynb_checkpoints/schema-checkpoint.yml
  models/int/schema.yml
[0m19:38:15.753841 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.301297, "process_in_blocks": "0", "process_kernel_time": 0.440981, "process_mem_max_rss": "255872", "process_out_blocks": "8", "process_user_time": 3.892719}
[0m19:38:15.754673 [debug] [MainThread]: Command `dbt test` failed at 19:38:15.754527 after 2.30 seconds
[0m19:38:15.755275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c25969570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c09995120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c09995090>]}
[0m19:38:15.755890 [debug] [MainThread]: Flushing usage events
[0m19:38:16.106459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:14.110743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd795da15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd794f26560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd794f26500>]}


============================== 19:39:14.114224 | 7935152b-e8d8-4998-93ba-fb5b6b66d280 ==============================
[0m19:39:14.114224 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:39:14.115202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select models/int/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:39:15.710316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7935152b-e8d8-4998-93ba-fb5b6b66d280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd796f32ec0>]}
[0m19:39:15.791633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7935152b-e8d8-4998-93ba-fb5b6b66d280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79545ada0>]}
[0m19:39:15.792623 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:39:15.964313 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:39:16.191771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:16.192401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:16.289673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7935152b-e8d8-4998-93ba-fb5b6b66d280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd779bb9e10>]}
[0m19:39:16.466548 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:39:16.468833 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:39:16.504774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7935152b-e8d8-4998-93ba-fb5b6b66d280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd779b4d840>]}
[0m19:39:16.505581 [info ] [MainThread]: Found 54 models, 1 seed, 29 data tests, 19 sources, 492 macros
[0m19:39:16.506237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7935152b-e8d8-4998-93ba-fb5b6b66d280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77aa18910>]}
[0m19:39:16.512669 [info ] [MainThread]: 
[0m19:39:16.513260 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:39:16.513815 [info ] [MainThread]: 
[0m19:39:16.514673 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:39:16.525825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m19:39:16.526641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:16.528306 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m19:39:16.529777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:16.676271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m19:39:16.677658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:16.687581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m19:39:16.691466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:16.922853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7935152b-e8d8-4998-93ba-fb5b6b66d280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7963bc490>]}
[0m19:39:16.923700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:16.928400 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m19:39:16.929318 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m19:39:16.930267 [info ] [Thread-1 (]: 1 of 29 START test not_null_Company_Data_employer_name ......................... [RUN]
[0m19:39:16.931518 [info ] [Thread-2 (]: 2 of 29 START test not_null_Employer_Detail_employer_petitioner_name ........... [RUN]
[0m19:39:16.932457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b)
[0m19:39:16.933180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227)
[0m19:39:16.933836 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m19:39:16.934513 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m19:39:16.966677 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m19:39:16.969722 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m19:39:16.970866 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m19:39:16.976671 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m19:39:17.011530 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m19:39:17.014092 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m19:39:17.015550 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_petitioner_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where employer_petitioner_name is null



      
    ) dbt_internal_test
[0m19:39:17.016266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:17.016934 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
where employer_name is null



      
    ) dbt_internal_test
[0m19:39:17.019396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:17.347568 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:338e63b3-ee35-466e-9bd6-41a0d0ff328d&page=queryresults
[0m19:39:17.379855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:78693cd4-bb8f-4eb9-b911-6c021dab76a9&page=queryresults
[0m19:39:17.766553 [info ] [Thread-2 (]: 2 of 29 PASS not_null_Employer_Detail_employer_petitioner_name ................. [[32mPASS[0m in 0.83s]
[0m19:39:17.767842 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m19:39:17.768589 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m19:39:17.769277 [info ] [Thread-2 (]: 3 of 29 START test not_null_Employer_Detail_fein ............................... [RUN]
[0m19:39:17.770308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227, now test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e)
[0m19:39:17.770928 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m19:39:17.777025 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e"
[0m19:39:17.777858 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m19:39:17.782140 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e"
[0m19:39:17.783067 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fein
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where fein is null



      
    ) dbt_internal_test
[0m19:39:17.783755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:17.797631 [info ] [Thread-1 (]: 1 of 29 PASS not_null_Company_Data_employer_name ............................... [[32mPASS[0m in 0.87s]
[0m19:39:17.799195 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m19:39:17.800223 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m19:39:17.801346 [info ] [Thread-1 (]: 4 of 29 START test not_null_LCA_Appendix_appx_a_date_of_degree ................. [RUN]
[0m19:39:17.802496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b, now test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155)
[0m19:39:17.803463 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m19:39:17.812561 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m19:39:17.813757 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m19:39:17.819351 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m19:39:17.820659 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appx_a_date_of_degree
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where appx_a_date_of_degree is null



      
    ) dbt_internal_test
[0m19:39:17.821684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:18.125949 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8570aebd-414d-45f0-b955-b558aa8efa6b&page=queryresults
[0m19:39:18.142089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4370e66b-e80a-4bde-9b6c-a08b351eb653&page=queryresults
[0m19:39:18.516995 [info ] [Thread-1 (]: 4 of 29 PASS not_null_LCA_Appendix_appx_a_date_of_degree ....................... [[32mPASS[0m in 0.71s]
[0m19:39:18.518420 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m19:39:18.519106 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m19:39:18.519924 [info ] [Thread-1 (]: 5 of 29 START test not_null_LCA_Appendix_case_number ........................... [RUN]
[0m19:39:18.520797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155, now test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b)
[0m19:39:18.521407 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m19:39:18.527878 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m19:39:18.528752 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m19:39:18.532328 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m19:39:18.533250 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where case_number is null



      
    ) dbt_internal_test
[0m19:39:18.534733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:18.538447 [info ] [Thread-2 (]: 3 of 29 PASS not_null_Employer_Detail_fein ..................................... [[32mPASS[0m in 0.77s]
[0m19:39:18.539763 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m19:39:18.540438 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m19:39:18.541274 [info ] [Thread-2 (]: 6 of 29 START test not_null_LCA_Disclosure_case_number ......................... [RUN]
[0m19:39:18.542338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e, now test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39)
[0m19:39:18.543453 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m19:39:18.549299 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m19:39:18.550356 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m19:39:18.554998 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m19:39:18.555842 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where case_number is null



      
    ) dbt_internal_test
[0m19:39:18.556496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:18.832203 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fce38343-f147-414b-9b39-826969a54029&page=queryresults
[0m19:39:18.845830 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9b2bdcc0-0bdd-4de8-bde2-6fe48270f72a&page=queryresults
[0m19:39:19.138930 [info ] [Thread-2 (]: 6 of 29 PASS not_null_LCA_Disclosure_case_number ............................... [[32mPASS[0m in 0.60s]
[0m19:39:19.140210 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m19:39:19.140945 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m19:39:19.141722 [info ] [Thread-2 (]: 7 of 29 START test not_null_LCA_Disclosure_decision_date ....................... [RUN]
[0m19:39:19.142609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39, now test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7)
[0m19:39:19.143290 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m19:39:19.149376 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"
[0m19:39:19.150234 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m19:39:19.153674 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"
[0m19:39:19.154572 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select decision_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where decision_date is null



      
    ) dbt_internal_test
[0m19:39:19.155247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:19.168705 [info ] [Thread-1 (]: 5 of 29 PASS not_null_LCA_Appendix_case_number ................................. [[32mPASS[0m in 0.65s]
[0m19:39:19.169790 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m19:39:19.170479 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m19:39:19.171295 [info ] [Thread-1 (]: 8 of 29 START test not_null_LCA_Disclosure_employer_name ....................... [RUN]
[0m19:39:19.172125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b, now test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2)
[0m19:39:19.172732 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m19:39:19.178125 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m19:39:19.178957 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m19:39:19.182285 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m19:39:19.183119 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where employer_name is null



      
    ) dbt_internal_test
[0m19:39:19.183743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:19.503496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8391f0dd-e920-4a0e-893c-c1ed7838eaa6&page=queryresults
[0m19:39:19.506743 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:908f708e-dfc7-4207-b220-63cf4f3d66a2&page=queryresults
[0m19:39:19.840705 [info ] [Thread-1 (]: 8 of 29 PASS not_null_LCA_Disclosure_employer_name ............................. [[32mPASS[0m in 0.67s]
[0m19:39:19.842065 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m19:39:19.842780 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m19:39:19.843467 [info ] [Thread-1 (]: 9 of 29 START test not_null_LCA_Worksites_row_id ............................... [RUN]
[0m19:39:19.844476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2, now test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8)
[0m19:39:19.845098 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m19:39:19.851105 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m19:39:19.853569 [info ] [Thread-2 (]: 7 of 29 PASS not_null_LCA_Disclosure_decision_date ............................. [[32mPASS[0m in 0.71s]
[0m19:39:19.854466 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m19:39:19.855367 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m19:39:19.860835 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m19:39:19.861636 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m19:39:19.862649 [info ] [Thread-2 (]: 10 of 29 START test not_null_Sentiment_Analysis_publication_date ............... [RUN]
[0m19:39:19.863524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7, now test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8)
[0m19:39:19.864237 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
where row_id is null



      
    ) dbt_internal_test
[0m19:39:19.864853 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m19:39:19.865563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:19.871025 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m19:39:19.873416 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m19:39:19.876879 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m19:39:19.877883 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select publication_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
where publication_date is null



      
    ) dbt_internal_test
[0m19:39:19.878624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:20.212527 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bf5f93cb-cdf8-4bff-b4ab-a89b95b83047&page=queryresults
[0m19:39:20.476224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b604cf5c-d696-48e6-b4ef-69d13fccce8e&page=queryresults
[0m19:39:20.566710 [info ] [Thread-2 (]: 10 of 29 PASS not_null_Sentiment_Analysis_publication_date ..................... [[32mPASS[0m in 0.70s]
[0m19:39:20.568135 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m19:39:20.568855 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m19:39:20.569630 [info ] [Thread-2 (]: 11 of 29 START test not_null_Single_Registration_agent_first_name .............. [RUN]
[0m19:39:20.570517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8, now test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3)
[0m19:39:20.571134 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m19:39:20.577300 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m19:39:20.578131 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m19:39:20.581572 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m19:39:20.582507 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_first_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_first_name is null



      
    ) dbt_internal_test
[0m19:39:20.583164 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:20.860796 [info ] [Thread-1 (]: 9 of 29 PASS not_null_LCA_Worksites_row_id ..................................... [[32mPASS[0m in 1.02s]
[0m19:39:20.862103 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m19:39:20.862886 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m19:39:20.863670 [info ] [Thread-1 (]: 12 of 29 START test not_null_Single_Registration_agent_last_name ............... [RUN]
[0m19:39:20.864481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8, now test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c)
[0m19:39:20.865190 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m19:39:20.871368 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m19:39:20.872722 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m19:39:20.878685 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0578b428-bc8e-4ad6-97ed-5c2853f549b1&page=queryresults
[0m19:39:20.877900 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m19:39:20.881106 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_last_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_last_name is null



      
    ) dbt_internal_test
[0m19:39:20.881792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:21.210148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:495c176e-6bd6-4957-84e0-0b750aea115b&page=queryresults
[0m19:39:21.219934 [error] [Thread-2 (]: 11 of 29 FAIL 49 not_null_Single_Registration_agent_first_name ................. [[31mFAIL 49[0m in 0.65s]
[0m19:39:21.221224 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m19:39:21.221939 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m19:39:21.222756 [info ] [Thread-2 (]: 13 of 29 START test not_null_Single_Registration_ben_year_of_birth ............. [RUN]
[0m19:39:21.223612 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3, now test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f)
[0m19:39:21.224283 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m19:39:21.230474 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m19:39:21.231298 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m19:39:21.234886 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m19:39:21.235745 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ben_year_of_birth
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where ben_year_of_birth is null



      
    ) dbt_internal_test
[0m19:39:21.236528 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:21.518122 [error] [Thread-1 (]: 12 of 29 FAIL 140 not_null_Single_Registration_agent_last_name ................. [[31mFAIL 140[0m in 0.65s]
[0m19:39:21.519424 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m19:39:21.520108 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m19:39:21.520887 [info ] [Thread-1 (]: 14 of 29 START test not_null_Single_Registration_employer_name ................. [RUN]
[0m19:39:21.521675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c, now test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49)
[0m19:39:21.522336 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m19:39:21.528397 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m19:39:21.529213 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m19:39:21.532538 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m19:39:21.533394 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where employer_name is null



      
    ) dbt_internal_test
[0m19:39:21.534079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:21.563409 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4c75f3a9-3c70-4a77-b44b-c8527872562f&page=queryresults
[0m19:39:21.854917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:99d53a59-d340-4524-ab44-fab088711213&page=queryresults
[0m19:39:21.969785 [info ] [Thread-2 (]: 13 of 29 PASS not_null_Single_Registration_ben_year_of_birth ................... [[32mPASS[0m in 0.75s]
[0m19:39:21.971148 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m19:39:21.971867 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m19:39:21.972630 [info ] [Thread-2 (]: 15 of 29 START test not_null_Single_Registration_gender ........................ [RUN]
[0m19:39:21.973514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f, now test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23)
[0m19:39:21.974132 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m19:39:21.980320 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m19:39:21.981136 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m19:39:21.984427 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m19:39:21.985275 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gender
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where gender is null



      
    ) dbt_internal_test
[0m19:39:21.985916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:22.175842 [error] [Thread-1 (]: 14 of 29 FAIL 1 not_null_Single_Registration_employer_name ..................... [[31mFAIL 1[0m in 0.65s]
[0m19:39:22.177167 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m19:39:22.177871 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m19:39:22.178662 [info ] [Thread-1 (]: 16 of 29 START test not_null_Single_Registration_mail_addr ..................... [RUN]
[0m19:39:22.179460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49, now test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3)
[0m19:39:22.180043 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m19:39:22.301629 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m19:39:22.303383 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0fb8a4a5-6342-4b6d-966d-e05815c6b2f3&page=queryresults
[0m19:39:22.305484 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m19:39:22.308930 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m19:39:22.309821 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mail_addr
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where mail_addr is null



      
    ) dbt_internal_test
[0m19:39:22.310685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:22.595672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:11f7dee9-9db0-4bc2-9b2f-26461d4e1911&page=queryresults
[0m19:39:22.671883 [info ] [Thread-2 (]: 15 of 29 PASS not_null_Single_Registration_gender .............................. [[32mPASS[0m in 0.70s]
[0m19:39:22.673266 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m19:39:22.674016 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m19:39:22.674830 [info ] [Thread-2 (]: 17 of 29 START test not_null_Wage_Summary_company_name ......................... [RUN]
[0m19:39:22.675691 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23, now test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5)
[0m19:39:22.676279 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m19:39:22.682422 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m19:39:22.683233 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m19:39:22.686714 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m19:39:22.687555 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where company_name is null



      
    ) dbt_internal_test
[0m19:39:22.688354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:22.944207 [info ] [Thread-1 (]: 16 of 29 PASS not_null_Single_Registration_mail_addr ........................... [[32mPASS[0m in 0.76s]
[0m19:39:22.945542 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m19:39:22.946275 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m19:39:22.947042 [info ] [Thread-1 (]: 18 of 29 START test not_null_Wage_Summary_job_title ............................ [RUN]
[0m19:39:22.947844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3, now test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417)
[0m19:39:22.948460 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m19:39:22.954626 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m19:39:22.955446 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m19:39:22.958839 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m19:39:22.959722 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where job_title is null



      
    ) dbt_internal_test
[0m19:39:22.960400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:23.030551 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7c413d59-89b1-4845-8f9c-ae4e4dbb8a79&page=queryresults
[0m19:39:23.274625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5ae01e61-08ca-46da-bf5d-5edd60c747a3&page=queryresults
[0m19:39:23.406278 [info ] [Thread-2 (]: 17 of 29 PASS not_null_Wage_Summary_company_name ............................... [[32mPASS[0m in 0.73s]
[0m19:39:23.407647 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m19:39:23.408372 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m19:39:23.409065 [info ] [Thread-2 (]: 19 of 29 START test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [RUN]
[0m19:39:23.410035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5, now test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6)
[0m19:39:23.410703 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m19:39:23.424367 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m19:39:23.425479 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m19:39:23.429078 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m19:39:23.430053 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select employer_petitioner_name as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
    where employer_petitioner_name is not null
),

parent as (
    select employer_name as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:39:23.430836 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:23.577643 [info ] [Thread-1 (]: 18 of 29 PASS not_null_Wage_Summary_job_title .................................. [[32mPASS[0m in 0.63s]
[0m19:39:23.579013 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m19:39:23.579721 [debug] [Thread-1 (]: Began running node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m19:39:23.580491 [info ] [Thread-1 (]: 20 of 29 START test relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_  [RUN]
[0m19:39:23.581288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417, now test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531)
[0m19:39:23.581903 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m19:39:23.590329 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"
[0m19:39:23.591166 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m19:39:23.595248 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"
[0m19:39:23.596188 [debug] [Thread-1 (]: On test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select decision_date as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    where decision_date is not null
),

parent as (
    select publication_date as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:39:23.596908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:23.668990 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e11138d0-9d73-44ef-8bd9-57e4ce65ee63&page=queryresults
[0m19:39:23.914495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7f6544de-e06d-48dc-b425-4fd64b71bdb6&page=queryresults
[0m19:39:24.021670 [error] [Thread-2 (]: 19 of 29 FAIL 26520 relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [[31mFAIL 26520[0m in 0.61s]
[0m19:39:24.023116 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m19:39:24.023815 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m19:39:24.024670 [info ] [Thread-2 (]: 21 of 29 START test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [RUN]
[0m19:39:24.025611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6, now test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46)
[0m19:39:24.026258 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m19:39:24.034673 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m19:39:24.037853 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m19:39:24.041558 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m19:39:24.042648 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select case_number as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
    where case_number is not null
),

parent as (
    select case_number as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:39:24.043582 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:24.236339 [error] [Thread-1 (]: 20 of 29 FAIL 548660 relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_  [[31mFAIL 548660[0m in 0.65s]
[0m19:39:24.237645 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m19:39:24.238438 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m19:39:24.239318 [info ] [Thread-1 (]: 22 of 29 START test unique_Company_Data_employer_name .......................... [RUN]
[0m19:39:24.240114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531, now test.cs329e_xh.unique_Company_Data_employer_name.69805b71db)
[0m19:39:24.240736 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m19:39:24.251828 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m19:39:24.252660 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m19:39:24.256032 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m19:39:24.256908 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Company_Data_employer_name.69805b71db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
  where employer_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:39:24.257603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:24.304946 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:61193c65-d99e-4103-a691-1cfd3ddaad5a&page=queryresults
[0m19:39:24.519543 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:794b4bbe-c85e-4f07-8397-145c74859088&page=queryresults
[0m19:39:24.619260 [error] [Thread-2 (]: 21 of 29 FAIL 14201 relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [[31mFAIL 14201[0m in 0.59s]
[0m19:39:24.620628 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m19:39:24.621340 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m19:39:24.622129 [info ] [Thread-2 (]: 23 of 29 START test unique_Employer_Detail_fein ................................ [RUN]
[0m19:39:24.623078 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46, now test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756)
[0m19:39:24.623687 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m19:39:24.629767 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756"
[0m19:39:24.630606 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m19:39:24.634024 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756"
[0m19:39:24.634906 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fein as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
  where fein is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:39:24.635601 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:24.821548 [info ] [Thread-1 (]: 22 of 29 PASS unique_Company_Data_employer_name ................................ [[32mPASS[0m in 0.58s]
[0m19:39:24.822827 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m19:39:24.823552 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m19:39:24.824435 [info ] [Thread-1 (]: 24 of 29 START test unique_LCA_Worksites_row_id ................................ [RUN]
[0m19:39:24.825457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Company_Data_employer_name.69805b71db, now test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef)
[0m19:39:24.826109 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m19:39:24.832066 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m19:39:24.832878 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m19:39:24.836513 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m19:39:24.837375 [debug] [Thread-1 (]: On test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select row_id as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
  where row_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:39:24.838039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:24.965824 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d07243c3-c778-4366-8381-b6d4a2331d54&page=queryresults
[0m19:39:25.072248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e66eae48-8fa9-4252-abd2-9792140acd1d&page=queryresults
[0m19:39:25.280499 [info ] [Thread-2 (]: 23 of 29 PASS unique_Employer_Detail_fein ...................................... [[32mPASS[0m in 0.66s]
[0m19:39:25.281795 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m19:39:25.285689 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m19:39:25.286484 [info ] [Thread-2 (]: 25 of 29 START test unique_Sentiment_Analysis_publication_date ................. [RUN]
[0m19:39:25.287283 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756, now test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e)
[0m19:39:25.287886 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m19:39:25.296093 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m19:39:25.297139 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m19:39:25.300716 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m19:39:25.301643 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select publication_date as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
  where publication_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:39:25.302547 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:25.391030 [info ] [Thread-1 (]: 24 of 29 PASS unique_LCA_Worksites_row_id ...................................... [[32mPASS[0m in 0.57s]
[0m19:39:25.392289 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m19:39:25.392975 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m19:39:25.393750 [info ] [Thread-1 (]: 26 of 29 START test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [RUN]
[0m19:39:25.394648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef, now test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557)
[0m19:39:25.395252 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m19:39:25.402512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:25.405008 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:25.405792 [error] [Thread-1 (]: 26 of 29 ERROR unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [[31mERROR[0m in 0.01s]
[0m19:39:25.406760 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m19:39:25.407417 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m19:39:25.408474 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:39:25.409174 [info ] [Thread-1 (]: 27 of 29 START test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [RUN]
[0m19:39:25.410894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557, now test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4)
[0m19:39:25.411511 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m19:39:25.417476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:25.419169 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:25.419942 [error] [Thread-1 (]: 27 of 29 ERROR unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [[31mERROR[0m in 0.01s]
[0m19:39:25.420823 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m19:39:25.421482 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m19:39:25.422209 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:39:25.422923 [info ] [Thread-1 (]: 28 of 29 START test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [RUN]
[0m19:39:25.423958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4, now test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d)
[0m19:39:25.424580 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m19:39:25.433923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:25.435377 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:25.436144 [error] [Thread-1 (]: 28 of 29 ERROR unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [[31mERROR[0m in 0.01s]
[0m19:39:25.437005 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m19:39:25.437644 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m19:39:25.438369 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:39:25.439040 [info ] [Thread-1 (]: 29 of 29 START test unique_combination_of_columns_Wage_Summary_company_name__job_title  [RUN]
[0m19:39:25.440049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d, now test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194)
[0m19:39:25.440651 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m19:39:25.448082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:25.449460 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:25.450249 [error] [Thread-1 (]: 29 of 29 ERROR unique_combination_of_columns_Wage_Summary_company_name__job_title  [[31mERROR[0m in 0.01s]
[0m19:39:25.451106 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m19:39:25.451859 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:39:25.598954 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c85d1039-f452-4786-80d0-adbfcf7d9c8e&page=queryresults
[0m19:39:25.904712 [info ] [Thread-2 (]: 25 of 29 PASS unique_Sentiment_Analysis_publication_date ....................... [[32mPASS[0m in 0.62s]
[0m19:39:25.906060 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m19:39:25.908148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:25.909114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:25.909648 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' was properly closed.
[0m19:39:25.910130 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e' was properly closed.
[0m19:39:25.910792 [info ] [MainThread]: 
[0m19:39:25.911375 [info ] [MainThread]: Finished running 29 data tests in 0 hours 0 minutes and 9.40 seconds (9.40s).
[0m19:39:25.917490 [debug] [MainThread]: Command end result
[0m19:39:25.983081 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:39:25.985200 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:39:25.996762 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m19:39:25.997293 [info ] [MainThread]: 
[0m19:39:25.997941 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m19:39:25.998694 [info ] [MainThread]: 
[0m19:39:25.999388 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_agent_first_name (models/int/schema.yml)[0m
[0m19:39:26.000058 [error] [MainThread]:   Got 49 results, configured to fail if != 0
[0m19:39:26.000592 [info ] [MainThread]: 
[0m19:39:26.001243 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_agent_first_name.sql
[0m19:39:26.001791 [info ] [MainThread]: 
[0m19:39:26.002576 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_agent_last_name (models/int/schema.yml)[0m
[0m19:39:26.003258 [error] [MainThread]:   Got 140 results, configured to fail if != 0
[0m19:39:26.003787 [info ] [MainThread]: 
[0m19:39:26.004445 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_agent_last_name.sql
[0m19:39:26.004986 [info ] [MainThread]: 
[0m19:39:26.005615 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_employer_name (models/int/schema.yml)[0m
[0m19:39:26.006223 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:39:26.006731 [info ] [MainThread]: 
[0m19:39:26.007296 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_employer_name.sql
[0m19:39:26.007800 [info ] [MainThread]: 
[0m19:39:26.008391 [error] [MainThread]: [31mFailure in test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_ (models/int/Employer_Details/schema.yml)[0m
[0m19:39:26.008962 [error] [MainThread]:   Got 26520 results, configured to fail if != 0
[0m19:39:26.009433 [info ] [MainThread]: 
[0m19:39:26.009993 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/relationships_Employer_Detail_a803ce1d5c10b4dae7e1dc33e0f1a09b.sql
[0m19:39:26.010550 [info ] [MainThread]: 
[0m19:39:26.011138 [error] [MainThread]: [31mFailure in test relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_ (models/int/schema.yml)[0m
[0m19:39:26.011715 [error] [MainThread]:   Got 548660 results, configured to fail if != 0
[0m19:39:26.012179 [info ] [MainThread]: 
[0m19:39:26.012740 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Disclosure_5b656fbbb20356ebf0977db6de7595b5.sql
[0m19:39:26.013223 [info ] [MainThread]: 
[0m19:39:26.013803 [error] [MainThread]: [31mFailure in test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_ (models/int/schema.yml)[0m
[0m19:39:26.014423 [error] [MainThread]:   Got 14201 results, configured to fail if != 0
[0m19:39:26.014900 [info ] [MainThread]: 
[0m19:39:26.015464 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Worksites_a871b7806445a97e6fda9420f0740807.sql
[0m19:39:26.016133 [info ] [MainThread]: 
[0m19:39:26.016900 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:26.017559 [info ] [MainThread]: 
[0m19:39:26.018404 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:26.019068 [info ] [MainThread]: 
[0m19:39:26.019813 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:26.020472 [info ] [MainThread]: 
[0m19:39:26.021228 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:39:26.021913 [info ] [MainThread]: 
[0m19:39:26.022679 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=10 SKIP=0 TOTAL=29
[0m19:39:26.023681 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 11.989072, "process_in_blocks": "0", "process_kernel_time": 0.496008, "process_mem_max_rss": "268116", "process_out_blocks": "4048", "process_user_time": 5.339952}
[0m19:39:26.024329 [debug] [MainThread]: Command `dbt test` failed at 19:39:26.024193 after 11.99 seconds
[0m19:39:26.024944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd795da15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd795c4a5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76abf69b0>]}
[0m19:39:26.025569 [debug] [MainThread]: Flushing usage events
[0m19:39:26.420993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:13.060297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcead2655d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceac3fe3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceac3fe380>]}


============================== 19:57:13.063862 | 9bd316ec-52cd-41f8-92b1-eb5d9edf7eaf ==============================
[0m19:57:13.063862 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:57:13.064873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/int/employer_detail.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:14.698278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bd316ec-52cd-41f8-92b1-eb5d9edf7eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceae5daef0>]}
[0m19:57:14.781166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bd316ec-52cd-41f8-92b1-eb5d9edf7eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceae69f520>]}
[0m19:57:14.782222 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:57:14.953539 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:57:15.182750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:57:15.183397 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:57:15.281182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd316ec-52cd-41f8-92b1-eb5d9edf7eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce91279c90>]}
[0m19:57:15.458107 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:57:15.460640 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:57:15.484434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd316ec-52cd-41f8-92b1-eb5d9edf7eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce91280790>]}
[0m19:57:15.485298 [info ] [MainThread]: Found 54 models, 1 seed, 29 data tests, 19 sources, 492 macros
[0m19:57:15.486011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd316ec-52cd-41f8-92b1-eb5d9edf7eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce912af760>]}
[0m19:57:15.489637 [warn ] [MainThread]: The selection criterion 'models/int/employer_detail.sql' does not match any enabled nodes
[0m19:57:15.491757 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:57:15.494547 [debug] [MainThread]: Command end result
[0m19:57:15.554823 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:57:15.557011 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:57:15.561477 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m19:57:15.562339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5791996, "process_in_blocks": "0", "process_kernel_time": 0.48857, "process_mem_max_rss": "256048", "process_out_blocks": "3432", "process_user_time": 4.15364}
[0m19:57:15.563014 [debug] [MainThread]: Command `dbt run` succeeded at 19:57:15.562876 after 2.58 seconds
[0m19:57:15.563603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcead2655d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceae5daef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce91206d40>]}
[0m19:57:15.564192 [debug] [MainThread]: Flushing usage events
[0m19:57:15.910565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:26.281743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b422515d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b413d65c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b413d6560>]}


============================== 19:57:26.285240 | 2519ce35-e0d6-420c-aab7-28d482bd8bed ==============================
[0m19:57:26.285240 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:57:26.286129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select models/int/', 'send_anonymous_usage_stats': 'True'}
[0m19:57:27.877011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2519ce35-e0d6-420c-aab7-28d482bd8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b4195cd00>]}
[0m19:57:27.958495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2519ce35-e0d6-420c-aab7-28d482bd8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b417914b0>]}
[0m19:57:27.959481 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:57:28.129486 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:57:28.356020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:57:28.356693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:57:28.454656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2519ce35-e0d6-420c-aab7-28d482bd8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b2606dea0>]}
[0m19:57:28.630542 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:57:28.633019 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:57:28.669483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2519ce35-e0d6-420c-aab7-28d482bd8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b26098a60>]}
[0m19:57:28.670314 [info ] [MainThread]: Found 54 models, 1 seed, 29 data tests, 19 sources, 492 macros
[0m19:57:28.670967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2519ce35-e0d6-420c-aab7-28d482bd8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b26ecc9a0>]}
[0m19:57:28.677271 [info ] [MainThread]: 
[0m19:57:28.677908 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:57:28.678551 [info ] [MainThread]: 
[0m19:57:28.679379 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:57:28.690017 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m19:57:28.691010 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt'
[0m19:57:28.691640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:28.692482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:28.860500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m19:57:28.861496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m19:57:28.867267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:28.867910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:29.007465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2519ce35-e0d6-420c-aab7-28d482bd8bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b43797a00>]}
[0m19:57:29.008336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:29.012476 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m19:57:29.013122 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m19:57:29.013854 [info ] [Thread-1 (]: 1 of 29 START test not_null_Company_Data_employer_name ......................... [RUN]
[0m19:57:29.015597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b)
[0m19:57:29.014892 [info ] [Thread-2 (]: 2 of 29 START test not_null_Employer_Detail_employer_petitioner_name ........... [RUN]
[0m19:57:29.016454 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m19:57:29.017279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227)
[0m19:57:29.038206 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m19:57:29.044878 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m19:57:29.050605 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m19:57:29.051647 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m19:57:29.052286 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m19:57:29.099221 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m19:57:29.100116 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m19:57:29.101263 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
where employer_name is null



      
    ) dbt_internal_test
[0m19:57:29.102040 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_petitioner_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where employer_petitioner_name is null



      
    ) dbt_internal_test
[0m19:57:29.102773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:29.103454 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:29.458263 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:27a42d62-b163-42da-a5e2-2ee2c38a7a5e&page=queryresults
[0m19:57:29.608392 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5b4ce0f5-50ed-4b59-8711-7ebd2f9aeaba&page=queryresults
[0m19:57:29.917724 [info ] [Thread-1 (]: 1 of 29 PASS not_null_Company_Data_employer_name ............................... [[32mPASS[0m in 0.90s]
[0m19:57:29.919090 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m19:57:29.919783 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m19:57:29.920653 [info ] [Thread-1 (]: 3 of 29 START test not_null_Employer_Detail_fein ............................... [RUN]
[0m19:57:29.921487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b, now test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e)
[0m19:57:29.922133 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m19:57:29.928965 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e"
[0m19:57:29.929806 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m19:57:29.933344 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e"
[0m19:57:29.934299 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fein
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where fein is null



      
    ) dbt_internal_test
[0m19:57:29.935037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:29.983494 [info ] [Thread-2 (]: 2 of 29 PASS not_null_Employer_Detail_employer_petitioner_name ................. [[32mPASS[0m in 0.97s]
[0m19:57:29.984656 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m19:57:29.985362 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m19:57:29.986123 [info ] [Thread-2 (]: 4 of 29 START test not_null_LCA_Appendix_appx_a_date_of_degree ................. [RUN]
[0m19:57:29.987014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227, now test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155)
[0m19:57:29.987620 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m19:57:29.993330 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m19:57:29.994128 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m19:57:29.997693 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m19:57:29.998572 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appx_a_date_of_degree
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where appx_a_date_of_degree is null



      
    ) dbt_internal_test
[0m19:57:29.999259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:30.280496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7566e89f-97c6-49c0-900a-e04b8845f9aa&page=queryresults
[0m19:57:30.333637 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aed9406d-1662-4fb9-8e3b-4c822aaa8869&page=queryresults
[0m19:57:30.610671 [info ] [Thread-1 (]: 3 of 29 PASS not_null_Employer_Detail_fein ..................................... [[32mPASS[0m in 0.69s]
[0m19:57:30.611875 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e
[0m19:57:30.612573 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m19:57:30.613328 [info ] [Thread-1 (]: 5 of 29 START test not_null_LCA_Appendix_case_number ........................... [RUN]
[0m19:57:30.614080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_fein.5a6c2d872e, now test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b)
[0m19:57:30.614732 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m19:57:30.620812 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m19:57:30.621635 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m19:57:30.625081 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m19:57:30.625929 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where case_number is null



      
    ) dbt_internal_test
[0m19:57:30.626613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:30.691419 [info ] [Thread-2 (]: 4 of 29 PASS not_null_LCA_Appendix_appx_a_date_of_degree ....................... [[32mPASS[0m in 0.70s]
[0m19:57:30.692454 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m19:57:30.693132 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m19:57:30.693867 [info ] [Thread-2 (]: 6 of 29 START test not_null_LCA_Disclosure_case_number ......................... [RUN]
[0m19:57:30.694753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155, now test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39)
[0m19:57:30.695364 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m19:57:30.702723 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m19:57:30.703523 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m19:57:30.706750 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m19:57:30.707594 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where case_number is null



      
    ) dbt_internal_test
[0m19:57:30.708259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:30.935251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2eed6544-783b-4364-b092-08fa1abac2e2&page=queryresults
[0m19:57:31.030029 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aad6ae42-9f5e-400c-ac0e-243f60f9fbd1&page=queryresults
[0m19:57:31.359437 [info ] [Thread-1 (]: 5 of 29 PASS not_null_LCA_Appendix_case_number ................................. [[32mPASS[0m in 0.75s]
[0m19:57:31.360705 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m19:57:31.361498 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m19:57:31.362645 [info ] [Thread-1 (]: 7 of 29 START test not_null_LCA_Disclosure_decision_date ....................... [RUN]
[0m19:57:31.363491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b, now test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7)
[0m19:57:31.364122 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m19:57:31.370325 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"
[0m19:57:31.371208 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m19:57:31.374534 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"
[0m19:57:31.377216 [info ] [Thread-2 (]: 6 of 29 PASS not_null_LCA_Disclosure_case_number ............................... [[32mPASS[0m in 0.68s]
[0m19:57:31.378412 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m19:57:31.379161 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m19:57:31.379902 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select decision_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where decision_date is null



      
    ) dbt_internal_test
[0m19:57:31.380748 [info ] [Thread-2 (]: 8 of 29 START test not_null_LCA_Disclosure_employer_name ....................... [RUN]
[0m19:57:31.381597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:31.382385 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39, now test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2)
[0m19:57:31.384890 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m19:57:31.390848 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m19:57:31.392002 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m19:57:31.395508 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m19:57:31.396614 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where employer_name is null



      
    ) dbt_internal_test
[0m19:57:31.397601 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:31.676968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:60d4aee0-1a6d-410c-93c9-518cdf44a713&page=queryresults
[0m19:57:31.722998 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:47332428-bc31-4fed-a11c-7df16a732232&page=queryresults
[0m19:57:32.009619 [info ] [Thread-1 (]: 7 of 29 PASS not_null_LCA_Disclosure_decision_date ............................. [[32mPASS[0m in 0.65s]
[0m19:57:32.010918 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m19:57:32.011608 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m19:57:32.012372 [info ] [Thread-1 (]: 9 of 29 START test not_null_LCA_Worksites_row_id ............................... [RUN]
[0m19:57:32.013139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7, now test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8)
[0m19:57:32.013736 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m19:57:32.020005 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m19:57:32.020818 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m19:57:32.025943 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m19:57:32.026848 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
where row_id is null



      
    ) dbt_internal_test
[0m19:57:32.027531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:32.059781 [info ] [Thread-2 (]: 8 of 29 PASS not_null_LCA_Disclosure_employer_name ............................. [[32mPASS[0m in 0.68s]
[0m19:57:32.060838 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m19:57:32.061523 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m19:57:32.062304 [info ] [Thread-2 (]: 10 of 29 START test not_null_Sentiment_Analysis_publication_date ............... [RUN]
[0m19:57:32.063146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2, now test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8)
[0m19:57:32.063745 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m19:57:32.069507 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m19:57:32.070324 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m19:57:32.073590 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m19:57:32.074450 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select publication_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
where publication_date is null



      
    ) dbt_internal_test
[0m19:57:32.075080 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:32.343042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ba97729f-c7f8-4806-a0c8-a35e83bebed7&page=queryresults
[0m19:57:32.346530 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7df098ed-e6dd-47e8-9726-1ae0cc5b4749&page=queryresults
[0m19:57:32.673684 [info ] [Thread-1 (]: 9 of 29 PASS not_null_LCA_Worksites_row_id ..................................... [[32mPASS[0m in 0.66s]
[0m19:57:32.675030 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m19:57:32.675721 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m19:57:32.676474 [info ] [Thread-1 (]: 11 of 29 START test not_null_Single_Registration_agent_first_name .............. [RUN]
[0m19:57:32.677348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8, now test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3)
[0m19:57:32.677955 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m19:57:32.683939 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m19:57:32.685346 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m19:57:32.689665 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m19:57:32.690620 [info ] [Thread-2 (]: 10 of 29 PASS not_null_Sentiment_Analysis_publication_date ..................... [[32mPASS[0m in 0.63s]
[0m19:57:32.691901 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m19:57:32.692690 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m19:57:32.693520 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_first_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_first_name is null



      
    ) dbt_internal_test
[0m19:57:32.694321 [info ] [Thread-2 (]: 12 of 29 START test not_null_Single_Registration_agent_last_name ............... [RUN]
[0m19:57:32.695281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:32.696001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8, now test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c)
[0m19:57:32.698340 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m19:57:32.703831 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m19:57:32.704828 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m19:57:32.709777 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m19:57:32.710792 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_last_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_last_name is null



      
    ) dbt_internal_test
[0m19:57:32.711476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:33.011426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5fec92be-af3f-44df-8bfd-b25f45b5349d&page=queryresults
[0m19:57:33.026043 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:319abbf7-a467-4fe9-9aa9-6f075c68364f&page=queryresults
[0m19:57:33.348471 [error] [Thread-2 (]: 12 of 29 FAIL 140 not_null_Single_Registration_agent_last_name ................. [[31mFAIL 140[0m in 0.65s]
[0m19:57:33.349864 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m19:57:33.350596 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m19:57:33.351424 [info ] [Thread-2 (]: 13 of 29 START test not_null_Single_Registration_ben_year_of_birth ............. [RUN]
[0m19:57:33.352359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c, now test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f)
[0m19:57:33.352956 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m19:57:33.359227 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m19:57:33.360054 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m19:57:33.363464 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m19:57:33.364322 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ben_year_of_birth
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where ben_year_of_birth is null



      
    ) dbt_internal_test
[0m19:57:33.364998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:33.419958 [error] [Thread-1 (]: 11 of 29 FAIL 49 not_null_Single_Registration_agent_first_name ................. [[31mFAIL 49[0m in 0.74s]
[0m19:57:33.421014 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m19:57:33.421685 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m19:57:33.422461 [info ] [Thread-1 (]: 14 of 29 START test not_null_Single_Registration_employer_name ................. [RUN]
[0m19:57:33.423241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3, now test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49)
[0m19:57:33.423853 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m19:57:33.429630 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m19:57:33.430462 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m19:57:33.433667 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m19:57:33.434543 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where employer_name is null



      
    ) dbt_internal_test
[0m19:57:33.435213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:33.675883 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fd8912f2-3ae1-42fe-aca0-8236b68a27de&page=queryresults
[0m19:57:33.760325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d3a7976b-16ba-4de7-a66e-9752ede90ea8&page=queryresults
[0m19:57:34.001300 [info ] [Thread-2 (]: 13 of 29 PASS not_null_Single_Registration_ben_year_of_birth ................... [[32mPASS[0m in 0.65s]
[0m19:57:34.002662 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m19:57:34.003353 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m19:57:34.004112 [info ] [Thread-2 (]: 15 of 29 START test not_null_Single_Registration_gender ........................ [RUN]
[0m19:57:34.005014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f, now test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23)
[0m19:57:34.005628 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m19:57:34.011720 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m19:57:34.012530 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m19:57:34.017447 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m19:57:34.018312 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gender
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where gender is null



      
    ) dbt_internal_test
[0m19:57:34.018967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:34.138018 [error] [Thread-1 (]: 14 of 29 FAIL 1 not_null_Single_Registration_employer_name ..................... [[31mFAIL 1[0m in 0.71s]
[0m19:57:34.139516 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m19:57:34.140266 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m19:57:34.141034 [info ] [Thread-1 (]: 16 of 29 START test not_null_Single_Registration_mail_addr ..................... [RUN]
[0m19:57:34.142391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49, now test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3)
[0m19:57:34.143064 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m19:57:34.149125 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m19:57:34.149942 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m19:57:34.153157 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m19:57:34.154012 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mail_addr
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where mail_addr is null



      
    ) dbt_internal_test
[0m19:57:34.154722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:34.466394 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8bb03c2c-9e50-443d-b827-9d2f1a2d6029&page=queryresults
[0m19:57:34.485596 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e719c64d-b916-446d-bc8a-e1ded83f6f60&page=queryresults
[0m19:57:34.782865 [info ] [Thread-1 (]: 16 of 29 PASS not_null_Single_Registration_mail_addr ........................... [[32mPASS[0m in 0.64s]
[0m19:57:34.784174 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m19:57:34.784866 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m19:57:34.785524 [info ] [Thread-1 (]: 17 of 29 START test not_null_Wage_Summary_company_name ......................... [RUN]
[0m19:57:34.786524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3, now test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5)
[0m19:57:34.787113 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m19:57:34.793119 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m19:57:34.793935 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m19:57:34.797151 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m19:57:34.797990 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where company_name is null



      
    ) dbt_internal_test
[0m19:57:34.798650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:34.843970 [info ] [Thread-2 (]: 15 of 29 PASS not_null_Single_Registration_gender .............................. [[32mPASS[0m in 0.84s]
[0m19:57:34.845097 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m19:57:34.845762 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m19:57:34.846526 [info ] [Thread-2 (]: 18 of 29 START test not_null_Wage_Summary_job_title ............................ [RUN]
[0m19:57:34.847356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23, now test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417)
[0m19:57:34.847942 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m19:57:34.853821 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m19:57:34.854646 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m19:57:34.857798 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m19:57:34.858645 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where job_title is null



      
    ) dbt_internal_test
[0m19:57:34.859303 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:35.067712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cc7c53ef-1c0b-4695-99cd-fb446db2397b&page=queryresults
[0m19:57:35.166064 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2695cb3c-5e38-43d2-9153-8b7cba498a52&page=queryresults
[0m19:57:35.416906 [info ] [Thread-1 (]: 17 of 29 PASS not_null_Wage_Summary_company_name ............................... [[32mPASS[0m in 0.63s]
[0m19:57:35.418271 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m19:57:35.418962 [debug] [Thread-1 (]: Began running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m19:57:35.419732 [info ] [Thread-1 (]: 19 of 29 START test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [RUN]
[0m19:57:35.420642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5, now test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6)
[0m19:57:35.421277 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m19:57:35.432981 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m19:57:35.433829 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m19:57:35.437394 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m19:57:35.438289 [debug] [Thread-1 (]: On test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select employer_petitioner_name as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
    where employer_petitioner_name is not null
),

parent as (
    select employer_name as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:57:35.438951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:35.503217 [info ] [Thread-2 (]: 18 of 29 PASS not_null_Wage_Summary_job_title .................................. [[32mPASS[0m in 0.66s]
[0m19:57:35.504569 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m19:57:35.505411 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m19:57:35.506252 [info ] [Thread-2 (]: 20 of 29 START test relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_  [RUN]
[0m19:57:35.507139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417, now test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531)
[0m19:57:35.507756 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m19:57:35.515635 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"
[0m19:57:35.516546 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m19:57:35.519851 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"
[0m19:57:35.520766 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select decision_date as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    where decision_date is not null
),

parent as (
    select publication_date as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:57:35.521460 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:35.812510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:99380a38-6e3b-4786-b892-e3c311c82f70&page=queryresults
[0m19:57:35.830122 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:58b9172a-9ae2-4daa-bfbb-42abe97e493e&page=queryresults
[0m19:57:36.130134 [error] [Thread-2 (]: 20 of 29 FAIL 548660 relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_  [[31mFAIL 548660[0m in 0.62s]
[0m19:57:36.131580 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m19:57:36.132281 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m19:57:36.133042 [info ] [Thread-2 (]: 21 of 29 START test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [RUN]
[0m19:57:36.133917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531, now test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46)
[0m19:57:36.134591 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m19:57:36.142771 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m19:57:36.145293 [error] [Thread-1 (]: 19 of 29 FAIL 26520 relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [[31mFAIL 26520[0m in 0.72s]
[0m19:57:36.146102 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m19:57:36.147333 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m19:57:36.150904 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m19:57:36.151655 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m19:57:36.152643 [info ] [Thread-1 (]: 22 of 29 START test unique_Company_Data_employer_name .......................... [RUN]
[0m19:57:36.153419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6, now test.cs329e_xh.unique_Company_Data_employer_name.69805b71db)
[0m19:57:36.154185 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select case_number as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
    where case_number is not null
),

parent as (
    select case_number as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:57:36.154875 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m19:57:36.155581 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:36.165983 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m19:57:36.168521 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m19:57:36.172144 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m19:57:36.173329 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Company_Data_employer_name.69805b71db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
  where employer_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:57:36.174066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:36.488140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:85add557-671c-4c00-ae66-31011a3d3793&page=queryresults
[0m19:57:36.516873 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:232cd70a-5159-496a-931f-4c56957dcf8f&page=queryresults
[0m19:57:36.834629 [info ] [Thread-1 (]: 22 of 29 PASS unique_Company_Data_employer_name ................................ [[32mPASS[0m in 0.68s]
[0m19:57:36.836868 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m19:57:36.837955 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m19:57:36.839190 [info ] [Thread-1 (]: 23 of 29 START test unique_Employer_Detail_fein ................................ [RUN]
[0m19:57:36.840359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Company_Data_employer_name.69805b71db, now test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756)
[0m19:57:36.841327 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m19:57:36.851027 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756"
[0m19:57:36.855144 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m19:57:36.854501 [error] [Thread-2 (]: 21 of 29 FAIL 14201 relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [[31mFAIL 14201[0m in 0.72s]
[0m19:57:36.861666 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756"
[0m19:57:36.862933 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m19:57:36.863904 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m19:57:36.864771 [info ] [Thread-2 (]: 24 of 29 START test unique_LCA_Worksites_row_id ................................ [RUN]
[0m19:57:36.865689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46, now test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef)
[0m19:57:36.866692 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m19:57:36.872451 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m19:57:36.873179 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fein as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
  where fein is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:57:36.874060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:36.876404 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m19:57:36.880949 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m19:57:36.882263 [debug] [Thread-2 (]: On test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select row_id as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
  where row_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:57:36.883004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:37.177464 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:83ad97aa-9020-4812-8ce0-c78df622b656&page=queryresults
[0m19:57:37.202869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:da9a2a6f-e180-4ed1-a744-a194a3257724&page=queryresults
[0m19:57:37.500651 [info ] [Thread-1 (]: 23 of 29 PASS unique_Employer_Detail_fein ...................................... [[32mPASS[0m in 0.66s]
[0m19:57:37.501935 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756
[0m19:57:37.502780 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m19:57:37.503658 [info ] [Thread-1 (]: 25 of 29 START test unique_Sentiment_Analysis_publication_date ................. [RUN]
[0m19:57:37.504501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Employer_Detail_fein.5cc5b6b756, now test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e)
[0m19:57:37.505182 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m19:57:37.513254 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m19:57:37.517306 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m19:57:37.516626 [info ] [Thread-2 (]: 24 of 29 PASS unique_LCA_Worksites_row_id ...................................... [[32mPASS[0m in 0.65s]
[0m19:57:37.521269 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m19:57:37.522506 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m19:57:37.523762 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m19:57:37.524967 [info ] [Thread-2 (]: 26 of 29 START test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [RUN]
[0m19:57:37.526426 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select publication_date as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
  where publication_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:57:37.527279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef, now test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557)
[0m19:57:37.528246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:37.528998 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m19:57:37.540551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:37.543428 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:57:37.544416 [error] [Thread-2 (]: 26 of 29 ERROR unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [[31mERROR[0m in 0.02s]
[0m19:57:37.546238 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m19:57:37.546971 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m19:57:37.548053 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:57:37.549122 [info ] [Thread-2 (]: 27 of 29 START test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [RUN]
[0m19:57:37.551191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557, now test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4)
[0m19:57:37.552181 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m19:57:37.561608 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:37.563905 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:57:37.565146 [error] [Thread-2 (]: 27 of 29 ERROR unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [[31mERROR[0m in 0.01s]
[0m19:57:37.566454 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m19:57:37.567482 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m19:57:37.568438 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:57:37.569306 [info ] [Thread-2 (]: 28 of 29 START test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [RUN]
[0m19:57:37.570725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4, now test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d)
[0m19:57:37.571716 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m19:57:37.586638 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:37.589196 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:57:37.590458 [error] [Thread-2 (]: 28 of 29 ERROR unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [[31mERROR[0m in 0.02s]
[0m19:57:37.591787 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m19:57:37.592831 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m19:57:37.593859 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:57:37.594643 [info ] [Thread-2 (]: 29 of 29 START test unique_combination_of_columns_Wage_Summary_company_name__job_title  [RUN]
[0m19:57:37.596036 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d, now test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194)
[0m19:57:37.597006 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m19:57:37.610767 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:37.613016 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:57:37.614247 [error] [Thread-2 (]: 29 of 29 ERROR unique_combination_of_columns_Wage_Summary_company_name__job_title  [[31mERROR[0m in 0.02s]
[0m19:57:37.615504 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m19:57:37.616534 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:57:37.808352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:34a8c74a-2fb3-4660-a214-1e3430484bb8&page=queryresults
[0m19:57:38.144033 [info ] [Thread-1 (]: 25 of 29 PASS unique_Sentiment_Analysis_publication_date ....................... [[32mPASS[0m in 0.64s]
[0m19:57:38.145334 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m19:57:38.147535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:57:38.148513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:38.149024 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' was properly closed.
[0m19:57:38.149512 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e' was properly closed.
[0m19:57:38.150083 [info ] [MainThread]: 
[0m19:57:38.150716 [info ] [MainThread]: Finished running 29 data tests in 0 hours 0 minutes and 9.47 seconds (9.47s).
[0m19:57:38.156932 [debug] [MainThread]: Command end result
[0m19:57:38.221477 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:57:38.223942 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:57:38.236076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m19:57:38.236697 [info ] [MainThread]: 
[0m19:57:38.237371 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m19:57:38.238118 [info ] [MainThread]: 
[0m19:57:38.238930 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_agent_last_name (models/int/schema.yml)[0m
[0m19:57:38.239658 [error] [MainThread]:   Got 140 results, configured to fail if != 0
[0m19:57:38.240274 [info ] [MainThread]: 
[0m19:57:38.240976 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_agent_last_name.sql
[0m19:57:38.241564 [info ] [MainThread]: 
[0m19:57:38.242260 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_agent_first_name (models/int/schema.yml)[0m
[0m19:57:38.242923 [error] [MainThread]:   Got 49 results, configured to fail if != 0
[0m19:57:38.243488 [info ] [MainThread]: 
[0m19:57:38.244129 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_agent_first_name.sql
[0m19:57:38.244794 [info ] [MainThread]: 
[0m19:57:38.245620 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_employer_name (models/int/schema.yml)[0m
[0m19:57:38.246542 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:57:38.247245 [info ] [MainThread]: 
[0m19:57:38.247955 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_employer_name.sql
[0m19:57:38.248603 [info ] [MainThread]: 
[0m19:57:38.249340 [error] [MainThread]: [31mFailure in test relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_ (models/int/schema.yml)[0m
[0m19:57:38.250060 [error] [MainThread]:   Got 548660 results, configured to fail if != 0
[0m19:57:38.250721 [info ] [MainThread]: 
[0m19:57:38.251440 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Disclosure_5b656fbbb20356ebf0977db6de7595b5.sql
[0m19:57:38.252178 [info ] [MainThread]: 
[0m19:57:38.253007 [error] [MainThread]: [31mFailure in test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_ (models/int/Employer_Details/schema.yml)[0m
[0m19:57:38.253809 [error] [MainThread]:   Got 26520 results, configured to fail if != 0
[0m19:57:38.254627 [info ] [MainThread]: 
[0m19:57:38.255558 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/relationships_Employer_Detail_a803ce1d5c10b4dae7e1dc33e0f1a09b.sql
[0m19:57:38.256269 [info ] [MainThread]: 
[0m19:57:38.257225 [error] [MainThread]: [31mFailure in test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_ (models/int/schema.yml)[0m
[0m19:57:38.258116 [error] [MainThread]:   Got 14201 results, configured to fail if != 0
[0m19:57:38.258782 [info ] [MainThread]: 
[0m19:57:38.259513 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Worksites_a871b7806445a97e6fda9420f0740807.sql
[0m19:57:38.260166 [info ] [MainThread]: 
[0m19:57:38.260901 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:57:38.261566 [info ] [MainThread]: 
[0m19:57:38.262406 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:57:38.263126 [info ] [MainThread]: 
[0m19:57:38.263877 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:57:38.264542 [info ] [MainThread]: 
[0m19:57:38.265302 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:57:38.265997 [info ] [MainThread]: 
[0m19:57:38.266732 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=10 SKIP=0 TOTAL=29
[0m19:57:38.267772 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 12.061925, "process_in_blocks": "0", "process_kernel_time": 0.477466, "process_mem_max_rss": "267944", "process_out_blocks": "4048", "process_user_time": 5.372012}
[0m19:57:38.268460 [debug] [MainThread]: Command `dbt test` failed at 19:57:38.268317 after 12.06 seconds
[0m19:57:38.269061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b422515d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b417bdc30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b417bdf90>]}
[0m19:57:38.269679 [debug] [MainThread]: Flushing usage events
[0m19:57:38.607562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:01.083576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77ff915a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77ef46410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77ef463b0>]}


============================== 19:59:01.087251 | 8fca60d2-cf8a-43a6-9e4b-cb1087ac0ea3 ==============================
[0m19:59:01.087251 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:59:01.088231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/int/Employer_Detail.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:59:02.717250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fca60d2-cf8a-43a6-9e4b-cb1087ac0ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77fe0cd90>]}
[0m19:59:02.800561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fca60d2-cf8a-43a6-9e4b-cb1087ac0ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77f651b40>]}
[0m19:59:02.801596 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:59:03.014690 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:59:03.252195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:03.252888 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:03.354708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fca60d2-cf8a-43a6-9e4b-cb1087ac0ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc763d9dbd0>]}
[0m19:59:03.532059 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:59:03.534535 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:59:03.557738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fca60d2-cf8a-43a6-9e4b-cb1087ac0ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc763da4f70>]}
[0m19:59:03.558604 [info ] [MainThread]: Found 54 models, 1 seed, 29 data tests, 19 sources, 492 macros
[0m19:59:03.559346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fca60d2-cf8a-43a6-9e4b-cb1087ac0ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc763db3730>]}
[0m19:59:03.563085 [warn ] [MainThread]: The selection criterion 'models/int/Employer_Detail.sql' does not match any enabled nodes
[0m19:59:03.565248 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:59:03.568295 [debug] [MainThread]: Command end result
[0m19:59:03.630403 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:59:03.632775 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:59:03.637244 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m19:59:03.638075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6312177, "process_in_blocks": "0", "process_kernel_time": 0.415941, "process_mem_max_rss": "256232", "process_out_blocks": "3432", "process_user_time": 4.135615}
[0m19:59:03.638781 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:03.638644 after 2.63 seconds
[0m19:59:03.639381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77ff915a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77fe0cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc763d47a00>]}
[0m19:59:03.640196 [debug] [MainThread]: Flushing usage events
[0m19:59:03.964218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:44.803789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df95455a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df86de410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df86de3b0>]}


============================== 19:59:44.807366 | 9c4b55fd-b26b-438b-9eef-9929ac808547 ==============================
[0m19:59:44.807366 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:59:44.808261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select Employer_Detail', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:59:46.409171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c4b55fd-b26b-438b-9eef-9929ac808547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8f21f00>]}
[0m19:59:46.493181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c4b55fd-b26b-438b-9eef-9929ac808547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8e253c0>]}
[0m19:59:46.494269 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:59:46.663373 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:59:46.893015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:46.893671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:46.991359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c4b55fd-b26b-438b-9eef-9929ac808547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddd555cc0>]}
[0m19:59:47.167765 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:59:47.170252 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:59:47.193091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c4b55fd-b26b-438b-9eef-9929ac808547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddd55c7f0>]}
[0m19:59:47.193897 [info ] [MainThread]: Found 54 models, 1 seed, 29 data tests, 19 sources, 492 macros
[0m19:59:47.194535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c4b55fd-b26b-438b-9eef-9929ac808547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddd56b790>]}
[0m19:59:47.197699 [info ] [MainThread]: 
[0m19:59:47.198357 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:59:47.198933 [info ] [MainThread]: 
[0m19:59:47.199738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:59:47.201064 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m19:59:47.201753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:47.438286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m19:59:47.439309 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m19:59:47.440099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:47.440714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:47.563204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m19:59:47.566585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:47.593871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m19:59:47.595004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:47.714271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c4b55fd-b26b-438b-9eef-9929ac808547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddd55f580>]}
[0m19:59:47.715089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:47.718482 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m19:59:47.719327 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_cs329e_xh_int.Employer_Detail ................. [RUN]
[0m19:59:47.720097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.Employer_Detail)
[0m19:59:47.720798 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Employer_Detail
[0m19:59:47.735136 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Employer_Detail"
[0m19:59:47.735976 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Employer_Detail
[0m19:59:47.756691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:47.933978 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m19:59:48.351658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:84f44ebe-1acc-452b-9347-fcd2e361acdf&page=queryresults
[0m19:59:48.502485 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        select
    
      
    cast(null as string)
 as fein, 
      
    cast(null as string)
 as employer_petitioner_name, 
      
    cast(null as int64)
 as employer_no, 
      
    cast(null as int64)
 as fiscal_year, 
      
    cast(null as string)
 as tax_id, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as petitioner_city, 
      
    cast(null as string)
 as petitioner_state, 
      
    cast(null as string)
 as petitioner_zip_code, 
      
    cast(null as string)
 as initial_approval, 
      
    cast(null as int64)
 as initial_denial, 
      
    cast(null as string)
 as continuing_approval, 
      
    cast(null as int64)
 as continuing_denial, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m19:59:48.842327 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:50208d62-1a11-4dc6-9fab-eadeb756a7f5&page=queryresults
[0m19:59:48.993894 [debug] [Thread-1 (]: Compilation Error in model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
[0m19:59:48.997287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c4b55fd-b26b-438b-9eef-9929ac808547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddd9e7af0>]}
[0m19:59:48.998402 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_cs329e_xh_int.Employer_Detail ........ [[31mERROR[0m in 1.27s]
[0m19:59:48.999626 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m19:59:49.000590 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.Employer_Detail' to be skipped because of status 'error'.  Reason: Compilation Error in model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql).
[0m19:59:49.003085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:49.004069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:49.004608 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int' was properly closed.
[0m19:59:49.005153 [debug] [MainThread]: Connection 'model.cs329e_xh.Employer_Detail' was properly closed.
[0m19:59:49.005687 [info ] [MainThread]: 
[0m19:59:49.006282 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m19:59:49.007395 [debug] [MainThread]: Command end result
[0m19:59:49.068886 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m19:59:49.071175 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m19:59:49.079510 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m19:59:49.080017 [info ] [MainThread]: 
[0m19:59:49.080644 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:59:49.081248 [info ] [MainThread]: 
[0m19:59:49.081997 [error] [MainThread]:   Compilation Error in model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
[0m19:59:49.082677 [info ] [MainThread]: 
[0m19:59:49.083462 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:59:49.084330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.3572736, "process_in_blocks": "184", "process_kernel_time": 0.409393, "process_mem_max_rss": "264232", "process_out_blocks": "3472", "process_user_time": 4.406966}
[0m19:59:49.085002 [debug] [MainThread]: Command `dbt run` failed at 19:59:49.084850 after 4.36 seconds
[0m19:59:49.085616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df95455a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddd4e2080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df9609d20>]}
[0m19:59:49.086245 [debug] [MainThread]: Flushing usage events
[0m19:59:49.457771 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:44.886427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54493854e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544833a2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544833a290>]}


============================== 20:01:44.889824 | 33e50298-22ef-436c-b0e9-358b428a8e94 ==============================
[0m20:01:44.889824 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:01:44.890807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select Employer_Detail', 'send_anonymous_usage_stats': 'True'}
[0m20:01:46.472368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e50298-22ef-436c-b0e9-358b428a8e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5448a1a6e0>]}
[0m20:01:46.555388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33e50298-22ef-436c-b0e9-358b428a8e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54485a4a00>]}
[0m20:01:46.556411 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:01:46.728776 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:01:46.958119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:46.958808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:47.057988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33e50298-22ef-436c-b0e9-358b428a8e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f542d1c9c00>]}
[0m20:01:47.233617 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:01:47.236039 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:01:47.259059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33e50298-22ef-436c-b0e9-358b428a8e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f542d1d0f70>]}
[0m20:01:47.259860 [info ] [MainThread]: Found 54 models, 1 seed, 29 data tests, 19 sources, 492 macros
[0m20:01:47.260563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e50298-22ef-436c-b0e9-358b428a8e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f542d1dfa30>]}
[0m20:01:47.263654 [info ] [MainThread]: 
[0m20:01:47.264371 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:01:47.265055 [info ] [MainThread]: 
[0m20:01:47.265965 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:01:47.267376 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:01:47.268061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:47.496449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m20:01:47.498044 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m20:01:47.498916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:47.499528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:47.633052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m20:01:47.635803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:47.723609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:01:47.727349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:47.860317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e50298-22ef-436c-b0e9-358b428a8e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544a8cdcc0>]}
[0m20:01:47.861128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:47.864048 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m20:01:47.864889 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_cs329e_xh_int.Employer_Detail ................. [RUN]
[0m20:01:47.865790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now model.cs329e_xh.Employer_Detail)
[0m20:01:47.866486 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Employer_Detail
[0m20:01:47.880553 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Employer_Detail"
[0m20:01:47.881372 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Employer_Detail
[0m20:01:47.901362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:48.075008 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:01:48.612584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:235ed1bb-3999-41c5-9165-b6e56a9ae653&page=queryresults
[0m20:01:48.774269 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        select
    
      
    cast(null as string)
 as fein, 
      
    cast(null as string)
 as employer_petitioner_name, 
      
    cast(null as int64)
 as employer_no, 
      
    cast(null as int64)
 as fiscal_year, 
      
    cast(null as string)
 as tax_id, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as petitioner_city, 
      
    cast(null as string)
 as petitioner_state, 
      
    cast(null as string)
 as petitioner_zip_code, 
      
    cast(null as string)
 as initial_approval, 
      
    cast(null as int64)
 as initial_denial, 
      
    cast(null as string)
 as continuing_approval, 
      
    cast(null as int64)
 as continuing_denial, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:01:49.121464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:76fede4b-7691-4972-96fc-06970ac0060b&page=queryresults
[0m20:01:49.289737 [debug] [Thread-1 (]: Compilation Error in model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
[0m20:01:49.292391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e50298-22ef-436c-b0e9-358b428a8e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5449964640>]}
[0m20:01:49.293460 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_cs329e_xh_int.Employer_Detail ........ [[31mERROR[0m in 1.43s]
[0m20:01:49.294689 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m20:01:49.295658 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.Employer_Detail' to be skipped because of status 'error'.  Reason: Compilation Error in model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql).
[0m20:01:49.298026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:01:49.299027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:49.299551 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt' was properly closed.
[0m20:01:49.300012 [debug] [MainThread]: Connection 'model.cs329e_xh.Employer_Detail' was properly closed.
[0m20:01:49.300529 [info ] [MainThread]: 
[0m20:01:49.301188 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m20:01:49.302449 [debug] [MainThread]: Command end result
[0m20:01:49.365151 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:01:49.367503 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:01:49.376406 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:01:49.376979 [info ] [MainThread]: 
[0m20:01:49.377768 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:01:49.378617 [info ] [MainThread]: 
[0m20:01:49.379477 [error] [MainThread]:   Compilation Error in model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
[0m20:01:49.380223 [info ] [MainThread]: 
[0m20:01:49.380945 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:01:49.381989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.571089, "process_in_blocks": "0", "process_kernel_time": 0.541124, "process_mem_max_rss": "265248", "process_out_blocks": "3464", "process_user_time": 4.272683}
[0m20:01:49.382728 [debug] [MainThread]: Command `dbt run` failed at 20:01:49.382578 after 4.57 seconds
[0m20:01:49.383353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54493854e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f542d161f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544922e2c0>]}
[0m20:01:49.383985 [debug] [MainThread]: Flushing usage events
[0m20:01:49.710318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:29.697224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e8db5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e7f423b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e7f42350>]}


============================== 20:08:29.700897 | af916b3b-e198-4983-a2d7-a907c7d1381d ==============================
[0m20:08:29.700897 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:08:29.701710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select Employer_Detail', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:08:31.375157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af916b3b-e198-4983-a2d7-a907c7d1381d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e9f32e90>]}
[0m20:08:31.459127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af916b3b-e198-4983-a2d7-a907c7d1381d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e8543310>]}
[0m20:08:31.460186 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:08:31.633355 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:08:31.865732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:08:31.866448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:08:31.965307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af916b3b-e198-4983-a2d7-a907c7d1381d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ccbbdc00>]}
[0m20:08:32.143287 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:08:32.145884 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:08:32.169662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af916b3b-e198-4983-a2d7-a907c7d1381d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ccbb8b80>]}
[0m20:08:32.170585 [info ] [MainThread]: Found 54 models, 1 seed, 29 data tests, 19 sources, 492 macros
[0m20:08:32.171291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af916b3b-e198-4983-a2d7-a907c7d1381d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ccbc74c0>]}
[0m20:08:32.174769 [info ] [MainThread]: 
[0m20:08:32.175407 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:08:32.176094 [info ] [MainThread]: 
[0m20:08:32.176953 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:08:32.178479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:08:32.179226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:32.502542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:08:32.504237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m20:08:32.504866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:32.505650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:32.645509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m20:08:32.646761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:32.677496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m20:08:32.680919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:32.808624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af916b3b-e198-4983-a2d7-a907c7d1381d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e848d630>]}
[0m20:08:32.809498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:32.812560 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m20:08:32.813420 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_cs329e_xh_int.Employer_Detail ................. [RUN]
[0m20:08:32.814271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Employer_Detail)
[0m20:08:32.815060 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Employer_Detail
[0m20:08:32.829344 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Employer_Detail"
[0m20:08:32.830288 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Employer_Detail
[0m20:08:32.850934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:33.034778 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:08:33.424950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e139b2d2-d826-467d-8cff-3638bab5984b&page=queryresults
[0m20:08:33.578262 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        select
    
      
    cast(null as string)
 as fein, 
      
    cast(null as string)
 as employer_petitioner_name, 
      
    cast(null as int64)
 as employer_no, 
      
    cast(null as int64)
 as fiscal_year, 
      
    cast(null as string)
 as tax_id, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as petitioner_city, 
      
    cast(null as string)
 as petitioner_state, 
      
    cast(null as string)
 as petitioner_zip_code, 
      
    cast(null as string)
 as initial_approval, 
      
    cast(null as int64)
 as initial_denial, 
      
    cast(null as string)
 as continuing_approval, 
      
    cast(null as int64)
 as continuing_denial, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:08:33.936155 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f1efb500-c1e1-4bf2-9abd-8b0a8605503c&page=queryresults
[0m20:08:34.096066 [debug] [Thread-1 (]: Compilation Error in model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
[0m20:08:34.098782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af916b3b-e198-4983-a2d7-a907c7d1381d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cd053e50>]}
[0m20:08:34.099874 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_cs329e_xh_int.Employer_Detail ........ [[31mERROR[0m in 1.28s]
[0m20:08:34.101082 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m20:08:34.102106 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.Employer_Detail' to be skipped because of status 'error'.  Reason: Compilation Error in model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql).
[0m20:08:34.104741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:08:34.105740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:34.106326 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg' was properly closed.
[0m20:08:34.106848 [debug] [MainThread]: Connection 'model.cs329e_xh.Employer_Detail' was properly closed.
[0m20:08:34.107361 [info ] [MainThread]: 
[0m20:08:34.108039 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m20:08:34.109260 [debug] [MainThread]: Command end result
[0m20:08:34.172613 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:08:34.175263 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:08:34.184235 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:08:34.184938 [info ] [MainThread]: 
[0m20:08:34.185747 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:08:34.186555 [info ] [MainThread]: 
[0m20:08:34.187379 [error] [MainThread]:   Compilation Error in model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Employer_Detail (models/int/Employer_Details/Employer_Detail.sql)
[0m20:08:34.188111 [info ] [MainThread]: 
[0m20:08:34.188828 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:08:34.189815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5704303, "process_in_blocks": "0", "process_kernel_time": 0.509001, "process_mem_max_rss": "263812", "process_out_blocks": "3472", "process_user_time": 4.46061}
[0m20:08:34.190549 [debug] [MainThread]: Command `dbt run` failed at 20:08:34.190394 after 4.57 seconds
[0m20:08:34.191145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e8db5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ccb4dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e8c5a620>]}
[0m20:08:34.191802 [debug] [MainThread]: Flushing usage events
[0m20:08:34.559992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:40.877802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48547995a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f485374e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f485374e350>]}


============================== 20:12:40.881539 | 55ff8f38-ebbd-420d-828a-6a01b11b30a2 ==============================
[0m20:12:40.881539 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:12:40.882465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select Employer_Detail', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:12:42.621416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ff8f38-ebbd-420d-828a-6a01b11b30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f485592aec0>]}
[0m20:12:42.711265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55ff8f38-ebbd-420d-828a-6a01b11b30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4853e5bfa0>]}
[0m20:12:42.712632 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:12:42.900275 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:12:43.141180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:12:43.142667 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/schema-checkpoint.yml
[0m20:12:43.143731 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/schema.yml
[0m20:12:43.676011 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named Employer_Detail. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for Employer_Detail in one of these files:
   - models/int/Employer_Details/schema.yml
  models/int/Employer_Details/.ipynb_checkpoints/schema-checkpoint.yml
[0m20:12:43.677301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8780148, "process_in_blocks": "0", "process_kernel_time": 0.436342, "process_mem_max_rss": "258928", "process_out_blocks": "16", "process_user_time": 4.601664}
[0m20:12:43.678142 [debug] [MainThread]: Command `dbt run` failed at 20:12:43.677955 after 2.88 seconds
[0m20:12:43.678829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48547995a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4854d7a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48385f0250>]}
[0m20:12:43.679546 [debug] [MainThread]: Flushing usage events
[0m20:12:44.038282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:15.840958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2486fa55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2485f5a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2485f5a3b0>]}


============================== 20:13:15.844731 | 7a3d4fe1-b9b8-4fdb-9632-909133669fed ==============================
[0m20:13:15.844731 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:13:15.845573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select Employer_Detail', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:13:17.588058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a3d4fe1-b9b8-4fdb-9632-909133669fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24865366e0>]}
[0m20:13:17.673616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a3d4fe1-b9b8-4fdb-9632-909133669fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2486606860>]}
[0m20:13:17.674710 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:13:17.851723 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:13:18.094832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:13:18.096396 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/schema.yml
[0m20:13:18.784219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a3d4fe1-b9b8-4fdb-9632-909133669fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246a4efe50>]}
[0m20:13:18.968208 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:13:18.971058 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:13:18.997300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a3d4fe1-b9b8-4fdb-9632-909133669fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246a3441c0>]}
[0m20:13:18.998289 [info ] [MainThread]: Found 54 models, 1 seed, 28 data tests, 19 sources, 492 macros
[0m20:13:18.998971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3d4fe1-b9b8-4fdb-9632-909133669fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246bc4c6d0>]}
[0m20:13:19.002574 [info ] [MainThread]: 
[0m20:13:19.003271 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:13:19.003869 [info ] [MainThread]: 
[0m20:13:19.004883 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:13:19.006483 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:13:19.007709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:19.379165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m20:13:19.380558 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m20:13:19.381350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:19.382068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:19.520375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:13:19.521687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:19.577997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m20:13:19.580757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:19.714886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3d4fe1-b9b8-4fdb-9632-909133669fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2487ff4640>]}
[0m20:13:19.715817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:13:19.719933 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m20:13:19.720917 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_cs329e_xh_int.Employer_Detail ................. [RUN]
[0m20:13:19.722273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.Employer_Detail)
[0m20:13:19.722921 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Employer_Detail
[0m20:13:19.735407 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Employer_Detail"
[0m20:13:19.736424 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Employer_Detail
[0m20:13:19.757098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:19.958141 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:13:20.424081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0dd73145-be8b-4df1-8367-93370348559e&page=queryresults
[0m20:13:20.589147 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        select
    
      
    cast(null as string)
 as employer_petitioner_name, 
      
    cast(null as string)
 as fein, 
      
    cast(null as int64)
 as employer_no, 
      
    cast(null as int64)
 as fiscal_year, 
      
    cast(null as string)
 as tax_id, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as petitioner_city, 
      
    cast(null as string)
 as petitioner_state, 
      
    cast(null as string)
 as petitioner_zip_code, 
      
    cast(null as string)
 as initial_approval, 
      
    cast(null as int64)
 as initial_denial, 
      
    cast(null as string)
 as continuing_approval, 
      
    cast(null as int64)
 as continuing_denial, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:13:20.949630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ee8bf0bb-94d3-4a57-8e0e-fcab77c13ead&page=queryresults
[0m20:13:21.108723 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:13:21.129508 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Employer_Detail"
[0m20:13:21.130917 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Employer_Detail"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
        
  (
    employer_petitioner_name string,
    fein string,
    employer_no int64,
    fiscal_year int64,
    tax_id string,
    naics_code string,
    petitioner_city string,
    petitioner_state string,
    petitioner_zip_code string,
    initial_approval string,
    initial_denial int64,
    continuing_approval string,
    continuing_denial int64,
    _data_source string,
    _load_time datetime,
    
    primary key (employer_petitioner_name) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_petitioner_name, fein, employer_no, fiscal_year, tax_id, naics_code, petitioner_city, petitioner_state, petitioner_zip_code, initial_approval, initial_denial, continuing_approval, continuing_denial, _data_source, _load_time
    from (
        with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp
    ) as model_subq
    );
  
[0m20:13:21.505764 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9888fdd9-8b20-46e5-8ded-8998fc66c935&page=queryresults
[0m20:13:23.957563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3d4fe1-b9b8-4fdb-9632-909133669fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246ad1bd60>]}
[0m20:13:23.958868 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_cs329e_xh_int.Employer_Detail ............ [[32mCREATE TABLE (28.9k rows, 10.8 MiB processed)[0m in 4.23s]
[0m20:13:23.960010 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m20:13:23.962012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:13:23.963138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:23.963679 [debug] [MainThread]: Connection 'model.cs329e_xh.Employer_Detail' was properly closed.
[0m20:13:23.964175 [debug] [MainThread]: Connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt' was properly closed.
[0m20:13:23.964714 [info ] [MainThread]: 
[0m20:13:23.965475 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m20:13:23.966804 [debug] [MainThread]: Command end result
[0m20:13:24.034295 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:13:24.037190 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:13:24.047366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:13:24.048045 [info ] [MainThread]: 
[0m20:13:24.049017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:24.050519 [info ] [MainThread]: 
[0m20:13:24.051632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:13:24.052862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.291663, "process_in_blocks": "0", "process_kernel_time": 0.471849, "process_mem_max_rss": "270408", "process_out_blocks": "4936", "process_user_time": 5.4665}
[0m20:13:24.053603 [debug] [MainThread]: Command `dbt run` succeeded at 20:13:24.053449 after 8.29 seconds
[0m20:13:24.054260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2486fa55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2487408cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246a3a3a60>]}
[0m20:13:24.054937 [debug] [MainThread]: Flushing usage events
[0m20:13:24.449710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:04.561995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c13f55570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c130b64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c130b6470>]}


============================== 20:14:04.566228 | 753bc958-523e-4a97-b787-f7352f81cbc6 ==============================
[0m20:14:04.566228 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:14:04.567213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select models/int/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:14:06.340490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '753bc958-523e-4a97-b787-f7352f81cbc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1350eb90>]}
[0m20:14:06.427509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '753bc958-523e-4a97-b787-f7352f81cbc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c13151480>]}
[0m20:14:06.428591 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:14:06.603385 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:14:06.840782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:14:06.841473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:14:06.944759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '753bc958-523e-4a97-b787-f7352f81cbc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf7d45b10>]}
[0m20:14:07.131431 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:14:07.134280 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:14:07.173558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '753bc958-523e-4a97-b787-f7352f81cbc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf7d7c280>]}
[0m20:14:07.174551 [info ] [MainThread]: Found 54 models, 1 seed, 28 data tests, 19 sources, 492 macros
[0m20:14:07.175291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '753bc958-523e-4a97-b787-f7352f81cbc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf8bbc850>]}
[0m20:14:07.181785 [info ] [MainThread]: 
[0m20:14:07.182477 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:14:07.183071 [info ] [MainThread]: 
[0m20:14:07.183928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:14:07.195029 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt'
[0m20:14:07.195896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:07.196714 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m20:14:07.197656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:07.334257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m20:14:07.337265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:07.375203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m20:14:07.378574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:07.536204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '753bc958-523e-4a97-b787-f7352f81cbc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c136193c0>]}
[0m20:14:07.537089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:07.540911 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m20:14:07.541680 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m20:14:07.542397 [info ] [Thread-1 (]: 1 of 28 START test not_null_Company_Data_employer_name ......................... [RUN]
[0m20:14:07.543322 [info ] [Thread-2 (]: 2 of 28 START test not_null_Employer_Detail_employer_petitioner_name ........... [RUN]
[0m20:14:07.544389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b)
[0m20:14:07.545222 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227)
[0m20:14:07.545905 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m20:14:07.546621 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m20:14:07.586142 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m20:14:07.587956 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m20:14:07.589127 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m20:14:07.595027 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m20:14:07.623153 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m20:14:07.624084 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m20:14:07.625463 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_petitioner_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where employer_petitioner_name is null



      
    ) dbt_internal_test
[0m20:14:07.626499 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:07.627267 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
where employer_name is null



      
    ) dbt_internal_test
[0m20:14:07.629795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:07.915127 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2798e05a-f638-478f-bc8b-7a7023ff5ab8&page=queryresults
[0m20:14:08.110229 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fd7f11cf-d582-4b1e-86be-70446016a289&page=queryresults
[0m20:14:08.369032 [info ] [Thread-1 (]: 1 of 28 PASS not_null_Company_Data_employer_name ............................... [[32mPASS[0m in 0.82s]
[0m20:14:08.370449 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m20:14:08.371184 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m20:14:08.372018 [info ] [Thread-1 (]: 3 of 28 START test not_null_LCA_Appendix_appx_a_date_of_degree ................. [RUN]
[0m20:14:08.372857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b, now test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155)
[0m20:14:08.373481 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m20:14:08.380644 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m20:14:08.385494 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m20:14:08.389791 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m20:14:08.390883 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appx_a_date_of_degree
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where appx_a_date_of_degree is null



      
    ) dbt_internal_test
[0m20:14:08.391621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:08.500728 [info ] [Thread-2 (]: 2 of 28 PASS not_null_Employer_Detail_employer_petitioner_name ................. [[32mPASS[0m in 0.96s]
[0m20:14:08.502279 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m20:14:08.503060 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m20:14:08.503849 [info ] [Thread-2 (]: 4 of 28 START test not_null_LCA_Appendix_case_number ........................... [RUN]
[0m20:14:08.504790 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227, now test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b)
[0m20:14:08.505457 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m20:14:08.512227 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m20:14:08.513286 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m20:14:08.517246 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m20:14:08.518326 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where case_number is null



      
    ) dbt_internal_test
[0m20:14:08.519043 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:08.670597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:15edb1ca-5bec-45c2-9b7b-643521496697&page=queryresults
[0m20:14:08.909716 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:20d406f6-b6f2-4001-b0e6-0f861b4426ed&page=queryresults
[0m20:14:09.005698 [info ] [Thread-1 (]: 3 of 28 PASS not_null_LCA_Appendix_appx_a_date_of_degree ....................... [[32mPASS[0m in 0.63s]
[0m20:14:09.007715 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m20:14:09.008871 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m20:14:09.010048 [info ] [Thread-1 (]: 5 of 28 START test not_null_LCA_Disclosure_case_number ......................... [RUN]
[0m20:14:09.011463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155, now test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39)
[0m20:14:09.012493 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m20:14:09.022844 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m20:14:09.027337 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m20:14:09.031637 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m20:14:09.032828 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where case_number is null



      
    ) dbt_internal_test
[0m20:14:09.033587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:09.227576 [info ] [Thread-2 (]: 4 of 28 PASS not_null_LCA_Appendix_case_number ................................. [[32mPASS[0m in 0.72s]
[0m20:14:09.229093 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m20:14:09.229888 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m20:14:09.230764 [info ] [Thread-2 (]: 6 of 28 START test not_null_LCA_Disclosure_decision_date ....................... [RUN]
[0m20:14:09.231821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b, now test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7)
[0m20:14:09.232482 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m20:14:09.241318 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"
[0m20:14:09.242328 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m20:14:09.245992 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"
[0m20:14:09.246978 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select decision_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where decision_date is null



      
    ) dbt_internal_test
[0m20:14:09.247699 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:09.349284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7fcedb74-3ad2-4077-8604-cbd866f01fd5&page=queryresults
[0m20:14:09.602023 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3f66258c-4801-4121-b41f-979fed76a754&page=queryresults
[0m20:14:09.699772 [info ] [Thread-1 (]: 5 of 28 PASS not_null_LCA_Disclosure_case_number ............................... [[32mPASS[0m in 0.69s]
[0m20:14:09.701043 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m20:14:09.701801 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m20:14:09.702625 [info ] [Thread-1 (]: 7 of 28 START test not_null_LCA_Disclosure_employer_name ....................... [RUN]
[0m20:14:09.703567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39, now test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2)
[0m20:14:09.704178 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m20:14:09.710852 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m20:14:09.711816 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m20:14:09.715442 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m20:14:09.716407 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where employer_name is null



      
    ) dbt_internal_test
[0m20:14:09.717135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:09.937819 [info ] [Thread-2 (]: 6 of 28 PASS not_null_LCA_Disclosure_decision_date ............................. [[32mPASS[0m in 0.71s]
[0m20:14:09.939357 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7
[0m20:14:09.940112 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m20:14:09.940967 [info ] [Thread-2 (]: 8 of 28 START test not_null_LCA_Worksites_row_id ............................... [RUN]
[0m20:14:09.941902 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_decision_date.d06d2d86f7, now test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8)
[0m20:14:09.942584 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m20:14:09.948917 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m20:14:09.949875 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m20:14:09.953933 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m20:14:09.955174 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
where row_id is null



      
    ) dbt_internal_test
[0m20:14:09.955946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:10.028983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c7edbcda-3a91-4a60-87d5-ca984c6a81dc&page=queryresults
[0m20:14:10.382000 [info ] [Thread-1 (]: 7 of 28 PASS not_null_LCA_Disclosure_employer_name ............................. [[32mPASS[0m in 0.68s]
[0m20:14:10.383529 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m20:14:10.384286 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m20:14:10.385167 [info ] [Thread-1 (]: 9 of 28 START test not_null_Sentiment_Analysis_publication_date ................ [RUN]
[0m20:14:10.386277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2, now test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8)
[0m20:14:10.386938 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m20:14:10.393460 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m20:14:10.394411 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m20:14:10.399771 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m20:14:10.400722 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select publication_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
where publication_date is null



      
    ) dbt_internal_test
[0m20:14:10.401434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:10.476099 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e6970eca-f1fa-4d96-ac86-2ed40c017180&page=queryresults
[0m20:14:10.690467 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:57412968-4ad4-4c2b-a0b7-fae51e322ae8&page=queryresults
[0m20:14:10.869094 [info ] [Thread-2 (]: 8 of 28 PASS not_null_LCA_Worksites_row_id ..................................... [[32mPASS[0m in 0.93s]
[0m20:14:10.870658 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m20:14:10.871403 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m20:14:10.872247 [info ] [Thread-2 (]: 10 of 28 START test not_null_Single_Registration_agent_first_name .............. [RUN]
[0m20:14:10.873156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8, now test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3)
[0m20:14:10.873771 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m20:14:10.880053 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m20:14:10.880940 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m20:14:10.884668 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m20:14:10.885819 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_first_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_first_name is null



      
    ) dbt_internal_test
[0m20:14:10.886716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:11.029977 [info ] [Thread-1 (]: 9 of 28 PASS not_null_Sentiment_Analysis_publication_date ...................... [[32mPASS[0m in 0.64s]
[0m20:14:11.031402 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m20:14:11.032124 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m20:14:11.033029 [info ] [Thread-1 (]: 11 of 28 START test not_null_Single_Registration_agent_last_name ............... [RUN]
[0m20:14:11.034037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8, now test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c)
[0m20:14:11.034746 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m20:14:11.041028 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m20:14:11.041942 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m20:14:11.045894 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m20:14:11.046900 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_last_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_last_name is null



      
    ) dbt_internal_test
[0m20:14:11.047615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:11.235716 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:163bb167-262f-49a7-8275-f4dad9d1f67e&page=queryresults
[0m20:14:11.356874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:32646cb7-fe1b-4cc3-8819-74da39eaaa82&page=queryresults
[0m20:14:11.543666 [error] [Thread-2 (]: 10 of 28 FAIL 49 not_null_Single_Registration_agent_first_name ................. [[31mFAIL 49[0m in 0.67s]
[0m20:14:11.545108 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m20:14:11.545816 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m20:14:11.546621 [info ] [Thread-2 (]: 12 of 28 START test not_null_Single_Registration_ben_year_of_birth ............. [RUN]
[0m20:14:11.547539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3, now test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f)
[0m20:14:11.548151 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m20:14:11.554655 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m20:14:11.555563 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m20:14:11.560965 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m20:14:11.561981 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ben_year_of_birth
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where ben_year_of_birth is null



      
    ) dbt_internal_test
[0m20:14:11.562738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:11.693170 [error] [Thread-1 (]: 11 of 28 FAIL 140 not_null_Single_Registration_agent_last_name ................. [[31mFAIL 140[0m in 0.66s]
[0m20:14:11.694736 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m20:14:11.695506 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m20:14:11.696334 [info ] [Thread-1 (]: 13 of 28 START test not_null_Single_Registration_employer_name ................. [RUN]
[0m20:14:11.697382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c, now test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49)
[0m20:14:11.698031 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m20:14:11.704682 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m20:14:11.705768 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m20:14:11.709727 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m20:14:11.710854 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where employer_name is null



      
    ) dbt_internal_test
[0m20:14:11.711904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:11.872940 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:49a10a0d-7c5c-4da5-9a77-15b4ba9304c4&page=queryresults
[0m20:14:12.059014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:38d0f6c3-62fb-4aff-b15f-028bd1bc9fd8&page=queryresults
[0m20:14:12.202399 [info ] [Thread-2 (]: 12 of 28 PASS not_null_Single_Registration_ben_year_of_birth ................... [[32mPASS[0m in 0.65s]
[0m20:14:12.203824 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m20:14:12.204571 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m20:14:12.205246 [info ] [Thread-2 (]: 14 of 28 START test not_null_Single_Registration_gender ........................ [RUN]
[0m20:14:12.206268 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f, now test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23)
[0m20:14:12.206898 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m20:14:12.213193 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m20:14:12.214241 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m20:14:12.218115 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m20:14:12.219138 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gender
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where gender is null



      
    ) dbt_internal_test
[0m20:14:12.219873 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:12.411427 [error] [Thread-1 (]: 13 of 28 FAIL 1 not_null_Single_Registration_employer_name ..................... [[31mFAIL 1[0m in 0.71s]
[0m20:14:12.412794 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m20:14:12.413539 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m20:14:12.414278 [info ] [Thread-1 (]: 15 of 28 START test not_null_Single_Registration_mail_addr ..................... [RUN]
[0m20:14:12.415261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49, now test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3)
[0m20:14:12.415864 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m20:14:12.422207 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m20:14:12.423151 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m20:14:12.568804 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m20:14:12.570059 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6a5a35d8-62ed-4c21-870c-aa4150259f87&page=queryresults
[0m20:14:12.572846 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mail_addr
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where mail_addr is null



      
    ) dbt_internal_test
[0m20:14:12.573716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:12.895627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5265b454-d85c-4a27-82a6-bcbd61117e36&page=queryresults
[0m20:14:12.925816 [info ] [Thread-2 (]: 14 of 28 PASS not_null_Single_Registration_gender .............................. [[32mPASS[0m in 0.72s]
[0m20:14:12.927394 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m20:14:12.928211 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m20:14:12.929144 [info ] [Thread-2 (]: 16 of 28 START test not_null_Wage_Summary_company_name ......................... [RUN]
[0m20:14:12.930076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23, now test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5)
[0m20:14:12.930868 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m20:14:12.937520 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m20:14:12.938617 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m20:14:12.942365 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m20:14:12.943398 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where company_name is null



      
    ) dbt_internal_test
[0m20:14:12.944128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:13.194664 [info ] [Thread-1 (]: 15 of 28 PASS not_null_Single_Registration_mail_addr ........................... [[32mPASS[0m in 0.78s]
[0m20:14:13.195966 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m20:14:13.196754 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m20:14:13.197749 [info ] [Thread-1 (]: 17 of 28 START test not_null_Wage_Summary_job_title ............................ [RUN]
[0m20:14:13.198638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3, now test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417)
[0m20:14:13.199272 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m20:14:13.205700 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m20:14:13.206761 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m20:14:13.210778 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m20:14:13.211960 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where job_title is null



      
    ) dbt_internal_test
[0m20:14:13.212709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:13.236963 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a22ad73d-9d58-4598-a5b5-314eb1b87f5b&page=queryresults
[0m20:14:13.540528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6597d3e0-8686-4da2-b524-fa9a2b531179&page=queryresults
[0m20:14:13.551550 [info ] [Thread-2 (]: 16 of 28 PASS not_null_Wage_Summary_company_name ............................... [[32mPASS[0m in 0.62s]
[0m20:14:13.552839 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m20:14:13.553596 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m20:14:13.554511 [info ] [Thread-2 (]: 18 of 28 START test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [RUN]
[0m20:14:13.555396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5, now test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6)
[0m20:14:13.556031 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m20:14:13.568657 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m20:14:13.569810 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m20:14:13.575903 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m20:14:13.577147 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select employer_petitioner_name as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
    where employer_petitioner_name is not null
),

parent as (
    select employer_name as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:14:13.577952 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:13.869195 [info ] [Thread-1 (]: 17 of 28 PASS not_null_Wage_Summary_job_title .................................. [[32mPASS[0m in 0.67s]
[0m20:14:13.870469 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m20:14:13.871205 [debug] [Thread-1 (]: Began running node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m20:14:13.871984 [info ] [Thread-1 (]: 19 of 28 START test relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_  [RUN]
[0m20:14:13.872793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417, now test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531)
[0m20:14:13.873444 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m20:14:13.882237 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"
[0m20:14:13.883278 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m20:14:13.887247 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"
[0m20:14:13.888261 [debug] [Thread-1 (]: On test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select decision_date as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    where decision_date is not null
),

parent as (
    select publication_date as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:14:13.889007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:14.075010 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:935fe866-6a3b-43f1-be1f-346bfdacc76a&page=queryresults
[0m20:14:14.238675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:45c76b9a-af30-4002-93ff-96134a3fd963&page=queryresults
[0m20:14:14.425962 [error] [Thread-2 (]: 18 of 28 FAIL 26520 relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [[31mFAIL 26520[0m in 0.87s]
[0m20:14:14.427481 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m20:14:14.428218 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m20:14:14.429032 [info ] [Thread-2 (]: 20 of 28 START test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [RUN]
[0m20:14:14.429964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6, now test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46)
[0m20:14:14.430651 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m20:14:14.439239 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m20:14:14.440177 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m20:14:14.443799 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m20:14:14.444865 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select case_number as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
    where case_number is not null
),

parent as (
    select case_number as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:14:14.445613 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:14.606317 [error] [Thread-1 (]: 19 of 28 FAIL 548660 relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_  [[31mFAIL 548660[0m in 0.73s]
[0m20:14:14.607657 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531
[0m20:14:14.608448 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m20:14:14.609252 [info ] [Thread-1 (]: 21 of 28 START test unique_Company_Data_employer_name .......................... [RUN]
[0m20:14:14.610080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_.1c1a022531, now test.cs329e_xh.unique_Company_Data_employer_name.69805b71db)
[0m20:14:14.610764 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m20:14:14.621420 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m20:14:14.622630 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m20:14:14.628939 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m20:14:14.630034 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Company_Data_employer_name.69805b71db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
  where employer_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:14.630856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:14.752442 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e33a3587-ed8c-4d81-a88e-80effb327032&page=queryresults
[0m20:14:14.970108 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5a985e8a-e84f-4ab2-be56-3274bb328081&page=queryresults
[0m20:14:15.064300 [error] [Thread-2 (]: 20 of 28 FAIL 14201 relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [[31mFAIL 14201[0m in 0.63s]
[0m20:14:15.065600 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m20:14:15.066335 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m20:14:15.067106 [info ] [Thread-2 (]: 22 of 28 START test unique_Employer_Detail_employer_petitioner_name ............ [RUN]
[0m20:14:15.067895 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46, now test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1)
[0m20:14:15.068580 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m20:14:15.075408 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m20:14:15.078188 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m20:14:15.081986 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m20:14:15.082955 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_petitioner_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
  where employer_petitioner_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:15.083627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:15.503937 [info ] [Thread-1 (]: 21 of 28 PASS unique_Company_Data_employer_name ................................ [[32mPASS[0m in 0.89s]
[0m20:14:15.505316 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m20:14:15.506078 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m20:14:15.506986 [info ] [Thread-1 (]: 23 of 28 START test unique_LCA_Worksites_row_id ................................ [RUN]
[0m20:14:15.507830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Company_Data_employer_name.69805b71db, now test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef)
[0m20:14:15.508478 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m20:14:15.514512 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m20:14:15.515414 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m20:14:15.519035 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m20:14:15.519979 [debug] [Thread-1 (]: On test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select row_id as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
  where row_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:15.520694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:15.581479 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7cc63d7c-836d-45fa-8cb1-a3594bf50e4e&page=queryresults
[0m20:14:15.891092 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:509572d1-8b14-425b-b041-92d11e852787&page=queryresults
[0m20:14:15.920117 [error] [Thread-2 (]: 22 of 28 FAIL 55 unique_Employer_Detail_employer_petitioner_name ............... [[31mFAIL 55[0m in 0.85s]
[0m20:14:15.921458 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m20:14:15.922265 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m20:14:15.923164 [info ] [Thread-2 (]: 24 of 28 START test unique_Sentiment_Analysis_publication_date ................. [RUN]
[0m20:14:15.924040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1, now test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e)
[0m20:14:15.924720 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m20:14:15.931156 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m20:14:15.932134 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m20:14:15.937890 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m20:14:15.939041 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select publication_date as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
  where publication_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:15.939771 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:16.227472 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a73d8abb-44b7-47dc-8cef-93767bf22c5a&page=queryresults
[0m20:14:16.262779 [info ] [Thread-1 (]: 23 of 28 PASS unique_LCA_Worksites_row_id ...................................... [[32mPASS[0m in 0.75s]
[0m20:14:16.264375 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m20:14:16.265162 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m20:14:16.266041 [info ] [Thread-1 (]: 25 of 28 START test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [RUN]
[0m20:14:16.267004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef, now test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557)
[0m20:14:16.267678 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m20:14:16.275954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:16.278965 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.280015 [error] [Thread-1 (]: 25 of 28 ERROR unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [[31mERROR[0m in 0.01s]
[0m20:14:16.281162 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m20:14:16.281891 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m20:14:16.282725 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:14:16.283529 [info ] [Thread-1 (]: 26 of 28 START test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [RUN]
[0m20:14:16.286102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557, now test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4)
[0m20:14:16.286826 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m20:14:16.293487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:16.295699 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.296613 [error] [Thread-1 (]: 26 of 28 ERROR unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [[31mERROR[0m in 0.01s]
[0m20:14:16.297561 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m20:14:16.298260 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m20:14:16.299068 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:14:16.299777 [info ] [Thread-1 (]: 27 of 28 START test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [RUN]
[0m20:14:16.300993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4, now test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d)
[0m20:14:16.301625 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m20:14:16.312144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:16.313896 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.314819 [error] [Thread-1 (]: 27 of 28 ERROR unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [[31mERROR[0m in 0.01s]
[0m20:14:16.315777 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m20:14:16.316441 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m20:14:16.317233 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:14:16.317989 [info ] [Thread-1 (]: 28 of 28 START test unique_combination_of_columns_Wage_Summary_company_name__job_title  [RUN]
[0m20:14:16.319215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d, now test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194)
[0m20:14:16.319855 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m20:14:16.328812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:16.330682 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.331607 [error] [Thread-1 (]: 28 of 28 ERROR unique_combination_of_columns_Wage_Summary_company_name__job_title  [[31mERROR[0m in 0.01s]
[0m20:14:16.332588 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m20:14:16.333566 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:14:16.582816 [info ] [Thread-2 (]: 24 of 28 PASS unique_Sentiment_Analysis_publication_date ....................... [[32mPASS[0m in 0.66s]
[0m20:14:16.584213 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m20:14:16.586661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:16.587806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:16.588399 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e' was properly closed.
[0m20:14:16.588890 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' was properly closed.
[0m20:14:16.589510 [info ] [MainThread]: 
[0m20:14:16.590222 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m20:14:16.596809 [debug] [MainThread]: Command end result
[0m20:14:16.664280 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:14:16.667275 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:14:16.679500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:14:16.680230 [info ] [MainThread]: 
[0m20:14:16.681041 [info ] [MainThread]: [31mCompleted with 11 errors, 0 partial successes, and 0 warnings:[0m
[0m20:14:16.681762 [info ] [MainThread]: 
[0m20:14:16.682571 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_agent_first_name (models/int/schema.yml)[0m
[0m20:14:16.683258 [error] [MainThread]:   Got 49 results, configured to fail if != 0
[0m20:14:16.683787 [info ] [MainThread]: 
[0m20:14:16.684454 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_agent_first_name.sql
[0m20:14:16.685045 [info ] [MainThread]: 
[0m20:14:16.685713 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_agent_last_name (models/int/schema.yml)[0m
[0m20:14:16.686396 [error] [MainThread]:   Got 140 results, configured to fail if != 0
[0m20:14:16.686923 [info ] [MainThread]: 
[0m20:14:16.687569 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_agent_last_name.sql
[0m20:14:16.688127 [info ] [MainThread]: 
[0m20:14:16.688720 [error] [MainThread]: [31mFailure in test not_null_Single_Registration_employer_name (models/int/schema.yml)[0m
[0m20:14:16.689306 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:14:16.689777 [info ] [MainThread]: 
[0m20:14:16.690679 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/not_null_Single_Registration_employer_name.sql
[0m20:14:16.691282 [info ] [MainThread]: 
[0m20:14:16.691940 [error] [MainThread]: [31mFailure in test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_ (models/int/Employer_Details/schema.yml)[0m
[0m20:14:16.692594 [error] [MainThread]:   Got 26520 results, configured to fail if != 0
[0m20:14:16.693122 [info ] [MainThread]: 
[0m20:14:16.693740 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/relationships_Employer_Detail_a803ce1d5c10b4dae7e1dc33e0f1a09b.sql
[0m20:14:16.694367 [info ] [MainThread]: 
[0m20:14:16.695005 [error] [MainThread]: [31mFailure in test relationships_LCA_Disclosure_decision_date__publication_date__ref_Sentiment_Analysis_ (models/int/schema.yml)[0m
[0m20:14:16.695643 [error] [MainThread]:   Got 548660 results, configured to fail if != 0
[0m20:14:16.696176 [info ] [MainThread]: 
[0m20:14:16.696787 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Disclosure_5b656fbbb20356ebf0977db6de7595b5.sql
[0m20:14:16.697335 [info ] [MainThread]: 
[0m20:14:16.697957 [error] [MainThread]: [31mFailure in test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_ (models/int/schema.yml)[0m
[0m20:14:16.698632 [error] [MainThread]:   Got 14201 results, configured to fail if != 0
[0m20:14:16.699151 [info ] [MainThread]: 
[0m20:14:16.699754 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Worksites_a871b7806445a97e6fda9420f0740807.sql
[0m20:14:16.700295 [info ] [MainThread]: 
[0m20:14:16.700915 [error] [MainThread]: [31mFailure in test unique_Employer_Detail_employer_petitioner_name (models/int/Employer_Details/schema.yml)[0m
[0m20:14:16.701682 [error] [MainThread]:   Got 55 results, configured to fail if != 0
[0m20:14:16.702412 [info ] [MainThread]: 
[0m20:14:16.703020 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/unique_Employer_Detail_employer_petitioner_name.sql
[0m20:14:16.703584 [info ] [MainThread]: 
[0m20:14:16.704269 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.704919 [info ] [MainThread]: 
[0m20:14:16.705556 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.706106 [info ] [MainThread]: 
[0m20:14:16.706784 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.707339 [info ] [MainThread]: 
[0m20:14:16.707952 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.708542 [info ] [MainThread]: 
[0m20:14:16.709146 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=11 SKIP=0 TOTAL=28
[0m20:14:16.710220 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 12.227758, "process_in_blocks": "0", "process_kernel_time": 0.474261, "process_mem_max_rss": "269356", "process_out_blocks": "4024", "process_user_time": 5.653693}
[0m20:14:16.710888 [debug] [MainThread]: Command `dbt test` failed at 20:14:16.710747 after 12.23 seconds
[0m20:14:16.711671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c13f55570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c13dfa620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf7ab2950>]}
[0m20:14:16.712610 [debug] [MainThread]: Flushing usage events
[0m20:14:17.059133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:37:30.014540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52173a15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52163523e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5216352380>]}


============================== 20:37:30.018364 | 84acf2e1-ac7b-41cb-a722-8ec86461ae30 ==============================
[0m20:37:30.018364 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:37:30.019259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:37:31.756494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84acf2e1-ac7b-41cb-a722-8ec86461ae30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52164afdf0>]}
[0m20:37:31.843229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84acf2e1-ac7b-41cb-a722-8ec86461ae30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5216525360>]}
[0m20:37:31.844349 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:37:32.021216 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:37:32.271174 [debug] [MainThread]: Partial parsing enabled: 12 files deleted, 2 files added, 3 files changed.
[0m20:37:32.272482 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/schema-checkpoint.yml
[0m20:37:32.273199 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/schema-checkpoint.yml
[0m20:37:32.275096 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/schema.yml
[0m20:37:32.275660 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m20:37:32.276146 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Sentiment_Analysis-checkpoint.sql
[0m20:37:32.276605 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Company_Data-checkpoint.sql
[0m20:37:32.277058 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m20:37:32.277514 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Disclosure-checkpoint.sql
[0m20:37:32.277957 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m20:37:32.278505 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Single_Registration-checkpoint.sql
[0m20:37:32.278959 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m20:37:32.279416 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m20:37:32.279851 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Appendix-checkpoint.sql
[0m20:37:32.280304 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m20:37:32.280743 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m20:37:32.281496 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Single_Registration.sql
[0m20:37:32.282254 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/Employer_Detail.sql
[0m20:37:32.696379 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "cs329e_xh_raw_company_data".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("cs329e_xh_raw", "company_data").
  
  To fix this, change the name of one of these resources:
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/.ipynb_checkpoints/schema-checkpoint.yml)
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/schema.yml)
[0m20:37:32.697583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7626266, "process_in_blocks": "0", "process_kernel_time": 0.448232, "process_mem_max_rss": "257700", "process_out_blocks": "24", "process_user_time": 4.485675}
[0m20:37:32.698439 [debug] [MainThread]: Command `dbt run` failed at 20:37:32.698270 after 2.76 seconds
[0m20:37:32.699068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52173a15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fa7d3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fa7d33a0>]}
[0m20:37:32.699743 [debug] [MainThread]: Flushing usage events
[0m20:37:33.055452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:21.349689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38162f95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381548e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381548e380>]}


============================== 20:38:21.353907 | 8423e36c-1d4f-4c04-8ff0-ab0ed2af806f ==============================
[0m20:38:21.353907 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:38:21.354941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:38:23.069441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8423e36c-1d4f-4c04-8ff0-ab0ed2af806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3815bceb30>]}
[0m20:38:23.154751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8423e36c-1d4f-4c04-8ff0-ab0ed2af806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381548e410>]}
[0m20:38:23.155803 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:38:23.328595 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:38:23.576760 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 1 files added, 3 files changed.
[0m20:38:23.578030 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/schema-checkpoint.yml
[0m20:38:23.580171 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/schema.yml
[0m20:38:23.580773 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Single_Registration-checkpoint.sql
[0m20:38:23.581353 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m20:38:23.581869 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m20:38:23.582414 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/stg/.ipynb_checkpoints/pw_disclosure-checkpoint.sql
[0m20:38:23.582896 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Appendix-checkpoint.sql
[0m20:38:23.583522 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m20:38:23.584025 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m20:38:23.584729 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m20:38:23.585244 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m20:38:23.585720 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Disclosure-checkpoint.sql
[0m20:38:23.586317 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m20:38:23.586820 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Company_Data-checkpoint.sql
[0m20:38:23.587298 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Sentiment_Analysis-checkpoint.sql
[0m20:38:23.587988 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/Employer_Detail.sql
[0m20:38:23.588748 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Single_Registration.sql
[0m20:38:23.990067 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "cs329e_xh_raw_approval_rate_by_month".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("cs329e_xh_raw", "approval_rate_by_month").
  
  To fix this, change the name of one of these resources:
  - source.cs329e_xh.cs329e_xh_raw.approval_rate_by_month (models/mrt/.ipynb_checkpoints/schema-checkpoint.yml)
  - source.cs329e_xh.cs329e_xh_raw.approval_rate_by_month (models/mrt/schema.yml)
[0m20:38:23.991297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7220147, "process_in_blocks": "0", "process_kernel_time": 0.520781, "process_mem_max_rss": "257332", "process_out_blocks": "16", "process_user_time": 4.347167}
[0m20:38:23.992088 [debug] [MainThread]: Command `dbt run` failed at 20:38:23.991932 after 2.72 seconds
[0m20:38:23.992749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38162f95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fa24ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f98edbd0>]}
[0m20:38:23.993481 [debug] [MainThread]: Flushing usage events
[0m20:38:24.252673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:50.760271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8862795a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8854263e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885426380>]}


============================== 20:38:50.764350 | c264072e-9e9f-41e3-a270-aa549258dc7d ==============================
[0m20:38:50.764350 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:38:50.765374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:38:52.526687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885a59f00>]}
[0m20:38:52.612539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885959bd0>]}
[0m20:38:52.613706 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:38:52.786669 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:38:53.031902 [debug] [MainThread]: Partial parsing enabled: 23 files deleted, 0 files added, 3 files changed.
[0m20:38:53.034436 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/schema.yml
[0m20:38:53.035084 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/wage_level_by_industry-checkpoint.sql
[0m20:38:53.035578 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_employer_details-checkpoint.sql
[0m20:38:53.036025 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_approval_rate-checkpoint.sql
[0m20:38:53.036487 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m20:38:53.036933 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/temp_emp-checkpoint.sql
[0m20:38:53.037390 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/state_wage_level-checkpoint.sql
[0m20:38:53.037836 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/city_approval_rate-checkpoint.sql
[0m20:38:53.038375 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/approval_rate_by_month-checkpoint.sql
[0m20:38:53.038848 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Worksites-checkpoint.sql
[0m20:38:53.039348 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_approval_rate-checkpoint.sql
[0m20:38:53.039802 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Single_Registration-checkpoint.sql
[0m20:38:53.040243 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Appendix-checkpoint.sql
[0m20:38:53.040695 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Wage_Summary-checkpoint.sql
[0m20:38:53.041152 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/major_wage_level-checkpoint.sql
[0m20:38:53.041617 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/industry_approval_rate-checkpoint.sql
[0m20:38:53.042055 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/soc_wage_level-checkpoint.sql
[0m20:38:53.042568 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/mrt/.ipynb_checkpoints/company_wage_level-checkpoint.sql
[0m20:38:53.043014 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/LCA_Disclosure-checkpoint.sql
[0m20:38:53.043471 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Sentiment_Analysis-checkpoint.sql
[0m20:38:53.043907 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/Company_Data-checkpoint.sql
[0m20:38:53.044365 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/Employer_Detail-checkpoint.sql
[0m20:38:53.044812 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/stg/.ipynb_checkpoints/pw_disclosure-checkpoint.sql
[0m20:38:53.045300 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/.ipynb_checkpoints/PW_Disclosure-checkpoint.sql
[0m20:38:53.046081 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Single_Registration.sql
[0m20:38:53.046884 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/Employer_Detail.sql
[0m20:38:53.841760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8697bd0c0>]}
[0m20:38:54.152499 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:38:54.155269 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:38:54.178060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86977ea40>]}
[0m20:38:54.179012 [info ] [MainThread]: Found 31 models, 1 seed, 26 data tests, 19 sources, 492 macros
[0m20:38:54.179636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8697bfbe0>]}
[0m20:38:54.184283 [info ] [MainThread]: 
[0m20:38:54.184927 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:38:54.185561 [info ] [MainThread]: 
[0m20:38:54.186432 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:38:54.195670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:38:54.196760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:38:54.197394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:54.198237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:54.444338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:54.647694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:38:54.648802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m20:38:54.649812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:54.650580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:54.783610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m20:38:54.787946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:54.804053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m20:38:54.807315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:54.934838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86977c9a0>]}
[0m20:38:54.935740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:54.939224 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_data
[0m20:38:54.939950 [debug] [Thread-2 (]: Began running node model.cs329e_xh.employer_details
[0m20:38:54.940929 [info ] [Thread-1 (]: 1 of 31 START sql table model dbt_cs329e_xh_stg.company_data ................... [RUN]
[0m20:38:54.942106 [info ] [Thread-2 (]: 2 of 31 START sql table model dbt_cs329e_xh_stg.employer_details ............... [RUN]
[0m20:38:54.943137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now model.cs329e_xh.company_data)
[0m20:38:54.943935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.employer_details)
[0m20:38:54.944648 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_data
[0m20:38:54.945349 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.employer_details
[0m20:38:54.963009 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_data"
[0m20:38:54.960854 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.employer_details"
[0m20:38:54.983366 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.employer_details
[0m20:38:54.989470 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_data
[0m20:38:55.023524 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:38:55.029516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:55.214772 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_data"
[0m20:38:55.213320 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.employer_details"
[0m20:38:55.217312 [debug] [Thread-2 (]: On model.cs329e_xh.employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details`
      
    
    

    OPTIONS()
    as (
      
with stg_employer_details_1 as (
select
    * except (`tax id`,`line by line` ),
    lpad(cast(cast(`tax id` as int64) as string), 4, '0') as tax_id,
    CAST(REPLACE(`line by line`, ',', '') AS INT64) AS employer_no
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`employer_details`
),
stg_employer_details as (
    select
    employer_no,
    `fiscal year   ` as fiscal_year,
    `employer petitioner name` as employer_petitioner_name,
    tax_id as tax_id,
    `industry naics code` as naics_code,
    `petitioner city` as petitioner_city,
    `petitioner state` as petitioner_state,
    `petitioner zip code` as petitioner_zip_code,
    `initial approval` as initial_approval,
    `initial denial` as initial_denial,
    `continuing approval` as continuing_approval,
    `continuing denial` as continuing_denial,
    _data_source, _load_time
from stg_employer_details_1
) 
select * from stg_employer_details
    );
  
[0m20:38:55.218242 [debug] [Thread-1 (]: On model.cs329e_xh.company_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
      
    
    

    OPTIONS()
    as (
      
with stg_company_data as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`company_data`
)
select * from stg_company_data
    );
  
[0m20:38:55.614450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:24dec932-a09f-44c8-a10b-bda9d0911a3b&page=queryresults
[0m20:38:55.642570 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a8098157-fbbe-419a-8d7d-7dfc998c2723&page=queryresults
[0m20:38:57.704245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe886547c70>]}
[0m20:38:57.705514 [info ] [Thread-1 (]: 1 of 31 OK created sql table model dbt_cs329e_xh_stg.company_data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.76s]
[0m20:38:57.706811 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_data
[0m20:38:57.707551 [debug] [Thread-1 (]: Began running node model.cs329e_xh.h1b_sentiment_analysis
[0m20:38:57.708409 [info ] [Thread-1 (]: 3 of 31 START sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis ......... [RUN]
[0m20:38:57.709845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_data, now model.cs329e_xh.h1b_sentiment_analysis)
[0m20:38:57.710616 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.h1b_sentiment_analysis
[0m20:38:57.716025 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m20:38:57.717007 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.h1b_sentiment_analysis
[0m20:38:57.721705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:57.859035 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m20:38:57.860814 [debug] [Thread-1 (]: On model.cs329e_xh.h1b_sentiment_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.h1b_sentiment_analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
      
    
    

    OPTIONS()
    as (
      
with stg_senti as (
select * 
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`h1b_sentiment_analysis`
)
select * from stg_senti
    );
  
[0m20:38:58.187079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a7de2394-460d-474e-8be3-803b123a1a61&page=queryresults
[0m20:39:00.192652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe886547c70>]}
[0m20:39:00.193886 [info ] [Thread-1 (]: 3 of 31 OK created sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis .... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.48s]
[0m20:39:00.195141 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.h1b_sentiment_analysis
[0m20:39:00.195893 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_appendix
[0m20:39:00.197085 [info ] [Thread-1 (]: 4 of 31 START sql table model dbt_cs329e_xh_stg.lca_appendix ................... [RUN]
[0m20:39:00.197944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.h1b_sentiment_analysis, now model.cs329e_xh.lca_appendix)
[0m20:39:00.198643 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_appendix
[0m20:39:00.203572 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_appendix"
[0m20:39:00.204478 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_appendix
[0m20:39:00.208113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:00.330877 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_appendix"
[0m20:39:00.332060 [debug] [Thread-1 (]: On model.cs329e_xh.lca_appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_appendix as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_appendix`
)
select * from stg_lca_appendix
    );
  
[0m20:39:00.717705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8b933c89-b1d7-4573-9fe9-e667fb06e22e&page=queryresults
[0m20:39:02.688424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8698ff550>]}
[0m20:39:02.689550 [info ] [Thread-1 (]: 4 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.49s]
[0m20:39:02.690796 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_appendix
[0m20:39:02.691498 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_disclosure
[0m20:39:02.692512 [info ] [Thread-1 (]: 5 of 31 START sql table model dbt_cs329e_xh_stg.lca_disclosure ................. [RUN]
[0m20:39:02.693602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_appendix, now model.cs329e_xh.lca_disclosure)
[0m20:39:02.694328 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_disclosure
[0m20:39:02.699427 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_disclosure"
[0m20:39:02.700316 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_disclosure
[0m20:39:02.703974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:02.834688 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_disclosure"
[0m20:39:02.835915 [debug] [Thread-1 (]: On model.cs329e_xh.lca_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
      
    
    

    OPTIONS()
    as (
      
with s as (
SELECT
    * EXCEPT (received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage, total_worksite_locations),
    SAFE_CAST(received_date AS DATETIME) AS received_date,
    SAFE_CAST(decision_date AS DATETIME) AS decision_date,
    SAFE_CAST(original_cert_date AS DATETIME) AS original_cert_date,
    
    SAFE_CAST(total_worker_positions AS INT64) AS total_worker_positions,
    SAFE_CAST(new_employment AS INT64) AS new_employment,
    SAFE_CAST(continued_employment AS INT64) AS continued_employment,
    SAFE_CAST(change_previous_employment AS INT64) AS change_previous_employment,
    SAFE_CAST(new_concurrent_employment AS INT64) AS new_concurrent_employment,
    SAFE_CAST(change_employer AS INT64) AS change_employer,
    SAFE_CAST(amended_petition AS INT64) AS amended_petition,
    SAFE_CAST(worksite_workers AS INT64) AS worksite_workers,
    SAFE_CAST(total_worksite_locations AS INT64) AS total_worksite_locations,

    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_from, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_from,
    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_to, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_to,
    SAFE_CAST(REGEXP_REPLACE(prevailing_wage, r'[\$,]', '') AS FLOAT64) AS prevailing_wage

FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_disclosure`
    )
select * from s
    );
  
[0m20:39:03.213005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:86601343-f4c3-44c2-8b2d-ba2a9c14223b&page=queryresults
[0m20:39:14.482772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8698fc670>]}
[0m20:39:14.483978 [info ] [Thread-1 (]: 5 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_disclosure ............ [[32mCREATE TABLE (561.0k rows, 485.1 MiB processed)[0m in 11.79s]
[0m20:39:14.485249 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_disclosure
[0m20:39:14.485987 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_worksites
[0m20:39:14.487379 [info ] [Thread-1 (]: 6 of 31 START sql table model dbt_cs329e_xh_stg.lca_worksites .................. [RUN]
[0m20:39:14.488412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_disclosure, now model.cs329e_xh.lca_worksites)
[0m20:39:14.489018 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_worksites
[0m20:39:14.493972 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_worksites"
[0m20:39:14.494925 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_worksites
[0m20:39:14.500825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:14.617244 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_worksites"
[0m20:39:14.618440 [debug] [Thread-1 (]: On model.cs329e_xh.lca_worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_worksites as (
select * except(worksite_workers, pw_other_year),
        cast(worksite_workers as int64) as worksite_workers,
        cast(pw_other_year as int64) as pw_other_year
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_worksites`
)
select * from stg_lca_worksites
    );
  
[0m20:39:15.002510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d9d552de-2a4d-44cf-80cb-4fcedd5ff1d1&page=queryresults
[0m20:39:22.356214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8698ff4c0>]}
[0m20:39:22.357452 [info ] [Thread-1 (]: 6 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 7.87s]
[0m20:39:22.358800 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_worksites
[0m20:39:22.359652 [debug] [Thread-1 (]: Began running node model.cs329e_xh.pw_disclosure
[0m20:39:22.360982 [info ] [Thread-1 (]: 7 of 31 START sql table model dbt_cs329e_xh_stg.pw_disclosure .................. [RUN]
[0m20:39:22.361839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_worksites, now model.cs329e_xh.pw_disclosure)
[0m20:39:22.362545 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.pw_disclosure
[0m20:39:22.367838 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.pw_disclosure"
[0m20:39:22.368900 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.pw_disclosure
[0m20:39:22.372855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:22.513991 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.pw_disclosure"
[0m20:39:22.515232 [debug] [Thread-1 (]: On model.cs329e_xh.pw_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.pw_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
      
    
    

    OPTIONS()
    as (
      
with temp as (
select 
    * except(required_experience_months, required_training_months, alt_training_months, alt_experience_months),
    cast(required_training_months as int64) as required_training_months,
    cast(required_experience_months as int64) as required_experience_months,
    cast(alt_training_months as int64) as alt_training_months,
    cast(alt_experience_months as int64) as alt_experience_months
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`pw_disclosure`
),
stg_pw_disclosure as (
    select 
    * except(bls_area),
    SPLIT(bls_area, ',')[SAFE_OFFSET(0)] AS bls_city,
    IFNULL(SPLIT(bls_area, ',')[SAFE_OFFSET(1)], '') AS bls_state
from temp)
select * from stg_pw_disclosure
    );
  
[0m20:39:22.907098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c092cd14-9b73-46d5-80c7-d8f1a412e4b7&page=queryresults
[0m20:39:38.036126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8698ffaf0>]}
[0m20:39:38.037258 [info ] [Thread-1 (]: 7 of 31 OK created sql table model dbt_cs329e_xh_stg.pw_disclosure ............. [[32mCREATE TABLE (237.9k rows, 372.8 MiB processed)[0m in 15.67s]
[0m20:39:38.038406 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.pw_disclosure
[0m20:39:38.039159 [debug] [Thread-1 (]: Began running node model.cs329e_xh.single_registrations
[0m20:39:38.040396 [info ] [Thread-1 (]: 8 of 31 START sql table model dbt_cs329e_xh_stg.single_registrations ........... [RUN]
[0m20:39:38.041229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.pw_disclosure, now model.cs329e_xh.single_registrations)
[0m20:39:38.041868 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.single_registrations
[0m20:39:38.047038 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.single_registrations"
[0m20:39:38.047994 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.single_registrations
[0m20:39:38.052034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:38.169153 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.single_registrations"
[0m20:39:38.170338 [debug] [Thread-1 (]: On model.cs329e_xh.single_registrations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.single_registrations"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
      
    
    

    OPTIONS()
    as (
      
with t1 as (
select
    case bcn when '(b)(6)' THEN NULL ELSE bcn END AS bcn,
    case receipt_number when '(b)(6)' THEN NULL ELSE receipt_number END AS receipt_number,
    case ben_date_of_birth when '(b)(6)' THEN NULL ELSE ben_date_of_birth END AS ben_date_of_birth,
    case dol_eta_case_number when '(b)(6)' THEN NULL ELSE dol_eta_case_number END AS dol_eta_case_number,
    *
EXCEPT (bcn, receipt_number, ben_date_of_birth, dol_eta_case_number)
FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`single_registrations`
WHERE bcn != '(b)(3) (b)(6) (b)(7)(c)'
)
, t2 as (select * except(bcn, receipt_number, ben_date_of_birth, dol_eta_case_number, t_u_vawa_flag)
FROM t1)
select * from t2
    );
  
[0m20:39:38.562229 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4e903d79-9ba2-49ab-9857-91c0805e1a24&page=queryresults
[0m20:39:43.013262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8698ffaf0>]}
[0m20:39:43.014464 [info ] [Thread-1 (]: 8 of 31 OK created sql table model dbt_cs329e_xh_stg.single_registrations ...... [[32mCREATE TABLE (350.1k rows, 78.4 MiB processed)[0m in 4.97s]
[0m20:39:43.015637 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.single_registrations
[0m20:39:43.016417 [debug] [Thread-1 (]: Began running node model.cs329e_xh.wage_summary
[0m20:39:43.017495 [info ] [Thread-1 (]: 9 of 31 START sql table model dbt_cs329e_xh_stg.wage_summary ................... [RUN]
[0m20:39:43.018666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.single_registrations, now model.cs329e_xh.wage_summary)
[0m20:39:43.019269 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.wage_summary
[0m20:39:43.026203 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.wage_summary"
[0m20:39:43.027150 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.wage_summary
[0m20:39:43.030992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:43.134029 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.wage_summary"
[0m20:39:43.136195 [debug] [Thread-1 (]: On model.cs329e_xh.wage_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
      
    
    

    OPTIONS()
    as (
      
with stg_wage_summary as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`wage_summary`
)
select * from stg_wage_summary
    );
  
[0m20:39:43.487013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ef0e6dba-5cf3-4db8-92a0-2718630bc83b&page=queryresults
[0m20:39:45.935220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe869fd9900>]}
[0m20:39:45.936377 [info ] [Thread-1 (]: 9 of 31 OK created sql table model dbt_cs329e_xh_stg.wage_summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.92s]
[0m20:39:45.937626 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.wage_summary
[0m20:39:45.938363 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m20:39:45.939348 [info ] [Thread-1 (]: 10 of 31 START sql table model dbt_cs329e_xh_int.Company_Data .................. [RUN]
[0m20:39:45.940561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.wage_summary, now model.cs329e_xh.Company_Data)
[0m20:39:45.941186 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m20:39:45.946335 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m20:39:45.947230 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m20:39:45.951103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:46.089966 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:46.561746 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:790a0030-3cc4-457b-ba2f-8fbde1923168&page=queryresults
[0m20:39:46.683460 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as int64)
 as count, 
      
    cast(null as string)
 as employer_url, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:46.992548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:db0d11c8-eabd-44bd-a359-e76b7996e760&page=queryresults
[0m20:39:47.110985 [debug] [Thread-1 (]: Compilation Error in model Company_Data (models/int/Company_Data.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Company_Data (models/int/Company_Data.sql)
[0m20:39:47.112134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86974b460>]}
[0m20:39:47.113259 [error] [Thread-1 (]: 10 of 31 ERROR creating sql table model dbt_cs329e_xh_int.Company_Data ......... [[31mERROR[0m in 1.17s]
[0m20:39:47.114606 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m20:39:47.115314 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m20:39:47.116266 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.Company_Data' to be skipped because of status 'error'.  Reason: Compilation Error in model Company_Data (models/int/Company_Data.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Company_Data (models/int/Company_Data.sql).
[0m20:39:47.117338 [info ] [Thread-1 (]: 11 of 31 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............ [RUN]
[0m20:39:47.119601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m20:39:47.120320 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m20:39:47.124925 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m20:39:47.125836 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m20:39:47.131527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:47.265559 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:47.694089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:12d85f79-b281-4f36-bcf0-b2ba4e67ff0a&page=queryresults
[0m20:39:47.810171 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        select
    
      
    cast(null as timestamp)
 as publication_date, 
      
    cast(null as string)
 as text_summary, 
      
    cast(null as string)
 as sentiment, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:48.159963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9a048583-a484-4bef-bb0b-099941f97e05&page=queryresults
[0m20:39:48.274835 [debug] [Thread-1 (]: Compilation Error in model Sentiment_Analysis (models/int/Sentiment_Analysis.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name      | definition_type | contract_type | mismatch_reason    |
  | ---------------- | --------------- | ------------- | ------------------ |
  | _load_time       | DATETIME        | TIMESTAMP     | data type mismatch |
  | publication_date | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Sentiment_Analysis (models/int/Sentiment_Analysis.sql)
[0m20:39:48.276014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe869fd9900>]}
[0m20:39:48.277131 [error] [Thread-1 (]: 11 of 31 ERROR creating sql table model dbt_cs329e_xh_int.Sentiment_Analysis ... [[31mERROR[0m in 1.16s]
[0m20:39:48.278294 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m20:39:48.279041 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m20:39:48.279992 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.Sentiment_Analysis' to be skipped because of status 'error'.  Reason: Compilation Error in model Sentiment_Analysis (models/int/Sentiment_Analysis.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name      | definition_type | contract_type | mismatch_reason    |
  | ---------------- | --------------- | ------------- | ------------------ |
  | _load_time       | DATETIME        | TIMESTAMP     | data type mismatch |
  | publication_date | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Sentiment_Analysis (models/int/Sentiment_Analysis.sql).
[0m20:39:48.280946 [info ] [Thread-1 (]: 12 of 31 START sql table model dbt_cs329e_xh_int.LCA_Appendix .................. [RUN]
[0m20:39:48.282327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.LCA_Appendix)
[0m20:39:48.282968 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m20:39:48.287640 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m20:39:48.288578 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m20:39:48.292876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:48.419777 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:48.776942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ee35bf51-ef84-4cc4-90fb-ba93dd67bc62&page=queryresults
[0m20:39:48.879837 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as timestamp)
 as appx_a_date_of_degree, 
      
    cast(null as string)
 as appx_a_name_of_institution, 
      
    cast(null as int64)
 as appx_a_no_of_exempt_workers, 
      
    cast(null as string)
 as appx_a_field_of_study, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:49.140867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9b868936-3a72-4ba1-b156-63062caf1dc5&page=queryresults
[0m20:39:49.271759 [debug] [Thread-1 (]: Compilation Error in model LCA_Appendix (models/int/LCA_Appendix.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name           | definition_type | contract_type | mismatch_reason    |
  | --------------------- | --------------- | ------------- | ------------------ |
  | _load_time            | DATETIME        | TIMESTAMP     | data type mismatch |
  | appx_a_date_of_degree | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model LCA_Appendix (models/int/LCA_Appendix.sql)
[0m20:39:49.272866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8683bf730>]}
[0m20:39:49.273935 [error] [Thread-1 (]: 12 of 31 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Appendix ......... [[31mERROR[0m in 0.99s]
[0m20:39:49.275048 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m20:39:49.275769 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m20:39:49.276753 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.LCA_Appendix' to be skipped because of status 'error'.  Reason: Compilation Error in model LCA_Appendix (models/int/LCA_Appendix.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name           | definition_type | contract_type | mismatch_reason    |
  | --------------------- | --------------- | ------------- | ------------------ |
  | _load_time            | DATETIME        | TIMESTAMP     | data type mismatch |
  | appx_a_date_of_degree | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model LCA_Appendix (models/int/LCA_Appendix.sql).
[0m20:39:49.277660 [info ] [Thread-1 (]: 13 of 31 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................ [RUN]
[0m20:39:49.278767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m20:39:49.279387 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m20:39:49.284575 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m20:39:49.285517 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m20:39:49.291633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:49.421260 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:49.836689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:70b89fba-4dd1-4288-9d9f-1d3e79301292&page=queryresults
[0m20:39:49.982501 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as case_status, 
      
    cast(null as string)
 as visa_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as soc_code, 
      
    cast(null as string)
 as soc_title, 
      
    cast(null as string)
 as full_time_position, 
      
    cast(null as string)
 as begin_date, 
      
    cast(null as string)
 as end_date, 
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as trade_name_dba, 
      
    cast(null as string)
 as employer_address1, 
      
    cast(null as string)
 as employer_address2, 
      
    cast(null as string)
 as employer_city, 
      
    cast(null as string)
 as employer_state, 
      
    cast(null as string)
 as employer_postal_code, 
      
    cast(null as string)
 as employer_country, 
      
    cast(null as string)
 as employer_province, 
      
    cast(null as string)
 as employer_phone, 
      
    cast(null as string)
 as employer_phone_ext, 
      
    cast(null as string)
 as employer_fein, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as employer_poc_last_name, 
      
    cast(null as string)
 as employer_poc_first_name, 
      
    cast(null as string)
 as employer_poc_middle_name, 
      
    cast(null as string)
 as employer_poc_job_title, 
      
    cast(null as string)
 as employer_poc_address1, 
      
    cast(null as string)
 as employer_poc_address2, 
      
    cast(null as string)
 as employer_poc_city, 
      
    cast(null as string)
 as employer_poc_state, 
      
    cast(null as string)
 as employer_poc_postal_code, 
      
    cast(null as string)
 as employer_poc_country, 
      
    cast(null as string)
 as employer_poc_province, 
      
    cast(null as string)
 as employer_poc_phone, 
      
    cast(null as string)
 as employer_poc_phone_ext, 
      
    cast(null as string)
 as employer_poc_email, 
      
    cast(null as string)
 as agent_representing_employer, 
      
    cast(null as string)
 as agent_attorney_last_name, 
      
    cast(null as string)
 as agent_attorney_first_name, 
      
    cast(null as string)
 as agent_attorney_middle_name, 
      
    cast(null as string)
 as agent_attorney_address1, 
      
    cast(null as string)
 as agent_attorney_address2, 
      
    cast(null as string)
 as agent_attorney_city, 
      
    cast(null as string)
 as agent_attorney_state, 
      
    cast(null as string)
 as agent_attorney_postal_code, 
      
    cast(null as string)
 as agent_attorney_country, 
      
    cast(null as string)
 as agent_attorney_province, 
      
    cast(null as string)
 as agent_attorney_phone, 
      
    cast(null as string)
 as agent_attorney_phone_ext, 
      
    cast(null as string)
 as agent_attorney_email_address, 
      
    cast(null as string)
 as lawfirm_name_business_name, 
      
    cast(null as string)
 as state_of_highest_court, 
      
    cast(null as string)
 as name_of_highest_state_court, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_other_year, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as agree_to_lc_statement, 
      
    cast(null as string)
 as h_1b_dependent, 
      
    cast(null as string)
 as willful_violator, 
      
    cast(null as string)
 as support_h1b, 
      
    cast(null as string)
 as statutory_basis, 
      
    cast(null as string)
 as appendix_a_attached, 
      
    cast(null as string)
 as public_disclosure, 
      
    cast(null as string)
 as preparer_last_name, 
      
    cast(null as string)
 as preparer_first_name, 
      
    cast(null as string)
 as preparer_middle_initial, 
      
    cast(null as string)
 as preparer_business_name, 
      
    cast(null as string)
 as preparer_email, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time, 
      
    cast(null as timestamp)
 as received_date, 
      
    cast(null as timestamp)
 as decision_date, 
      
    cast(null as timestamp)
 as original_cert_date, 
      
    cast(null as int64)
 as total_worker_positions, 
      
    cast(null as int64)
 as new_employment, 
      
    cast(null as int64)
 as continued_employment, 
      
    cast(null as int64)
 as change_previous_employment, 
      
    cast(null as int64)
 as new_concurrent_employment, 
      
    cast(null as int64)
 as change_employer, 
      
    cast(null as int64)
 as amended_petition, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as total_worksite_locations, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as float64)
 as prevailing_wage
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:50.303486 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b12884bd-7a33-4a20-860e-95fd98ab85c3&page=queryresults
[0m20:39:50.426414 [debug] [Thread-1 (]: Compilation Error in model LCA_Disclosure (models/int/LCA_Disclosure.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name        | definition_type | contract_type | mismatch_reason    |
  | ------------------ | --------------- | ------------- | ------------------ |
  | _load_time         | DATETIME        | TIMESTAMP     | data type mismatch |
  | decision_date      | DATETIME        | TIMESTAMP     | data type mismatch |
  | original_cert_date | DATETIME        | TIMESTAMP     | data type mismatch |
  | received_date      | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model LCA_Disclosure (models/int/LCA_Disclosure.sql)
[0m20:39:50.427736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86a2eada0>]}
[0m20:39:50.429059 [error] [Thread-1 (]: 13 of 31 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Disclosure ....... [[31mERROR[0m in 1.15s]
[0m20:39:50.430393 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m20:39:50.431149 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m20:39:50.432057 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.LCA_Disclosure' to be skipped because of status 'error'.  Reason: Compilation Error in model LCA_Disclosure (models/int/LCA_Disclosure.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name        | definition_type | contract_type | mismatch_reason    |
  | ------------------ | --------------- | ------------- | ------------------ |
  | _load_time         | DATETIME        | TIMESTAMP     | data type mismatch |
  | decision_date      | DATETIME        | TIMESTAMP     | data type mismatch |
  | original_cert_date | DATETIME        | TIMESTAMP     | data type mismatch |
  | received_date      | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model LCA_Disclosure (models/int/LCA_Disclosure.sql).
[0m20:39:50.432975 [info ] [Thread-1 (]: 14 of 31 START sql table model dbt_cs329e_xh_int.LCA_Worksites ................. [RUN]
[0m20:39:50.434688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.LCA_Worksites)
[0m20:39:50.435347 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m20:39:50.440253 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m20:39:50.441132 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m20:39:50.445028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:50.580174 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:50.952253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:881760f5-eade-4ccb-bf05-9d8e2dc39767&page=queryresults
[0m20:39:51.062796 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        select
    
      
    cast(null as string)
 as row_id, 
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as float64)
 as prevailing_wage, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as pw_other_year
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:39:51.335327 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:08fe0cf2-f2dd-4331-a6c6-b061465b76cd&page=queryresults
[0m20:39:51.473457 [debug] [Thread-1 (]: Compilation Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model LCA_Worksites (models/int/LCA_Worksites.sql)
[0m20:39:51.474806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86a2eb160>]}
[0m20:39:51.475972 [error] [Thread-1 (]: 14 of 31 ERROR creating sql table model dbt_cs329e_xh_int.LCA_Worksites ........ [[31mERROR[0m in 1.04s]
[0m20:39:51.477194 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m20:39:51.477970 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m20:39:51.478905 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.LCA_Worksites' to be skipped because of status 'error'.  Reason: Compilation Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model LCA_Worksites (models/int/LCA_Worksites.sql).
[0m20:39:51.479978 [info ] [Thread-1 (]: 15 of 31 START sql table model dbt_cs329e_xh_int.PW_Disclosure ................. [RUN]
[0m20:39:51.481618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.PW_Disclosure)
[0m20:39:51.482357 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m20:39:51.487075 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m20:39:51.487940 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m20:39:51.492072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:51.619735 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m20:39:51.620916 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m20:39:51.955528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:37f312b5-c632-4bf6-89df-1efa305fc6b6&page=queryresults
[0m20:40:04.546459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88538b9a0>]}
[0m20:40:04.548283 [info ] [Thread-1 (]: 15 of 31 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............ [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 13.06s]
[0m20:40:04.549951 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m20:40:04.551082 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m20:40:04.552576 [info ] [Thread-1 (]: 16 of 31 START sql table model dbt_cs329e_xh_int.Single_Registration ........... [RUN]
[0m20:40:04.553817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.Single_Registration)
[0m20:40:04.554803 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m20:40:04.565609 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m20:40:04.567137 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m20:40:04.574189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:04.707762 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: select * from (
        with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:40:05.043662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1b4c8fd6-01ae-499e-93e3-242aa9b7b316&page=queryresults
[0m20:40:05.191926 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as ben_year_of_birth, 
      
    cast(null as string)
 as gender, 
      
    cast(null as string)
 as agent_first_name, 
      
    cast(null as string)
 as agent_last_name, 
      
    cast(null as string)
 as mail_addr, 
      
    cast(null as string)
 as country_of_birth, 
      
    cast(null as string)
 as country_of_nationality, 
      
    cast(null as string)
 as fein, 
      
    cast(null as string)
 as city, 
      
    cast(null as string)
 as state, 
      
    cast(null as string)
 as zip, 
      
    cast(null as string)
 as lottery_year, 
      
    cast(null as string)
 as status_type, 
      
    cast(null as string)
 as ben_multi_reg_ind, 
      
    cast(null as string)
 as rec_date, 
      
    cast(null as string)
 as first_decision, 
      
    cast(null as string)
 as first_decision_date, 
      
    cast(null as string)
 as i129_employer_name, 
      
    cast(null as string)
 as pet_street, 
      
    cast(null as string)
 as pet_city, 
      
    cast(null as string)
 as pet_state, 
      
    cast(null as string)
 as pet_zip, 
      
    cast(null as string)
 as requested_class, 
      
    cast(null as string)
 as basis_for_classification, 
      
    cast(null as string)
 as requested_action, 
      
    cast(null as string)
 as number_of_beneficiaries, 
      
    cast(null as string)
 as ben_sex, 
      
    cast(null as string)
 as ben_country_of_birth, 
      
    cast(null as string)
 as ben_current_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as worksite_street, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_zip, 
      
    cast(null as string)
 as full_time_ind, 
      
    cast(null as string)
 as wage_amt, 
      
    cast(null as string)
 as wage_unit, 
      
    cast(null as string)
 as valid_from, 
      
    cast(null as string)
 as valid_to, 
      
    cast(null as string)
 as num_of_emp_in_us, 
      
    cast(null as string)
 as s1q1a, 
      
    cast(null as string)
 as s1q1b, 
      
    cast(null as string)
 as ben_education_code, 
      
    cast(null as string)
 as ed_level_definition, 
      
    cast(null as string)
 as ben_pfield_of_study, 
      
    cast(null as string)
 as ben_comp_paid, 
      
    cast(null as string)
 as dot_code, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as s3q1, 
      
    cast(null as string)
 as s4q1, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:40:05.519188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4361de3a-3761-400e-a88d-cbb55b0be141&page=queryresults
[0m20:40:05.642474 [debug] [Thread-1 (]: Compilation Error in model Single_Registration (models/int/Single_Registration.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Single_Registration (models/int/Single_Registration.sql)
[0m20:40:05.643660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88538b9a0>]}
[0m20:40:05.644741 [error] [Thread-1 (]: 16 of 31 ERROR creating sql table model dbt_cs329e_xh_int.Single_Registration .. [[31mERROR[0m in 1.09s]
[0m20:40:05.646198 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m20:40:05.646922 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m20:40:05.647789 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.Single_Registration' to be skipped because of status 'error'.  Reason: Compilation Error in model Single_Registration (models/int/Single_Registration.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Single_Registration (models/int/Single_Registration.sql).
[0m20:40:05.648657 [info ] [Thread-1 (]: 17 of 31 START sql table model dbt_cs329e_xh_int.temp_emp ...................... [RUN]
[0m20:40:05.650725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.temp_emp)
[0m20:40:05.651481 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m20:40:05.656415 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m20:40:05.658967 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_emp
[0m20:40:05.662992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:05.845422 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m20:40:05.846602 [debug] [Thread-1 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw),
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m20:40:06.096565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cd5527c0-7925-4739-b17c-ccebf4ba8470&page=queryresults
[0m20:40:08.804548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8683bf730>]}
[0m20:40:08.806503 [info ] [Thread-1 (]: 17 of 31 OK created sql table model dbt_cs329e_xh_int.temp_emp ................. [[32mCREATE TABLE (90.2k rows, 19.9 MiB processed)[0m in 3.15s]
[0m20:40:08.808169 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m20:40:08.809370 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m20:40:08.810932 [info ] [Thread-1 (]: 18 of 31 START sql table model dbt_cs329e_xh_int.Wage_Summary .................. [RUN]
[0m20:40:08.812246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.Wage_Summary)
[0m20:40:08.813282 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m20:40:08.821114 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m20:40:08.822703 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m20:40:08.829722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:08.963212 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: select * from (
        with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:40:09.287510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c4d5642d-eeea-415a-9281-ca8c806acf04&page=queryresults
[0m20:40:09.392273 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: select * from (
        select
    
      
    cast(null as string)
 as company_name, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as int64)
 as min_wage, 
      
    cast(null as int64)
 as max_wage, 
      
    cast(null as float64)
 as average_wage, 
      
    cast(null as int64)
 as job_count, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as timestamp)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:40:09.621930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ab03495c-af7b-46d2-af06-ebc522a3b09c&page=queryresults
[0m20:40:09.737916 [debug] [Thread-1 (]: Compilation Error in model Wage_Summary (models/int/Wage_Summary.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Wage_Summary (models/int/Wage_Summary.sql)
[0m20:40:09.739061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe869fd9900>]}
[0m20:40:09.740173 [error] [Thread-1 (]: 18 of 31 ERROR creating sql table model dbt_cs329e_xh_int.Wage_Summary ......... [[31mERROR[0m in 0.93s]
[0m20:40:09.741313 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m20:40:09.742080 [debug] [Thread-1 (]: Began running node model.cs329e_xh.approval_rate_by_month
[0m20:40:09.742994 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.Wage_Summary' to be skipped because of status 'error'.  Reason: Compilation Error in model Wage_Summary (models/int/Wage_Summary.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Wage_Summary (models/int/Wage_Summary.sql).
[0m20:40:09.743739 [info ] [Thread-1 (]: 19 of 31 SKIP relation dbt_cs329e_xh_mrt.approval_rate_by_month ................ [[33mSKIP[0m]
[0m20:40:09.744800 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.approval_rate_by_month
[0m20:40:09.745486 [debug] [Thread-1 (]: Began running node model.cs329e_xh.major_wage_level
[0m20:40:09.746275 [info ] [Thread-1 (]: 20 of 31 SKIP relation dbt_cs329e_xh_mrt.major_wage_level ...................... [[33mSKIP[0m]
[0m20:40:09.746996 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.major_wage_level
[0m20:40:09.747646 [debug] [Thread-1 (]: Began running node model.cs329e_xh.soc_wage_level
[0m20:40:09.748400 [info ] [Thread-1 (]: 21 of 31 SKIP relation dbt_cs329e_xh_mrt.soc_wage_level ........................ [[33mSKIP[0m]
[0m20:40:09.749108 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.soc_wage_level
[0m20:40:09.749752 [debug] [Thread-1 (]: Began running node model.cs329e_xh.city_approval_rate
[0m20:40:09.750530 [info ] [Thread-1 (]: 22 of 31 SKIP relation dbt_cs329e_xh_mrt.city_approval_rate .................... [[33mSKIP[0m]
[0m20:40:09.751245 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.city_approval_rate
[0m20:40:09.751884 [debug] [Thread-1 (]: Began running node model.cs329e_xh.state_approval_rate
[0m20:40:09.752639 [info ] [Thread-1 (]: 23 of 31 SKIP relation dbt_cs329e_xh_mrt.state_approval_rate ................... [[33mSKIP[0m]
[0m20:40:09.753351 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.state_approval_rate
[0m20:40:09.753986 [debug] [Thread-1 (]: Began running node model.cs329e_xh.state_wage_level
[0m20:40:09.754754 [info ] [Thread-1 (]: 24 of 31 SKIP relation dbt_cs329e_xh_mrt.state_wage_level ...................... [[33mSKIP[0m]
[0m20:40:09.755469 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.state_wage_level
[0m20:40:13.274667 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8697486a0>]}
[0m20:40:13.275791 [info ] [Thread-2 (]: 2 of 31 OK created sql table model dbt_cs329e_xh_stg.employer_details .......... [[32mCREATE TABLE (61.5k rows, 9.3 MiB processed)[0m in 78.33s]
[0m20:40:13.277012 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.employer_details
[0m20:40:13.278480 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m20:40:13.279304 [info ] [Thread-1 (]: 25 of 31 START sql table model dbt_cs329e_xh_int.temp_employer_details ......... [RUN]
[0m20:40:13.280100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_employer_details)
[0m20:40:13.280714 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m20:40:13.285566 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m20:40:13.286458 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_employer_details
[0m20:40:13.290024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:13.415490 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_employer_details"
[0m20:40:13.416613 [debug] [Thread-1 (]: On model.cs329e_xh.temp_employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_employer_details`
      
    
    

    OPTIONS()
    as (
      WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp` as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched
    );
  
[0m20:40:13.752672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3f6a0b9b-6303-4a4f-9ace-d43d0a922b13&page=queryresults
[0m20:40:33.540676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8698ffe50>]}
[0m20:40:33.542055 [info ] [Thread-1 (]: 25 of 31 OK created sql table model dbt_cs329e_xh_int.temp_employer_details .... [[32mCREATE TABLE (589.3k rows, 4.9 MiB processed)[0m in 20.26s]
[0m20:40:33.543311 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m20:40:33.544616 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m20:40:33.545469 [info ] [Thread-2 (]: 26 of 31 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m20:40:33.546251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.employer_details, now model.cs329e_xh.matching)
[0m20:40:33.546885 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching
[0m20:40:33.579484 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m20:40:33.580556 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching
[0m20:40:33.584540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:33.757963 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m20:40:33.759160 [debug] [Thread-2 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    current_dir = os.path.dirname(__file__)
    matching = dbt.ref("matched_results_full")
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"matched_results_full": "silken-fortress-448205-p9.cs329e_xh_dbt.matched_results_full", "temp_employer_details": "silken-fortress-448205-p9.dbt_cs329e_xh_int.temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m20:40:33.820457 [debug] [Thread-2 (]: BigQuery adapter: Submitting batch job with id: aade6d13-ed5f-4016-84aa-5bf93d075eb3
[0m20:45:57.240617 [debug] [Thread-2 (]: Execution status: OK in 323.4800109863281 seconds
[0m20:45:57.245266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86a347d90>]}
[0m20:45:57.246948 [info ] [Thread-2 (]: 26 of 31 OK created python table model dbt_cs329e_xh_int.matching .............. [[32mOK[0m in 323.70s]
[0m20:45:57.248241 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.matching
[0m20:45:57.249741 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m20:45:57.250949 [info ] [Thread-1 (]: 27 of 31 START sql table model dbt_cs329e_xh_int.Employer_Detail ............... [RUN]
[0m20:45:57.251823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.Employer_Detail)
[0m20:45:57.252470 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Employer_Detail
[0m20:45:57.258095 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Employer_Detail"
[0m20:45:57.259267 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Employer_Detail
[0m20:45:57.263524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:57.410734 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp where employer_petitioner_name is not null
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:45:57.829227 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:24578018-1970-4216-bab5-32741ef2bcb7&page=queryresults
[0m20:45:57.978713 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        select
    
      
    cast(null as string)
 as employer_petitioner_name, 
      
    cast(null as string)
 as fein, 
      
    cast(null as int64)
 as employer_no, 
      
    cast(null as int64)
 as fiscal_year, 
      
    cast(null as string)
 as tax_id, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as petitioner_city, 
      
    cast(null as string)
 as petitioner_state, 
      
    cast(null as string)
 as petitioner_zip_code, 
      
    cast(null as string)
 as initial_approval, 
      
    cast(null as int64)
 as initial_denial, 
      
    cast(null as string)
 as continuing_approval, 
      
    cast(null as int64)
 as continuing_denial, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:45:58.473923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0b2a26a1-c7ea-4dc0-814e-22635eae6e29&page=queryresults
[0m20:45:58.611454 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:45:58.623270 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Employer_Detail"
[0m20:45:58.624582 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Employer_Detail"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
        
  (
    employer_petitioner_name string,
    fein string,
    employer_no int64,
    fiscal_year int64,
    tax_id string,
    naics_code string,
    petitioner_city string,
    petitioner_state string,
    petitioner_zip_code string,
    initial_approval string,
    initial_denial int64,
    continuing_approval string,
    continuing_denial int64,
    _data_source string,
    _load_time datetime,
    
    primary key (employer_petitioner_name) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_petitioner_name, fein, employer_no, fiscal_year, tax_id, naics_code, petitioner_city, petitioner_state, petitioner_zip_code, initial_approval, initial_denial, continuing_approval, continuing_denial, _data_source, _load_time
    from (
        with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp where employer_petitioner_name is not null
    ) as model_subq
    );
  
[0m20:45:58.997282 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3874102b-4088-4444-950c-64911240aca5&page=queryresults
[0m20:46:03.835210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c264072e-9e9f-41e3-a270-aa549258dc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86a54d9c0>]}
[0m20:46:03.837195 [info ] [Thread-1 (]: 27 of 31 OK created sql table model dbt_cs329e_xh_int.Employer_Detail .......... [[32mCREATE TABLE (28.9k rows, 10.8 MiB processed)[0m in 6.58s]
[0m20:46:03.838983 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m20:46:03.842611 [debug] [Thread-2 (]: Began running node model.cs329e_xh.company_approval_rate
[0m20:46:03.845294 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_wage_level
[0m20:46:03.843805 [info ] [Thread-2 (]: 28 of 31 SKIP relation dbt_cs329e_xh_mrt.company_approval_rate ................. [[33mSKIP[0m]
[0m20:46:03.848225 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.company_approval_rate
[0m20:46:03.849331 [debug] [Thread-2 (]: Began running node model.cs329e_xh.industry_approval_rate
[0m20:46:03.846479 [info ] [Thread-1 (]: 29 of 31 SKIP relation dbt_cs329e_xh_mrt.company_wage_level .................... [[33mSKIP[0m]
[0m20:46:03.853224 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_wage_level
[0m20:46:03.855426 [debug] [Thread-1 (]: Began running node model.cs329e_xh.wage_level_by_industry
[0m20:46:03.851825 [info ] [Thread-2 (]: 30 of 31 SKIP relation dbt_cs329e_xh_mrt.industry_approval_rate ................ [[33mSKIP[0m]
[0m20:46:03.859041 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.industry_approval_rate
[0m20:46:03.856622 [info ] [Thread-1 (]: 31 of 31 SKIP relation dbt_cs329e_xh_mrt.wage_level_by_industry ................ [[33mSKIP[0m]
[0m20:46:03.860782 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.wage_level_by_industry
[0m20:46:03.863811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:03.866403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:03.867448 [debug] [MainThread]: Connection 'model.cs329e_xh.Employer_Detail' was properly closed.
[0m20:46:03.868388 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m20:46:03.869622 [info ] [MainThread]: 
[0m20:46:03.870634 [info ] [MainThread]: Finished running 31 table models in 0 hours 7 minutes and 9.68 seconds (429.68s).
[0m20:46:03.883108 [debug] [MainThread]: Command end result
[0m20:46:03.992532 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:46:03.996693 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:46:04.015232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:46:04.016384 [info ] [MainThread]: 
[0m20:46:04.017520 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m20:46:04.018576 [info ] [MainThread]: 
[0m20:46:04.019724 [error] [MainThread]:   Compilation Error in model Company_Data (models/int/Company_Data.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Company_Data (models/int/Company_Data.sql)
[0m20:46:04.020728 [info ] [MainThread]: 
[0m20:46:04.021886 [error] [MainThread]:   Compilation Error in model Sentiment_Analysis (models/int/Sentiment_Analysis.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name      | definition_type | contract_type | mismatch_reason    |
  | ---------------- | --------------- | ------------- | ------------------ |
  | _load_time       | DATETIME        | TIMESTAMP     | data type mismatch |
  | publication_date | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Sentiment_Analysis (models/int/Sentiment_Analysis.sql)
[0m20:46:04.022951 [info ] [MainThread]: 
[0m20:46:04.024149 [error] [MainThread]:   Compilation Error in model LCA_Appendix (models/int/LCA_Appendix.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name           | definition_type | contract_type | mismatch_reason    |
  | --------------------- | --------------- | ------------- | ------------------ |
  | _load_time            | DATETIME        | TIMESTAMP     | data type mismatch |
  | appx_a_date_of_degree | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model LCA_Appendix (models/int/LCA_Appendix.sql)
[0m20:46:04.025211 [info ] [MainThread]: 
[0m20:46:04.026379 [error] [MainThread]:   Compilation Error in model LCA_Disclosure (models/int/LCA_Disclosure.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name        | definition_type | contract_type | mismatch_reason    |
  | ------------------ | --------------- | ------------- | ------------------ |
  | _load_time         | DATETIME        | TIMESTAMP     | data type mismatch |
  | decision_date      | DATETIME        | TIMESTAMP     | data type mismatch |
  | original_cert_date | DATETIME        | TIMESTAMP     | data type mismatch |
  | received_date      | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model LCA_Disclosure (models/int/LCA_Disclosure.sql)
[0m20:46:04.027430 [info ] [MainThread]: 
[0m20:46:04.028545 [error] [MainThread]:   Compilation Error in model LCA_Worksites (models/int/LCA_Worksites.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model LCA_Worksites (models/int/LCA_Worksites.sql)
[0m20:46:04.029543 [info ] [MainThread]: 
[0m20:46:04.030682 [error] [MainThread]:   Compilation Error in model Single_Registration (models/int/Single_Registration.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Single_Registration (models/int/Single_Registration.sql)
[0m20:46:04.031680 [info ] [MainThread]: 
[0m20:46:04.032777 [error] [MainThread]:   Compilation Error in model Wage_Summary (models/int/Wage_Summary.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | _load_time  | DATETIME        | TIMESTAMP     | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro bigquery__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model Wage_Summary (models/int/Wage_Summary.sql)
[0m20:46:04.033851 [info ] [MainThread]: 
[0m20:46:04.034846 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=7 SKIP=10 TOTAL=31
[0m20:46:04.036376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 433.35626, "process_in_blocks": "11032", "process_kernel_time": 0.655035, "process_mem_max_rss": "282224", "process_out_blocks": "5008", "process_user_time": 7.170311}
[0m20:46:04.037607 [debug] [MainThread]: Command `dbt run` failed at 20:46:04.037366 after 433.36 seconds
[0m20:46:04.038685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8862795a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86976fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe886141d20>]}
[0m20:46:04.039752 [debug] [MainThread]: Flushing usage events
[0m20:46:04.490217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:24.143418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba5aa95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba4c323e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba4c32380>]}


============================== 20:49:24.147017 | b1d90be0-8091-4b25-9a60-0ef834276f0f ==============================
[0m20:49:24.147017 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:49:24.148125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:49:25.795764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1d90be0-8091-4b25-9a60-0ef834276f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba4bcd7e0>]}
[0m20:49:25.878959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1d90be0-8091-4b25-9a60-0ef834276f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba4c305e0>]}
[0m20:49:25.879984 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:49:26.050298 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:49:26.282543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m20:49:26.283697 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/stg/.ipynb_checkpoints/schema-checkpoint.yml
[0m20:49:26.284393 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/schema-checkpoint.yml
[0m20:49:26.286799 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/schema.yml
[0m20:49:26.690910 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "cs329e_xh_raw_company_data".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("cs329e_xh_raw", "company_data").
  
  To fix this, change the name of one of these resources:
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/.ipynb_checkpoints/schema-checkpoint.yml)
  - source.cs329e_xh.cs329e_xh_raw.company_data (models/stg/schema.yml)
[0m20:49:26.692040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.626351, "process_in_blocks": "0", "process_kernel_time": 0.400796, "process_mem_max_rss": "257588", "process_out_blocks": "16", "process_user_time": 4.300556}
[0m20:49:26.692930 [debug] [MainThread]: Command `dbt run` failed at 20:49:26.692778 after 2.63 seconds
[0m20:49:26.693549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba5aa95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b89019750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b890197b0>]}
[0m20:49:26.694326 [debug] [MainThread]: Flushing usage events
[0m20:49:27.027101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:50.582648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60b9d55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60ab5e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60ab5e380>]}


============================== 20:49:50.586343 | d70ed2b7-e256-4424-aa61-067f17122157 ==============================
[0m20:49:50.586343 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:49:50.587210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:49:52.237768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd70ed2b7-e256-4424-aa61-067f17122157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60aaf8a30>]}
[0m20:49:52.321554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd70ed2b7-e256-4424-aa61-067f17122157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60b069510>]}
[0m20:49:52.322630 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:49:52.492467 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:49:52.727663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:49:52.728814 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/mrt/.ipynb_checkpoints/schema-checkpoint.yml
[0m20:49:52.731273 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/schema.yml
[0m20:49:53.140648 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "cs329e_xh_raw_approval_rate_by_month".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("cs329e_xh_raw", "approval_rate_by_month").
  
  To fix this, change the name of one of these resources:
  - source.cs329e_xh.cs329e_xh_raw.approval_rate_by_month (models/mrt/.ipynb_checkpoints/schema-checkpoint.yml)
  - source.cs329e_xh.cs329e_xh_raw.approval_rate_by_month (models/mrt/schema.yml)
[0m20:49:53.141824 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6371162, "process_in_blocks": "0", "process_kernel_time": 0.463758, "process_mem_max_rss": "257844", "process_out_blocks": "8", "process_user_time": 4.253184}
[0m20:49:53.142697 [debug] [MainThread]: Command `dbt run` failed at 20:49:53.142548 after 2.64 seconds
[0m20:49:53.143318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60b9d55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ef0d36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5eef79990>]}
[0m20:49:53.143929 [debug] [MainThread]: Flushing usage events
[0m20:49:53.320124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:47.046128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbd0f15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbc29e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbc29e320>]}


============================== 20:50:47.049661 | 2ed6efaa-2975-474b-9489-4d97cd4e1f15 ==============================
[0m20:50:47.049661 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:47.050541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:48.697082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbc666fb0>]}
[0m20:50:48.780350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbcfc26e0>]}
[0m20:50:48.781416 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:50:48.952540 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:50:49.185525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:50:49.188470 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/schema.yml
[0m20:50:50.004339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0625300>]}
[0m20:50:50.306363 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:50:50.309167 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:50:50.331765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0819b40>]}
[0m20:50:50.332674 [info ] [MainThread]: Found 31 models, 1 seed, 26 data tests, 19 sources, 492 macros
[0m20:50:50.333299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca081a8c0>]}
[0m20:50:50.337780 [info ] [MainThread]: 
[0m20:50:50.338435 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:50:50.338955 [info ] [MainThread]: 
[0m20:50:50.339727 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:50:50.349119 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:50:50.350124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m20:50:50.350934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:50.351601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:50.582382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:50.765462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m20:50:50.766562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m20:50:50.767245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:50.768033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:50.896743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m20:50:50.898113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:50.907229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:50:50.909890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:51.049431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca088a710>]}
[0m20:50:51.050343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:51.053973 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_data
[0m20:50:51.054768 [debug] [Thread-2 (]: Began running node model.cs329e_xh.employer_details
[0m20:50:51.055656 [info ] [Thread-1 (]: 1 of 31 START sql table model dbt_cs329e_xh_stg.company_data ................... [RUN]
[0m20:50:51.056705 [info ] [Thread-2 (]: 2 of 31 START sql table model dbt_cs329e_xh_stg.employer_details ............... [RUN]
[0m20:50:51.057902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now model.cs329e_xh.company_data)
[0m20:50:51.058759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.employer_details)
[0m20:50:51.059478 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_data
[0m20:50:51.060214 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.employer_details
[0m20:50:51.077677 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_data"
[0m20:50:51.076140 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.employer_details"
[0m20:50:51.079349 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_data
[0m20:50:51.085200 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.employer_details
[0m20:50:51.111056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:51.117093 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:51.295734 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.employer_details"
[0m20:50:51.296685 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_data"
[0m20:50:51.298027 [debug] [Thread-1 (]: On model.cs329e_xh.company_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
      
    
    

    OPTIONS()
    as (
      
with stg_company_data as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`company_data`
)
select * from stg_company_data
    );
  
[0m20:50:51.298923 [debug] [Thread-2 (]: On model.cs329e_xh.employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details`
      
    
    

    OPTIONS()
    as (
      
with stg_employer_details_1 as (
select
    * except (`tax id`,`line by line` ),
    lpad(cast(cast(`tax id` as int64) as string), 4, '0') as tax_id,
    CAST(REPLACE(`line by line`, ',', '') AS INT64) AS employer_no
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`employer_details`
),
stg_employer_details as (
    select
    employer_no,
    `fiscal year   ` as fiscal_year,
    `employer petitioner name` as employer_petitioner_name,
    tax_id as tax_id,
    `industry naics code` as naics_code,
    `petitioner city` as petitioner_city,
    `petitioner state` as petitioner_state,
    `petitioner zip code` as petitioner_zip_code,
    `initial approval` as initial_approval,
    `initial denial` as initial_denial,
    `continuing approval` as continuing_approval,
    `continuing denial` as continuing_denial,
    _data_source, _load_time
from stg_employer_details_1
) 
select * from stg_employer_details
    );
  
[0m20:50:51.616947 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fe160265-3896-4428-89f3-cf8491a3d11b&page=queryresults
[0m20:50:51.701459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:835e6060-7f37-4704-9f79-211d2db3a6a9&page=queryresults
[0m20:50:53.734593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0619570>]}
[0m20:50:53.735755 [info ] [Thread-1 (]: 1 of 31 OK created sql table model dbt_cs329e_xh_stg.company_data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.68s]
[0m20:50:53.737030 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_data
[0m20:50:53.737736 [debug] [Thread-1 (]: Began running node model.cs329e_xh.h1b_sentiment_analysis
[0m20:50:53.738896 [info ] [Thread-1 (]: 3 of 31 START sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis ......... [RUN]
[0m20:50:53.739841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_data, now model.cs329e_xh.h1b_sentiment_analysis)
[0m20:50:53.740493 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.h1b_sentiment_analysis
[0m20:50:53.745157 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m20:50:53.746003 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.h1b_sentiment_analysis
[0m20:50:53.749532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:53.876558 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m20:50:53.877727 [debug] [Thread-1 (]: On model.cs329e_xh.h1b_sentiment_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.h1b_sentiment_analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
      
    
    

    OPTIONS()
    as (
      
with stg_senti as (
select * 
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`h1b_sentiment_analysis`
)
select * from stg_senti
    );
  
[0m20:50:53.969730 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbe687c40>]}
[0m20:50:53.970980 [info ] [Thread-2 (]: 2 of 31 OK created sql table model dbt_cs329e_xh_stg.employer_details .......... [[32mCREATE TABLE (61.5k rows, 9.3 MiB processed)[0m in 2.91s]
[0m20:50:53.972197 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.employer_details
[0m20:50:53.973038 [debug] [Thread-2 (]: Began running node model.cs329e_xh.lca_appendix
[0m20:50:53.974044 [info ] [Thread-2 (]: 4 of 31 START sql table model dbt_cs329e_xh_stg.lca_appendix ................... [RUN]
[0m20:50:53.975127 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.employer_details, now model.cs329e_xh.lca_appendix)
[0m20:50:53.975788 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.lca_appendix
[0m20:50:53.980703 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.lca_appendix"
[0m20:50:53.981603 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.lca_appendix
[0m20:50:53.985343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:54.170586 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.lca_appendix"
[0m20:50:54.171715 [debug] [Thread-2 (]: On model.cs329e_xh.lca_appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_appendix as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_appendix`
)
select * from stg_lca_appendix
    );
  
[0m20:50:54.208085 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2f150abe-99fe-46c7-a1b6-dbe2ed56a543&page=queryresults
[0m20:50:54.458577 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b713479a-a8a7-4c03-8e17-0f35058fe936&page=queryresults
[0m20:50:56.166959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbd3bfc70>]}
[0m20:50:56.168080 [info ] [Thread-1 (]: 3 of 31 OK created sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis .... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.43s]
[0m20:50:56.169196 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.h1b_sentiment_analysis
[0m20:50:56.169861 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_disclosure
[0m20:50:56.170957 [info ] [Thread-1 (]: 5 of 31 START sql table model dbt_cs329e_xh_stg.lca_disclosure ................. [RUN]
[0m20:50:56.171798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.h1b_sentiment_analysis, now model.cs329e_xh.lca_disclosure)
[0m20:50:56.172405 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_disclosure
[0m20:50:56.177295 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_disclosure"
[0m20:50:56.178118 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_disclosure
[0m20:50:56.183479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:56.312594 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_disclosure"
[0m20:50:56.313801 [debug] [Thread-1 (]: On model.cs329e_xh.lca_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
      
    
    

    OPTIONS()
    as (
      
with s as (
SELECT
    * EXCEPT (received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage, total_worksite_locations),
    SAFE_CAST(received_date AS DATETIME) AS received_date,
    SAFE_CAST(decision_date AS DATETIME) AS decision_date,
    SAFE_CAST(original_cert_date AS DATETIME) AS original_cert_date,
    
    SAFE_CAST(total_worker_positions AS INT64) AS total_worker_positions,
    SAFE_CAST(new_employment AS INT64) AS new_employment,
    SAFE_CAST(continued_employment AS INT64) AS continued_employment,
    SAFE_CAST(change_previous_employment AS INT64) AS change_previous_employment,
    SAFE_CAST(new_concurrent_employment AS INT64) AS new_concurrent_employment,
    SAFE_CAST(change_employer AS INT64) AS change_employer,
    SAFE_CAST(amended_petition AS INT64) AS amended_petition,
    SAFE_CAST(worksite_workers AS INT64) AS worksite_workers,
    SAFE_CAST(total_worksite_locations AS INT64) AS total_worksite_locations,

    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_from, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_from,
    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_to, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_to,
    SAFE_CAST(REGEXP_REPLACE(prevailing_wage, r'[\$,]', '') AS FLOAT64) AS prevailing_wage

FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_disclosure`
    )
select * from s
    );
  
[0m20:50:56.459781 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0684c40>]}
[0m20:50:56.460895 [info ] [Thread-2 (]: 4 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.48s]
[0m20:50:56.461973 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.lca_appendix
[0m20:50:56.462855 [debug] [Thread-2 (]: Began running node model.cs329e_xh.lca_worksites
[0m20:50:56.463947 [info ] [Thread-2 (]: 6 of 31 START sql table model dbt_cs329e_xh_stg.lca_worksites .................. [RUN]
[0m20:50:56.464839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_appendix, now model.cs329e_xh.lca_worksites)
[0m20:50:56.465475 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.lca_worksites
[0m20:50:56.470356 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.lca_worksites"
[0m20:50:56.471187 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.lca_worksites
[0m20:50:56.474789 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:56.608432 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.lca_worksites"
[0m20:50:56.609590 [debug] [Thread-2 (]: On model.cs329e_xh.lca_worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_worksites as (
select * except(worksite_workers, pw_other_year),
        cast(worksite_workers as int64) as worksite_workers,
        cast(pw_other_year as int64) as pw_other_year
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_worksites`
)
select * from stg_lca_worksites
    );
  
[0m20:50:56.736399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:666c5e73-cd97-44cc-a142-093a4f4e6824&page=queryresults
[0m20:50:56.999874 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:79ac19e9-4fa5-4d6c-a670-57adf7bf51d1&page=queryresults
[0m20:51:03.175446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca049bf10>]}
[0m20:51:03.176552 [info ] [Thread-2 (]: 6 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 6.71s]
[0m20:51:03.177657 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.lca_worksites
[0m20:51:03.178500 [debug] [Thread-2 (]: Began running node model.cs329e_xh.pw_disclosure
[0m20:51:03.179330 [info ] [Thread-2 (]: 7 of 31 START sql table model dbt_cs329e_xh_stg.pw_disclosure .................. [RUN]
[0m20:51:03.180375 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_worksites, now model.cs329e_xh.pw_disclosure)
[0m20:51:03.181260 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.pw_disclosure
[0m20:51:03.186417 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.pw_disclosure"
[0m20:51:03.187719 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.pw_disclosure
[0m20:51:03.194028 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:03.313511 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.pw_disclosure"
[0m20:51:03.315271 [debug] [Thread-2 (]: On model.cs329e_xh.pw_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.pw_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
      
    
    

    OPTIONS()
    as (
      
with temp as (
select 
    * except(required_experience_months, required_training_months, alt_training_months, alt_experience_months),
    cast(required_training_months as int64) as required_training_months,
    cast(required_experience_months as int64) as required_experience_months,
    cast(alt_training_months as int64) as alt_training_months,
    cast(alt_experience_months as int64) as alt_experience_months
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`pw_disclosure`
),
stg_pw_disclosure as (
    select 
    * except(bls_area),
    SPLIT(bls_area, ',')[SAFE_OFFSET(0)] AS bls_city,
    IFNULL(SPLIT(bls_area, ',')[SAFE_OFFSET(1)], '') AS bls_state
from temp)
select * from stg_pw_disclosure
    );
  
[0m20:51:03.650606 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b12f3b19-ce7d-4418-9aae-821fc622787f&page=queryresults
[0m20:51:08.637014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca061aa40>]}
[0m20:51:08.638689 [info ] [Thread-1 (]: 5 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_disclosure ............ [[32mCREATE TABLE (561.0k rows, 485.1 MiB processed)[0m in 12.47s]
[0m20:51:08.640213 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_disclosure
[0m20:51:08.641196 [debug] [Thread-1 (]: Began running node model.cs329e_xh.single_registrations
[0m20:51:08.642356 [info ] [Thread-1 (]: 8 of 31 START sql table model dbt_cs329e_xh_stg.single_registrations ........... [RUN]
[0m20:51:08.643292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_disclosure, now model.cs329e_xh.single_registrations)
[0m20:51:08.643899 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.single_registrations
[0m20:51:08.648790 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.single_registrations"
[0m20:51:08.649625 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.single_registrations
[0m20:51:08.654912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:08.784937 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.single_registrations"
[0m20:51:08.786279 [debug] [Thread-1 (]: On model.cs329e_xh.single_registrations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.single_registrations"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
      
    
    

    OPTIONS()
    as (
      
with t1 as (
select
    case bcn when '(b)(6)' THEN NULL ELSE bcn END AS bcn,
    case receipt_number when '(b)(6)' THEN NULL ELSE receipt_number END AS receipt_number,
    case ben_date_of_birth when '(b)(6)' THEN NULL ELSE ben_date_of_birth END AS ben_date_of_birth,
    case dol_eta_case_number when '(b)(6)' THEN NULL ELSE dol_eta_case_number END AS dol_eta_case_number,
    *
EXCEPT (bcn, receipt_number, ben_date_of_birth, dol_eta_case_number)
FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`single_registrations`
WHERE bcn != '(b)(3) (b)(6) (b)(7)(c)'
)
, t2 as (select * except(bcn, receipt_number, ben_date_of_birth, dol_eta_case_number, t_u_vawa_flag)
FROM t1)
select * from t2
    );
  
[0m20:51:09.138136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bb4848fb-8e6c-47c6-973a-ad697fe3e1ee&page=queryresults
[0m20:51:13.559727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0239990>]}
[0m20:51:13.560925 [info ] [Thread-1 (]: 8 of 31 OK created sql table model dbt_cs329e_xh_stg.single_registrations ...... [[32mCREATE TABLE (350.1k rows, 78.4 MiB processed)[0m in 4.92s]
[0m20:51:13.562059 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.single_registrations
[0m20:51:13.562869 [debug] [Thread-1 (]: Began running node model.cs329e_xh.wage_summary
[0m20:51:13.563978 [info ] [Thread-1 (]: 9 of 31 START sql table model dbt_cs329e_xh_stg.wage_summary ................... [RUN]
[0m20:51:13.564801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.single_registrations, now model.cs329e_xh.wage_summary)
[0m20:51:13.565442 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.wage_summary
[0m20:51:13.570426 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.wage_summary"
[0m20:51:13.571290 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.wage_summary
[0m20:51:13.574845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:13.758836 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.wage_summary"
[0m20:51:13.760793 [debug] [Thread-1 (]: On model.cs329e_xh.wage_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
      
    
    

    OPTIONS()
    as (
      
with stg_wage_summary as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`wage_summary`
)
select * from stg_wage_summary
    );
  
[0m20:51:14.096813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:31a6ecdf-e716-460d-aff9-cbee51f996e2&page=queryresults
[0m20:51:16.068332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca07bc940>]}
[0m20:51:16.069505 [info ] [Thread-1 (]: 9 of 31 OK created sql table model dbt_cs329e_xh_stg.wage_summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.50s]
[0m20:51:16.070757 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.wage_summary
[0m20:51:16.071477 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m20:51:16.072608 [info ] [Thread-1 (]: 10 of 31 START sql table model dbt_cs329e_xh_int.Company_Data .................. [RUN]
[0m20:51:16.073534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.wage_summary, now model.cs329e_xh.Company_Data)
[0m20:51:16.074185 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m20:51:16.078941 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m20:51:16.079836 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m20:51:16.083597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:16.239576 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:16.639373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:35ba8801-5146-42d1-8ea4-b22d1be978be&page=queryresults
[0m20:51:16.763001 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as int64)
 as count, 
      
    cast(null as string)
 as employer_url, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:17.075688 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:176cf94f-18ad-462a-aa95-f45dbf5c0962&page=queryresults
[0m20:51:17.225116 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:51:17.235001 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m20:51:17.238744 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
        
  (
    employer_name string primary key not enforced,
    count int64,
    employer_url string,
    _data_source string,
    _load_time datetime
    
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_name, count, employer_url, _data_source, _load_time
    from (
        with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    ) as model_subq
    );
  
[0m20:51:17.437830 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0ed2b30>]}
[0m20:51:17.439059 [info ] [Thread-2 (]: 7 of 31 OK created sql table model dbt_cs329e_xh_stg.pw_disclosure ............. [[32mCREATE TABLE (237.9k rows, 372.8 MiB processed)[0m in 14.26s]
[0m20:51:17.440297 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.pw_disclosure
[0m20:51:17.441072 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m20:51:17.442394 [info ] [Thread-2 (]: 11 of 31 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............ [RUN]
[0m20:51:17.443393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.pw_disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m20:51:17.444013 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m20:51:17.449017 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m20:51:17.449935 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m20:51:17.453931 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:17.518400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7575cb00-81e5-4f8d-a260-35f1f18bb81a&page=queryresults
[0m20:51:17.572649 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:17.982430 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9af210a8-0ff4-47ca-8b0b-f18c142480f4&page=queryresults
[0m20:51:18.201749 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        select
    
      
    cast(null as datetime)
 as publication_date, 
      
    cast(null as string)
 as text_summary, 
      
    cast(null as string)
 as sentiment, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:18.552132 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:56396449-d064-425b-a7c9-dc496d4369f8&page=queryresults
[0m20:51:18.676775 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:51:18.678799 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m20:51:18.679895 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
        
  (
    publication_date datetime primary key not enforced,
    text_summary string,
    sentiment string,
    _data_source string,
    _load_time datetime
    
    )

      
    
    

    OPTIONS()
    as (
      
    select publication_date, text_summary, sentiment, _data_source, _load_time
    from (
        with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    ) as model_subq
    );
  
[0m20:51:18.996763 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b9367c12-8ed9-482a-adc0-6f97bf7d32aa&page=queryresults
[0m20:51:19.523883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca07bc940>]}
[0m20:51:19.525070 [info ] [Thread-1 (]: 10 of 31 OK created sql table model dbt_cs329e_xh_int.Company_Data ............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 3.45s]
[0m20:51:19.526277 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m20:51:19.526993 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m20:51:19.527999 [info ] [Thread-1 (]: 12 of 31 START sql table model dbt_cs329e_xh_int.LCA_Appendix .................. [RUN]
[0m20:51:19.528841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Appendix)
[0m20:51:19.529451 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m20:51:19.533871 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m20:51:19.534739 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m20:51:19.538432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:19.640479 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:20.031521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9c3e6408-31ea-43a1-a910-fe1c9e58f7dc&page=queryresults
[0m20:51:20.229827 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as datetime)
 as appx_a_date_of_degree, 
      
    cast(null as string)
 as appx_a_name_of_institution, 
      
    cast(null as int64)
 as appx_a_no_of_exempt_workers, 
      
    cast(null as string)
 as appx_a_field_of_study, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:20.545946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b74adcff-3b5f-4ce9-8e8b-246f047932d8&page=queryresults
[0m20:51:20.661698 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:51:20.663721 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m20:51:20.664808 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
        
  (
    case_number string,
    appx_a_date_of_degree datetime,
    appx_a_name_of_institution string,
    appx_a_no_of_exempt_workers int64,
    appx_a_field_of_study string,
    _data_source string,
    _load_time datetime,
    
    primary key (case_number, appx_a_date_of_degree) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select case_number, appx_a_date_of_degree, appx_a_name_of_institution, appx_a_no_of_exempt_workers, appx_a_field_of_study, _data_source, _load_time
    from (
        with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    ) as model_subq
    );
  
[0m20:51:20.921678 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3f0b7b13-8002-4418-9bbe-4d8ab6b3a0fa&page=queryresults
[0m20:51:21.023533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0ed2b30>]}
[0m20:51:21.024695 [info ] [Thread-2 (]: 11 of 31 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ....... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 3.58s]
[0m20:51:21.025843 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m20:51:21.026685 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m20:51:21.027516 [info ] [Thread-2 (]: 13 of 31 START sql table model dbt_cs329e_xh_int.LCA_Worksites ................. [RUN]
[0m20:51:21.028525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.LCA_Worksites)
[0m20:51:21.029170 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m20:51:21.033846 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m20:51:21.034747 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m20:51:21.038653 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:21.184465 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:21.551079 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aefcf7e2-8f56-431b-a42d-019f1266c9fe&page=queryresults
[0m20:51:21.675910 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        select
    
      
    cast(null as string)
 as row_id, 
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as float64)
 as prevailing_wage, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as pw_other_year
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:21.989991 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:92de7f9f-b6de-4f54-ac6b-1aeabad1efdc&page=queryresults
[0m20:51:22.108230 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:51:22.110740 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m20:51:22.111879 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
        
  (
    row_id string primary key not enforced,
    case_number string,
    secondary_entity string,
    secondary_entity_business_name string,
    worksite_address1 string,
    worksite_address2 string,
    worksite_city string,
    worksite_county string,
    worksite_state string,
    worksite_postal_code string,
    wage_rate_of_pay_from float64,
    wage_rate_of_pay_to float64,
    wage_unit_of_pay string,
    prevailing_wage float64,
    pw_unit_of_pay string,
    pw_tracking_number string,
    pw_wage_level string,
    pw_oes_year string,
    pw_other_source string,
    pw_survey_publisher string,
    pw_survey_name string,
    _data_source string,
    _load_time datetime,
    worksite_workers int64,
    pw_other_year int64
    
    )

      
    
    

    OPTIONS()
    as (
      
    select row_id, case_number, secondary_entity, secondary_entity_business_name, worksite_address1, worksite_address2, worksite_city, worksite_county, worksite_state, worksite_postal_code, wage_rate_of_pay_from, wage_rate_of_pay_to, wage_unit_of_pay, prevailing_wage, pw_unit_of_pay, pw_tracking_number, pw_wage_level, pw_oes_year, pw_other_source, pw_survey_publisher, pw_survey_name, _data_source, _load_time, worksite_workers, pw_other_year
    from (
        with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    ) as model_subq
    );
  
[0m20:51:22.399684 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ebb39ff0-049e-4f50-98c0-c7b0b1669c74&page=queryresults
[0m20:51:22.855612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0f4b0d0>]}
[0m20:51:22.856733 [info ] [Thread-1 (]: 12 of 31 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix ............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 3.33s]
[0m20:51:22.857849 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m20:51:22.858586 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m20:51:22.859502 [info ] [Thread-1 (]: 14 of 31 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................ [RUN]
[0m20:51:22.860297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m20:51:22.860897 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m20:51:22.865763 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m20:51:22.866640 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m20:51:22.871584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:23.001998 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:23.453891 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d9bee631-695e-4f73-9819-174b1f90a3bb&page=queryresults
[0m20:51:23.578272 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as case_status, 
      
    cast(null as string)
 as visa_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as soc_code, 
      
    cast(null as string)
 as soc_title, 
      
    cast(null as string)
 as full_time_position, 
      
    cast(null as string)
 as begin_date, 
      
    cast(null as string)
 as end_date, 
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as trade_name_dba, 
      
    cast(null as string)
 as employer_address1, 
      
    cast(null as string)
 as employer_address2, 
      
    cast(null as string)
 as employer_city, 
      
    cast(null as string)
 as employer_state, 
      
    cast(null as string)
 as employer_postal_code, 
      
    cast(null as string)
 as employer_country, 
      
    cast(null as string)
 as employer_province, 
      
    cast(null as string)
 as employer_phone, 
      
    cast(null as string)
 as employer_phone_ext, 
      
    cast(null as string)
 as employer_fein, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as employer_poc_last_name, 
      
    cast(null as string)
 as employer_poc_first_name, 
      
    cast(null as string)
 as employer_poc_middle_name, 
      
    cast(null as string)
 as employer_poc_job_title, 
      
    cast(null as string)
 as employer_poc_address1, 
      
    cast(null as string)
 as employer_poc_address2, 
      
    cast(null as string)
 as employer_poc_city, 
      
    cast(null as string)
 as employer_poc_state, 
      
    cast(null as string)
 as employer_poc_postal_code, 
      
    cast(null as string)
 as employer_poc_country, 
      
    cast(null as string)
 as employer_poc_province, 
      
    cast(null as string)
 as employer_poc_phone, 
      
    cast(null as string)
 as employer_poc_phone_ext, 
      
    cast(null as string)
 as employer_poc_email, 
      
    cast(null as string)
 as agent_representing_employer, 
      
    cast(null as string)
 as agent_attorney_last_name, 
      
    cast(null as string)
 as agent_attorney_first_name, 
      
    cast(null as string)
 as agent_attorney_middle_name, 
      
    cast(null as string)
 as agent_attorney_address1, 
      
    cast(null as string)
 as agent_attorney_address2, 
      
    cast(null as string)
 as agent_attorney_city, 
      
    cast(null as string)
 as agent_attorney_state, 
      
    cast(null as string)
 as agent_attorney_postal_code, 
      
    cast(null as string)
 as agent_attorney_country, 
      
    cast(null as string)
 as agent_attorney_province, 
      
    cast(null as string)
 as agent_attorney_phone, 
      
    cast(null as string)
 as agent_attorney_phone_ext, 
      
    cast(null as string)
 as agent_attorney_email_address, 
      
    cast(null as string)
 as lawfirm_name_business_name, 
      
    cast(null as string)
 as state_of_highest_court, 
      
    cast(null as string)
 as name_of_highest_state_court, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_other_year, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as agree_to_lc_statement, 
      
    cast(null as string)
 as h_1b_dependent, 
      
    cast(null as string)
 as willful_violator, 
      
    cast(null as string)
 as support_h1b, 
      
    cast(null as string)
 as statutory_basis, 
      
    cast(null as string)
 as appendix_a_attached, 
      
    cast(null as string)
 as public_disclosure, 
      
    cast(null as string)
 as preparer_last_name, 
      
    cast(null as string)
 as preparer_first_name, 
      
    cast(null as string)
 as preparer_middle_initial, 
      
    cast(null as string)
 as preparer_business_name, 
      
    cast(null as string)
 as preparer_email, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time, 
      
    cast(null as datetime)
 as received_date, 
      
    cast(null as datetime)
 as decision_date, 
      
    cast(null as datetime)
 as original_cert_date, 
      
    cast(null as int64)
 as total_worker_positions, 
      
    cast(null as int64)
 as new_employment, 
      
    cast(null as int64)
 as continued_employment, 
      
    cast(null as int64)
 as change_previous_employment, 
      
    cast(null as int64)
 as new_concurrent_employment, 
      
    cast(null as int64)
 as change_employer, 
      
    cast(null as int64)
 as amended_petition, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as total_worksite_locations, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as float64)
 as prevailing_wage
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:23.912131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aa0a55b6-279f-4b31-b47f-ac62e639786a&page=queryresults
[0m20:51:24.055199 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:51:24.058555 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m20:51:24.059820 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
        
  (
    case_number string,
    case_status string,
    visa_class string,
    job_title string,
    soc_code string,
    soc_title string,
    full_time_position string,
    begin_date string,
    end_date string,
    employer_name string,
    trade_name_dba string,
    employer_address1 string,
    employer_address2 string,
    employer_city string,
    employer_state string,
    employer_postal_code string,
    employer_country string,
    employer_province string,
    employer_phone string,
    employer_phone_ext string,
    employer_fein string,
    naics_code string,
    employer_poc_last_name string,
    employer_poc_first_name string,
    employer_poc_middle_name string,
    employer_poc_job_title string,
    employer_poc_address1 string,
    employer_poc_address2 string,
    employer_poc_city string,
    employer_poc_state string,
    employer_poc_postal_code string,
    employer_poc_country string,
    employer_poc_province string,
    employer_poc_phone string,
    employer_poc_phone_ext string,
    employer_poc_email string,
    agent_representing_employer string,
    agent_attorney_last_name string,
    agent_attorney_first_name string,
    agent_attorney_middle_name string,
    agent_attorney_address1 string,
    agent_attorney_address2 string,
    agent_attorney_city string,
    agent_attorney_state string,
    agent_attorney_postal_code string,
    agent_attorney_country string,
    agent_attorney_province string,
    agent_attorney_phone string,
    agent_attorney_phone_ext string,
    agent_attorney_email_address string,
    lawfirm_name_business_name string,
    state_of_highest_court string,
    name_of_highest_state_court string,
    secondary_entity string,
    secondary_entity_business_name string,
    worksite_address1 string,
    worksite_address2 string,
    worksite_city string,
    worksite_county string,
    worksite_state string,
    worksite_postal_code string,
    wage_unit_of_pay string,
    pw_unit_of_pay string,
    pw_tracking_number string,
    pw_wage_level string,
    pw_oes_year string,
    pw_other_source string,
    pw_other_year string,
    pw_survey_publisher string,
    pw_survey_name string,
    agree_to_lc_statement string,
    h_1b_dependent string,
    willful_violator string,
    support_h1b string,
    statutory_basis string,
    appendix_a_attached string,
    public_disclosure string,
    preparer_last_name string,
    preparer_first_name string,
    preparer_middle_initial string,
    preparer_business_name string,
    preparer_email string,
    _data_source string,
    _load_time datetime,
    received_date datetime,
    decision_date datetime,
    original_cert_date datetime,
    total_worker_positions int64,
    new_employment int64,
    continued_employment int64,
    change_previous_employment int64,
    new_concurrent_employment int64,
    change_employer int64,
    amended_petition int64,
    worksite_workers int64,
    total_worksite_locations int64,
    wage_rate_of_pay_from float64,
    wage_rate_of_pay_to float64,
    prevailing_wage float64,
    
    primary key (case_number, employer_name) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select case_number, case_status, visa_class, job_title, soc_code, soc_title, full_time_position, begin_date, end_date, employer_name, trade_name_dba, employer_address1, employer_address2, employer_city, employer_state, employer_postal_code, employer_country, employer_province, employer_phone, employer_phone_ext, employer_fein, naics_code, employer_poc_last_name, employer_poc_first_name, employer_poc_middle_name, employer_poc_job_title, employer_poc_address1, employer_poc_address2, employer_poc_city, employer_poc_state, employer_poc_postal_code, employer_poc_country, employer_poc_province, employer_poc_phone, employer_poc_phone_ext, employer_poc_email, agent_representing_employer, agent_attorney_last_name, agent_attorney_first_name, agent_attorney_middle_name, agent_attorney_address1, agent_attorney_address2, agent_attorney_city, agent_attorney_state, agent_attorney_postal_code, agent_attorney_country, agent_attorney_province, agent_attorney_phone, agent_attorney_phone_ext, agent_attorney_email_address, lawfirm_name_business_name, state_of_highest_court, name_of_highest_state_court, secondary_entity, secondary_entity_business_name, worksite_address1, worksite_address2, worksite_city, worksite_county, worksite_state, worksite_postal_code, wage_unit_of_pay, pw_unit_of_pay, pw_tracking_number, pw_wage_level, pw_oes_year, pw_other_source, pw_other_year, pw_survey_publisher, pw_survey_name, agree_to_lc_statement, h_1b_dependent, willful_violator, support_h1b, statutory_basis, appendix_a_attached, public_disclosure, preparer_last_name, preparer_first_name, preparer_middle_initial, preparer_business_name, preparer_email, _data_source, _load_time, received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, total_worksite_locations, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage
    from (
        with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    ) as model_subq
    );
  
[0m20:51:24.395372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fd8f21b4-8eb8-4efa-95ba-060dfe1335b6&page=queryresults
[0m20:51:31.749732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca00a1e10>]}
[0m20:51:31.750906 [info ] [Thread-2 (]: 13 of 31 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............ [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 10.72s]
[0m20:51:31.752137 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m20:51:31.752911 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m20:51:31.753692 [info ] [Thread-2 (]: 15 of 31 START sql table model dbt_cs329e_xh_int.Single_Registration ........... [RUN]
[0m20:51:31.754735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Single_Registration)
[0m20:51:31.755327 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m20:51:31.760602 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m20:51:31.761435 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m20:51:31.765140 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:31.885275 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: select * from (
        with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:32.230528 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a3d161f5-8440-410c-a2c4-61cf605a30a6&page=queryresults
[0m20:51:32.346061 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as ben_year_of_birth, 
      
    cast(null as string)
 as gender, 
      
    cast(null as string)
 as agent_first_name, 
      
    cast(null as string)
 as agent_last_name, 
      
    cast(null as string)
 as mail_addr, 
      
    cast(null as string)
 as country_of_birth, 
      
    cast(null as string)
 as country_of_nationality, 
      
    cast(null as string)
 as fein, 
      
    cast(null as string)
 as city, 
      
    cast(null as string)
 as state, 
      
    cast(null as string)
 as zip, 
      
    cast(null as string)
 as lottery_year, 
      
    cast(null as string)
 as status_type, 
      
    cast(null as string)
 as ben_multi_reg_ind, 
      
    cast(null as string)
 as rec_date, 
      
    cast(null as string)
 as first_decision, 
      
    cast(null as string)
 as first_decision_date, 
      
    cast(null as string)
 as i129_employer_name, 
      
    cast(null as string)
 as pet_street, 
      
    cast(null as string)
 as pet_city, 
      
    cast(null as string)
 as pet_state, 
      
    cast(null as string)
 as pet_zip, 
      
    cast(null as string)
 as requested_class, 
      
    cast(null as string)
 as basis_for_classification, 
      
    cast(null as string)
 as requested_action, 
      
    cast(null as string)
 as number_of_beneficiaries, 
      
    cast(null as string)
 as ben_sex, 
      
    cast(null as string)
 as ben_country_of_birth, 
      
    cast(null as string)
 as ben_current_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as worksite_street, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_zip, 
      
    cast(null as string)
 as full_time_ind, 
      
    cast(null as string)
 as wage_amt, 
      
    cast(null as string)
 as wage_unit, 
      
    cast(null as string)
 as valid_from, 
      
    cast(null as string)
 as valid_to, 
      
    cast(null as string)
 as num_of_emp_in_us, 
      
    cast(null as string)
 as s1q1a, 
      
    cast(null as string)
 as s1q1b, 
      
    cast(null as string)
 as ben_education_code, 
      
    cast(null as string)
 as ed_level_definition, 
      
    cast(null as string)
 as ben_pfield_of_study, 
      
    cast(null as string)
 as ben_comp_paid, 
      
    cast(null as string)
 as dot_code, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as s3q1, 
      
    cast(null as string)
 as s4q1, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:32.670767 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6da746fe-f31a-469a-94aa-923314ce5d00&page=queryresults
[0m20:51:32.771370 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:51:32.774013 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m20:51:32.775222 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
        
  (
    employer_name string,
    ben_year_of_birth string,
    gender string,
    agent_first_name string,
    agent_last_name string,
    mail_addr string,
    country_of_birth string,
    country_of_nationality string,
    fein string,
    city string,
    state string,
    zip string,
    lottery_year string,
    status_type string,
    ben_multi_reg_ind string,
    rec_date string,
    first_decision string,
    first_decision_date string,
    i129_employer_name string,
    pet_street string,
    pet_city string,
    pet_state string,
    pet_zip string,
    requested_class string,
    basis_for_classification string,
    requested_action string,
    number_of_beneficiaries string,
    ben_sex string,
    ben_country_of_birth string,
    ben_current_class string,
    job_title string,
    worksite_street string,
    worksite_city string,
    worksite_state string,
    worksite_zip string,
    full_time_ind string,
    wage_amt string,
    wage_unit string,
    valid_from string,
    valid_to string,
    num_of_emp_in_us string,
    s1q1a string,
    s1q1b string,
    ben_education_code string,
    ed_level_definition string,
    ben_pfield_of_study string,
    ben_comp_paid string,
    dot_code string,
    naics_code string,
    s3q1 string,
    s4q1 string,
    _data_source string,
    _load_time datetime,
    
    primary key (employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr, country_of_birth, country_of_nationality, fein, city, state, zip, lottery_year, status_type, ben_multi_reg_ind, rec_date, first_decision, first_decision_date, i129_employer_name, pet_street, pet_city, pet_state, pet_zip, requested_class, basis_for_classification, requested_action, number_of_beneficiaries, ben_sex, ben_country_of_birth, ben_current_class, job_title, worksite_street, worksite_city, worksite_state, worksite_zip, full_time_ind, wage_amt, wage_unit, valid_from, valid_to, num_of_emp_in_us, s1q1a, s1q1b, ben_education_code, ed_level_definition, ben_pfield_of_study, ben_comp_paid, dot_code, naics_code, s3q1, s4q1, _data_source, _load_time
    from (
        with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
    ) as model_subq
    );
  
[0m20:51:33.073761 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:92394760-8fec-4ce1-bcca-381dd5e98a51&page=queryresults
[0m20:51:40.292226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0f4b0d0>]}
[0m20:51:40.293399 [info ] [Thread-1 (]: 14 of 31 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ........... [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 17.43s]
[0m20:51:40.294645 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m20:51:40.295340 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m20:51:40.296378 [info ] [Thread-1 (]: 16 of 31 START sql table model dbt_cs329e_xh_int.Wage_Summary .................. [RUN]
[0m20:51:40.297580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Wage_Summary)
[0m20:51:40.298242 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m20:51:40.302748 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m20:51:40.303583 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m20:51:40.308167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:40.373839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca00a1e10>]}
[0m20:51:40.374975 [info ] [Thread-2 (]: 15 of 31 OK created sql table model dbt_cs329e_xh_int.Single_Registration ...... [[32mCREATE TABLE (237.8k rows, 75.7 MiB processed)[0m in 8.62s]
[0m20:51:40.375969 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m20:51:40.376657 [debug] [Thread-2 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m20:51:40.377786 [info ] [Thread-2 (]: 17 of 31 START sql table model dbt_cs329e_xh_int.PW_Disclosure ................. [RUN]
[0m20:51:40.378629 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.PW_Disclosure)
[0m20:51:40.379248 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m20:51:40.383853 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m20:51:40.384706 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m20:51:40.388467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:40.454056 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: select * from (
        with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:40.510688 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m20:51:40.512414 [debug] [Thread-2 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m20:51:40.911400 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ae2f81a0-bef4-4a38-a888-86dd6c589e0b&page=queryresults
[0m20:51:40.956287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7188667f-9ad9-4b6c-8454-36e6af1d13a5&page=queryresults
[0m20:51:41.056899 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: select * from (
        select
    
      
    cast(null as string)
 as company_name, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as int64)
 as min_wage, 
      
    cast(null as int64)
 as max_wage, 
      
    cast(null as float64)
 as average_wage, 
      
    cast(null as int64)
 as job_count, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:51:41.372965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:206c3dff-b09d-4859-9ded-21fc975376d9&page=queryresults
[0m20:51:41.493959 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:51:41.495896 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m20:51:41.496948 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
        
  (
    company_name string,
    job_title string,
    min_wage int64,
    max_wage int64,
    average_wage float64,
    job_count int64,
    _data_source string,
    _load_time datetime,
    
    primary key (company_name, job_title) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select company_name, job_title, min_wage, max_wage, average_wage, job_count, _data_source, _load_time
    from (
        with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    ) as model_subq
    );
  
[0m20:51:41.743883 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3332e10c-3f47-4572-9f3e-beda690deb70&page=queryresults
[0m20:51:43.709140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0f4b0d0>]}
[0m20:51:43.710373 [info ] [Thread-1 (]: 16 of 31 OK created sql table model dbt_cs329e_xh_int.Wage_Summary ............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 3.41s]
[0m20:51:43.711492 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m20:51:43.712199 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m20:51:43.713187 [info ] [Thread-1 (]: 18 of 31 START sql table model dbt_cs329e_xh_int.temp_emp ...................... [RUN]
[0m20:51:43.713993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.temp_emp)
[0m20:51:43.714649 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m20:51:43.719895 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m20:51:43.720862 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_emp
[0m20:51:43.724771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:43.881888 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m20:51:43.883104 [debug] [Thread-1 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw),
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m20:51:44.148749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:68cff22d-2d57-4958-b909-edc8c935831d&page=queryresults
[0m20:51:46.805199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0f4b0d0>]}
[0m20:51:46.806550 [info ] [Thread-1 (]: 18 of 31 OK created sql table model dbt_cs329e_xh_int.temp_emp ................. [[32mCREATE TABLE (90.2k rows, 19.9 MiB processed)[0m in 3.09s]
[0m20:51:46.807869 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m20:51:46.808553 [debug] [Thread-1 (]: Began running node model.cs329e_xh.approval_rate_by_month
[0m20:51:46.809480 [info ] [Thread-1 (]: 19 of 31 START sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ........ [RUN]
[0m20:51:46.810592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.approval_rate_by_month)
[0m20:51:46.811266 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.approval_rate_by_month
[0m20:51:46.816270 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.approval_rate_by_month"
[0m20:51:46.817795 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.approval_rate_by_month
[0m20:51:46.821392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:46.920993 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.approval_rate_by_month"
[0m20:51:46.922803 [debug] [Thread-1 (]: On model.cs329e_xh.approval_rate_by_month: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.approval_rate_by_month"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`approval_rate_by_month`
      
    
    

    OPTIONS()
    as (
      WITH monthly_windows AS (
    SELECT 
        EXTRACT (YEAR FROM publication_date) AS year,
        EXTRACT(MONTH FROM publication_date) AS month,
        MAX(publication_date) AS latest_date
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
    GROUP BY year, month
),
approval_rate_monthly AS (

    SELECT 
        EXTRACT(YEAR FROM decision_date) AS year,
        EXTRACT(MONTH FROM decision_date) AS month,
        COUNT(CASE WHEN case_status = 'Certified' THEN 1 END) AS approved_count,
        COUNT(CASE WHEN case_status != 'Certified' THEN 1 END) AS denied_count,
        COUNT(*) AS total_applications
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    WHERE decision_date IS NOT NULL
    GROUP BY year, month
)
SELECT 
    a.month,
    m.latest_date,
    a.approved_count,
    a.denied_count,
    a.total_applications,
    ROUND(100.0 * a.approved_count / a.total_applications, 2) AS approval_rate
FROM approval_rate_monthly a
LEFT JOIN monthly_windows m
    ON a.month = m.month
ORDER BY a.month
    );
  
[0m20:51:47.364606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:84d0f907-63b7-4097-a172-d9d17c43960a&page=queryresults
[0m20:51:49.672352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c99584400>]}
[0m20:51:49.673445 [info ] [Thread-1 (]: 19 of 31 OK created sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ... [[32mCREATE TABLE (12.0 rows, 10.5 MiB processed)[0m in 2.86s]
[0m20:51:49.674671 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.approval_rate_by_month
[0m20:51:49.675387 [debug] [Thread-1 (]: Began running node model.cs329e_xh.city_approval_rate
[0m20:51:49.676376 [info ] [Thread-1 (]: 20 of 31 START sql table model dbt_cs329e_xh_mrt.city_approval_rate ............ [RUN]
[0m20:51:49.677255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.approval_rate_by_month, now model.cs329e_xh.city_approval_rate)
[0m20:51:49.677868 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.city_approval_rate
[0m20:51:49.682779 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.city_approval_rate"
[0m20:51:49.683627 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.city_approval_rate
[0m20:51:49.687194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:49.840600 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.city_approval_rate"
[0m20:51:49.841760 [debug] [Thread-1 (]: On model.cs329e_xh.city_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.city_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`city_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_city AS city,
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_city, lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m20:51:50.143019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8e2f0e41-728c-4b28-aa10-0f00a661c632&page=queryresults
[0m20:51:53.356984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c99584400>]}
[0m20:51:53.358106 [info ] [Thread-1 (]: 20 of 31 OK created sql table model dbt_cs329e_xh_mrt.city_approval_rate ....... [[32mCREATE TABLE (20.1k rows, 50.1 MiB processed)[0m in 3.68s]
[0m20:51:53.359304 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.city_approval_rate
[0m20:51:53.359964 [debug] [Thread-1 (]: Began running node model.cs329e_xh.major_wage_level
[0m20:51:53.360870 [info ] [Thread-1 (]: 21 of 31 START sql table model dbt_cs329e_xh_mrt.major_wage_level .............. [RUN]
[0m20:51:53.361734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.city_approval_rate, now model.cs329e_xh.major_wage_level)
[0m20:51:53.362366 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.major_wage_level
[0m20:51:53.367309 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.major_wage_level"
[0m20:51:53.368139 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.major_wage_level
[0m20:51:53.371717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:53.537225 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.major_wage_level"
[0m20:51:53.538455 [debug] [Thread-1 (]: On model.cs329e_xh.major_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.major_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`major_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH salary_by_field AS (
    SELECT 
        a.appx_a_field_of_study AS field_of_study,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE a.appx_a_field_of_study IS NOT NULL
)

SELECT 
    field_of_study,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM salary_by_field
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY field_of_study, wage_unit_of_pay
ORDER BY field_of_study, wage_unit_of_pay
    );
  
[0m20:51:54.065709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7020e1ef-03aa-48ab-b27e-99b7b7631bb0&page=queryresults
[0m20:51:55.325643 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca00a1e10>]}
[0m20:51:55.326822 [info ] [Thread-2 (]: 17 of 31 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............ [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 14.95s]
[0m20:51:55.328042 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m20:51:55.328731 [debug] [Thread-2 (]: Began running node model.cs329e_xh.soc_wage_level
[0m20:51:55.329629 [info ] [Thread-2 (]: 22 of 31 START sql table model dbt_cs329e_xh_mrt.soc_wage_level ................ [RUN]
[0m20:51:55.330548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.soc_wage_level)
[0m20:51:55.331150 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.soc_wage_level
[0m20:51:55.336380 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.soc_wage_level"
[0m20:51:55.337263 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.soc_wage_level
[0m20:51:55.341085 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:55.487862 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.soc_wage_level"
[0m20:51:55.489087 [debug] [Thread-2 (]: On model.cs329e_xh.soc_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.soc_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`soc_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH job_salary AS (
    SELECT 
        l.soc_code,
        l.soc_title,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE l.soc_code IS NOT NULL AND l.soc_title IS NOT NULL
)

SELECT 
    soc_code,
    soc_title,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM job_salary
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY soc_code, soc_title, wage_unit_of_pay
ORDER BY avg_wage_from DESC
    );
  
[0m20:51:55.782292 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:36f5f9cf-984a-4cb6-a044-c454ae0724ba&page=queryresults
[0m20:51:56.062015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca061aa40>]}
[0m20:51:56.063255 [info ] [Thread-1 (]: 21 of 31 OK created sql table model dbt_cs329e_xh_mrt.major_wage_level ......... [[32mCREATE TABLE (87.0 rows, 19.6 MiB processed)[0m in 2.70s]
[0m20:51:56.064345 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.major_wage_level
[0m20:51:56.065072 [debug] [Thread-1 (]: Began running node model.cs329e_xh.state_approval_rate
[0m20:51:56.065894 [info ] [Thread-1 (]: 23 of 31 START sql table model dbt_cs329e_xh_mrt.state_approval_rate ........... [RUN]
[0m20:51:56.067038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.major_wage_level, now model.cs329e_xh.state_approval_rate)
[0m20:51:56.067670 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.state_approval_rate
[0m20:51:56.072427 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.state_approval_rate"
[0m20:51:56.073312 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.state_approval_rate
[0m20:51:56.077026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:56.212128 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.state_approval_rate"
[0m20:51:56.213326 [debug] [Thread-1 (]: On model.cs329e_xh.state_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m20:51:56.531782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:836c20b7-ac13-4577-851d-48a9e2a6bf8e&page=queryresults
[0m20:51:58.894967 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca119c610>]}
[0m20:51:58.896141 [info ] [Thread-2 (]: 22 of 31 OK created sql table model dbt_cs329e_xh_mrt.soc_wage_level ........... [[32mCREATE TABLE (55.0 rows, 41.3 MiB processed)[0m in 3.56s]
[0m20:51:58.897226 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.soc_wage_level
[0m20:51:58.897991 [debug] [Thread-2 (]: Began running node model.cs329e_xh.state_wage_level
[0m20:51:58.898976 [info ] [Thread-2 (]: 24 of 31 START sql table model dbt_cs329e_xh_mrt.state_wage_level .............. [RUN]
[0m20:51:58.899784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.soc_wage_level, now model.cs329e_xh.state_wage_level)
[0m20:51:58.900402 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.state_wage_level
[0m20:51:58.905382 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.state_wage_level"
[0m20:51:58.906319 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.state_wage_level
[0m20:51:58.911639 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:59.044803 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.state_wage_level"
[0m20:51:59.046049 [debug] [Thread-2 (]: On model.cs329e_xh.state_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_wage_level`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  ROUND(AVG(ld.prevailing_wage), 2) AS avg_wage,
  ROUND(MAX(ld.prevailing_wage), 2) AS max_wage,
  ROUND(MIN(ld.prevailing_wage), 2) AS min_wage,
  COUNT(ld.case_number) AS total_cases
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
WHERE ld.prevailing_wage IS NOT NULL
AND LOWER(ld.pw_unit_of_pay) != 'hour'  -- Exclude hourly wage records
GROUP BY lw.worksite_state
ORDER BY avg_wage DESC
    );
  
[0m20:51:59.361976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0f4b0d0>]}
[0m20:51:59.420825 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:32506dd3-c55f-437a-bb1c-e0407fea4e03&page=queryresults
[0m20:51:59.868115 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m20:51:59.869609 [info ] [Thread-1 (]: 23 of 31 OK created sql table model dbt_cs329e_xh_mrt.state_approval_rate ...... [[32mCREATE TABLE (55.0 rows, 41.5 MiB processed)[0m in 3.29s]
[0m20:51:59.870947 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.state_approval_rate
[0m20:51:59.871729 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_employer_details
[0m20:51:59.872686 [info ] [Thread-1 (]: 25 of 31 START sql table model dbt_cs329e_xh_int.temp_employer_details ......... [RUN]
[0m20:51:59.873644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_approval_rate, now model.cs329e_xh.temp_employer_details)
[0m20:51:59.874337 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m20:51:59.879349 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m20:51:59.880401 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_employer_details
[0m20:51:59.884216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:59.999455 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_employer_details"
[0m20:52:00.000631 [debug] [Thread-1 (]: On model.cs329e_xh.temp_employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_employer_details`
      
    
    

    OPTIONS()
    as (
      WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp` as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched
    );
  
[0m20:52:00.197648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:56b0909f-a421-4c0c-94c8-d02ccc5477e4&page=queryresults
[0m20:52:02.209284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca119c610>]}
[0m20:52:02.211067 [info ] [Thread-2 (]: 24 of 31 OK created sql table model dbt_cs329e_xh_mrt.state_wage_level ......... [[32mCREATE TABLE (55.0 rows, 42.8 MiB processed)[0m in 3.31s]
[0m20:52:02.212553 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.state_wage_level
[0m20:52:04.845633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca0188ac0>]}
[0m20:52:04.846841 [info ] [Thread-1 (]: 25 of 31 OK created sql table model dbt_cs329e_xh_int.temp_employer_details .... [[32mCREATE TABLE (589.3k rows, 4.9 MiB processed)[0m in 4.97s]
[0m20:52:04.848058 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m20:52:04.849367 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching
[0m20:52:04.850335 [info ] [Thread-2 (]: 26 of 31 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m20:52:04.851304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_wage_level, now model.cs329e_xh.matching)
[0m20:52:04.851918 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching
[0m20:52:04.883168 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m20:52:04.884204 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching
[0m20:52:04.888054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:52:05.148211 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m20:52:05.149394 [debug] [Thread-2 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    current_dir = os.path.dirname(__file__)
    matching = dbt.ref("matched_results_full")
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"matched_results_full": "silken-fortress-448205-p9.cs329e_xh_dbt.matched_results_full", "temp_employer_details": "silken-fortress-448205-p9.dbt_cs329e_xh_int.temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m20:52:05.169807 [debug] [Thread-2 (]: BigQuery adapter: Submitting batch job with id: b051a013-4e3f-4bba-9762-4ea6cc29eb36
[0m20:57:00.778020 [debug] [Thread-2 (]: Execution status: OK in 295.6300048828125 seconds
[0m20:57:00.781827 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c995c6ad0>]}
[0m20:57:00.782912 [info ] [Thread-2 (]: 26 of 31 OK created python table model dbt_cs329e_xh_int.matching .............. [[32mOK[0m in 295.93s]
[0m20:57:00.783953 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.matching
[0m20:57:00.785522 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Employer_Detail
[0m20:57:00.786351 [info ] [Thread-1 (]: 27 of 31 START sql table model dbt_cs329e_xh_int.Employer_Detail ............... [RUN]
[0m20:57:00.787110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.Employer_Detail)
[0m20:57:00.787684 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Employer_Detail
[0m20:57:00.793042 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Employer_Detail"
[0m20:57:00.794094 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Employer_Detail
[0m20:57:00.797850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:00.931396 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp where employer_petitioner_name is not null
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:57:01.343101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b1f03202-dcaf-4de1-a8bf-5a024c204d25&page=queryresults
[0m20:57:01.473189 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: select * from (
        select
    
      
    cast(null as string)
 as employer_petitioner_name, 
      
    cast(null as string)
 as fein, 
      
    cast(null as int64)
 as employer_no, 
      
    cast(null as int64)
 as fiscal_year, 
      
    cast(null as string)
 as tax_id, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as petitioner_city, 
      
    cast(null as string)
 as petitioner_state, 
      
    cast(null as string)
 as petitioner_zip_code, 
      
    cast(null as string)
 as initial_approval, 
      
    cast(null as int64)
 as initial_denial, 
      
    cast(null as string)
 as continuing_approval, 
      
    cast(null as int64)
 as continuing_denial, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:57:01.735930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:85e7edc0-39af-4096-b7e1-bf7e9413c4a6&page=queryresults
[0m20:57:01.852787 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:57:01.854893 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Employer_Detail"
[0m20:57:01.855957 [debug] [Thread-1 (]: On model.cs329e_xh.Employer_Detail: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Employer_Detail"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
        
  (
    employer_petitioner_name string,
    fein string,
    employer_no int64,
    fiscal_year int64,
    tax_id string,
    naics_code string,
    petitioner_city string,
    petitioner_state string,
    petitioner_zip_code string,
    initial_approval string,
    initial_denial int64,
    continuing_approval string,
    continuing_denial int64,
    _data_source string,
    _load_time datetime,
    
    primary key (employer_petitioner_name) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_petitioner_name, fein, employer_no, fiscal_year, tax_id, naics_code, petitioner_city, petitioner_state, petitioner_zip_code, initial_approval, initial_denial, continuing_approval, continuing_denial, _data_source, _load_time
    from (
        with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        fein,
        employer_no,
        fiscal_year,
        employer_petitioner_name,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp where employer_petitioner_name is not null
    ) as model_subq
    );
  
[0m20:57:02.237476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b2146a46-fb80-476b-a390-e4830950da03&page=queryresults
[0m20:57:04.838522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c995c6830>]}
[0m20:57:04.839603 [info ] [Thread-1 (]: 27 of 31 OK created sql table model dbt_cs329e_xh_int.Employer_Detail .......... [[32mCREATE TABLE (28.9k rows, 10.8 MiB processed)[0m in 4.05s]
[0m20:57:04.840786 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m20:57:04.842099 [debug] [Thread-2 (]: Began running node model.cs329e_xh.company_approval_rate
[0m20:57:04.842966 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_wage_level
[0m20:57:04.843745 [info ] [Thread-2 (]: 28 of 31 START sql table model dbt_cs329e_xh_mrt.company_approval_rate ......... [RUN]
[0m20:57:04.844736 [info ] [Thread-1 (]: 29 of 31 START sql table model dbt_cs329e_xh_mrt.company_wage_level ............ [RUN]
[0m20:57:04.845684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.matching, now model.cs329e_xh.company_approval_rate)
[0m20:57:04.846440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Employer_Detail, now model.cs329e_xh.company_wage_level)
[0m20:57:04.847107 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.company_approval_rate
[0m20:57:04.847754 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_wage_level
[0m20:57:04.852661 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.company_approval_rate"
[0m20:57:04.857714 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_wage_level"
[0m20:57:04.858771 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.company_approval_rate
[0m20:57:04.859420 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_wage_level
[0m20:57:04.864213 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:04.867462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:04.982906 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.company_approval_rate"
[0m20:57:04.984002 [debug] [Thread-2 (]: On model.cs329e_xh.company_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`company_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
    COALESCE(sr.employer_name, cd.employer_name, ed.employer_petitioner_name) AS employer_name,
    COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) AS total_approved,
    COUNT(CASE WHEN sr.first_decision = 'Denied' THEN 1 END) AS total_denied,
    COUNT(*) AS total_applications,
    ROUND(
        (COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) * 100.0) / 
        NULLIF(COUNT(*), 0), 2
    ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration` sr
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed 
    ON sr.employer_name = ed.employer_petitioner_name
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd 
    ON sr.employer_name = cd.employer_name
GROUP BY employer_name
ORDER BY approval_rate DESC
    );
  
[0m20:57:04.993470 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_wage_level"
[0m20:57:04.994394 [debug] [Thread-1 (]: On model.cs329e_xh.company_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`company_wage_level`
      
    
    

    OPTIONS()
    as (
      SELECT 
    COALESCE(ws.company_name, cd.employer_name, ed.employer_petitioner_name) AS employer_name,
    ROUND(AVG(ws.min_wage), 2) AS min_wage,
    ROUND(AVG(ws.max_wage), 2) AS max_wage,
    ROUND(AVG(ws.average_wage), 2) AS average_wage
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary` ws
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed 
    ON ws.company_name = ed.employer_petitioner_name
LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd 
    ON ws.company_name = cd.employer_name
GROUP BY employer_name
ORDER BY average_wage DESC
    );
  
[0m20:57:05.262485 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3e6243db-0164-4640-a8cd-d5af0054fee9&page=queryresults
[0m20:57:05.437891 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:533deb39-9bc5-40e7-9944-bfead82b5abf&page=queryresults
[0m20:57:08.000926 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c99481b70>]}
[0m20:57:08.002063 [info ] [Thread-2 (]: 28 of 31 OK created sql table model dbt_cs329e_xh_mrt.company_approval_rate .... [[32mCREATE TABLE (45.3k rows, 6.7 MiB processed)[0m in 3.16s]
[0m20:57:08.003150 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.company_approval_rate
[0m20:57:08.003814 [debug] [Thread-2 (]: Began running node model.cs329e_xh.industry_approval_rate
[0m20:57:08.004785 [info ] [Thread-2 (]: 30 of 31 START sql table model dbt_cs329e_xh_mrt.industry_approval_rate ........ [RUN]
[0m20:57:08.005572 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_approval_rate, now model.cs329e_xh.industry_approval_rate)
[0m20:57:08.006220 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.industry_approval_rate
[0m20:57:08.012004 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.industry_approval_rate"
[0m20:57:08.012847 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.industry_approval_rate
[0m20:57:08.016341 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:08.161190 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.industry_approval_rate"
[0m20:57:08.162522 [debug] [Thread-2 (]: On model.cs329e_xh.industry_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.industry_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`industry_approval_rate`
      
    
    

    OPTIONS()
    as (
      WITH industry_data AS (
  SELECT
    sr.employer_name,
    -- Assign NAICS code: First use Employer_Detail, then fallback to SR
    COALESCE(SUBSTR(ed.naics_code, 1, 2), SUBSTR(sr.naics_code, 1, 2)) AS naics_code,
    CASE 
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '11' THEN '11 - Agriculture, Forestry, Fishing and Hunting'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '21' THEN '21 - Mining'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '22' THEN '22 - Utilities'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '23' THEN '23 - Construction'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) BETWEEN '31' AND '33' THEN '31-33 - Manufacturing'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '42' THEN '42 - Wholesale Trade'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) BETWEEN '44' AND '45' THEN '44-45 - Retail Trade'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) BETWEEN '48' AND '49' THEN '48-49 - Transportation and Warehousing'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '51' THEN '51 - Information'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '52' THEN '52 - Finance and Insurance'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '53' THEN '53 - Real Estate Rental and Leasing'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '54' THEN '54 - Professional, Scientific, and Technical Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '55' THEN '55 - Management of Companies and Enterprises'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '56' THEN '56 - Administrative and Support Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '61' THEN '61 - Educational Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '62' THEN '62 - Health Care and Social Assistance'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '71' THEN '71 - Arts, Entertainment, and Recreation'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '72' THEN '72 - Accommodation and Food Services'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '81' THEN '81 - Other Services (except Public Administration)'
      WHEN SUBSTR(COALESCE(ed.naics_code, sr.naics_code), 1, 2) = '92' THEN '92 - Public Administration'
      ELSE 'Unclassified' 
    END AS industry,
    COUNT(CASE WHEN sr.first_decision = 'Approved' THEN 1 END) AS approved,
    COUNT(CASE WHEN sr.first_decision = 'Denied' THEN 1 END) AS denied,
    COUNT(*) AS total
  FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration` sr
  LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed
    ON sr.employer_name = ed.employer_petitioner_name
  LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data` cd
    ON sr.employer_name = cd.employer_name
  GROUP BY sr.employer_name, naics_code, industry
)
SELECT 
  industry,
  SUM(approved) AS total_approved,
  SUM(denied) AS total_denied,
  SUM(total) AS total_applications,
  ROUND(SUM(approved) / SUM(total) * 100, 2) AS approval_rate
FROM industry_data
GROUP BY industry
ORDER BY approval_rate DESC
    );
  
[0m20:57:08.259332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c99586290>]}
[0m20:57:08.260424 [info ] [Thread-1 (]: 29 of 31 OK created sql table model dbt_cs329e_xh_mrt.company_wage_level ....... [[32mCREATE TABLE (4.1k rows, 1.7 MiB processed)[0m in 3.41s]
[0m20:57:08.261641 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_wage_level
[0m20:57:08.262389 [debug] [Thread-1 (]: Began running node model.cs329e_xh.wage_level_by_industry
[0m20:57:08.263284 [info ] [Thread-1 (]: 31 of 31 START sql table model dbt_cs329e_xh_mrt.wage_level_by_industry ........ [RUN]
[0m20:57:08.264159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_wage_level, now model.cs329e_xh.wage_level_by_industry)
[0m20:57:08.264760 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.wage_level_by_industry
[0m20:57:08.269941 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.wage_level_by_industry"
[0m20:57:08.270846 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.wage_level_by_industry
[0m20:57:08.274243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:08.407352 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.wage_level_by_industry"
[0m20:57:08.408598 [debug] [Thread-1 (]: On model.cs329e_xh.wage_level_by_industry: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_level_by_industry"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`wage_level_by_industry`
      
    
    

    OPTIONS()
    as (
      WITH industry_wages AS (
  SELECT
    CASE 
      WHEN SUBSTR(ed.naics_code, 1, 2) = '11' THEN '11 - Agriculture, Forestry, Fishing and Hunting'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '21' THEN '21 - Mining'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '22' THEN '22 - Utilities'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '23' THEN '23 - Construction'
      WHEN SUBSTR(ed.naics_code, 1, 2) BETWEEN '31' AND '33' THEN '31-33 - Manufacturing'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '42' THEN '42 - Wholesale Trade'
      WHEN SUBSTR(ed.naics_code, 1, 2) BETWEEN '44' AND '45' THEN '44-45 - Retail Trade'
      WHEN SUBSTR(ed.naics_code, 1, 2) BETWEEN '48' AND '49' THEN '48-49 - Transportation and Warehousing'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '51' THEN '51 - Information'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '52' THEN '52 - Finance and Insurance'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '53' THEN '53 - Real Estate Rental and Leasing'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '54' THEN '54 - Professional, Scientific, and Technical Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '55' THEN '55 - Management of Companies and Enterprises'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '56' THEN '56 - Administrative and Support Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '61' THEN '61 - Educational Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '62' THEN '62 - Health Care and Social Assistance'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '71' THEN '71 - Arts, Entertainment, and Recreation'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '72' THEN '72 - Accommodation and Food Services'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '81' THEN '81 - Other Services (except Public Administration)'
      WHEN SUBSTR(ed.naics_code, 1, 2) = '92' THEN '92 - Public Administration'
      ELSE 'Unclassified'
    END AS industry,
    ROUND(AVG(ws.average_wage), 2) AS avg_wage,
    ROUND(MIN(ws.min_wage), 2) AS min_wage,
    ROUND(MAX(ws.max_wage), 2) AS max_wage
  FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary` ws
  LEFT JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail` ed
    ON ws.company_name = ed.employer_petitioner_name
  WHERE ws.average_wage IS NOT NULL
  GROUP BY industry
)
SELECT
  industry,
  avg_wage,
  min_wage,
  max_wage
FROM industry_wages
ORDER BY avg_wage DESC
    );
  
[0m20:57:08.526880 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7e78cf6c-c173-4fd6-b659-2b6b5d98af19&page=queryresults
[0m20:57:08.768088 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0eb726cf-5586-430e-8b96-c31e41d2b7b6&page=queryresults
[0m20:57:11.027941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9830c1c0>]}
[0m20:57:11.029047 [info ] [Thread-1 (]: 31 of 31 OK created sql table model dbt_cs329e_xh_mrt.wage_level_by_industry ... [[32mCREATE TABLE (21.0 rows, 2.7 MiB processed)[0m in 2.76s]
[0m20:57:11.030078 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.wage_level_by_industry
[0m20:57:11.035148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed6efaa-2975-474b-9489-4d97cd4e1f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c983045e0>]}
[0m20:57:11.036074 [info ] [Thread-2 (]: 30 of 31 OK created sql table model dbt_cs329e_xh_mrt.industry_approval_rate ... [[32mCREATE TABLE (21.0 rows, 8.3 MiB processed)[0m in 3.03s]
[0m20:57:11.037021 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.industry_approval_rate
[0m20:57:11.038923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:11.039825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:11.040351 [debug] [MainThread]: Connection 'model.cs329e_xh.wage_level_by_industry' was properly closed.
[0m20:57:11.040823 [debug] [MainThread]: Connection 'model.cs329e_xh.industry_approval_rate' was properly closed.
[0m20:57:11.041508 [info ] [MainThread]: 
[0m20:57:11.042114 [info ] [MainThread]: Finished running 31 table models in 0 hours 6 minutes and 20.70 seconds (380.70s).
[0m20:57:11.049333 [debug] [MainThread]: Command end result
[0m20:57:11.104125 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:57:11.106611 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:57:11.117119 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:57:11.117680 [info ] [MainThread]: 
[0m20:57:11.118366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:11.119123 [info ] [MainThread]: 
[0m20:57:11.119727 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
[0m20:57:11.120679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 384.1521, "process_in_blocks": "16", "process_kernel_time": 0.627698, "process_mem_max_rss": "287068", "process_out_blocks": "5280", "process_user_time": 7.200316}
[0m20:57:11.121344 [debug] [MainThread]: Command `dbt run` succeeded at 20:57:11.121199 after 384.15 seconds
[0m20:57:11.121922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbd0f15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbc666fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca07eb400>]}
[0m20:57:11.122581 [debug] [MainThread]: Flushing usage events
[0m20:57:11.533965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:52.983301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a89bdd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a88d764d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a88d76530>]}


============================== 20:57:52.986839 | 2b392475-b96e-4b12-a9dd-0686f1cdc1c7 ==============================
[0m20:57:52.986839 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:57:52.987708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:57:54.613928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b392475-b96e-4b12-a9dd-0686f1cdc1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a895b9c90>]}
[0m20:57:54.697590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b392475-b96e-4b12-a9dd-0686f1cdc1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a894aab30>]}
[0m20:57:54.698655 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:57:54.880836 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:57:55.113244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:57:55.113931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:57:55.209505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b392475-b96e-4b12-a9dd-0686f1cdc1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6dbd5ff0>]}
[0m20:57:55.378782 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:57:55.381109 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:57:55.415427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b392475-b96e-4b12-a9dd-0686f1cdc1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6db6e140>]}
[0m20:57:55.416335 [info ] [MainThread]: Found 31 models, 1 seed, 26 data tests, 19 sources, 492 macros
[0m20:57:55.417012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b392475-b96e-4b12-a9dd-0686f1cdc1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6ea408b0>]}
[0m20:57:55.421827 [info ] [MainThread]: 
[0m20:57:55.422511 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:57:55.423125 [info ] [MainThread]: 
[0m20:57:55.423971 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:57:55.433170 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m20:57:55.434246 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m20:57:55.434853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:55.435632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:55.564442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m20:57:55.567360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:55.570577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m20:57:55.574450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:55.803817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b392475-b96e-4b12-a9dd-0686f1cdc1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8b303a00>]}
[0m20:57:55.804711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:55.809169 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m20:57:55.809868 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m20:57:55.810675 [info ] [Thread-1 (]: 1 of 26 START test not_null_Company_Data_employer_name ......................... [RUN]
[0m20:57:55.811572 [info ] [Thread-2 (]: 2 of 26 START test not_null_Employer_Detail_employer_petitioner_name ........... [RUN]
[0m20:57:55.812640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b)
[0m20:57:55.813449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227)
[0m20:57:55.814132 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m20:57:55.814859 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m20:57:55.846058 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m20:57:55.847365 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m20:57:55.848492 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m20:57:55.854326 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m20:57:55.885692 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m20:57:55.886587 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m20:57:55.887736 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
where employer_name is null



      
    ) dbt_internal_test
[0m20:57:55.888517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:55.889276 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_petitioner_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where employer_petitioner_name is null



      
    ) dbt_internal_test
[0m20:57:55.891658 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:56.337254 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8d2dfd71-96bc-4672-84e7-167d480dae32&page=queryresults
[0m20:57:56.364873 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a9813d98-c8bc-43ba-92af-8a59fe3906e3&page=queryresults
[0m20:57:56.688172 [info ] [Thread-2 (]: 2 of 26 PASS not_null_Employer_Detail_employer_petitioner_name ................. [[32mPASS[0m in 0.87s]
[0m20:57:56.689443 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m20:57:56.690224 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m20:57:56.691013 [info ] [Thread-2 (]: 3 of 26 START test not_null_LCA_Appendix_appx_a_date_of_degree ................. [RUN]
[0m20:57:56.691801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227, now test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155)
[0m20:57:56.692438 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m20:57:56.698776 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m20:57:56.699659 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m20:57:56.704001 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m20:57:56.704903 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appx_a_date_of_degree
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where appx_a_date_of_degree is null



      
    ) dbt_internal_test
[0m20:57:56.705558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:56.725831 [info ] [Thread-1 (]: 1 of 26 PASS not_null_Company_Data_employer_name ............................... [[32mPASS[0m in 0.91s]
[0m20:57:56.726886 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m20:57:56.727562 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m20:57:56.728323 [info ] [Thread-1 (]: 4 of 26 START test not_null_LCA_Appendix_case_number ........................... [RUN]
[0m20:57:56.729116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b, now test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b)
[0m20:57:56.729728 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m20:57:56.735918 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m20:57:56.736733 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m20:57:56.740137 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m20:57:56.740983 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where case_number is null



      
    ) dbt_internal_test
[0m20:57:56.741667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:57.111246 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:696584b3-7207-475c-8d00-807de318aa24&page=queryresults
[0m20:57:57.200618 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cad15005-3537-4de1-8442-993cf7c0178a&page=queryresults
[0m20:57:57.544165 [info ] [Thread-1 (]: 4 of 26 PASS not_null_LCA_Appendix_case_number ................................. [[32mPASS[0m in 0.81s]
[0m20:57:57.545651 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m20:57:57.546746 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m20:57:57.547709 [info ] [Thread-1 (]: 5 of 26 START test not_null_LCA_Disclosure_case_number ......................... [RUN]
[0m20:57:57.548574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b, now test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39)
[0m20:57:57.549223 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m20:57:57.556519 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m20:57:57.560246 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m20:57:57.564015 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m20:57:57.564949 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where case_number is null



      
    ) dbt_internal_test
[0m20:57:57.565793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:57.665374 [info ] [Thread-2 (]: 3 of 26 PASS not_null_LCA_Appendix_appx_a_date_of_degree ....................... [[32mPASS[0m in 0.97s]
[0m20:57:57.666636 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m20:57:57.667417 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m20:57:57.668206 [info ] [Thread-2 (]: 6 of 26 START test not_null_LCA_Disclosure_employer_name ....................... [RUN]
[0m20:57:57.668996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155, now test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2)
[0m20:57:57.669751 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m20:57:57.676054 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m20:57:57.676934 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m20:57:57.680325 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m20:57:57.681223 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where employer_name is null



      
    ) dbt_internal_test
[0m20:57:57.682064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:58.002285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a8b3e4fa-e3d9-406f-ae06-ae4ea3896488&page=queryresults
[0m20:57:58.111865 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:96604d41-a9fd-4a9b-9a9a-528f6d86614b&page=queryresults
[0m20:57:58.417189 [info ] [Thread-2 (]: 6 of 26 PASS not_null_LCA_Disclosure_employer_name ............................. [[32mPASS[0m in 0.75s]
[0m20:57:58.419697 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m20:57:58.418353 [info ] [Thread-1 (]: 5 of 26 PASS not_null_LCA_Disclosure_case_number ............................... [[32mPASS[0m in 0.87s]
[0m20:57:58.420686 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m20:57:58.421939 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m20:57:58.422690 [info ] [Thread-2 (]: 7 of 26 START test not_null_LCA_Worksites_row_id ............................... [RUN]
[0m20:57:58.423568 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m20:57:58.424418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2, now test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8)
[0m20:57:58.425297 [info ] [Thread-1 (]: 8 of 26 START test not_null_Sentiment_Analysis_publication_date ................ [RUN]
[0m20:57:58.426213 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m20:57:58.426957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39, now test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8)
[0m20:57:58.433302 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m20:57:58.434001 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m20:57:58.440339 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m20:57:58.441288 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m20:57:58.441972 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m20:57:58.445639 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m20:57:58.449226 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m20:57:58.450477 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
where row_id is null



      
    ) dbt_internal_test
[0m20:57:58.451235 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select publication_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
where publication_date is null



      
    ) dbt_internal_test
[0m20:57:58.451914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:58.452644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:58.816875 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a675056d-56e3-40f6-b3b0-1c289cc921dc&page=queryresults
[0m20:57:58.944026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:938b9ebd-bac0-4b4c-a5bc-cd0669e99391&page=queryresults
[0m20:57:59.149324 [info ] [Thread-2 (]: 7 of 26 PASS not_null_LCA_Worksites_row_id ..................................... [[32mPASS[0m in 0.72s]
[0m20:57:59.150638 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m20:57:59.151407 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m20:57:59.152192 [info ] [Thread-2 (]: 9 of 26 START test not_null_Single_Registration_agent_first_name ............... [RUN]
[0m20:57:59.152993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8, now test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3)
[0m20:57:59.153619 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m20:57:59.159769 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m20:57:59.160717 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m20:57:59.164220 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m20:57:59.165088 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_first_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_first_name is null



      
    ) dbt_internal_test
[0m20:57:59.165734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:59.310352 [info ] [Thread-1 (]: 8 of 26 PASS not_null_Sentiment_Analysis_publication_date ...................... [[32mPASS[0m in 0.88s]
[0m20:57:59.311680 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m20:57:59.312428 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m20:57:59.313275 [info ] [Thread-1 (]: 10 of 26 START test not_null_Single_Registration_agent_last_name ............... [RUN]
[0m20:57:59.314239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8, now test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c)
[0m20:57:59.314848 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m20:57:59.320826 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m20:57:59.321664 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m20:57:59.325059 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m20:57:59.325924 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_last_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_last_name is null



      
    ) dbt_internal_test
[0m20:57:59.326642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:59.627666 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6d9bdc0b-2764-4502-9434-d45b23091d03&page=queryresults
[0m20:57:59.785414 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6c1def0e-8a3e-4008-8adc-2a0927a42f45&page=queryresults
[0m20:57:59.939113 [info ] [Thread-2 (]: 9 of 26 PASS not_null_Single_Registration_agent_first_name ..................... [[32mPASS[0m in 0.79s]
[0m20:57:59.940602 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m20:57:59.941336 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m20:57:59.942127 [info ] [Thread-2 (]: 11 of 26 START test not_null_Single_Registration_ben_year_of_birth ............. [RUN]
[0m20:57:59.943046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3, now test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f)
[0m20:57:59.943669 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m20:57:59.949859 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m20:57:59.950748 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m20:57:59.954244 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m20:57:59.955115 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ben_year_of_birth
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where ben_year_of_birth is null



      
    ) dbt_internal_test
[0m20:57:59.955791 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:00.157848 [info ] [Thread-1 (]: 10 of 26 PASS not_null_Single_Registration_agent_last_name ..................... [[32mPASS[0m in 0.84s]
[0m20:58:00.159234 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m20:58:00.159982 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m20:58:00.160777 [info ] [Thread-1 (]: 12 of 26 START test not_null_Single_Registration_employer_name ................. [RUN]
[0m20:58:00.161589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c, now test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49)
[0m20:58:00.162262 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m20:58:00.168354 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m20:58:00.169185 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m20:58:00.172681 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m20:58:00.173562 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where employer_name is null



      
    ) dbt_internal_test
[0m20:58:00.174290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:00.577443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7da1ea85-399b-45ae-a81f-aa16cc0ec6a8&page=queryresults
[0m20:58:00.613383 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5ecd3d7d-6be6-4cb6-8a3f-01fa8ff857d4&page=queryresults
[0m20:58:00.859932 [info ] [Thread-1 (]: 12 of 26 PASS not_null_Single_Registration_employer_name ....................... [[32mPASS[0m in 0.70s]
[0m20:58:00.861220 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m20:58:00.861937 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m20:58:00.862809 [info ] [Thread-1 (]: 13 of 26 START test not_null_Single_Registration_gender ........................ [RUN]
[0m20:58:00.863611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49, now test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23)
[0m20:58:00.864225 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m20:58:00.995820 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m20:58:00.998065 [info ] [Thread-2 (]: 11 of 26 PASS not_null_Single_Registration_ben_year_of_birth ................... [[32mPASS[0m in 1.05s]
[0m20:58:00.999498 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m20:58:01.000182 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m20:58:01.001000 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m20:58:01.004577 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m20:58:01.005305 [info ] [Thread-2 (]: 14 of 26 START test not_null_Single_Registration_mail_addr ..................... [RUN]
[0m20:58:01.006437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f, now test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3)
[0m20:58:01.007104 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m20:58:01.012677 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m20:58:01.013038 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gender
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where gender is null



      
    ) dbt_internal_test
[0m20:58:01.014494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:01.017121 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m20:58:01.020471 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m20:58:01.021492 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mail_addr
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where mail_addr is null



      
    ) dbt_internal_test
[0m20:58:01.022435 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:01.388343 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:28c950bf-aaa2-4ccc-a6cb-2b3fab462838&page=queryresults
[0m20:58:01.477989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c3c72faa-94b2-473f-ae84-396fc8ed6657&page=queryresults
[0m20:58:01.718134 [info ] [Thread-2 (]: 14 of 26 PASS not_null_Single_Registration_mail_addr ........................... [[32mPASS[0m in 0.71s]
[0m20:58:01.719563 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m20:58:01.720613 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m20:58:01.721795 [info ] [Thread-2 (]: 15 of 26 START test not_null_Wage_Summary_company_name ......................... [RUN]
[0m20:58:01.722802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3, now test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5)
[0m20:58:01.723580 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m20:58:01.729763 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m20:58:01.730658 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m20:58:01.734107 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m20:58:01.734985 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where company_name is null



      
    ) dbt_internal_test
[0m20:58:01.735639 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:01.813556 [info ] [Thread-1 (]: 13 of 26 PASS not_null_Single_Registration_gender .............................. [[32mPASS[0m in 0.95s]
[0m20:58:01.814931 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m20:58:01.815650 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m20:58:01.816422 [info ] [Thread-1 (]: 16 of 26 START test not_null_Wage_Summary_job_title ............................ [RUN]
[0m20:58:01.817298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23, now test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417)
[0m20:58:01.817899 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m20:58:01.825740 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m20:58:01.826615 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m20:58:01.830249 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m20:58:01.831123 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where job_title is null



      
    ) dbt_internal_test
[0m20:58:01.831760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:02.143476 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2ee32c5e-8d42-4194-9afc-e5bfe4432691&page=queryresults
[0m20:58:02.203983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b652b0f9-1d55-4ebc-84f9-2527bf02fc2d&page=queryresults
[0m20:58:02.473445 [info ] [Thread-2 (]: 15 of 26 PASS not_null_Wage_Summary_company_name ............................... [[32mPASS[0m in 0.75s]
[0m20:58:02.474894 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m20:58:02.475659 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m20:58:02.476467 [info ] [Thread-2 (]: 17 of 26 START test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [RUN]
[0m20:58:02.477361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5, now test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6)
[0m20:58:02.478105 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m20:58:02.490453 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m20:58:02.491377 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m20:58:02.494915 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m20:58:02.495850 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select employer_petitioner_name as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
    where employer_petitioner_name is not null
),

parent as (
    select employer_name as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:58:02.496557 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:02.555680 [info ] [Thread-1 (]: 16 of 26 PASS not_null_Wage_Summary_job_title .................................. [[32mPASS[0m in 0.74s]
[0m20:58:02.557084 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m20:58:02.557832 [debug] [Thread-1 (]: Began running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m20:58:02.558686 [info ] [Thread-1 (]: 18 of 26 START test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [RUN]
[0m20:58:02.559688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417, now test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46)
[0m20:58:02.560323 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m20:58:02.568728 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m20:58:02.569633 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m20:58:02.573442 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m20:58:02.574386 [debug] [Thread-1 (]: On test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select case_number as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
    where case_number is not null
),

parent as (
    select case_number as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:58:02.575228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:02.975499 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b6e2a5ec-310b-4b93-95d9-9a558160c50d&page=queryresults
[0m20:58:03.298543 [error] [Thread-2 (]: 17 of 26 FAIL 26518 relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [[31mFAIL 26518[0m in 0.82s]
[0m20:58:03.301517 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m20:58:03.302689 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m20:58:03.303925 [info ] [Thread-2 (]: 19 of 26 START test unique_Company_Data_employer_name .......................... [RUN]
[0m20:58:03.305181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6, now test.cs329e_xh.unique_Company_Data_employer_name.69805b71db)
[0m20:58:03.306285 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m20:58:03.324067 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m20:58:03.325507 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m20:58:03.331441 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m20:58:03.332816 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Company_Data_employer_name.69805b71db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
  where employer_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:58:03.333871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:03.773813 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7fff2078-4b8b-4f28-ba8f-79def229e226&page=queryresults
[0m20:58:03.899167 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ac201feb-ae40-4741-a18e-90cc73a37255&page=queryresults
[0m20:58:04.105608 [info ] [Thread-2 (]: 19 of 26 PASS unique_Company_Data_employer_name ................................ [[32mPASS[0m in 0.80s]
[0m20:58:04.107056 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m20:58:04.107812 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m20:58:04.108482 [info ] [Thread-2 (]: 20 of 26 START test unique_Employer_Detail_employer_petitioner_name ............ [RUN]
[0m20:58:04.109433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Company_Data_employer_name.69805b71db, now test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1)
[0m20:58:04.110177 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m20:58:04.116587 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m20:58:04.117431 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m20:58:04.120807 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m20:58:04.121681 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_petitioner_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
  where employer_petitioner_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:58:04.122430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:04.234206 [error] [Thread-1 (]: 18 of 26 FAIL 14201 relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [[31mFAIL 14201[0m in 1.67s]
[0m20:58:04.235545 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m20:58:04.236321 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m20:58:04.237218 [info ] [Thread-1 (]: 21 of 26 START test unique_LCA_Worksites_row_id ................................ [RUN]
[0m20:58:04.238053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46, now test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef)
[0m20:58:04.238752 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m20:58:04.244807 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m20:58:04.245671 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m20:58:04.249163 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m20:58:04.250062 [debug] [Thread-1 (]: On test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select row_id as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
  where row_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:58:04.250968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:04.598033 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8c2f36b2-3e08-4d7d-9968-d96ef577abe5&page=queryresults
[0m20:58:04.969160 [error] [Thread-2 (]: 20 of 26 FAIL 53 unique_Employer_Detail_employer_petitioner_name ............... [[31mFAIL 53[0m in 0.86s]
[0m20:58:04.970601 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m20:58:04.971373 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m20:58:04.972208 [info ] [Thread-2 (]: 22 of 26 START test unique_Sentiment_Analysis_publication_date ................. [RUN]
[0m20:58:04.973142 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1, now test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e)
[0m20:58:04.973908 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m20:58:04.981796 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m20:58:04.982681 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m20:58:04.986325 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m20:58:04.987194 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select publication_date as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
  where publication_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:58:04.987896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:05.576406 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:98e2f10d-5577-4fb1-a063-958d3353ebb1&page=queryresults
[0m20:58:05.581918 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5d6bf421-483c-4cd5-b7ec-908f6691d4fe&page=queryresults
[0m20:58:05.909435 [info ] [Thread-2 (]: 22 of 26 PASS unique_Sentiment_Analysis_publication_date ....................... [[32mPASS[0m in 0.94s]
[0m20:58:05.910850 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m20:58:05.911644 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m20:58:05.912428 [info ] [Thread-2 (]: 23 of 26 START test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [RUN]
[0m20:58:05.913224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e, now test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557)
[0m20:58:05.913840 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m20:58:05.921609 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:05.924380 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:58:05.925198 [error] [Thread-2 (]: 23 of 26 ERROR unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [[31mERROR[0m in 0.01s]
[0m20:58:05.926072 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m20:58:05.926792 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m20:58:05.927538 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:58:05.928253 [info ] [Thread-2 (]: 24 of 26 START test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [RUN]
[0m20:58:05.929876 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557, now test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4)
[0m20:58:05.930551 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m20:58:05.936495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:05.937916 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:58:05.938740 [error] [Thread-2 (]: 24 of 26 ERROR unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [[31mERROR[0m in 0.01s]
[0m20:58:05.939585 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m20:58:05.940236 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m20:58:05.940930 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:58:05.941613 [info ] [Thread-2 (]: 25 of 26 START test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [RUN]
[0m20:58:05.942590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4, now test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d)
[0m20:58:05.943205 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m20:58:05.952845 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:05.954323 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:58:05.955114 [error] [Thread-2 (]: 25 of 26 ERROR unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [[31mERROR[0m in 0.01s]
[0m20:58:05.955984 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m20:58:05.956638 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m20:58:05.957379 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:58:05.958027 [info ] [Thread-2 (]: 26 of 26 START test unique_combination_of_columns_Wage_Summary_company_name__job_title  [RUN]
[0m20:58:05.959031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d, now test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194)
[0m20:58:05.959646 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m20:58:05.966804 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:05.968229 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:58:05.968974 [error] [Thread-2 (]: 26 of 26 ERROR unique_combination_of_columns_Wage_Summary_company_name__job_title  [[31mERROR[0m in 0.01s]
[0m20:58:05.969815 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m20:58:05.970590 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:58:06.364255 [info ] [Thread-1 (]: 21 of 26 PASS unique_LCA_Worksites_row_id ...................................... [[32mPASS[0m in 2.13s]
[0m20:58:06.365572 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m20:58:06.367603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:06.368581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:06.369108 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' was properly closed.
[0m20:58:06.369610 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef' was properly closed.
[0m20:58:06.370221 [info ] [MainThread]: 
[0m20:58:06.370924 [info ] [MainThread]: Finished running 26 data tests in 0 hours 0 minutes and 10.95 seconds (10.95s).
[0m20:58:06.376675 [debug] [MainThread]: Command end result
[0m20:58:06.434374 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m20:58:06.437064 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m20:58:06.448556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m20:58:06.449156 [info ] [MainThread]: 
[0m20:58:06.449948 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m20:58:06.450733 [info ] [MainThread]: 
[0m20:58:06.451523 [error] [MainThread]: [31mFailure in test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_ (models/int/Employer_Details/schema.yml)[0m
[0m20:58:06.452316 [error] [MainThread]:   Got 26518 results, configured to fail if != 0
[0m20:58:06.452881 [info ] [MainThread]: 
[0m20:58:06.453678 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/relationships_Employer_Detail_a803ce1d5c10b4dae7e1dc33e0f1a09b.sql
[0m20:58:06.454368 [info ] [MainThread]: 
[0m20:58:06.455110 [error] [MainThread]: [31mFailure in test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_ (models/int/schema.yml)[0m
[0m20:58:06.455863 [error] [MainThread]:   Got 14201 results, configured to fail if != 0
[0m20:58:06.456549 [info ] [MainThread]: 
[0m20:58:06.457274 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Worksites_a871b7806445a97e6fda9420f0740807.sql
[0m20:58:06.457927 [info ] [MainThread]: 
[0m20:58:06.458712 [error] [MainThread]: [31mFailure in test unique_Employer_Detail_employer_petitioner_name (models/int/Employer_Details/schema.yml)[0m
[0m20:58:06.459435 [error] [MainThread]:   Got 53 results, configured to fail if != 0
[0m20:58:06.460059 [info ] [MainThread]: 
[0m20:58:06.460776 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/unique_Employer_Detail_employer_petitioner_name.sql
[0m20:58:06.461427 [info ] [MainThread]: 
[0m20:58:06.462170 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:58:06.462878 [info ] [MainThread]: 
[0m20:58:06.463608 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:58:06.464248 [info ] [MainThread]: 
[0m20:58:06.465005 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:58:06.465657 [info ] [MainThread]: 
[0m20:58:06.466416 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:58:06.467104 [info ] [MainThread]: 
[0m20:58:06.467788 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=7 SKIP=0 TOTAL=26
[0m20:58:06.468811 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 13.562902, "process_in_blocks": "0", "process_kernel_time": 0.534972, "process_mem_max_rss": "268204", "process_out_blocks": "3560", "process_user_time": 5.269259}
[0m20:58:06.469498 [debug] [MainThread]: Command `dbt test` failed at 20:58:06.469353 after 13.56 seconds
[0m20:58:06.470098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a89bdd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6dd28550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6d8ff5b0>]}
[0m20:58:06.470790 [debug] [MainThread]: Flushing usage events
[0m20:58:06.822187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:19.773577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe8cd9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe7e5e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe7e5e470>]}


============================== 21:03:19.777180 | 44968daf-3753-4e84-909b-ab47ff51c42a ==============================
[0m21:03:19.777180 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:03:19.778030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m21:03:21.409545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44968daf-3753-4e84-909b-ab47ff51c42a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe82f2e30>]}
[0m21:03:21.493008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44968daf-3753-4e84-909b-ab47ff51c42a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe8487310>]}
[0m21:03:21.494074 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:03:21.663971 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:03:21.895613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:03:21.896671 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://macros/unique_combination_of_columns.sql
[0m21:03:22.065863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44968daf-3753-4e84-909b-ab47ff51c42a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febccae9de0>]}
[0m21:03:22.236343 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:03:22.239168 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:03:22.273929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44968daf-3753-4e84-909b-ab47ff51c42a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febccaee8c0>]}
[0m21:03:22.274872 [info ] [MainThread]: Found 31 models, 1 seed, 26 data tests, 19 sources, 492 macros
[0m21:03:22.275567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44968daf-3753-4e84-909b-ab47ff51c42a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febccd3b190>]}
[0m21:03:22.280613 [info ] [MainThread]: 
[0m21:03:22.281304 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:03:22.281912 [info ] [MainThread]: 
[0m21:03:22.282832 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:03:22.292145 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m21:03:22.292928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:22.293710 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m21:03:22.294875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:22.449971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m21:03:22.451292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:22.455330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m21:03:22.459088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:22.582397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44968daf-3753-4e84-909b-ab47ff51c42a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe8237d60>]}
[0m21:03:22.583243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:22.586893 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:03:22.587635 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:03:22.588311 [info ] [Thread-1 (]: 1 of 26 START test not_null_Company_Data_employer_name ......................... [RUN]
[0m21:03:22.589260 [info ] [Thread-2 (]: 2 of 26 START test not_null_Employer_Detail_employer_petitioner_name ........... [RUN]
[0m21:03:22.590304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b)
[0m21:03:22.591047 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227)
[0m21:03:22.591745 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:03:22.592413 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:03:22.628641 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m21:03:22.627803 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m21:03:22.629934 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:03:22.630680 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:03:22.676262 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m21:03:22.677136 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m21:03:22.678479 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_petitioner_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where employer_petitioner_name is null



      
    ) dbt_internal_test
[0m21:03:22.679333 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
where employer_name is null



      
    ) dbt_internal_test
[0m21:03:22.680048 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:22.680775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:23.011797 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ec8e42ee-8021-476f-b238-a67202c83510&page=queryresults
[0m21:03:23.111430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:36ffa47d-7aab-4c26-b2bc-57b3d1964961&page=queryresults
[0m21:03:23.411273 [info ] [Thread-2 (]: 2 of 26 PASS not_null_Employer_Detail_employer_petitioner_name ................. [[32mPASS[0m in 0.82s]
[0m21:03:23.412528 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:03:23.413285 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:03:23.413974 [info ] [Thread-2 (]: 3 of 26 START test not_null_LCA_Appendix_appx_a_date_of_degree ................. [RUN]
[0m21:03:23.415012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227, now test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155)
[0m21:03:23.415638 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:03:23.421920 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m21:03:23.422827 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:03:23.426309 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m21:03:23.427166 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appx_a_date_of_degree
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where appx_a_date_of_degree is null



      
    ) dbt_internal_test
[0m21:03:23.427856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:23.697189 [info ] [Thread-1 (]: 1 of 26 PASS not_null_Company_Data_employer_name ............................... [[32mPASS[0m in 1.11s]
[0m21:03:23.699056 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:03:23.700198 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:03:23.701364 [info ] [Thread-1 (]: 4 of 26 START test not_null_LCA_Appendix_case_number ........................... [RUN]
[0m21:03:23.702579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b, now test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b)
[0m21:03:23.703567 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:03:23.713522 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m21:03:23.714818 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:03:23.722125 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m21:03:23.723508 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where case_number is null



      
    ) dbt_internal_test
[0m21:03:23.724549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:23.772626 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3252b9d7-f5f6-4f9d-b198-83f8e86bf2bf&page=queryresults
[0m21:03:24.180193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:797c8178-eed0-46e1-9283-0fb93e18c427&page=queryresults
[0m21:03:24.209373 [info ] [Thread-2 (]: 3 of 26 PASS not_null_LCA_Appendix_appx_a_date_of_degree ....................... [[32mPASS[0m in 0.79s]
[0m21:03:24.211107 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:03:24.212191 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:03:24.213353 [info ] [Thread-2 (]: 5 of 26 START test not_null_LCA_Disclosure_case_number ......................... [RUN]
[0m21:03:24.214542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155, now test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39)
[0m21:03:24.215522 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:03:24.225380 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m21:03:24.226704 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:03:24.232299 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m21:03:24.233653 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where case_number is null



      
    ) dbt_internal_test
[0m21:03:24.234723 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:24.554979 [info ] [Thread-1 (]: 4 of 26 PASS not_null_LCA_Appendix_case_number ................................. [[32mPASS[0m in 0.85s]
[0m21:03:24.556438 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:03:24.557210 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:03:24.558096 [info ] [Thread-1 (]: 6 of 26 START test not_null_LCA_Disclosure_employer_name ....................... [RUN]
[0m21:03:24.559047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b, now test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2)
[0m21:03:24.559682 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:03:24.566196 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m21:03:24.567038 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:03:24.570510 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m21:03:24.571394 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where employer_name is null



      
    ) dbt_internal_test
[0m21:03:24.572032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:24.594861 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c8535d65-69f1-4551-b75e-b29e166be8dd&page=queryresults
[0m21:03:24.939456 [info ] [Thread-2 (]: 5 of 26 PASS not_null_LCA_Disclosure_case_number ............................... [[32mPASS[0m in 0.72s]
[0m21:03:24.940958 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:03:24.941804 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:03:24.942757 [info ] [Thread-2 (]: 7 of 26 START test not_null_LCA_Worksites_row_id ............................... [RUN]
[0m21:03:24.943678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39, now test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8)
[0m21:03:24.944312 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:03:24.950590 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m21:03:24.951418 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:03:24.956614 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m21:03:24.957544 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
where row_id is null



      
    ) dbt_internal_test
[0m21:03:24.958320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:24.961497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1c708144-7ff4-422c-940d-fdc0762af250&page=queryresults
[0m21:03:25.305937 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7a2cd857-fff5-451d-abca-c7d021b065ed&page=queryresults
[0m21:03:25.308387 [info ] [Thread-1 (]: 6 of 26 PASS not_null_LCA_Disclosure_employer_name ............................. [[32mPASS[0m in 0.75s]
[0m21:03:25.311979 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:03:25.312697 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:03:25.313481 [info ] [Thread-1 (]: 8 of 26 START test not_null_Sentiment_Analysis_publication_date ................ [RUN]
[0m21:03:25.314383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2, now test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8)
[0m21:03:25.314990 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:03:25.321267 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m21:03:25.322092 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:03:25.325676 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m21:03:25.326593 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select publication_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
where publication_date is null



      
    ) dbt_internal_test
[0m21:03:25.327249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:25.625306 [info ] [Thread-2 (]: 7 of 26 PASS not_null_LCA_Worksites_row_id ..................................... [[32mPASS[0m in 0.68s]
[0m21:03:25.626598 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:03:25.627317 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:03:25.628121 [info ] [Thread-2 (]: 9 of 26 START test not_null_Single_Registration_agent_first_name ............... [RUN]
[0m21:03:25.628926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8, now test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3)
[0m21:03:25.629570 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:03:25.635591 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m21:03:25.636456 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:03:25.640078 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m21:03:25.640966 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_first_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_first_name is null



      
    ) dbt_internal_test
[0m21:03:25.641652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:25.722608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:199a8fbd-d26d-4e8c-9ca5-ce980710e191&page=queryresults
[0m21:03:25.988510 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5901682d-7b1d-4022-a979-e2f03663bed1&page=queryresults
[0m21:03:26.091074 [info ] [Thread-1 (]: 8 of 26 PASS not_null_Sentiment_Analysis_publication_date ...................... [[32mPASS[0m in 0.78s]
[0m21:03:26.092530 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:03:26.093330 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:03:26.094070 [info ] [Thread-1 (]: 10 of 26 START test not_null_Single_Registration_agent_last_name ............... [RUN]
[0m21:03:26.095084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8, now test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c)
[0m21:03:26.095722 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:03:26.101824 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m21:03:26.102732 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:03:26.107988 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m21:03:26.109025 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_last_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_last_name is null



      
    ) dbt_internal_test
[0m21:03:26.109738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:26.339746 [info ] [Thread-2 (]: 9 of 26 PASS not_null_Single_Registration_agent_first_name ..................... [[32mPASS[0m in 0.71s]
[0m21:03:26.341182 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:03:26.341899 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:03:26.342753 [info ] [Thread-2 (]: 11 of 26 START test not_null_Single_Registration_ben_year_of_birth ............. [RUN]
[0m21:03:26.343574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3, now test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f)
[0m21:03:26.344191 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:03:26.350585 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m21:03:26.351488 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:03:26.355182 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m21:03:26.356051 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ben_year_of_birth
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where ben_year_of_birth is null



      
    ) dbt_internal_test
[0m21:03:26.356754 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:26.411901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6a4490a8-a88e-466c-bbac-f0a43fbc4f26&page=queryresults
[0m21:03:26.728253 [info ] [Thread-1 (]: 10 of 26 PASS not_null_Single_Registration_agent_last_name ..................... [[32mPASS[0m in 0.63s]
[0m21:03:26.730384 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:03:26.731191 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:03:26.732118 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:853792e6-cba5-46ca-a1a9-284c7b9a3561&page=queryresults
[0m21:03:26.732954 [info ] [Thread-1 (]: 12 of 26 START test not_null_Single_Registration_employer_name ................. [RUN]
[0m21:03:26.735467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c, now test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49)
[0m21:03:26.736147 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:03:26.742344 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m21:03:26.743227 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:03:26.747084 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m21:03:26.747953 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where employer_name is null



      
    ) dbt_internal_test
[0m21:03:26.748723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:27.072754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:34cdfc09-e9a5-4f9e-93a4-a874e512e39e&page=queryresults
[0m21:03:27.095316 [info ] [Thread-2 (]: 11 of 26 PASS not_null_Single_Registration_ben_year_of_birth ................... [[32mPASS[0m in 0.75s]
[0m21:03:27.096653 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:03:27.097400 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:03:27.098214 [info ] [Thread-2 (]: 13 of 26 START test not_null_Single_Registration_gender ........................ [RUN]
[0m21:03:27.098989 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f, now test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23)
[0m21:03:27.099613 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:03:27.105855 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m21:03:27.106740 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:03:27.112208 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m21:03:27.113082 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gender
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where gender is null



      
    ) dbt_internal_test
[0m21:03:27.113729 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:27.385853 [info ] [Thread-1 (]: 12 of 26 PASS not_null_Single_Registration_employer_name ....................... [[32mPASS[0m in 0.65s]
[0m21:03:27.387162 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:03:27.387896 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:03:27.388673 [info ] [Thread-1 (]: 14 of 26 START test not_null_Single_Registration_mail_addr ..................... [RUN]
[0m21:03:27.389453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49, now test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3)
[0m21:03:27.390062 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:03:27.396329 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m21:03:27.398034 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b72ce224-2d9b-42a6-8053-a1d791f5076b&page=queryresults
[0m21:03:27.398770 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:03:27.403706 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m21:03:27.404586 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mail_addr
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where mail_addr is null



      
    ) dbt_internal_test
[0m21:03:27.405260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:27.713593 [info ] [Thread-2 (]: 13 of 26 PASS not_null_Single_Registration_gender .............................. [[32mPASS[0m in 0.61s]
[0m21:03:27.715068 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:03:27.715798 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:03:27.716606 [info ] [Thread-2 (]: 15 of 26 START test not_null_Wage_Summary_company_name ......................... [RUN]
[0m21:03:27.717439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23, now test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5)
[0m21:03:27.718075 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:03:27.724283 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m21:03:27.725198 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:03:27.728597 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m21:03:27.729519 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where company_name is null



      
    ) dbt_internal_test
[0m21:03:27.730499 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:27.796587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f1bbaed6-9cce-43c1-9752-89a82a5c8469&page=queryresults
[0m21:03:28.116111 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:298e866c-4698-4e58-92f9-5e3cd7b2e24e&page=queryresults
[0m21:03:28.143806 [info ] [Thread-1 (]: 14 of 26 PASS not_null_Single_Registration_mail_addr ........................... [[32mPASS[0m in 0.75s]
[0m21:03:28.145120 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:03:28.145883 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:03:28.146675 [info ] [Thread-1 (]: 16 of 26 START test not_null_Wage_Summary_job_title ............................ [RUN]
[0m21:03:28.147450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3, now test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417)
[0m21:03:28.148063 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:03:28.154070 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m21:03:28.154938 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:03:28.158428 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m21:03:28.159279 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where job_title is null



      
    ) dbt_internal_test
[0m21:03:28.159931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:28.371722 [info ] [Thread-2 (]: 15 of 26 PASS not_null_Wage_Summary_company_name ............................... [[32mPASS[0m in 0.65s]
[0m21:03:28.372960 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:03:28.373700 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:03:28.374623 [info ] [Thread-2 (]: 17 of 26 START test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [RUN]
[0m21:03:28.375407 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5, now test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6)
[0m21:03:28.376016 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:03:28.515678 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m21:03:28.516713 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:03:28.520270 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m21:03:28.521202 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select employer_petitioner_name as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
    where employer_petitioner_name is not null
),

parent as (
    select employer_name as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:03:28.521913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:28.568427 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:394f97d3-ce76-40f2-aadf-0b713df345f6&page=queryresults
[0m21:03:28.839045 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5e1df43c-a61c-41ae-a10c-b9e91fc965d1&page=queryresults
[0m21:03:28.918353 [info ] [Thread-1 (]: 16 of 26 PASS not_null_Wage_Summary_job_title .................................. [[32mPASS[0m in 0.77s]
[0m21:03:28.919624 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:03:28.920382 [debug] [Thread-1 (]: Began running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:03:28.921164 [info ] [Thread-1 (]: 18 of 26 START test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [RUN]
[0m21:03:28.921925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417, now test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46)
[0m21:03:28.922590 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:03:28.930732 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m21:03:28.931574 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:03:28.935113 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m21:03:28.937356 [debug] [Thread-1 (]: On test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select case_number as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
    where case_number is not null
),

parent as (
    select case_number as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:03:28.939212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:29.165572 [error] [Thread-2 (]: 17 of 26 FAIL 26518 relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [[31mFAIL 26518[0m in 0.79s]
[0m21:03:29.166946 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:03:29.167650 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:03:29.168566 [info ] [Thread-2 (]: 19 of 26 START test unique_Company_Data_employer_name .......................... [RUN]
[0m21:03:29.169330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6, now test.cs329e_xh.unique_Company_Data_employer_name.69805b71db)
[0m21:03:29.169951 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:03:29.178931 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m21:03:29.179780 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:03:29.183584 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m21:03:29.184473 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Company_Data_employer_name.69805b71db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
  where employer_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:03:29.185153 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:29.257733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:379aeb80-0aba-4074-a861-27bcdc4bec96&page=queryresults
[0m21:03:29.420376 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6466bfc5-b100-49b4-a9cf-435c1d6ed2e4&page=queryresults
[0m21:03:29.584052 [error] [Thread-1 (]: 18 of 26 FAIL 14201 relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [[31mFAIL 14201[0m in 0.66s]
[0m21:03:29.585401 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:03:29.586207 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:03:29.587007 [info ] [Thread-1 (]: 20 of 26 START test unique_Employer_Detail_employer_petitioner_name ............ [RUN]
[0m21:03:29.587807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46, now test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1)
[0m21:03:29.588441 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:03:29.596319 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m21:03:29.598638 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:03:29.603385 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m21:03:29.604540 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_petitioner_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
  where employer_petitioner_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:03:29.605248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:29.819784 [info ] [Thread-2 (]: 19 of 26 PASS unique_Company_Data_employer_name ................................ [[32mPASS[0m in 0.65s]
[0m21:03:29.821139 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:03:29.821886 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:03:29.822702 [info ] [Thread-2 (]: 21 of 26 START test unique_LCA_Worksites_row_id ................................ [RUN]
[0m21:03:29.823482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Company_Data_employer_name.69805b71db, now test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef)
[0m21:03:29.824105 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:03:29.830211 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m21:03:29.831057 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:03:29.834365 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m21:03:29.835232 [debug] [Thread-2 (]: On test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select row_id as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
  where row_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:03:29.835910 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:29.920708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d319114d-9896-460c-8a6f-92798ffddcfc&page=queryresults
[0m21:03:30.153905 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4c5580d5-85f2-4ba5-81aa-451e534dbc1f&page=queryresults
[0m21:03:30.213822 [error] [Thread-1 (]: 20 of 26 FAIL 53 unique_Employer_Detail_employer_petitioner_name ............... [[31mFAIL 53[0m in 0.63s]
[0m21:03:30.215183 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:03:30.215929 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:03:30.216768 [info ] [Thread-1 (]: 22 of 26 START test unique_Sentiment_Analysis_publication_date ................. [RUN]
[0m21:03:30.217597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1, now test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e)
[0m21:03:30.218247 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:03:30.224105 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m21:03:30.224953 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:03:30.228419 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m21:03:30.229291 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select publication_date as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
  where publication_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:03:30.229999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:30.456734 [info ] [Thread-2 (]: 21 of 26 PASS unique_LCA_Worksites_row_id ...................................... [[32mPASS[0m in 0.63s]
[0m21:03:30.458038 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:03:30.458807 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:03:30.459623 [info ] [Thread-2 (]: 23 of 26 START test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [RUN]
[0m21:03:30.460404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef, now test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557)
[0m21:03:30.461020 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:03:30.470215 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:30.473102 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:03:30.473906 [error] [Thread-2 (]: 23 of 26 ERROR unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [[31mERROR[0m in 0.01s]
[0m21:03:30.474796 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:03:30.475446 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:03:30.476205 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m21:03:30.476935 [info ] [Thread-2 (]: 24 of 26 START test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [RUN]
[0m21:03:30.478857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557, now test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4)
[0m21:03:30.479491 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:03:30.485668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:30.487310 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:03:30.488078 [error] [Thread-2 (]: 24 of 26 ERROR unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [[31mERROR[0m in 0.01s]
[0m21:03:30.488960 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:03:30.489606 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:03:30.490356 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m21:03:30.491057 [info ] [Thread-2 (]: 25 of 26 START test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [RUN]
[0m21:03:30.492103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4, now test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d)
[0m21:03:30.492736 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:03:30.502278 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:30.503763 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:03:30.504553 [error] [Thread-2 (]: 25 of 26 ERROR unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [[31mERROR[0m in 0.01s]
[0m21:03:30.505473 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:03:30.506133 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:03:30.506852 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m21:03:30.507577 [info ] [Thread-2 (]: 26 of 26 START test unique_combination_of_columns_Wage_Summary_company_name__job_title  [RUN]
[0m21:03:30.508587 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d, now test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194)
[0m21:03:30.509203 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:03:30.516571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:30.518016 [debug] [Thread-2 (]: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:03:30.518804 [error] [Thread-2 (]: 26 of 26 ERROR unique_combination_of_columns_Wage_Summary_company_name__job_title  [[31mERROR[0m in 0.01s]
[0m21:03:30.519874 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:03:30.520661 [debug] [Thread-5 (]: Marking all children of 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m21:03:30.560020 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:dfa80fb8-3771-456d-98af-a1cc0127af14&page=queryresults
[0m21:03:30.877348 [info ] [Thread-1 (]: 22 of 26 PASS unique_Sentiment_Analysis_publication_date ....................... [[32mPASS[0m in 0.66s]
[0m21:03:30.878805 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:03:30.880760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:30.881758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:30.882322 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e' was properly closed.
[0m21:03:30.882814 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' was properly closed.
[0m21:03:30.883411 [info ] [MainThread]: 
[0m21:03:30.884092 [info ] [MainThread]: Finished running 26 data tests in 0 hours 0 minutes and 8.60 seconds (8.60s).
[0m21:03:30.889971 [debug] [MainThread]: Command end result
[0m21:03:30.948873 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:03:30.951720 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:03:30.963783 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m21:03:30.964466 [info ] [MainThread]: 
[0m21:03:30.965256 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m21:03:30.966131 [info ] [MainThread]: 
[0m21:03:30.966957 [error] [MainThread]: [31mFailure in test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_ (models/int/Employer_Details/schema.yml)[0m
[0m21:03:30.967732 [error] [MainThread]:   Got 26518 results, configured to fail if != 0
[0m21:03:30.968378 [info ] [MainThread]: 
[0m21:03:30.969130 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/relationships_Employer_Detail_a803ce1d5c10b4dae7e1dc33e0f1a09b.sql
[0m21:03:30.969803 [info ] [MainThread]: 
[0m21:03:30.970617 [error] [MainThread]: [31mFailure in test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_ (models/int/schema.yml)[0m
[0m21:03:30.971360 [error] [MainThread]:   Got 14201 results, configured to fail if != 0
[0m21:03:30.971992 [info ] [MainThread]: 
[0m21:03:30.972731 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Worksites_a871b7806445a97e6fda9420f0740807.sql
[0m21:03:30.973405 [info ] [MainThread]: 
[0m21:03:30.974179 [error] [MainThread]: [31mFailure in test unique_Employer_Detail_employer_petitioner_name (models/int/Employer_Details/schema.yml)[0m
[0m21:03:30.974925 [error] [MainThread]:   Got 53 results, configured to fail if != 0
[0m21:03:30.975556 [info ] [MainThread]: 
[0m21:03:30.976278 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/unique_Employer_Detail_employer_petitioner_name.sql
[0m21:03:30.976928 [info ] [MainThread]: 
[0m21:03:30.977663 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:03:30.978363 [info ] [MainThread]: 
[0m21:03:30.979097 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:03:30.979742 [info ] [MainThread]: 
[0m21:03:30.980366 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:03:30.980884 [info ] [MainThread]: 
[0m21:03:30.981474 [error] [MainThread]:   Compilation Error in test unique_combination_of_columns_Wage_Summary_company_name__job_title (models/int/schema.yml)
  'test_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:03:30.982015 [info ] [MainThread]: 
[0m21:03:30.982625 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=7 SKIP=0 TOTAL=26
[0m21:03:30.983561 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 11.286288, "process_in_blocks": "0", "process_kernel_time": 0.571609, "process_mem_max_rss": "267212", "process_out_blocks": "4896", "process_user_time": 5.3046}
[0m21:03:30.984296 [debug] [MainThread]: Command `dbt test` failed at 21:03:30.984133 after 11.29 seconds
[0m21:03:30.984958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe8cd9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febccc16a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe8ba2560>]}
[0m21:03:30.985595 [debug] [MainThread]: Flushing usage events
[0m21:03:31.332585 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:43.177690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b798a5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78a2a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78a2a470>]}


============================== 21:04:43.181175 | fad08870-cb75-4c7b-b877-6e06cdc40cc6 ==============================
[0m21:04:43.181175 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:04:43.182016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:44.791402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fad08870-cb75-4c7b-b877-6e06cdc40cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78e02e30>]}
[0m21:04:44.873974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fad08870-cb75-4c7b-b877-6e06cdc40cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b79053310>]}
[0m21:04:44.875029 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:04:45.045330 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:04:45.281069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:04:45.282093 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://macros/.ipynb_checkpoints/unique_combination_of_columns-checkpoint.sql
[0m21:04:45.282793 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://macros/unique_combination_of_columns.sql
[0m21:04:45.288187 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "test_unique_combination_of_columns" in the project
  "cs329e_xh".
   To fix this error, rename or remove one of the following macros:
      - macros/unique_combination_of_columns.sql
      - macros/.ipynb_checkpoints/unique_combination_of_columns-checkpoint.sql
[0m21:04:45.289236 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.187872, "process_in_blocks": "0", "process_kernel_time": 0.411772, "process_mem_max_rss": "253384", "process_out_blocks": "8", "process_user_time": 3.833629}
[0m21:04:45.290142 [debug] [MainThread]: Command `dbt test` failed at 21:04:45.289966 after 2.19 seconds
[0m21:04:45.290884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b798a5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5d9bb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5d9bb820>]}
[0m21:04:45.291557 [debug] [MainThread]: Flushing usage events
[0m21:04:45.657146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:58.257715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8079309540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807848e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807848e4a0>]}


============================== 21:04:58.261307 | 7ddbad78-f480-46ea-ba71-15a80cc60903 ==============================
[0m21:04:58.261307 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:04:58.262191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:04:59.883921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ddbad78-f480-46ea-ba71-15a80cc60903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80788e72e0>]}
[0m21:04:59.966820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ddbad78-f480-46ea-ba71-15a80cc60903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8078ab62c0>]}
[0m21:04:59.967863 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:05:00.138738 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:05:00.369522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:05:00.370864 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://macros/unique_combination_of_columns.sql
[0m21:05:00.544909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ddbad78-f480-46ea-ba71-15a80cc60903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805d11e320>]}
[0m21:05:00.712839 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:05:00.715204 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:05:00.749182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ddbad78-f480-46ea-ba71-15a80cc60903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805d3e9210>]}
[0m21:05:00.749989 [info ] [MainThread]: Found 31 models, 1 seed, 26 data tests, 19 sources, 494 macros
[0m21:05:00.750679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddbad78-f480-46ea-ba71-15a80cc60903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805df808b0>]}
[0m21:05:00.755669 [info ] [MainThread]: 
[0m21:05:00.756313 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:05:00.756890 [info ] [MainThread]: 
[0m21:05:00.757726 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:05:00.766798 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m21:05:00.768244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:00.769092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_stg'
[0m21:05:00.770398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:00.913523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m21:05:00.916243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:00.924630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m21:05:00.925770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:01.060150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddbad78-f480-46ea-ba71-15a80cc60903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807959ee60>]}
[0m21:05:01.061006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:05:01.064717 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:05:01.065470 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:05:01.066280 [info ] [Thread-1 (]: 1 of 26 START test not_null_Company_Data_employer_name ......................... [RUN]
[0m21:05:01.067250 [info ] [Thread-2 (]: 2 of 26 START test not_null_Employer_Detail_employer_petitioner_name ........... [RUN]
[0m21:05:01.068248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b)
[0m21:05:01.069714 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:05:01.069001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227)
[0m21:05:01.090508 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:05:01.101480 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m21:05:01.102127 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m21:05:01.103183 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:05:01.103823 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:05:01.151726 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m21:05:01.152808 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m21:05:01.154030 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
where employer_name is null



      
    ) dbt_internal_test
[0m21:05:01.154864 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_petitioner_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where employer_petitioner_name is null



      
    ) dbt_internal_test
[0m21:05:01.155742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:01.156414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:01.391821 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3864e100-4bd8-4783-ac60-8016bb269de4&page=queryresults
[0m21:05:01.499260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:66c410d1-a6c6-45b9-881e-cb4f672e05c6&page=queryresults
[0m21:05:01.788567 [info ] [Thread-2 (]: 2 of 26 PASS not_null_Employer_Detail_employer_petitioner_name ................. [[32mPASS[0m in 0.72s]
[0m21:05:01.789974 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:05:01.790738 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:05:01.791559 [info ] [Thread-2 (]: 3 of 26 START test not_null_LCA_Appendix_appx_a_date_of_degree ................. [RUN]
[0m21:05:01.792455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227, now test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155)
[0m21:05:01.793081 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:05:01.799194 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m21:05:01.800038 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:05:01.803527 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m21:05:01.804437 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appx_a_date_of_degree
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where appx_a_date_of_degree is null



      
    ) dbt_internal_test
[0m21:05:01.805174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:01.842339 [info ] [Thread-1 (]: 1 of 26 PASS not_null_Company_Data_employer_name ............................... [[32mPASS[0m in 0.77s]
[0m21:05:01.843855 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:05:01.844607 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:05:01.845425 [info ] [Thread-1 (]: 4 of 26 START test not_null_LCA_Appendix_case_number ........................... [RUN]
[0m21:05:01.846405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b, now test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b)
[0m21:05:01.847045 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:05:01.854037 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m21:05:01.854949 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:05:01.858532 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m21:05:01.859435 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where case_number is null



      
    ) dbt_internal_test
[0m21:05:01.860140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:02.131167 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:271095bf-4f71-4125-96ef-fa0162b0bb54&page=queryresults
[0m21:05:02.151383 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d1268477-7d88-4b8a-b398-f967b5c48d8c&page=queryresults
[0m21:05:02.468173 [info ] [Thread-2 (]: 3 of 26 PASS not_null_LCA_Appendix_appx_a_date_of_degree ....................... [[32mPASS[0m in 0.68s]
[0m21:05:02.469471 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:05:02.470278 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:05:02.471081 [info ] [Thread-2 (]: 5 of 26 START test not_null_LCA_Disclosure_case_number ......................... [RUN]
[0m21:05:02.471890 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155, now test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39)
[0m21:05:02.472530 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:05:02.478745 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m21:05:02.479586 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:05:02.482972 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m21:05:02.483828 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where case_number is null



      
    ) dbt_internal_test
[0m21:05:02.484511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:02.625570 [info ] [Thread-1 (]: 4 of 26 PASS not_null_LCA_Appendix_case_number ................................. [[32mPASS[0m in 0.78s]
[0m21:05:02.627031 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:05:02.627765 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:05:02.628583 [info ] [Thread-1 (]: 6 of 26 START test not_null_LCA_Disclosure_employer_name ....................... [RUN]
[0m21:05:02.629482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b, now test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2)
[0m21:05:02.630107 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:05:02.636507 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m21:05:02.637395 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:05:02.640945 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m21:05:02.641935 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where employer_name is null



      
    ) dbt_internal_test
[0m21:05:02.642657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:02.767122 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a9d20de2-dad7-4f92-b5ba-cc829125b1f9&page=queryresults
[0m21:05:03.073827 [info ] [Thread-2 (]: 5 of 26 PASS not_null_LCA_Disclosure_case_number ............................... [[32mPASS[0m in 0.60s]
[0m21:05:03.075310 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:05:03.076001 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:05:03.076890 [info ] [Thread-2 (]: 7 of 26 START test not_null_LCA_Worksites_row_id ............................... [RUN]
[0m21:05:03.077843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39, now test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8)
[0m21:05:03.078541 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:05:03.085024 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m21:05:03.085876 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:05:03.091119 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m21:05:03.092002 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
where row_id is null



      
    ) dbt_internal_test
[0m21:05:03.092660 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:03.402362 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b2c49ecb-1038-4004-a49f-fc7ebdff5c5b&page=queryresults
[0m21:05:03.785561 [info ] [Thread-2 (]: 7 of 26 PASS not_null_LCA_Worksites_row_id ..................................... [[32mPASS[0m in 0.71s]
[0m21:05:03.786945 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:05:03.787707 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:05:03.788402 [info ] [Thread-2 (]: 8 of 26 START test not_null_Sentiment_Analysis_publication_date ................ [RUN]
[0m21:05:03.789308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8, now test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8)
[0m21:05:03.790100 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:05:03.796178 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m21:05:03.797085 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:05:03.800824 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m21:05:03.801710 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select publication_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
where publication_date is null



      
    ) dbt_internal_test
[0m21:05:03.802422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:04.164234 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bc4f382b-a6a2-470a-9c93-db4c05109b5e&page=queryresults
[0m21:05:04.468686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4e038caf-7df2-4b37-a475-11e1df06bc9e&page=queryresults
[0m21:05:04.594123 [info ] [Thread-2 (]: 8 of 26 PASS not_null_Sentiment_Analysis_publication_date ...................... [[32mPASS[0m in 0.80s]
[0m21:05:04.595594 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:05:04.596296 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:05:04.597229 [info ] [Thread-2 (]: 9 of 26 START test not_null_Single_Registration_agent_first_name ............... [RUN]
[0m21:05:04.598113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8, now test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3)
[0m21:05:04.598792 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:05:04.604983 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m21:05:04.605812 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:05:04.609268 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m21:05:04.610130 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_first_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_first_name is null



      
    ) dbt_internal_test
[0m21:05:04.610816 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:04.805530 [info ] [Thread-1 (]: 6 of 26 PASS not_null_LCA_Disclosure_employer_name ............................. [[32mPASS[0m in 2.18s]
[0m21:05:04.806842 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:05:04.807674 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:05:04.808473 [info ] [Thread-1 (]: 10 of 26 START test not_null_Single_Registration_agent_last_name ............... [RUN]
[0m21:05:04.809290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2, now test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c)
[0m21:05:04.809929 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:05:04.816619 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m21:05:04.817447 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:05:04.822645 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m21:05:04.823523 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_last_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_last_name is null



      
    ) dbt_internal_test
[0m21:05:04.824168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:04.936112 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1af6931e-36cb-474b-8093-161c657614ff&page=queryresults
[0m21:05:05.095318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5a2353ba-fa35-46a9-a2a6-4f16270d1f24&page=queryresults
[0m21:05:05.316331 [info ] [Thread-2 (]: 9 of 26 PASS not_null_Single_Registration_agent_first_name ..................... [[32mPASS[0m in 0.72s]
[0m21:05:05.318380 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:05:05.321780 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:05:05.322731 [info ] [Thread-2 (]: 11 of 26 START test not_null_Single_Registration_ben_year_of_birth ............. [RUN]
[0m21:05:05.323763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3, now test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f)
[0m21:05:05.324389 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:05:05.330559 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m21:05:05.331408 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:05:05.335305 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m21:05:05.336192 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ben_year_of_birth
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where ben_year_of_birth is null



      
    ) dbt_internal_test
[0m21:05:05.336846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:05.435026 [info ] [Thread-1 (]: 10 of 26 PASS not_null_Single_Registration_agent_last_name ..................... [[32mPASS[0m in 0.63s]
[0m21:05:05.436341 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:05:05.437058 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:05:05.437835 [info ] [Thread-1 (]: 12 of 26 START test not_null_Single_Registration_employer_name ................. [RUN]
[0m21:05:05.438671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c, now test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49)
[0m21:05:05.439294 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:05:05.445146 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m21:05:05.445984 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:05:05.449479 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m21:05:05.450356 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where employer_name is null



      
    ) dbt_internal_test
[0m21:05:05.451062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:05.790453 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:552a466c-0be6-48a0-a779-9cf73beeeb85&page=queryresults
[0m21:05:05.842493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d5e26edb-27ab-4cdc-881b-7f74a94a5f23&page=queryresults
[0m21:05:06.175897 [info ] [Thread-2 (]: 11 of 26 PASS not_null_Single_Registration_ben_year_of_birth ................... [[32mPASS[0m in 0.85s]
[0m21:05:06.177369 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:05:06.178067 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:05:06.178869 [info ] [Thread-2 (]: 13 of 26 START test not_null_Single_Registration_gender ........................ [RUN]
[0m21:05:06.179812 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f, now test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23)
[0m21:05:06.180436 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:05:06.186746 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m21:05:06.189034 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:05:06.189986 [info ] [Thread-1 (]: 12 of 26 PASS not_null_Single_Registration_employer_name ....................... [[32mPASS[0m in 0.75s]
[0m21:05:06.195311 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m21:05:06.196255 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:05:06.197443 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gender
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where gender is null



      
    ) dbt_internal_test
[0m21:05:06.198223 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:05:06.199052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:06.199766 [info ] [Thread-1 (]: 14 of 26 START test not_null_Single_Registration_mail_addr ..................... [RUN]
[0m21:05:06.202328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49, now test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3)
[0m21:05:06.203102 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:05:06.208638 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m21:05:06.209657 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:05:06.213242 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m21:05:06.214110 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mail_addr
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where mail_addr is null



      
    ) dbt_internal_test
[0m21:05:06.214844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:06.484467 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:dc606733-1a2b-479d-a32f-5c1ab5bc2939&page=queryresults
[0m21:05:06.564052 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bd22ad82-8253-44f3-affc-3343dab209a8&page=queryresults
[0m21:05:06.796865 [info ] [Thread-1 (]: 14 of 26 PASS not_null_Single_Registration_mail_addr ........................... [[32mPASS[0m in 0.59s]
[0m21:05:06.798245 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:05:06.798992 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:05:06.799789 [info ] [Thread-1 (]: 15 of 26 START test not_null_Wage_Summary_company_name ......................... [RUN]
[0m21:05:06.800594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3, now test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5)
[0m21:05:06.801208 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:05:06.807382 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m21:05:06.808217 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:05:06.811624 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m21:05:06.812483 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where company_name is null



      
    ) dbt_internal_test
[0m21:05:06.813143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:06.870667 [info ] [Thread-2 (]: 13 of 26 PASS not_null_Single_Registration_gender .............................. [[32mPASS[0m in 0.69s]
[0m21:05:06.871999 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:05:06.872704 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:05:06.873479 [info ] [Thread-2 (]: 16 of 26 START test not_null_Wage_Summary_job_title ............................ [RUN]
[0m21:05:06.874370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23, now test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417)
[0m21:05:06.875085 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:05:06.881402 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m21:05:06.882289 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:05:06.887464 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m21:05:06.888364 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where job_title is null



      
    ) dbt_internal_test
[0m21:05:06.889045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:07.161023 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:045879b0-2dfe-4539-9838-17d204f4c40c&page=queryresults
[0m21:05:07.168170 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:df8e214d-5969-47e6-8e7a-0e1f2a519a92&page=queryresults
[0m21:05:07.488456 [info ] [Thread-1 (]: 15 of 26 PASS not_null_Wage_Summary_company_name ............................... [[32mPASS[0m in 0.69s]
[0m21:05:07.489911 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:05:07.490697 [debug] [Thread-1 (]: Began running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:05:07.491480 [info ] [Thread-1 (]: 17 of 26 START test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [RUN]
[0m21:05:07.492517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5, now test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6)
[0m21:05:07.493141 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:05:07.505241 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m21:05:07.506127 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:05:07.509855 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m21:05:07.512791 [info ] [Thread-2 (]: 16 of 26 PASS not_null_Wage_Summary_job_title .................................. [[32mPASS[0m in 0.64s]
[0m21:05:07.513745 [debug] [Thread-1 (]: On test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select employer_petitioner_name as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
    where employer_petitioner_name is not null
),

parent as (
    select employer_name as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:05:07.514689 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:05:07.515421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:07.516152 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:05:07.518736 [info ] [Thread-2 (]: 18 of 26 START test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [RUN]
[0m21:05:07.519701 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417, now test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46)
[0m21:05:07.520388 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:05:07.528604 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m21:05:07.529604 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:05:07.533223 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m21:05:07.534347 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select case_number as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
    where case_number is not null
),

parent as (
    select case_number as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:05:07.535335 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:07.843717 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fcdc9cf1-3d01-4dff-895f-7f0c6be3aa7e&page=queryresults
[0m21:05:07.877955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3d18e32e-8bdc-460a-b068-de33308c1b78&page=queryresults
[0m21:05:08.238586 [error] [Thread-1 (]: 17 of 26 FAIL 26518 relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [[31mFAIL 26518[0m in 0.75s]
[0m21:05:08.240008 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:05:08.240718 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:05:08.241498 [info ] [Thread-1 (]: 19 of 26 START test unique_Company_Data_employer_name .......................... [RUN]
[0m21:05:08.242401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6, now test.cs329e_xh.unique_Company_Data_employer_name.69805b71db)
[0m21:05:08.243067 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:05:08.252943 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m21:05:08.255070 [error] [Thread-2 (]: 18 of 26 FAIL 14201 relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [[31mFAIL 14201[0m in 0.74s]
[0m21:05:08.256237 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:05:08.256910 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:05:08.257642 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:05:08.263447 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m21:05:08.264269 [info ] [Thread-2 (]: 20 of 26 START test unique_Employer_Detail_employer_petitioner_name ............ [RUN]
[0m21:05:08.265414 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46, now test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1)
[0m21:05:08.266049 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:05:08.394861 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Company_Data_employer_name.69805b71db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
  where employer_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:05:08.400233 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m21:05:08.401113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:08.404015 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:05:08.407867 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m21:05:08.409048 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_petitioner_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
  where employer_petitioner_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:05:08.409805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:08.655709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1efbf3db-d98f-46a8-a748-4336b6b25aa8&page=queryresults
[0m21:05:08.762862 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b8fd703d-745e-42b3-89aa-c70e59c21ce5&page=queryresults
[0m21:05:08.997491 [info ] [Thread-1 (]: 19 of 26 PASS unique_Company_Data_employer_name ................................ [[32mPASS[0m in 0.76s]
[0m21:05:08.998979 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:05:08.999712 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:05:09.000510 [info ] [Thread-1 (]: 21 of 26 START test unique_LCA_Worksites_row_id ................................ [RUN]
[0m21:05:09.001347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Company_Data_employer_name.69805b71db, now test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef)
[0m21:05:09.001969 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:05:09.009606 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m21:05:09.010489 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:05:09.013951 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m21:05:09.014902 [debug] [Thread-1 (]: On test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select row_id as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
  where row_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:05:09.015592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:09.075180 [error] [Thread-2 (]: 20 of 26 FAIL 53 unique_Employer_Detail_employer_petitioner_name ............... [[31mFAIL 53[0m in 0.81s]
[0m21:05:09.076325 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:05:09.077005 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:05:09.077778 [info ] [Thread-2 (]: 22 of 26 START test unique_Sentiment_Analysis_publication_date ................. [RUN]
[0m21:05:09.078597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1, now test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e)
[0m21:05:09.079211 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:05:09.085504 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m21:05:09.086542 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:05:09.091736 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m21:05:09.092631 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select publication_date as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
  where publication_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:05:09.093335 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:09.302036 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9e2976ac-f1bf-4232-8dc7-0d1b2a372d53&page=queryresults
[0m21:05:09.332240 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5d908a15-bb76-464b-838b-6e0c3ff75ee6&page=queryresults
[0m21:05:09.606524 [info ] [Thread-2 (]: 22 of 26 PASS unique_Sentiment_Analysis_publication_date ....................... [[32mPASS[0m in 0.53s]
[0m21:05:09.607958 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:05:09.608673 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:05:09.609531 [info ] [Thread-2 (]: 23 of 26 START test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [RUN]
[0m21:05:09.610444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e, now test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557)
[0m21:05:09.611058 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:05:09.624725 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557"
[0m21:05:09.625614 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:05:09.629218 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557"
[0m21:05:09.630111 [debug] [Thread-2 (]: On test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        case_number, appx_a_date_of_degree
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
    group by case_number, appx_a_date_of_degree
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:05:09.630845 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:09.752309 [info ] [Thread-1 (]: 21 of 26 PASS unique_LCA_Worksites_row_id ...................................... [[32mPASS[0m in 0.75s]
[0m21:05:09.753658 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:05:09.754521 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:05:09.755400 [info ] [Thread-1 (]: 24 of 26 START test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [RUN]
[0m21:05:09.756201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef, now test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4)
[0m21:05:09.756824 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:05:09.763554 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4"
[0m21:05:09.764355 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:05:09.767797 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4"
[0m21:05:09.768652 [debug] [Thread-1 (]: On test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        case_number, employer_name
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    group by case_number, employer_name
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:05:09.769317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:10.126971 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b2e405d8-2c98-4feb-9ae1-95112c2c5f67&page=queryresults
[0m21:05:10.465997 [info ] [Thread-2 (]: 23 of 26 PASS unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [[32mPASS[0m in 0.86s]
[0m21:05:10.467509 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:05:10.468255 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:05:10.469199 [info ] [Thread-2 (]: 25 of 26 START test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [RUN]
[0m21:05:10.470135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557, now test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d)
[0m21:05:10.470797 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:05:10.480871 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d"
[0m21:05:10.481736 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:05:10.487593 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d"
[0m21:05:10.488501 [debug] [Thread-2 (]: On test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
    group by employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:05:10.489190 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:11.168178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ecf348b8-4bcb-4d48-84b6-55cfe5907289&page=queryresults
[0m21:05:11.555545 [info ] [Thread-1 (]: 24 of 26 PASS unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [[32mPASS[0m in 1.80s]
[0m21:05:11.556881 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:05:11.557598 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:05:11.558393 [info ] [Thread-1 (]: 26 of 26 START test unique_combination_of_columns_Wage_Summary_company_name__job_title  [RUN]
[0m21:05:11.559194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4, now test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194)
[0m21:05:11.559812 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:05:11.567654 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194"
[0m21:05:11.568473 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:05:11.571994 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194"
[0m21:05:11.572870 [debug] [Thread-1 (]: On test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        company_name, job_title
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
    group by company_name, job_title
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:05:11.573537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:11.987704 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:67181c73-e120-49dd-97d1-d3a7303cbbaa&page=queryresults
[0m21:05:12.059795 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c878b7c1-d1ed-4b1a-8651-236270c3f719&page=queryresults
[0m21:05:12.369267 [info ] [Thread-1 (]: 26 of 26 PASS unique_combination_of_columns_Wage_Summary_company_name__job_title  [[32mPASS[0m in 0.81s]
[0m21:05:12.370643 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:05:12.430923 [error] [Thread-2 (]: 25 of 26 FAIL 25737 unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [[31mFAIL 25737[0m in 1.96s]
[0m21:05:12.432323 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:05:12.434466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:05:12.435452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:12.435984 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d' was properly closed.
[0m21:05:12.436490 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' was properly closed.
[0m21:05:12.437077 [info ] [MainThread]: 
[0m21:05:12.437688 [info ] [MainThread]: Finished running 26 data tests in 0 hours 0 minutes and 11.68 seconds (11.68s).
[0m21:05:12.443547 [debug] [MainThread]: Command end result
[0m21:05:12.501094 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:05:12.503931 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:05:12.515579 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m21:05:12.516228 [info ] [MainThread]: 
[0m21:05:12.516928 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m21:05:12.517576 [info ] [MainThread]: 
[0m21:05:12.518441 [error] [MainThread]: [31mFailure in test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_ (models/int/Employer_Details/schema.yml)[0m
[0m21:05:12.519321 [error] [MainThread]:   Got 26518 results, configured to fail if != 0
[0m21:05:12.519883 [info ] [MainThread]: 
[0m21:05:12.520576 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/relationships_Employer_Detail_a803ce1d5c10b4dae7e1dc33e0f1a09b.sql
[0m21:05:12.521169 [info ] [MainThread]: 
[0m21:05:12.521860 [error] [MainThread]: [31mFailure in test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_ (models/int/schema.yml)[0m
[0m21:05:12.522555 [error] [MainThread]:   Got 14201 results, configured to fail if != 0
[0m21:05:12.523109 [info ] [MainThread]: 
[0m21:05:12.523790 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Worksites_a871b7806445a97e6fda9420f0740807.sql
[0m21:05:12.524380 [info ] [MainThread]: 
[0m21:05:12.525066 [error] [MainThread]: [31mFailure in test unique_Employer_Detail_employer_petitioner_name (models/int/Employer_Details/schema.yml)[0m
[0m21:05:12.525744 [error] [MainThread]:   Got 53 results, configured to fail if != 0
[0m21:05:12.526305 [info ] [MainThread]: 
[0m21:05:12.526923 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/unique_Employer_Detail_employer_petitioner_name.sql
[0m21:05:12.527480 [info ] [MainThread]: 
[0m21:05:12.528346 [error] [MainThread]: [31mFailure in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)[0m
[0m21:05:12.529025 [error] [MainThread]:   Got 25737 results, configured to fail if != 0
[0m21:05:12.529542 [info ] [MainThread]: 
[0m21:05:12.530175 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/unique_combination_of_columns__ae77d73b6ce81585721aac3ba435e239.sql
[0m21:05:12.530774 [info ] [MainThread]: 
[0m21:05:12.531349 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=4 SKIP=0 TOTAL=26
[0m21:05:12.532277 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 14.35123, "process_in_blocks": "0", "process_kernel_time": 0.499749, "process_mem_max_rss": "267284", "process_out_blocks": "4976", "process_user_time": 5.43721}
[0m21:05:12.532953 [debug] [MainThread]: Command `dbt test` failed at 21:05:12.532806 after 14.35 seconds
[0m21:05:12.533563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8079309540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805d28c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80795d4550>]}
[0m21:05:12.534216 [debug] [MainThread]: Flushing usage events
[0m21:05:12.812577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:55.260844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf0dc9600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3beff62440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3beff623e0>]}


============================== 21:10:55.264615 | 1c9e495e-9250-41e6-9198-e0e6cfe31dc0 ==============================
[0m21:10:55.264615 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:10:55.265613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models int/Employer_Details', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:10:56.855669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c9e495e-9250-41e6-9198-e0e6cfe31dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf00f9360>]}
[0m21:10:56.938297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c9e495e-9250-41e6-9198-e0e6cfe31dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf076eec0>]}
[0m21:10:56.939321 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:10:57.111522 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:10:57.339260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:10:57.340384 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/Employer_Detail.sql
[0m21:10:57.984472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c9e495e-9250-41e6-9198-e0e6cfe31dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd42bd9f0>]}
[0m21:10:58.269775 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:10:58.272146 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:10:58.292563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c9e495e-9250-41e6-9198-e0e6cfe31dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd429da20>]}
[0m21:10:58.293362 [info ] [MainThread]: Found 31 models, 1 seed, 26 data tests, 19 sources, 494 macros
[0m21:10:58.294066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c9e495e-9250-41e6-9198-e0e6cfe31dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd429d330>]}
[0m21:10:58.297049 [warn ] [MainThread]: The selection criterion 'int/Employer_Details' does not match any enabled nodes
[0m21:10:58.299084 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:10:58.300049 [debug] [MainThread]: Command end result
[0m21:10:58.355689 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:10:58.357902 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:10:58.362124 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m21:10:58.362953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1856153, "process_in_blocks": "0", "process_kernel_time": 0.426995, "process_mem_max_rss": "262212", "process_out_blocks": "4360", "process_user_time": 4.789465}
[0m21:10:58.363610 [debug] [MainThread]: Command `dbt run` succeeded at 21:10:58.363474 after 3.19 seconds
[0m21:10:58.364193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf141c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd42bd3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd4cf57e0>]}
[0m21:10:58.364784 [debug] [MainThread]: Flushing usage events
[0m21:10:58.643013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:11:13.580988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f390bb7d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f390ab32410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f390ab323b0>]}


============================== 21:11:13.584740 | 8ee481cd-6af3-456f-8dfe-d13bbb1fb6be ==============================
[0m21:11:13.584740 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:11:13.585638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models Employer_Details', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:11:15.227453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ee481cd-6af3-456f-8dfe-d13bbb1fb6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f390b361f00>]}
[0m21:11:15.311896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ee481cd-6af3-456f-8dfe-d13bbb1fb6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f390ad9d4e0>]}
[0m21:11:15.312942 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:11:15.497566 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:11:15.730254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:11:15.730938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:11:15.827305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ee481cd-6af3-456f-8dfe-d13bbb1fb6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ef98e320>]}
[0m21:11:15.996707 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:11:15.999196 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:11:16.020233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ee481cd-6af3-456f-8dfe-d13bbb1fb6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ef97f880>]}
[0m21:11:16.021072 [info ] [MainThread]: Found 31 models, 1 seed, 26 data tests, 19 sources, 494 macros
[0m21:11:16.021708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee481cd-6af3-456f-8dfe-d13bbb1fb6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ef97e050>]}
[0m21:11:16.023197 [warn ] [MainThread]: The selection criterion 'Employer_Details' does not match any enabled nodes
[0m21:11:16.025151 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:11:16.028019 [debug] [MainThread]: Command end result
[0m21:11:16.083146 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:11:16.085719 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:11:16.090414 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m21:11:16.091345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5893226, "process_in_blocks": "0", "process_kernel_time": 0.512431, "process_mem_max_rss": "257372", "process_out_blocks": "3024", "process_user_time": 4.1198}
[0m21:11:16.092262 [debug] [MainThread]: Command `dbt run` succeeded at 21:11:16.092024 after 2.59 seconds
[0m21:11:16.093022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f390bb7d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f390b361f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ef98f220>]}
[0m21:11:16.093687 [debug] [MainThread]: Flushing usage events
[0m21:11:16.430335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:16.818946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94da1995a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94d9326410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94d93263b0>]}


============================== 21:27:16.822485 | 8ade8a68-546f-435f-b6d5-cdb891cf616d ==============================
[0m21:27:16.822485 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:27:16.823434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models Employer_Details', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:18.450519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ade8a68-546f-435f-b6d5-cdb891cf616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94d96f66e0>]}
[0m21:27:18.534187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ade8a68-546f-435f-b6d5-cdb891cf616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94d97ca860>]}
[0m21:27:18.535279 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:27:18.713209 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:27:18.944818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:18.946044 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/Employer_Detail.sql
[0m21:27:19.659631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ade8a68-546f-435f-b6d5-cdb891cf616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bd4a5f30>]}
[0m21:27:19.860660 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:27:19.863144 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:27:20.004213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ade8a68-546f-435f-b6d5-cdb891cf616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bd58b100>]}
[0m21:27:20.005182 [info ] [MainThread]: Found 31 models, 1 seed, 26 data tests, 19 sources, 494 macros
[0m21:27:20.005890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ade8a68-546f-435f-b6d5-cdb891cf616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bd58ba00>]}
[0m21:27:20.007409 [warn ] [MainThread]: The selection criterion 'Employer_Details' does not match any enabled nodes
[0m21:27:20.009445 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:27:20.010341 [debug] [MainThread]: Command end result
[0m21:27:20.064391 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:27:20.066911 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:27:20.071089 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m21:27:20.071943 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3302631, "process_in_blocks": "0", "process_kernel_time": 0.452635, "process_mem_max_rss": "264636", "process_out_blocks": "4360", "process_user_time": 4.943569}
[0m21:27:20.072608 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:20.072465 after 3.33 seconds
[0m21:27:20.073192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bd5730d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be0d1120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be0d0dc0>]}
[0m21:27:20.073819 [debug] [MainThread]: Flushing usage events
[0m21:27:20.412783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:13.676812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfc0c1600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfb076440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfb0763e0>]}


============================== 21:28:13.680258 | 0227def0-6cfe-4f65-b898-5cb471c77963 ==============================
[0m21:28:13.680258 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:28:13.681094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'debug': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/int/Employer_Details', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:28:15.293880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfb209360>]}
[0m21:28:15.377872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfb8bf550>]}
[0m21:28:15.378915 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:28:15.551465 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:28:15.784494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:28:15.785179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:28:15.882587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdfef6830>]}
[0m21:28:16.050996 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:28:16.053328 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:28:16.073803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdfee34f0>]}
[0m21:28:16.074657 [info ] [MainThread]: Found 31 models, 1 seed, 26 data tests, 19 sources, 494 macros
[0m21:28:16.075357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdfee2b00>]}
[0m21:28:16.079698 [info ] [MainThread]: 
[0m21:28:16.080411 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:28:16.081143 [info ] [MainThread]: 
[0m21:28:16.082133 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:28:16.088580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m21:28:16.089273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:16.313266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m21:28:16.314350 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt'
[0m21:28:16.315226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:16.315854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:16.446271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m21:28:16.449976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:16.505731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m21:28:16.508894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:16.638514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfd604f70>]}
[0m21:28:16.639363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:16.642337 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m21:28:16.643385 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_cs329e_xh_int.temp_emp ........................ [RUN]
[0m21:28:16.644374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.temp_emp)
[0m21:28:16.645208 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m21:28:16.659896 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m21:28:16.660828 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_emp
[0m21:28:16.681682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:16.854573 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m21:28:16.855703 [debug] [Thread-1 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw),
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m21:28:17.283809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:42a3f689-2529-4d55-9c46-918a43e32cea&page=queryresults
[0m21:28:20.264068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfb755d50>]}
[0m21:28:20.265229 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_cs329e_xh_int.temp_emp ................... [[32mCREATE TABLE (90.2k rows, 19.9 MiB processed)[0m in 3.62s]
[0m21:28:20.266188 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m21:28:20.267633 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m21:28:20.268437 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_cs329e_xh_int.temp_employer_details ........... [RUN]
[0m21:28:20.269149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now model.cs329e_xh.temp_employer_details)
[0m21:28:20.269742 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m21:28:20.275103 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m21:28:20.275935 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_employer_details
[0m21:28:20.279400 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:20.408704 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_employer_details"
[0m21:28:20.409801 [debug] [Thread-2 (]: On model.cs329e_xh.temp_employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_employer_details`
      
    
    

    OPTIONS()
    as (
      WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp` as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched
    );
  
[0m21:28:20.795127 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ac4f8c0c-747e-4472-82c1-627be359f207&page=queryresults
[0m21:28:25.271402 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdd475360>]}
[0m21:28:25.272541 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_cs329e_xh_int.temp_employer_details ...... [[32mCREATE TABLE (589.3k rows, 4.9 MiB processed)[0m in 5.00s]
[0m21:28:25.274109 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m21:28:25.275456 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m21:28:25.276506 [info ] [Thread-1 (]: 3 of 4 START python table model dbt_cs329e_xh_int.matching ..................... [RUN]
[0m21:28:25.277345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.matching)
[0m21:28:25.277963 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m21:28:25.309450 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m21:28:25.310553 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m21:28:25.314597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:25.465161 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m21:28:25.466372 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


import pandas as pd
import os
import json
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    current_dir = os.path.dirname(__file__)
    matching = dbt.ref("matched_results_full")
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"matched_results_full": "silken-fortress-448205-p9.cs329e_xh_dbt.matched_results_full", "temp_employer_details": "silken-fortress-448205-p9.dbt_cs329e_xh_int.temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m21:28:25.485101 [debug] [Thread-1 (]: BigQuery adapter: Submitting batch job with id: 0dea9451-a18b-42d9-91ee-49f69ac25265
[0m21:34:13.445636 [debug] [Thread-1 (]: Execution status: OK in 347.9800109863281 seconds
[0m21:34:13.449422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdd0af550>]}
[0m21:34:13.450550 [info ] [Thread-1 (]: 3 of 4 OK created python table model dbt_cs329e_xh_int.matching ................ [[32mOK[0m in 348.17s]
[0m21:34:13.451756 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m21:34:13.453182 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m21:34:13.454118 [info ] [Thread-2 (]: 4 of 4 START sql table model dbt_cs329e_xh_int.Employer_Detail ................. [RUN]
[0m21:34:13.455060 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.Employer_Detail)
[0m21:34:13.455678 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Employer_Detail
[0m21:34:13.463537 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Employer_Detail"
[0m21:34:13.464743 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Employer_Detail
[0m21:34:13.468524 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:34:13.632887 [debug] [Thread-2 (]: On model.cs329e_xh.Employer_Detail: select * from (
        
with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        distinct employer_petitioner_name,
        fein,
        employer_no,
        fiscal_year,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp where employer_petitioner_name is not null
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:34:14.044469 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7b5d68ea-8bd0-4a0d-9657-bed3f0f59636&page=queryresults
[0m21:34:14.193539 [debug] [Thread-2 (]: On model.cs329e_xh.Employer_Detail: select * from (
        select
    
      
    cast(null as string)
 as employer_petitioner_name, 
      
    cast(null as string)
 as fein, 
      
    cast(null as int64)
 as employer_no, 
      
    cast(null as int64)
 as fiscal_year, 
      
    cast(null as string)
 as tax_id, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as petitioner_city, 
      
    cast(null as string)
 as petitioner_state, 
      
    cast(null as string)
 as petitioner_zip_code, 
      
    cast(null as string)
 as initial_approval, 
      
    cast(null as int64)
 as initial_denial, 
      
    cast(null as string)
 as continuing_approval, 
      
    cast(null as int64)
 as continuing_denial, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m21:34:14.510411 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3350afd0-9669-4fbd-90e6-bdee5d90c865&page=queryresults
[0m21:34:14.648461 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m21:34:14.657749 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Employer_Detail"
[0m21:34:14.659011 [debug] [Thread-2 (]: On model.cs329e_xh.Employer_Detail: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Employer_Detail"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
        
  (
    employer_petitioner_name string,
    fein string,
    employer_no int64,
    fiscal_year int64,
    tax_id string,
    naics_code string,
    petitioner_city string,
    petitioner_state string,
    petitioner_zip_code string,
    initial_approval string,
    initial_denial int64,
    continuing_approval string,
    continuing_denial int64,
    _data_source string,
    _load_time datetime,
    
    primary key (employer_petitioner_name) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_petitioner_name, fein, employer_no, fiscal_year, tax_id, naics_code, petitioner_city, petitioner_state, petitioner_zip_code, initial_approval, initial_denial, continuing_approval, continuing_denial, _data_source, _load_time
    from (
        
with ed as(
select a.*, b.matched_fein as fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as a
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`matching` as b
    on a.employer_petitioner_name = b.original_name)
, int_emp as (
    SELECT
    fein,
    employer_no,
    fiscal_year,
    employer_petitioner_name,
    tax_id,
    naics_code,
    petitioner_city,
    petitioner_state,
    petitioner_zip_code,
    initial_approval,
    initial_denial,
    continuing_approval,
    continuing_denial,
    _data_source,
    _load_time
FROM (
    SELECT
        distinct employer_petitioner_name,
        fein,
        employer_no,
        fiscal_year,
        tax_id,
        naics_code,
        petitioner_city,
        petitioner_state,
        petitioner_zip_code,
        initial_approval,
        initial_denial,
        continuing_approval,
        continuing_denial,
        _data_source,
        _load_time,
        ROW_NUMBER() OVER (PARTITION BY fein ORDER BY _load_time DESC) AS row_num
    FROM
        ed
    WHERE
        fein IS NOT NULL AND fein != ''
)
WHERE
    row_num = 1
)
select * from int_emp where employer_petitioner_name is not null
    ) as model_subq
    );
  
[0m21:34:14.952662 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bd9b15d5-3eb7-4b15-a503-aa90c1223aa8&page=queryresults
[0m21:34:18.819320 [debug] [Thread-2 (]: On model.cs329e_xh.Employer_Detail: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Employer_Detail"} */

        drop table if exists dbt_cs329e_xh_int.matching
      
[0m21:34:19.064774 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a2539077-6733-4b37-b77f-c9f46caf5529&page=queryresults
[0m21:34:19.326114 [debug] [Thread-2 (]: On model.cs329e_xh.Employer_Detail: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Employer_Detail"} */

        drop table if exists dbt_cs329e_xh_int.temp_emp
      
[0m21:34:19.563057 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:57a2569a-c3a4-40cd-ac04-6fd7d64d740f&page=queryresults
[0m21:34:19.828125 [debug] [Thread-2 (]: On model.cs329e_xh.Employer_Detail: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Employer_Detail"} */

        drop table if exists dbt_cs329e_xh_int.temp_employer_details
      
[0m21:34:20.024507 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b557aaea-6d3b-49ba-a4fb-e045cd624ecd&page=queryresults
[0m21:34:20.277437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0227def0-6cfe-4f65-b898-5cb471c77963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdd0af550>]}
[0m21:34:20.278600 [info ] [Thread-2 (]: 4 of 4 OK created sql table model dbt_cs329e_xh_int.Employer_Detail ............ [[32mCREATE TABLE (28.9k rows, 10.8 MiB processed)[0m in 6.82s]
[0m21:34:20.279849 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m21:34:20.281791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:20.282879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:20.283431 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m21:34:20.283928 [debug] [MainThread]: Connection 'model.cs329e_xh.Employer_Detail' was properly closed.
[0m21:34:20.284546 [info ] [MainThread]: 
[0m21:34:20.285159 [info ] [MainThread]: Finished running 4 table models in 0 hours 6 minutes and 4.20 seconds (364.20s).
[0m21:34:20.286978 [debug] [MainThread]: Command end result
[0m21:34:20.343289 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:34:20.345862 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:34:20.354946 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m21:34:20.355526 [info ] [MainThread]: 
[0m21:34:20.356155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:34:20.356810 [info ] [MainThread]: 
[0m21:34:20.357457 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:34:20.358505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 366.75845, "process_in_blocks": "0", "process_kernel_time": 0.589837, "process_mem_max_rss": "273100", "process_out_blocks": "3184", "process_user_time": 4.948372}
[0m21:34:20.359335 [debug] [MainThread]: Command `dbt run` succeeded at 21:34:20.359188 after 366.76 seconds
[0m21:34:20.359942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfc0c1600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfb209360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdfef77f0>]}
[0m21:34:20.360554 [debug] [MainThread]: Flushing usage events
[0m21:34:20.794963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:28.096874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e64795a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e55da4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e55da470>]}


============================== 21:53:28.100808 | c0b7e21c-c4ae-457e-b30e-236c104c6181 ==============================
[0m21:53:28.100808 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:53:28.101841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:53:29.832085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0b7e21c-c4ae-457e-b30e-236c104c6181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e5b55d80>]}
[0m21:53:29.916237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0b7e21c-c4ae-457e-b30e-236c104c6181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e55dbee0>]}
[0m21:53:29.917287 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:53:30.087363 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:53:30.326364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:53:30.327448 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m21:53:30.328151 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/matching.py
[0m21:53:30.762695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0b7e21c-c4ae-457e-b30e-236c104c6181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ca1d7f70>]}
[0m21:53:30.937022 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:53:30.939773 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:53:30.974819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0b7e21c-c4ae-457e-b30e-236c104c6181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ca171a20>]}
[0m21:53:30.975727 [info ] [MainThread]: Found 32 models, 1 seed, 26 data tests, 19 sources, 494 macros
[0m21:53:30.976472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b7e21c-c4ae-457e-b30e-236c104c6181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cb0d8e20>]}
[0m21:53:30.981567 [info ] [MainThread]: 
[0m21:53:30.982327 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:53:30.983051 [info ] [MainThread]: 
[0m21:53:30.983980 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:53:30.993766 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_cs329e_xh_dbt'
[0m21:53:30.995007 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9_dbt_cs329e_xh_int'
[0m21:53:30.995874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:30.996494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:31.157128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m21:53:31.161143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:31.164434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m21:53:31.165699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:31.303848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b7e21c-c4ae-457e-b30e-236c104c6181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e5b566b0>]}
[0m21:53:31.304690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:31.308943 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:53:31.309695 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:53:31.310417 [info ] [Thread-1 (]: 1 of 26 START test not_null_Company_Data_employer_name ......................... [RUN]
[0m21:53:31.311420 [info ] [Thread-2 (]: 2 of 26 START test not_null_Employer_Detail_employer_petitioner_name ........... [RUN]
[0m21:53:31.312386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b)
[0m21:53:31.313338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227)
[0m21:53:31.314049 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:53:31.314809 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:53:31.354837 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m21:53:31.356297 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m21:53:31.357652 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:53:31.358369 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:53:31.403918 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"
[0m21:53:31.405574 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"
[0m21:53:31.406882 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_petitioner_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
where employer_petitioner_name is null



      
    ) dbt_internal_test
[0m21:53:31.407743 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:31.410360 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
where employer_name is null



      
    ) dbt_internal_test
[0m21:53:31.411298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:31.746090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7cdd8b9a-11ee-4185-a480-cca872a82263&page=queryresults
[0m21:53:32.007385 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0b3d0a7c-25df-4868-8c01-866e5b3bcfd9&page=queryresults
[0m21:53:32.176395 [info ] [Thread-1 (]: 1 of 26 PASS not_null_Company_Data_employer_name ............................... [[32mPASS[0m in 0.86s]
[0m21:53:32.177753 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b
[0m21:53:32.178747 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:53:32.179596 [info ] [Thread-1 (]: 3 of 26 START test not_null_LCA_Appendix_appx_a_date_of_degree ................. [RUN]
[0m21:53:32.180517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Company_Data_employer_name.e520a74a8b, now test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155)
[0m21:53:32.181142 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:53:32.187506 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m21:53:32.188386 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:53:32.192422 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"
[0m21:53:32.193387 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appx_a_date_of_degree
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where appx_a_date_of_degree is null



      
    ) dbt_internal_test
[0m21:53:32.194122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:32.328547 [info ] [Thread-2 (]: 2 of 26 PASS not_null_Employer_Detail_employer_petitioner_name ................. [[32mPASS[0m in 1.02s]
[0m21:53:32.329965 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227
[0m21:53:32.330776 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:53:32.331658 [info ] [Thread-2 (]: 4 of 26 START test not_null_LCA_Appendix_case_number ........................... [RUN]
[0m21:53:32.332622 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Employer_Detail_employer_petitioner_name.121afb4227, now test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b)
[0m21:53:32.333237 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:53:32.339336 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m21:53:32.340174 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:53:32.475834 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"
[0m21:53:32.477290 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
where case_number is null



      
    ) dbt_internal_test
[0m21:53:32.478389 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:32.529201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f33c85a0-6367-4fce-a112-1dcceb50c155&page=queryresults
[0m21:53:32.769074 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:10e84bfb-fa1d-4c2a-8550-88325c60039b&page=queryresults
[0m21:53:32.853640 [info ] [Thread-1 (]: 3 of 26 PASS not_null_LCA_Appendix_appx_a_date_of_degree ....................... [[32mPASS[0m in 0.67s]
[0m21:53:32.855040 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155
[0m21:53:32.855879 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:53:32.856655 [info ] [Thread-1 (]: 5 of 26 START test not_null_LCA_Disclosure_case_number ......................... [RUN]
[0m21:53:32.857740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_appx_a_date_of_degree.b23a187155, now test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39)
[0m21:53:32.858443 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:53:32.864865 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m21:53:32.865786 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:53:32.869519 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"
[0m21:53:32.870481 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select case_number
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where case_number is null



      
    ) dbt_internal_test
[0m21:53:32.871167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:33.200188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:275fe451-2811-4295-805c-36d55c183aa9&page=queryresults
[0m21:53:33.229466 [info ] [Thread-2 (]: 4 of 26 PASS not_null_LCA_Appendix_case_number ................................. [[32mPASS[0m in 0.90s]
[0m21:53:33.231056 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b
[0m21:53:33.231828 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:53:33.232722 [info ] [Thread-2 (]: 6 of 26 START test not_null_LCA_Disclosure_employer_name ....................... [RUN]
[0m21:53:33.233824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Appendix_case_number.446f74776b, now test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2)
[0m21:53:33.234525 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:53:33.240915 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m21:53:33.241925 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:53:33.245873 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"
[0m21:53:33.246923 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
where employer_name is null



      
    ) dbt_internal_test
[0m21:53:33.247684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:33.541468 [info ] [Thread-1 (]: 5 of 26 PASS not_null_LCA_Disclosure_case_number ............................... [[32mPASS[0m in 0.68s]
[0m21:53:33.542891 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39
[0m21:53:33.543679 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:53:33.544548 [info ] [Thread-1 (]: 7 of 26 START test not_null_LCA_Worksites_row_id ............................... [RUN]
[0m21:53:33.545455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_case_number.88585ebf39, now test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8)
[0m21:53:33.546106 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:53:33.552884 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m21:53:33.553846 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:53:33.559842 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"
[0m21:53:33.560922 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
where row_id is null



      
    ) dbt_internal_test
[0m21:53:33.561686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:33.608631 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:40197dfb-9a79-4666-ad61-7ae1046620d8&page=queryresults
[0m21:53:33.855647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:babba665-0d72-472a-8eeb-bd01fa4cd1f5&page=queryresults
[0m21:53:34.198632 [info ] [Thread-2 (]: 6 of 26 PASS not_null_LCA_Disclosure_employer_name ............................. [[32mPASS[0m in 0.96s]
[0m21:53:34.200051 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2
[0m21:53:34.200754 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:53:34.201673 [info ] [Thread-2 (]: 8 of 26 START test not_null_Sentiment_Analysis_publication_date ................ [RUN]
[0m21:53:34.202625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Disclosure_employer_name.72d1e543f2, now test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8)
[0m21:53:34.203252 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:53:34.209749 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m21:53:34.213186 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:53:34.212543 [info ] [Thread-1 (]: 7 of 26 PASS not_null_LCA_Worksites_row_id ..................................... [[32mPASS[0m in 0.67s]
[0m21:53:34.217118 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"
[0m21:53:34.218071 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8
[0m21:53:34.219081 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:53:34.219956 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select publication_date
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
where publication_date is null



      
    ) dbt_internal_test
[0m21:53:34.220661 [info ] [Thread-1 (]: 9 of 26 START test not_null_Single_Registration_agent_first_name ............... [RUN]
[0m21:53:34.221543 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:34.222292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_LCA_Worksites_row_id.061b45a9e8, now test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3)
[0m21:53:34.224743 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:53:34.231055 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m21:53:34.232170 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:53:34.235789 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"
[0m21:53:34.236680 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_first_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_first_name is null



      
    ) dbt_internal_test
[0m21:53:34.237844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:34.541085 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cb07bc61-4073-4c0d-b255-baaa1b34fb82&page=queryresults
[0m21:53:34.542114 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fba54e5b-3f53-4230-867c-8061a5d07b31&page=queryresults
[0m21:53:34.860913 [info ] [Thread-2 (]: 8 of 26 PASS not_null_Sentiment_Analysis_publication_date ...................... [[32mPASS[0m in 0.66s]
[0m21:53:34.862356 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8
[0m21:53:34.863069 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:53:34.863926 [info ] [Thread-2 (]: 10 of 26 START test not_null_Single_Registration_agent_last_name ............... [RUN]
[0m21:53:34.864887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Sentiment_Analysis_publication_date.fda8e8c4c8, now test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c)
[0m21:53:34.865544 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:53:34.872120 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m21:53:34.874555 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:53:34.879433 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"
[0m21:53:34.875639 [info ] [Thread-1 (]: 9 of 26 PASS not_null_Single_Registration_agent_first_name ..................... [[32mPASS[0m in 0.65s]
[0m21:53:34.880828 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3
[0m21:53:34.881654 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:53:34.882440 [info ] [Thread-1 (]: 11 of 26 START test not_null_Single_Registration_ben_year_of_birth ............. [RUN]
[0m21:53:34.883447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_first_name.e5b65456b3, now test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f)
[0m21:53:34.884100 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:53:34.884793 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agent_last_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where agent_last_name is null



      
    ) dbt_internal_test
[0m21:53:34.893428 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m21:53:34.894306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:34.896903 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:53:34.900644 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"
[0m21:53:34.901760 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ben_year_of_birth
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where ben_year_of_birth is null



      
    ) dbt_internal_test
[0m21:53:34.902769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:35.193820 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:70871b18-d8a7-4810-98a5-61b202e57b7c&page=queryresults
[0m21:53:35.222048 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:87a17328-3ac2-4b1f-9722-f3b18e3ef0c8&page=queryresults
[0m21:53:35.505636 [info ] [Thread-2 (]: 10 of 26 PASS not_null_Single_Registration_agent_last_name ..................... [[32mPASS[0m in 0.64s]
[0m21:53:35.506962 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c
[0m21:53:35.507694 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:53:35.508455 [info ] [Thread-2 (]: 12 of 26 START test not_null_Single_Registration_employer_name ................. [RUN]
[0m21:53:35.509403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_agent_last_name.616aba0b7c, now test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49)
[0m21:53:35.510025 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:53:35.516315 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m21:53:35.517172 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:53:35.520681 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"
[0m21:53:35.521551 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employer_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where employer_name is null



      
    ) dbt_internal_test
[0m21:53:35.522215 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:35.561114 [info ] [Thread-1 (]: 11 of 26 PASS not_null_Single_Registration_ben_year_of_birth ................... [[32mPASS[0m in 0.68s]
[0m21:53:35.562306 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f
[0m21:53:35.563009 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:53:35.563793 [info ] [Thread-1 (]: 13 of 26 START test not_null_Single_Registration_gender ........................ [RUN]
[0m21:53:35.564590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_ben_year_of_birth.c91a12e09f, now test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23)
[0m21:53:35.565223 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:53:35.571547 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m21:53:35.572364 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:53:35.575886 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"
[0m21:53:35.576756 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gender
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where gender is null



      
    ) dbt_internal_test
[0m21:53:35.577409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:35.828163 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a008ab83-19e1-4c62-a1b0-527e45eff558&page=queryresults
[0m21:53:35.898503 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:26f49b24-3856-429c-9657-076d2f615b1f&page=queryresults
[0m21:53:36.141358 [info ] [Thread-2 (]: 12 of 26 PASS not_null_Single_Registration_employer_name ....................... [[32mPASS[0m in 0.63s]
[0m21:53:36.142692 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49
[0m21:53:36.143427 [debug] [Thread-2 (]: Began running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:53:36.144195 [info ] [Thread-2 (]: 14 of 26 START test not_null_Single_Registration_mail_addr ..................... [RUN]
[0m21:53:36.144971 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_employer_name.ee9a15bc49, now test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3)
[0m21:53:36.145608 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:53:36.151643 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m21:53:36.152474 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:53:36.155876 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"
[0m21:53:36.156752 [debug] [Thread-2 (]: On test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mail_addr
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
where mail_addr is null



      
    ) dbt_internal_test
[0m21:53:36.157625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:36.215736 [info ] [Thread-1 (]: 13 of 26 PASS not_null_Single_Registration_gender .............................. [[32mPASS[0m in 0.65s]
[0m21:53:36.216866 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23
[0m21:53:36.217550 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:53:36.218327 [info ] [Thread-1 (]: 15 of 26 START test not_null_Wage_Summary_company_name ......................... [RUN]
[0m21:53:36.219089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_gender.86e6608b23, now test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5)
[0m21:53:36.219700 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:53:36.225579 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m21:53:36.226446 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:53:36.229892 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"
[0m21:53:36.230789 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where company_name is null



      
    ) dbt_internal_test
[0m21:53:36.231439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:36.468637 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e3bf73d8-44c4-47bd-8735-efe27eef986e&page=queryresults
[0m21:53:36.494556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:928cb9db-5417-485b-bd16-ef8235e46500&page=queryresults
[0m21:53:36.782656 [info ] [Thread-1 (]: 15 of 26 PASS not_null_Wage_Summary_company_name ............................... [[32mPASS[0m in 0.56s]
[0m21:53:36.783942 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5
[0m21:53:36.784671 [debug] [Thread-1 (]: Began running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:53:36.785482 [info ] [Thread-1 (]: 16 of 26 START test not_null_Wage_Summary_job_title ............................ [RUN]
[0m21:53:36.786285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_company_name.d8394e89a5, now test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417)
[0m21:53:36.786910 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:53:36.792935 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m21:53:36.793783 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:53:36.797359 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"
[0m21:53:36.798269 [debug] [Thread-1 (]: On test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select job_title
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
where job_title is null



      
    ) dbt_internal_test
[0m21:53:36.798927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:36.809021 [info ] [Thread-2 (]: 14 of 26 PASS not_null_Single_Registration_mail_addr ........................... [[32mPASS[0m in 0.66s]
[0m21:53:36.810556 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3
[0m21:53:36.811337 [debug] [Thread-2 (]: Began running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:53:36.812273 [info ] [Thread-2 (]: 17 of 26 START test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [RUN]
[0m21:53:36.813025 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Single_Registration_mail_addr.91bba49ce3, now test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6)
[0m21:53:36.813641 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:53:36.825382 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m21:53:36.826477 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:53:36.830971 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"
[0m21:53:36.832163 [debug] [Thread-2 (]: On test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select employer_petitioner_name as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
    where employer_petitioner_name is not null
),

parent as (
    select employer_name as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:53:36.832865 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:37.070908 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0acfa733-026b-4b84-b4e2-7999b088d7f0&page=queryresults
[0m21:53:37.365704 [info ] [Thread-1 (]: 16 of 26 PASS not_null_Wage_Summary_job_title .................................. [[32mPASS[0m in 0.58s]
[0m21:53:37.367197 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417
[0m21:53:37.367951 [debug] [Thread-1 (]: Began running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:53:37.368731 [info ] [Thread-1 (]: 18 of 26 START test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [RUN]
[0m21:53:37.369669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.not_null_Wage_Summary_job_title.9f665ce417, now test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46)
[0m21:53:37.370342 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:53:37.378908 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m21:53:37.379899 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:53:37.383488 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"
[0m21:53:37.384452 [debug] [Thread-1 (]: On test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select case_number as from_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
    where case_number is not null
),

parent as (
    select case_number as to_field
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:53:37.385154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:37.394227 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:48a071b2-93c6-41d5-a8fa-9ec95a63f0e1&page=queryresults
[0m21:53:37.738352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d8676860-3d0f-4498-8910-e9da4a09566b&page=queryresults
[0m21:53:37.827514 [error] [Thread-2 (]: 17 of 26 FAIL 26525 relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_  [[31mFAIL 26525[0m in 1.01s]
[0m21:53:37.829053 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6
[0m21:53:37.829835 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:53:37.830736 [info ] [Thread-2 (]: 19 of 26 START test unique_Company_Data_employer_name .......................... [RUN]
[0m21:53:37.831680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_.c8741760b6, now test.cs329e_xh.unique_Company_Data_employer_name.69805b71db)
[0m21:53:37.832353 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:53:37.841792 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m21:53:37.842757 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:53:37.849678 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"
[0m21:53:37.852672 [debug] [Thread-2 (]: On test.cs329e_xh.unique_Company_Data_employer_name.69805b71db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Company_Data_employer_name.69805b71db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
  where employer_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:53:37.853386 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:38.062081 [error] [Thread-1 (]: 18 of 26 FAIL 14201 relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_  [[31mFAIL 14201[0m in 0.69s]
[0m21:53:38.063387 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46
[0m21:53:38.064120 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:53:38.064950 [info ] [Thread-1 (]: 20 of 26 START test unique_Employer_Detail_employer_petitioner_name ............ [RUN]
[0m21:53:38.065768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_.c7ae4cff46, now test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1)
[0m21:53:38.066422 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:53:38.072673 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m21:53:38.073552 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:53:38.077034 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"
[0m21:53:38.078040 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select employer_petitioner_name as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Employer_Detail`
  where employer_petitioner_name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:53:38.078718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:38.188554 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8916001c-b7a6-4ca9-9145-e5d278c221c8&page=queryresults
[0m21:53:38.517761 [info ] [Thread-2 (]: 19 of 26 PASS unique_Company_Data_employer_name ................................ [[32mPASS[0m in 0.69s]
[0m21:53:38.519107 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_Company_Data_employer_name.69805b71db
[0m21:53:38.519821 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:53:38.520575 [info ] [Thread-2 (]: 21 of 26 START test unique_LCA_Worksites_row_id ................................ [RUN]
[0m21:53:38.521329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Company_Data_employer_name.69805b71db, now test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef)
[0m21:53:38.521942 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:53:38.528082 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m21:53:38.528937 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:53:38.532430 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"
[0m21:53:38.533365 [debug] [Thread-2 (]: On test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select row_id as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
  where row_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:53:38.534013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:38.540934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cb208ba1-d629-4271-a352-8466a002b9ef&page=queryresults
[0m21:53:38.832723 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d0e296f1-d000-4b08-937c-dfb410fc3658&page=queryresults
[0m21:53:38.874015 [error] [Thread-1 (]: 20 of 26 FAIL 56 unique_Employer_Detail_employer_petitioner_name ............... [[31mFAIL 56[0m in 0.81s]
[0m21:53:38.875438 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1
[0m21:53:38.876132 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:53:38.877053 [info ] [Thread-1 (]: 22 of 26 START test unique_Sentiment_Analysis_publication_date ................. [RUN]
[0m21:53:38.877943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Employer_Detail_employer_petitioner_name.9c1be754f1, now test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e)
[0m21:53:38.878614 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:53:38.884747 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m21:53:38.885631 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:53:38.889024 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"
[0m21:53:38.890066 [debug] [Thread-1 (]: On test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select publication_date as unique_field
  from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
  where publication_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m21:53:38.890766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:39.173847 [info ] [Thread-2 (]: 21 of 26 PASS unique_LCA_Worksites_row_id ...................................... [[32mPASS[0m in 0.65s]
[0m21:53:39.175329 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef
[0m21:53:39.176008 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:53:39.176791 [info ] [Thread-2 (]: 23 of 26 START test unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [RUN]
[0m21:53:39.177692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_LCA_Worksites_row_id.fd822b6fef, now test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557)
[0m21:53:39.178338 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:53:39.192447 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557"
[0m21:53:39.194487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:387400c9-76d5-4251-be4b-1eb6ab10b6d2&page=queryresults
[0m21:53:39.195320 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:53:39.200750 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557"
[0m21:53:39.201754 [debug] [Thread-2 (]: On test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        case_number, appx_a_date_of_degree
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
    group by case_number, appx_a_date_of_degree
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:53:39.202504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:39.493809 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5f62fcea-74e9-442d-aa82-72a52db577df&page=queryresults
[0m21:53:39.502674 [info ] [Thread-1 (]: 22 of 26 PASS unique_Sentiment_Analysis_publication_date ....................... [[32mPASS[0m in 0.62s]
[0m21:53:39.503906 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e
[0m21:53:39.504632 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:53:39.505349 [info ] [Thread-1 (]: 24 of 26 START test unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [RUN]
[0m21:53:39.506344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_Sentiment_Analysis_publication_date.39656edb5e, now test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4)
[0m21:53:39.506967 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:53:39.513569 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4"
[0m21:53:39.514528 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:53:39.518073 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4"
[0m21:53:39.519068 [debug] [Thread-1 (]: On test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        case_number, employer_name
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    group by case_number, employer_name
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:53:39.519791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:39.832000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:aa91ae24-dc38-4e31-90dd-c66ac7a22100&page=queryresults
[0m21:53:39.834433 [info ] [Thread-2 (]: 23 of 26 PASS unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree  [[32mPASS[0m in 0.66s]
[0m21:53:39.837495 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557
[0m21:53:39.838462 [debug] [Thread-2 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:53:39.839317 [info ] [Thread-2 (]: 25 of 26 START test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [RUN]
[0m21:53:39.840203 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Appendix_case_number__appx_a_date_of_degree.74e2a60557, now test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d)
[0m21:53:39.840854 [debug] [Thread-2 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:53:39.851761 [debug] [Thread-2 (]: Writing injected SQL for node "test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d"
[0m21:53:39.852734 [debug] [Thread-2 (]: Began executing node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:53:39.856352 [debug] [Thread-2 (]: Writing runtime sql for node "test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d"
[0m21:53:39.857307 [debug] [Thread-2 (]: On test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
    group by employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:53:39.858051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:40.134734 [info ] [Thread-1 (]: 24 of 26 PASS unique_combination_of_columns_LCA_Disclosure_case_number__employer_name  [[32mPASS[0m in 0.63s]
[0m21:53:40.136019 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4
[0m21:53:40.136774 [debug] [Thread-1 (]: Began running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:53:40.137620 [info ] [Thread-1 (]: 26 of 26 START test unique_combination_of_columns_Wage_Summary_company_name__job_title  [RUN]
[0m21:53:40.138608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.cs329e_xh.unique_combination_of_columns_LCA_Disclosure_case_number__employer_name.a784ecc7c4, now test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194)
[0m21:53:40.139268 [debug] [Thread-1 (]: Began compiling node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:53:40.147575 [debug] [Thread-1 (]: Writing injected SQL for node "test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194"
[0m21:53:40.148521 [debug] [Thread-1 (]: Began executing node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:53:40.152073 [debug] [Thread-1 (]: Writing runtime sql for node "test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194"
[0m21:53:40.152975 [debug] [Thread-1 (]: On test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        company_name, job_title
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
    group by company_name, job_title
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:53:40.153674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:40.162689 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eeb6614b-57b8-4b78-9fde-ef5dfa783b11&page=queryresults
[0m21:53:40.482916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:72127e28-d27c-4480-8def-e359f71c015a&page=queryresults
[0m21:53:40.503332 [error] [Thread-2 (]: 25 of 26 FAIL 25737 unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr  [[31mFAIL 25737[0m in 0.66s]
[0m21:53:40.504654 [debug] [Thread-2 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d
[0m21:53:40.785363 [info ] [Thread-1 (]: 26 of 26 PASS unique_combination_of_columns_Wage_Summary_company_name__job_title  [[32mPASS[0m in 0.65s]
[0m21:53:40.786646 [debug] [Thread-1 (]: Finished running node test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194
[0m21:53:40.788626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:53:40.789655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:40.790239 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Wage_Summary_company_name__job_title.8eddfba194' was properly closed.
[0m21:53:40.790766 [debug] [MainThread]: Connection 'test.cs329e_xh.unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr.d5f6cc052d' was properly closed.
[0m21:53:40.791365 [info ] [MainThread]: 
[0m21:53:40.791959 [info ] [MainThread]: Finished running 26 data tests in 0 hours 0 minutes and 9.81 seconds (9.81s).
[0m21:53:40.797908 [debug] [MainThread]: Command end result
[0m21:53:40.857673 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m21:53:40.860641 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m21:53:40.873006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m21:53:40.873691 [info ] [MainThread]: 
[0m21:53:40.874458 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m21:53:40.875291 [info ] [MainThread]: 
[0m21:53:40.876481 [error] [MainThread]: [31mFailure in test relationships_Employer_Detail_employer_petitioner_name__employer_name__ref_Company_Data_ (models/int/Employer_Details/schema.yml)[0m
[0m21:53:40.877372 [error] [MainThread]:   Got 26525 results, configured to fail if != 0
[0m21:53:40.877940 [info ] [MainThread]: 
[0m21:53:40.878876 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/relationships_Employer_Detail_a803ce1d5c10b4dae7e1dc33e0f1a09b.sql
[0m21:53:40.879531 [info ] [MainThread]: 
[0m21:53:40.880273 [error] [MainThread]: [31mFailure in test relationships_LCA_Worksites_case_number__case_number__ref_LCA_Disclosure_ (models/int/schema.yml)[0m
[0m21:53:40.880966 [error] [MainThread]:   Got 14201 results, configured to fail if != 0
[0m21:53:40.881535 [info ] [MainThread]: 
[0m21:53:40.882248 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/relationships_LCA_Worksites_a871b7806445a97e6fda9420f0740807.sql
[0m21:53:40.883049 [info ] [MainThread]: 
[0m21:53:40.883773 [error] [MainThread]: [31mFailure in test unique_Employer_Detail_employer_petitioner_name (models/int/Employer_Details/schema.yml)[0m
[0m21:53:40.884423 [error] [MainThread]:   Got 56 results, configured to fail if != 0
[0m21:53:40.884958 [info ] [MainThread]: 
[0m21:53:40.885724 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/Employer_Details/schema.yml/unique_Employer_Detail_employer_petitioner_name.sql
[0m21:53:40.886387 [info ] [MainThread]: 
[0m21:53:40.887219 [error] [MainThread]: [31mFailure in test unique_combination_of_columns_Single_Registration_employer_name__ben_year_of_birth__gender__agent_first_name__agent_last_name__mail_addr (models/int/schema.yml)[0m
[0m21:53:40.887918 [error] [MainThread]:   Got 25737 results, configured to fail if != 0
[0m21:53:40.888469 [info ] [MainThread]: 
[0m21:53:40.889093 [info ] [MainThread]:   compiled code at target/compiled/cs329e_xh/models/int/schema.yml/unique_combination_of_columns__ae77d73b6ce81585721aac3ba435e239.sql
[0m21:53:40.889703 [info ] [MainThread]: 
[0m21:53:40.890334 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=4 SKIP=0 TOTAL=26
[0m21:53:40.891328 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 12.877472, "process_in_blocks": "0", "process_kernel_time": 0.535958, "process_mem_max_rss": "271724", "process_out_blocks": "5112", "process_user_time": 5.911814}
[0m21:53:40.891993 [debug] [MainThread]: Command `dbt test` failed at 21:53:40.891853 after 12.88 seconds
[0m21:53:40.892643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e64795a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ca194ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e631e5f0>]}
[0m21:53:40.893302 [debug] [MainThread]: Flushing usage events
[0m21:53:41.157430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:42:12.675052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38172a14e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3816252350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38162522f0>]}


============================== 22:42:12.679010 | d1b2431d-0058-40fd-a828-a4b608730f68 ==============================
[0m22:42:12.679010 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:42:12.680038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jupyter/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jupyter/cs329e_xh/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:42:14.442552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3818432e00>]}
[0m22:42:14.531267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38163af4f0>]}
[0m22:42:14.532372 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:42:14.706844 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:42:14.949986 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m22:42:14.952357 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/schema.yml
[0m22:42:14.953017 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m22:42:15.695216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fa7a4d00>]}
[0m22:42:16.019583 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m22:42:16.022397 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m22:42:16.047017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fb23fcd0>]}
[0m22:42:16.047978 [info ] [MainThread]: Found 31 models, 1 seed, 25 data tests, 19 sources, 494 macros
[0m22:42:16.048747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fb23df00>]}
[0m22:42:16.054337 [info ] [MainThread]: 
[0m22:42:16.055246 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:42:16.056042 [info ] [MainThread]: 
[0m22:42:16.057188 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:42:16.068091 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m22:42:16.069377 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m22:42:16.070190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:16.071755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:16.294389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:16.491144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m22:42:16.492484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m22:42:16.493280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:16.494548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:16.631109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m22:42:16.636612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:16.645010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m22:42:16.650625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:16.832994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381753a230>]}
[0m22:42:16.834382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:16.839845 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_data
[0m22:42:16.841297 [debug] [Thread-2 (]: Began running node model.cs329e_xh.employer_details
[0m22:42:16.842396 [info ] [Thread-1 (]: 1 of 31 START sql table model dbt_cs329e_xh_stg.company_data ................... [RUN]
[0m22:42:16.843955 [info ] [Thread-2 (]: 2 of 31 START sql table model dbt_cs329e_xh_stg.employer_details ............... [RUN]
[0m22:42:16.845471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now model.cs329e_xh.company_data)
[0m22:42:16.846507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.employer_details)
[0m22:42:16.847547 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_data
[0m22:42:16.848379 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.employer_details
[0m22:42:16.867099 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_data"
[0m22:42:16.864474 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.employer_details"
[0m22:42:16.869271 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_data
[0m22:42:16.870094 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.employer_details
[0m22:42:16.909665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:16.914928 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:42:17.089350 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.employer_details"
[0m22:42:17.092923 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_data"
[0m22:42:17.094721 [debug] [Thread-2 (]: On model.cs329e_xh.employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details`
      
    
    

    OPTIONS()
    as (
      
with stg_employer_details_1 as (
select
    * except (`tax id`,`line by line` ),
    lpad(cast(cast(`tax id` as int64) as string), 4, '0') as tax_id,
    CAST(REPLACE(`line by line`, ',', '') AS INT64) AS employer_no
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`employer_details`
),
stg_employer_details as (
    select
    employer_no,
    `fiscal year   ` as fiscal_year,
    `employer petitioner name` as employer_petitioner_name,
    tax_id as tax_id,
    `industry naics code` as naics_code,
    `petitioner city` as petitioner_city,
    `petitioner state` as petitioner_state,
    `petitioner zip code` as petitioner_zip_code,
    `initial approval` as initial_approval,
    `initial denial` as initial_denial,
    `continuing approval` as continuing_approval,
    `continuing denial` as continuing_denial,
    _data_source, _load_time
from stg_employer_details_1
) 
select * from stg_employer_details
    );
  
[0m22:42:17.095914 [debug] [Thread-1 (]: On model.cs329e_xh.company_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
      
    
    

    OPTIONS()
    as (
      
with stg_company_data as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`company_data`
)
select * from stg_company_data
    );
  
[0m22:42:17.445741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f069dad7-4bec-42e8-a1a7-30328936a8e8&page=queryresults
[0m22:42:17.508229 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3f0a21e4-52b1-485b-b81d-8e814e2270ef&page=queryresults
[0m22:42:19.524160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381756cf10>]}
[0m22:42:19.525604 [info ] [Thread-1 (]: 1 of 31 OK created sql table model dbt_cs329e_xh_stg.company_data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.68s]
[0m22:42:19.526914 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_data
[0m22:42:19.527992 [debug] [Thread-1 (]: Began running node model.cs329e_xh.h1b_sentiment_analysis
[0m22:42:19.529851 [info ] [Thread-1 (]: 3 of 31 START sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis ......... [RUN]
[0m22:42:19.530893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_data, now model.cs329e_xh.h1b_sentiment_analysis)
[0m22:42:19.531551 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.h1b_sentiment_analysis
[0m22:42:19.537620 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m22:42:19.538814 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.h1b_sentiment_analysis
[0m22:42:19.547193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:19.683835 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m22:42:19.685037 [debug] [Thread-1 (]: On model.cs329e_xh.h1b_sentiment_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.h1b_sentiment_analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
      
    
    

    OPTIONS()
    as (
      
with stg_senti as (
select * 
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`h1b_sentiment_analysis`
)
select * from stg_senti
    );
  
[0m22:42:19.804483 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381a08f1c0>]}
[0m22:42:19.805707 [info ] [Thread-2 (]: 2 of 31 OK created sql table model dbt_cs329e_xh_stg.employer_details .......... [[32mCREATE TABLE (61.5k rows, 9.3 MiB processed)[0m in 2.96s]
[0m22:42:19.806915 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.employer_details
[0m22:42:19.807685 [debug] [Thread-2 (]: Began running node model.cs329e_xh.lca_appendix
[0m22:42:19.808722 [info ] [Thread-2 (]: 4 of 31 START sql table model dbt_cs329e_xh_stg.lca_appendix ................... [RUN]
[0m22:42:19.809646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.employer_details, now model.cs329e_xh.lca_appendix)
[0m22:42:19.810347 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.lca_appendix
[0m22:42:19.815575 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.lca_appendix"
[0m22:42:19.816646 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.lca_appendix
[0m22:42:19.820547 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:42:19.949816 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.lca_appendix"
[0m22:42:19.951081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:15207b0a-e439-4e8e-be4c-3d79b7b71d09&page=queryresults
[0m22:42:19.954062 [debug] [Thread-2 (]: On model.cs329e_xh.lca_appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_appendix as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_appendix`
)
select * from stg_lca_appendix
    );
  
[0m22:42:20.307141 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:22438999-457e-4b66-85a5-85f4e0c37f9e&page=queryresults
[0m22:42:21.782876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fb0ca110>]}
[0m22:42:21.784089 [info ] [Thread-1 (]: 3 of 31 OK created sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis .... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.25s]
[0m22:42:21.785365 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.h1b_sentiment_analysis
[0m22:42:21.786482 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_disclosure
[0m22:42:21.787456 [info ] [Thread-1 (]: 5 of 31 START sql table model dbt_cs329e_xh_stg.lca_disclosure ................. [RUN]
[0m22:42:21.788775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.h1b_sentiment_analysis, now model.cs329e_xh.lca_disclosure)
[0m22:42:21.789683 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_disclosure
[0m22:42:21.795112 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_disclosure"
[0m22:42:21.796120 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_disclosure
[0m22:42:21.799924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:21.935785 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_disclosure"
[0m22:42:21.936992 [debug] [Thread-1 (]: On model.cs329e_xh.lca_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
      
    
    

    OPTIONS()
    as (
      
with s as (
SELECT
    * EXCEPT (received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage, total_worksite_locations),
    SAFE_CAST(received_date AS DATETIME) AS received_date,
    SAFE_CAST(decision_date AS DATETIME) AS decision_date,
    SAFE_CAST(original_cert_date AS DATETIME) AS original_cert_date,
    
    SAFE_CAST(total_worker_positions AS INT64) AS total_worker_positions,
    SAFE_CAST(new_employment AS INT64) AS new_employment,
    SAFE_CAST(continued_employment AS INT64) AS continued_employment,
    SAFE_CAST(change_previous_employment AS INT64) AS change_previous_employment,
    SAFE_CAST(new_concurrent_employment AS INT64) AS new_concurrent_employment,
    SAFE_CAST(change_employer AS INT64) AS change_employer,
    SAFE_CAST(amended_petition AS INT64) AS amended_petition,
    SAFE_CAST(worksite_workers AS INT64) AS worksite_workers,
    SAFE_CAST(total_worksite_locations AS INT64) AS total_worksite_locations,

    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_from, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_from,
    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_to, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_to,
    SAFE_CAST(REGEXP_REPLACE(prevailing_wage, r'[\$,]', '') AS FLOAT64) AS prevailing_wage

FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_disclosure`
    )
select * from s
    );
  
[0m22:42:22.214247 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fb0a3f10>]}
[0m22:42:22.215506 [info ] [Thread-2 (]: 4 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.40s]
[0m22:42:22.216679 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.lca_appendix
[0m22:42:22.217724 [debug] [Thread-2 (]: Began running node model.cs329e_xh.lca_worksites
[0m22:42:22.219004 [info ] [Thread-2 (]: 6 of 31 START sql table model dbt_cs329e_xh_stg.lca_worksites .................. [RUN]
[0m22:42:22.220105 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_appendix, now model.cs329e_xh.lca_worksites)
[0m22:42:22.220797 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.lca_worksites
[0m22:42:22.226419 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.lca_worksites"
[0m22:42:22.227469 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.lca_worksites
[0m22:42:22.233781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:42:22.292652 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:befc1c5c-d027-4868-baa1-4f515ff8d92d&page=queryresults
[0m22:42:22.362980 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.lca_worksites"
[0m22:42:22.364157 [debug] [Thread-2 (]: On model.cs329e_xh.lca_worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_worksites as (
select * except(worksite_workers, pw_other_year),
        cast(worksite_workers as int64) as worksite_workers,
        cast(pw_other_year as int64) as pw_other_year
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_worksites`
)
select * from stg_lca_worksites
    );
  
[0m22:42:22.756367 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:751ad1a6-47d2-4e27-86fd-b93769bfda8d&page=queryresults
[0m22:42:30.070313 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fb082ad0>]}
[0m22:42:30.071516 [info ] [Thread-2 (]: 6 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 7.85s]
[0m22:42:30.072645 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.lca_worksites
[0m22:42:30.073424 [debug] [Thread-2 (]: Began running node model.cs329e_xh.pw_disclosure
[0m22:42:30.074655 [info ] [Thread-2 (]: 7 of 31 START sql table model dbt_cs329e_xh_stg.pw_disclosure .................. [RUN]
[0m22:42:30.075707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_worksites, now model.cs329e_xh.pw_disclosure)
[0m22:42:30.076328 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.pw_disclosure
[0m22:42:30.081634 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.pw_disclosure"
[0m22:42:30.082700 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.pw_disclosure
[0m22:42:30.086808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:42:30.204524 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.pw_disclosure"
[0m22:42:30.205724 [debug] [Thread-2 (]: On model.cs329e_xh.pw_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.pw_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
      
    
    

    OPTIONS()
    as (
      
with temp as (
select 
    * except(required_experience_months, required_training_months, alt_training_months, alt_experience_months),
    cast(required_training_months as int64) as required_training_months,
    cast(required_experience_months as int64) as required_experience_months,
    cast(alt_training_months as int64) as alt_training_months,
    cast(alt_experience_months as int64) as alt_experience_months
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`pw_disclosure`
),
stg_pw_disclosure as (
    select 
    * except(bls_area),
    SPLIT(bls_area, ',')[SAFE_OFFSET(0)] AS bls_city,
    IFNULL(SPLIT(bls_area, ',')[SAFE_OFFSET(1)], '') AS bls_state
from temp)
select * from stg_pw_disclosure
    );
  
[0m22:42:30.863187 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4f2c8c69-68ad-4101-9890-016c4df2a570&page=queryresults
[0m22:42:34.313449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381756cf10>]}
[0m22:42:34.314683 [info ] [Thread-1 (]: 5 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_disclosure ............ [[32mCREATE TABLE (561.0k rows, 485.1 MiB processed)[0m in 12.52s]
[0m22:42:34.316013 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_disclosure
[0m22:42:34.316757 [debug] [Thread-1 (]: Began running node model.cs329e_xh.single_registrations
[0m22:42:34.317995 [info ] [Thread-1 (]: 8 of 31 START sql table model dbt_cs329e_xh_stg.single_registrations ........... [RUN]
[0m22:42:34.319012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_disclosure, now model.cs329e_xh.single_registrations)
[0m22:42:34.319642 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.single_registrations
[0m22:42:34.324983 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.single_registrations"
[0m22:42:34.325990 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.single_registrations
[0m22:42:34.331185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:34.466903 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.single_registrations"
[0m22:42:34.468138 [debug] [Thread-1 (]: On model.cs329e_xh.single_registrations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.single_registrations"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
      
    
    

    OPTIONS()
    as (
      
with t1 as (
select
    case bcn when '(b)(6)' THEN NULL ELSE bcn END AS bcn,
    case receipt_number when '(b)(6)' THEN NULL ELSE receipt_number END AS receipt_number,
    case ben_date_of_birth when '(b)(6)' THEN NULL ELSE ben_date_of_birth END AS ben_date_of_birth,
    case dol_eta_case_number when '(b)(6)' THEN NULL ELSE dol_eta_case_number END AS dol_eta_case_number,
    *
EXCEPT (bcn, receipt_number, ben_date_of_birth, dol_eta_case_number)
FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`single_registrations`
WHERE bcn != '(b)(3) (b)(6) (b)(7)(c)'
)
, t2 as (select * except(bcn, receipt_number, ben_date_of_birth, dol_eta_case_number, t_u_vawa_flag)
FROM t1)
select * from t2
    );
  
[0m22:42:34.735209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:38a51f83-0ae8-4f0a-8685-76fbd71cff6a&page=queryresults
[0m22:42:39.844154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38163ae980>]}
[0m22:42:39.845469 [info ] [Thread-1 (]: 8 of 31 OK created sql table model dbt_cs329e_xh_stg.single_registrations ...... [[32mCREATE TABLE (350.1k rows, 78.4 MiB processed)[0m in 5.52s]
[0m22:42:39.846781 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.single_registrations
[0m22:42:39.847612 [debug] [Thread-1 (]: Began running node model.cs329e_xh.wage_summary
[0m22:42:39.848440 [info ] [Thread-1 (]: 9 of 31 START sql table model dbt_cs329e_xh_stg.wage_summary ................... [RUN]
[0m22:42:39.849805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.single_registrations, now model.cs329e_xh.wage_summary)
[0m22:42:39.850569 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.wage_summary
[0m22:42:39.857326 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.wage_summary"
[0m22:42:39.858440 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.wage_summary
[0m22:42:39.864211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:40.011794 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.wage_summary"
[0m22:42:40.013102 [debug] [Thread-1 (]: On model.cs329e_xh.wage_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
      
    
    

    OPTIONS()
    as (
      
with stg_wage_summary as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`wage_summary`
)
select * from stg_wage_summary
    );
  
[0m22:42:40.387378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5ddcead1-0319-4c5b-8b6c-ff33e5d6dc35&page=queryresults
[0m22:42:42.394741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381756cf10>]}
[0m22:42:42.395939 [info ] [Thread-1 (]: 9 of 31 OK created sql table model dbt_cs329e_xh_stg.wage_summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.54s]
[0m22:42:42.397050 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.wage_summary
[0m22:42:42.398102 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m22:42:42.399029 [info ] [Thread-1 (]: 10 of 31 START sql table model dbt_cs329e_xh_int.Company_Data .................. [RUN]
[0m22:42:42.400559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.wage_summary, now model.cs329e_xh.Company_Data)
[0m22:42:42.401207 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m22:42:42.406290 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m22:42:42.407338 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m22:42:42.411321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:42.564541 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:42.933141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eb93a147-8d5f-4993-8b7e-5bcc028559bf&page=queryresults
[0m22:42:43.054321 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as int64)
 as count, 
      
    cast(null as string)
 as employer_url, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:43.395132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:80b88f01-f503-483b-a948-9a984d9ef439&page=queryresults
[0m22:42:43.544409 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:42:43.553961 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m22:42:43.555364 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
        
  (
    employer_name string primary key not enforced,
    count int64,
    employer_url string,
    _data_source string,
    _load_time datetime
    
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_name, count, employer_url, _data_source, _load_time
    from (
        with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    ) as model_subq
    );
  
[0m22:42:43.797570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:91caec7a-845a-48a0-b56b-40fd304bda9e&page=queryresults
[0m22:42:43.973588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fb0734f0>]}
[0m22:42:43.974817 [info ] [Thread-2 (]: 7 of 31 OK created sql table model dbt_cs329e_xh_stg.pw_disclosure ............. [[32mCREATE TABLE (237.9k rows, 372.8 MiB processed)[0m in 13.90s]
[0m22:42:43.975896 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.pw_disclosure
[0m22:42:43.976641 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m22:42:43.977686 [info ] [Thread-2 (]: 11 of 31 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............ [RUN]
[0m22:42:43.978983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.pw_disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m22:42:43.979641 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m22:42:43.984583 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m22:42:43.985596 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m22:42:43.991389 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:42:44.117461 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:44.542408 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e937d6f7-4e0b-48a8-80c4-49079569d641&page=queryresults
[0m22:42:44.685938 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        select
    
      
    cast(null as datetime)
 as publication_date, 
      
    cast(null as string)
 as text_summary, 
      
    cast(null as string)
 as sentiment, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:44.983834 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4eb97566-fac8-4845-b85c-bca9733b1907&page=queryresults
[0m22:42:45.094992 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:42:45.096976 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m22:42:45.098070 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
        
  (
    publication_date datetime primary key not enforced,
    text_summary string,
    sentiment string,
    _data_source string,
    _load_time datetime
    
    )

      
    
    

    OPTIONS()
    as (
      
    select publication_date, text_summary, sentiment, _data_source, _load_time
    from (
        with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    ) as model_subq
    );
  
[0m22:42:45.432566 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:95cc8d1d-1cf2-45b7-a07e-fe75f4c46c40&page=queryresults
[0m22:42:45.774456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fb070a90>]}
[0m22:42:45.775631 [info ] [Thread-1 (]: 10 of 31 OK created sql table model dbt_cs329e_xh_int.Company_Data ............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 3.37s]
[0m22:42:45.776971 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m22:42:45.777741 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m22:42:45.778627 [info ] [Thread-1 (]: 12 of 31 START sql table model dbt_cs329e_xh_int.LCA_Appendix .................. [RUN]
[0m22:42:45.779643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Appendix)
[0m22:42:45.781017 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m22:42:45.787781 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m22:42:45.788876 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m22:42:45.793150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:45.926774 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:46.493556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4615c6f5-89bf-4431-b512-bdc559daa331&page=queryresults
[0m22:42:46.604818 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as datetime)
 as appx_a_date_of_degree, 
      
    cast(null as string)
 as appx_a_name_of_institution, 
      
    cast(null as int64)
 as appx_a_no_of_exempt_workers, 
      
    cast(null as string)
 as appx_a_field_of_study, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:46.941033 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5606f9f5-ebec-43e0-b05c-795c1e86d6b9&page=queryresults
[0m22:42:47.086685 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:42:47.089085 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m22:42:47.090629 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
        
  (
    case_number string,
    appx_a_date_of_degree datetime,
    appx_a_name_of_institution string,
    appx_a_no_of_exempt_workers int64,
    appx_a_field_of_study string,
    _data_source string,
    _load_time datetime,
    
    primary key (case_number, appx_a_date_of_degree) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select case_number, appx_a_date_of_degree, appx_a_name_of_institution, appx_a_no_of_exempt_workers, appx_a_field_of_study, _data_source, _load_time
    from (
        with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    ) as model_subq
    );
  
[0m22:42:47.367963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bde72ca1-2352-4a49-b578-ce5303ae74e7&page=queryresults
[0m22:42:47.390892 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381a08f1c0>]}
[0m22:42:47.392099 [info ] [Thread-2 (]: 11 of 31 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ....... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 3.41s]
[0m22:42:47.393469 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m22:42:47.394233 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m22:42:47.395063 [info ] [Thread-2 (]: 13 of 31 START sql table model dbt_cs329e_xh_int.LCA_Worksites ................. [RUN]
[0m22:42:47.396323 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.LCA_Worksites)
[0m22:42:47.396990 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m22:42:47.402051 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m22:42:47.403128 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m22:42:47.408824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:42:47.585908 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:47.916412 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9d19ffcd-08ef-4a37-88d9-4a280cb286cf&page=queryresults
[0m22:42:48.038144 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        select
    
      
    cast(null as string)
 as row_id, 
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as float64)
 as prevailing_wage, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as pw_other_year
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:48.316656 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:8edd6fe7-3112-455c-ac97-a2ee9383d41e&page=queryresults
[0m22:42:48.437569 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:42:48.440310 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m22:42:48.441574 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
        
  (
    row_id string primary key not enforced,
    case_number string,
    secondary_entity string,
    secondary_entity_business_name string,
    worksite_address1 string,
    worksite_address2 string,
    worksite_city string,
    worksite_county string,
    worksite_state string,
    worksite_postal_code string,
    wage_rate_of_pay_from float64,
    wage_rate_of_pay_to float64,
    wage_unit_of_pay string,
    prevailing_wage float64,
    pw_unit_of_pay string,
    pw_tracking_number string,
    pw_wage_level string,
    pw_oes_year string,
    pw_other_source string,
    pw_survey_publisher string,
    pw_survey_name string,
    _data_source string,
    _load_time datetime,
    worksite_workers int64,
    pw_other_year int64
    
    )

      
    
    

    OPTIONS()
    as (
      
    select row_id, case_number, secondary_entity, secondary_entity_business_name, worksite_address1, worksite_address2, worksite_city, worksite_county, worksite_state, worksite_postal_code, wage_rate_of_pay_from, wage_rate_of_pay_to, wage_unit_of_pay, prevailing_wage, pw_unit_of_pay, pw_tracking_number, pw_wage_level, pw_oes_year, pw_other_source, pw_survey_publisher, pw_survey_name, _data_source, _load_time, worksite_workers, pw_other_year
    from (
        with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    ) as model_subq
    );
  
[0m22:42:48.746575 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:55053f3c-ad2e-4bf2-9b4b-fc94713fcba6&page=queryresults
[0m22:42:49.349159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fa86e4d0>]}
[0m22:42:49.350399 [info ] [Thread-1 (]: 12 of 31 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix ............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 3.57s]
[0m22:42:49.351686 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m22:42:49.352416 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m22:42:49.353409 [info ] [Thread-1 (]: 14 of 31 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................ [RUN]
[0m22:42:49.354406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m22:42:49.355042 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m22:42:49.360527 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m22:42:49.361546 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m22:42:49.365914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:49.490679 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:49.893432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1dfd1761-3788-43c0-87a1-e9390f013cbb&page=queryresults
[0m22:42:50.031669 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as case_status, 
      
    cast(null as string)
 as visa_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as soc_code, 
      
    cast(null as string)
 as soc_title, 
      
    cast(null as string)
 as full_time_position, 
      
    cast(null as string)
 as begin_date, 
      
    cast(null as string)
 as end_date, 
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as trade_name_dba, 
      
    cast(null as string)
 as employer_address1, 
      
    cast(null as string)
 as employer_address2, 
      
    cast(null as string)
 as employer_city, 
      
    cast(null as string)
 as employer_state, 
      
    cast(null as string)
 as employer_postal_code, 
      
    cast(null as string)
 as employer_country, 
      
    cast(null as string)
 as employer_province, 
      
    cast(null as string)
 as employer_phone, 
      
    cast(null as string)
 as employer_phone_ext, 
      
    cast(null as string)
 as employer_fein, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as employer_poc_last_name, 
      
    cast(null as string)
 as employer_poc_first_name, 
      
    cast(null as string)
 as employer_poc_middle_name, 
      
    cast(null as string)
 as employer_poc_job_title, 
      
    cast(null as string)
 as employer_poc_address1, 
      
    cast(null as string)
 as employer_poc_address2, 
      
    cast(null as string)
 as employer_poc_city, 
      
    cast(null as string)
 as employer_poc_state, 
      
    cast(null as string)
 as employer_poc_postal_code, 
      
    cast(null as string)
 as employer_poc_country, 
      
    cast(null as string)
 as employer_poc_province, 
      
    cast(null as string)
 as employer_poc_phone, 
      
    cast(null as string)
 as employer_poc_phone_ext, 
      
    cast(null as string)
 as employer_poc_email, 
      
    cast(null as string)
 as agent_representing_employer, 
      
    cast(null as string)
 as agent_attorney_last_name, 
      
    cast(null as string)
 as agent_attorney_first_name, 
      
    cast(null as string)
 as agent_attorney_middle_name, 
      
    cast(null as string)
 as agent_attorney_address1, 
      
    cast(null as string)
 as agent_attorney_address2, 
      
    cast(null as string)
 as agent_attorney_city, 
      
    cast(null as string)
 as agent_attorney_state, 
      
    cast(null as string)
 as agent_attorney_postal_code, 
      
    cast(null as string)
 as agent_attorney_country, 
      
    cast(null as string)
 as agent_attorney_province, 
      
    cast(null as string)
 as agent_attorney_phone, 
      
    cast(null as string)
 as agent_attorney_phone_ext, 
      
    cast(null as string)
 as agent_attorney_email_address, 
      
    cast(null as string)
 as lawfirm_name_business_name, 
      
    cast(null as string)
 as state_of_highest_court, 
      
    cast(null as string)
 as name_of_highest_state_court, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_other_year, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as agree_to_lc_statement, 
      
    cast(null as string)
 as h_1b_dependent, 
      
    cast(null as string)
 as willful_violator, 
      
    cast(null as string)
 as support_h1b, 
      
    cast(null as string)
 as statutory_basis, 
      
    cast(null as string)
 as appendix_a_attached, 
      
    cast(null as string)
 as public_disclosure, 
      
    cast(null as string)
 as preparer_last_name, 
      
    cast(null as string)
 as preparer_first_name, 
      
    cast(null as string)
 as preparer_middle_initial, 
      
    cast(null as string)
 as preparer_business_name, 
      
    cast(null as string)
 as preparer_email, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time, 
      
    cast(null as datetime)
 as received_date, 
      
    cast(null as datetime)
 as decision_date, 
      
    cast(null as datetime)
 as original_cert_date, 
      
    cast(null as int64)
 as total_worker_positions, 
      
    cast(null as int64)
 as new_employment, 
      
    cast(null as int64)
 as continued_employment, 
      
    cast(null as int64)
 as change_previous_employment, 
      
    cast(null as int64)
 as new_concurrent_employment, 
      
    cast(null as int64)
 as change_employer, 
      
    cast(null as int64)
 as amended_petition, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as total_worksite_locations, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as float64)
 as prevailing_wage
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:50.431347 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e3bad4aa-5a6d-4eb2-adeb-b12f028183a2&page=queryresults
[0m22:42:50.551002 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:42:50.554649 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m22:42:50.556030 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
        
  (
    case_number string,
    case_status string,
    visa_class string,
    job_title string,
    soc_code string,
    soc_title string,
    full_time_position string,
    begin_date string,
    end_date string,
    employer_name string,
    trade_name_dba string,
    employer_address1 string,
    employer_address2 string,
    employer_city string,
    employer_state string,
    employer_postal_code string,
    employer_country string,
    employer_province string,
    employer_phone string,
    employer_phone_ext string,
    employer_fein string,
    naics_code string,
    employer_poc_last_name string,
    employer_poc_first_name string,
    employer_poc_middle_name string,
    employer_poc_job_title string,
    employer_poc_address1 string,
    employer_poc_address2 string,
    employer_poc_city string,
    employer_poc_state string,
    employer_poc_postal_code string,
    employer_poc_country string,
    employer_poc_province string,
    employer_poc_phone string,
    employer_poc_phone_ext string,
    employer_poc_email string,
    agent_representing_employer string,
    agent_attorney_last_name string,
    agent_attorney_first_name string,
    agent_attorney_middle_name string,
    agent_attorney_address1 string,
    agent_attorney_address2 string,
    agent_attorney_city string,
    agent_attorney_state string,
    agent_attorney_postal_code string,
    agent_attorney_country string,
    agent_attorney_province string,
    agent_attorney_phone string,
    agent_attorney_phone_ext string,
    agent_attorney_email_address string,
    lawfirm_name_business_name string,
    state_of_highest_court string,
    name_of_highest_state_court string,
    secondary_entity string,
    secondary_entity_business_name string,
    worksite_address1 string,
    worksite_address2 string,
    worksite_city string,
    worksite_county string,
    worksite_state string,
    worksite_postal_code string,
    wage_unit_of_pay string,
    pw_unit_of_pay string,
    pw_tracking_number string,
    pw_wage_level string,
    pw_oes_year string,
    pw_other_source string,
    pw_other_year string,
    pw_survey_publisher string,
    pw_survey_name string,
    agree_to_lc_statement string,
    h_1b_dependent string,
    willful_violator string,
    support_h1b string,
    statutory_basis string,
    appendix_a_attached string,
    public_disclosure string,
    preparer_last_name string,
    preparer_first_name string,
    preparer_middle_initial string,
    preparer_business_name string,
    preparer_email string,
    _data_source string,
    _load_time datetime,
    received_date datetime,
    decision_date datetime,
    original_cert_date datetime,
    total_worker_positions int64,
    new_employment int64,
    continued_employment int64,
    change_previous_employment int64,
    new_concurrent_employment int64,
    change_employer int64,
    amended_petition int64,
    worksite_workers int64,
    total_worksite_locations int64,
    wage_rate_of_pay_from float64,
    wage_rate_of_pay_to float64,
    prevailing_wage float64,
    
    primary key (case_number, employer_name) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select case_number, case_status, visa_class, job_title, soc_code, soc_title, full_time_position, begin_date, end_date, employer_name, trade_name_dba, employer_address1, employer_address2, employer_city, employer_state, employer_postal_code, employer_country, employer_province, employer_phone, employer_phone_ext, employer_fein, naics_code, employer_poc_last_name, employer_poc_first_name, employer_poc_middle_name, employer_poc_job_title, employer_poc_address1, employer_poc_address2, employer_poc_city, employer_poc_state, employer_poc_postal_code, employer_poc_country, employer_poc_province, employer_poc_phone, employer_poc_phone_ext, employer_poc_email, agent_representing_employer, agent_attorney_last_name, agent_attorney_first_name, agent_attorney_middle_name, agent_attorney_address1, agent_attorney_address2, agent_attorney_city, agent_attorney_state, agent_attorney_postal_code, agent_attorney_country, agent_attorney_province, agent_attorney_phone, agent_attorney_phone_ext, agent_attorney_email_address, lawfirm_name_business_name, state_of_highest_court, name_of_highest_state_court, secondary_entity, secondary_entity_business_name, worksite_address1, worksite_address2, worksite_city, worksite_county, worksite_state, worksite_postal_code, wage_unit_of_pay, pw_unit_of_pay, pw_tracking_number, pw_wage_level, pw_oes_year, pw_other_source, pw_other_year, pw_survey_publisher, pw_survey_name, agree_to_lc_statement, h_1b_dependent, willful_violator, support_h1b, statutory_basis, appendix_a_attached, public_disclosure, preparer_last_name, preparer_first_name, preparer_middle_initial, preparer_business_name, preparer_email, _data_source, _load_time, received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, total_worksite_locations, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage
    from (
        with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    ) as model_subq
    );
  
[0m22:42:50.897278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1748f656-3934-4ffa-8fd7-3fec46d87ad5&page=queryresults
[0m22:42:56.415723 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381694fac0>]}
[0m22:42:56.416983 [info ] [Thread-2 (]: 13 of 31 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............ [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 9.02s]
[0m22:42:56.418256 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m22:42:56.419072 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Single_Registration
[0m22:42:56.420289 [info ] [Thread-2 (]: 15 of 31 START sql table model dbt_cs329e_xh_int.Single_Registration ........... [RUN]
[0m22:42:56.421191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Single_Registration)
[0m22:42:56.421807 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m22:42:56.427518 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m22:42:56.428771 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Single_Registration
[0m22:42:56.433738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:42:56.561452 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: select * from (
        with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:56.949720 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a928c01a-e2db-4865-81d9-925c01d630a5&page=queryresults
[0m22:42:57.062078 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as ben_year_of_birth, 
      
    cast(null as string)
 as gender, 
      
    cast(null as string)
 as agent_first_name, 
      
    cast(null as string)
 as agent_last_name, 
      
    cast(null as string)
 as mail_addr, 
      
    cast(null as string)
 as country_of_birth, 
      
    cast(null as string)
 as country_of_nationality, 
      
    cast(null as string)
 as fein, 
      
    cast(null as string)
 as city, 
      
    cast(null as string)
 as state, 
      
    cast(null as string)
 as zip, 
      
    cast(null as string)
 as lottery_year, 
      
    cast(null as string)
 as status_type, 
      
    cast(null as string)
 as ben_multi_reg_ind, 
      
    cast(null as string)
 as rec_date, 
      
    cast(null as string)
 as first_decision, 
      
    cast(null as string)
 as first_decision_date, 
      
    cast(null as string)
 as i129_employer_name, 
      
    cast(null as string)
 as pet_street, 
      
    cast(null as string)
 as pet_city, 
      
    cast(null as string)
 as pet_state, 
      
    cast(null as string)
 as pet_zip, 
      
    cast(null as string)
 as requested_class, 
      
    cast(null as string)
 as basis_for_classification, 
      
    cast(null as string)
 as requested_action, 
      
    cast(null as string)
 as number_of_beneficiaries, 
      
    cast(null as string)
 as ben_sex, 
      
    cast(null as string)
 as ben_country_of_birth, 
      
    cast(null as string)
 as ben_current_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as worksite_street, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_zip, 
      
    cast(null as string)
 as full_time_ind, 
      
    cast(null as string)
 as wage_amt, 
      
    cast(null as string)
 as wage_unit, 
      
    cast(null as string)
 as valid_from, 
      
    cast(null as string)
 as valid_to, 
      
    cast(null as string)
 as num_of_emp_in_us, 
      
    cast(null as string)
 as s1q1a, 
      
    cast(null as string)
 as s1q1b, 
      
    cast(null as string)
 as ben_education_code, 
      
    cast(null as string)
 as ed_level_definition, 
      
    cast(null as string)
 as ben_pfield_of_study, 
      
    cast(null as string)
 as ben_comp_paid, 
      
    cast(null as string)
 as dot_code, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as s3q1, 
      
    cast(null as string)
 as s4q1, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:42:57.358033 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a39d6f42-4f07-4b5f-810b-f4100b88ed9c&page=queryresults
[0m22:42:57.443510 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:42:57.446419 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m22:42:57.447870 [debug] [Thread-2 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
        
  (
    employer_name string,
    ben_year_of_birth string,
    gender string,
    agent_first_name string,
    agent_last_name string,
    mail_addr string,
    country_of_birth string,
    country_of_nationality string,
    fein string,
    city string,
    state string,
    zip string,
    lottery_year string,
    status_type string,
    ben_multi_reg_ind string,
    rec_date string,
    first_decision string,
    first_decision_date string,
    i129_employer_name string,
    pet_street string,
    pet_city string,
    pet_state string,
    pet_zip string,
    requested_class string,
    basis_for_classification string,
    requested_action string,
    number_of_beneficiaries string,
    ben_sex string,
    ben_country_of_birth string,
    ben_current_class string,
    job_title string,
    worksite_street string,
    worksite_city string,
    worksite_state string,
    worksite_zip string,
    full_time_ind string,
    wage_amt string,
    wage_unit string,
    valid_from string,
    valid_to string,
    num_of_emp_in_us string,
    s1q1a string,
    s1q1b string,
    ben_education_code string,
    ed_level_definition string,
    ben_pfield_of_study string,
    ben_comp_paid string,
    dot_code string,
    naics_code string,
    s3q1 string,
    s4q1 string,
    _data_source string,
    _load_time datetime,
    
    primary key (employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr, country_of_birth, country_of_nationality, fein, city, state, zip, lottery_year, status_type, ben_multi_reg_ind, rec_date, first_decision, first_decision_date, i129_employer_name, pet_street, pet_city, pet_state, pet_zip, requested_class, basis_for_classification, requested_action, number_of_beneficiaries, ben_sex, ben_country_of_birth, ben_current_class, job_title, worksite_street, worksite_city, worksite_state, worksite_zip, full_time_ind, wage_amt, wage_unit, valid_from, valid_to, num_of_emp_in_us, s1q1a, s1q1b, ben_education_code, ed_level_definition, ben_pfield_of_study, ben_comp_paid, dot_code, naics_code, s3q1, s4q1, _data_source, _load_time
    from (
        with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
    ) as model_subq
    );
  
[0m22:42:57.764039 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f3e2cf67-1c44-4ee8-94a9-dfce119bf489&page=queryresults
[0m22:43:01.713803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fa86e4d0>]}
[0m22:43:01.715133 [info ] [Thread-1 (]: 14 of 31 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ........... [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 12.36s]
[0m22:43:01.716271 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m22:43:01.717054 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Wage_Summary
[0m22:43:01.717871 [info ] [Thread-1 (]: 16 of 31 START sql table model dbt_cs329e_xh_int.Wage_Summary .................. [RUN]
[0m22:43:01.719248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Wage_Summary)
[0m22:43:01.720260 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m22:43:01.725591 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m22:43:01.726750 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m22:43:01.731445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:01.891882 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: select * from (
        with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:43:02.263790 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fd160e8b-1a38-485e-9c60-374650ffb671&page=queryresults
[0m22:43:02.387056 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: select * from (
        select
    
      
    cast(null as string)
 as company_name, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as int64)
 as min_wage, 
      
    cast(null as int64)
 as max_wage, 
      
    cast(null as float64)
 as average_wage, 
      
    cast(null as int64)
 as job_count, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:43:02.753566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a12878ac-babe-4628-a3ea-a61dc96c851c&page=queryresults
[0m22:43:02.860763 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:43:02.863489 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m22:43:02.865198 [debug] [Thread-1 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
        
  (
    company_name string,
    job_title string,
    min_wage int64,
    max_wage int64,
    average_wage float64,
    job_count int64,
    _data_source string,
    _load_time datetime,
    
    primary key (company_name, job_title) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select company_name, job_title, min_wage, max_wage, average_wage, job_count, _data_source, _load_time
    from (
        with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    ) as model_subq
    );
  
[0m22:43:03.087529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5126926a-5007-4886-9bd7-974ecca4c5d3&page=queryresults
[0m22:43:05.320988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f8405d20>]}
[0m22:43:05.322340 [info ] [Thread-1 (]: 16 of 31 OK created sql table model dbt_cs329e_xh_int.Wage_Summary ............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 3.60s]
[0m22:43:05.323646 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m22:43:05.324446 [debug] [Thread-1 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m22:43:05.325533 [info ] [Thread-1 (]: 17 of 31 START sql table model dbt_cs329e_xh_int.PW_Disclosure ................. [RUN]
[0m22:43:05.326566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.PW_Disclosure)
[0m22:43:05.327192 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m22:43:05.332963 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m22:43:05.333981 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m22:43:05.337843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:05.470270 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m22:43:05.471721 [debug] [Thread-1 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m22:43:05.737444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b9a3cd65-96f1-4f47-b93f-25a8d5455dc2&page=queryresults
[0m22:43:05.803349 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381694fac0>]}
[0m22:43:05.805248 [info ] [Thread-2 (]: 15 of 31 OK created sql table model dbt_cs329e_xh_int.Single_Registration ...... [[32mCREATE TABLE (237.8k rows, 75.7 MiB processed)[0m in 9.38s]
[0m22:43:05.807144 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Single_Registration
[0m22:43:05.807978 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_emp
[0m22:43:05.809152 [info ] [Thread-2 (]: 18 of 31 START sql table model dbt_cs329e_xh_int.temp_emp ...................... [RUN]
[0m22:43:05.810335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.temp_emp)
[0m22:43:05.810981 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_emp
[0m22:43:05.817838 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m22:43:05.823435 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_emp
[0m22:43:05.830770 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m22:43:05.832439 [debug] [Thread-2 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw),
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m22:43:05.834088 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:06.158853 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a3049887-d3a5-40f7-ba8a-4a8bfd2d97b1&page=queryresults
[0m22:43:09.287381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381694fac0>]}
[0m22:43:09.289156 [info ] [Thread-2 (]: 18 of 31 OK created sql table model dbt_cs329e_xh_int.temp_emp ................. [[32mCREATE TABLE (90.2k rows, 19.9 MiB processed)[0m in 3.48s]
[0m22:43:09.290856 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_emp
[0m22:43:09.291992 [debug] [Thread-2 (]: Began running node model.cs329e_xh.approval_rate_by_month
[0m22:43:09.293733 [info ] [Thread-2 (]: 19 of 31 START sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ........ [RUN]
[0m22:43:09.295150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.approval_rate_by_month)
[0m22:43:09.296204 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.approval_rate_by_month
[0m22:43:09.303234 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.approval_rate_by_month"
[0m22:43:09.304245 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.approval_rate_by_month
[0m22:43:09.308663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:09.449421 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.approval_rate_by_month"
[0m22:43:09.450726 [debug] [Thread-2 (]: On model.cs329e_xh.approval_rate_by_month: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.approval_rate_by_month"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`approval_rate_by_month`
      
    
    

    OPTIONS()
    as (
      WITH monthly_windows AS (
    SELECT 
        EXTRACT (YEAR FROM publication_date) AS year,
        EXTRACT(MONTH FROM publication_date) AS month,
        MAX(publication_date) AS latest_date
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
    GROUP BY year, month
),
approval_rate_monthly AS (

    SELECT 
        EXTRACT(YEAR FROM decision_date) AS year,
        EXTRACT(MONTH FROM decision_date) AS month,
        COUNT(CASE WHEN case_status = 'Certified' THEN 1 END) AS approved_count,
        COUNT(CASE WHEN case_status != 'Certified' THEN 1 END) AS denied_count,
        COUNT(*) AS total_applications
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    WHERE decision_date IS NOT NULL
    GROUP BY year, month
)
SELECT 
    a.month,
    m.latest_date,
    a.approved_count,
    a.denied_count,
    a.total_applications,
    ROUND(100.0 * a.approved_count / a.total_applications, 2) AS approval_rate
FROM approval_rate_monthly a
LEFT JOIN monthly_windows m
    ON a.month = m.month
ORDER BY a.month
    );
  
[0m22:43:09.795484 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e02caa1b-ff9c-4d46-bdd1-b74181181a22&page=queryresults
[0m22:43:12.039858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fb071810>]}
[0m22:43:12.041165 [info ] [Thread-2 (]: 19 of 31 OK created sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ... [[32mCREATE TABLE (12.0 rows, 10.5 MiB processed)[0m in 2.74s]
[0m22:43:12.042387 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.approval_rate_by_month
[0m22:43:12.043194 [debug] [Thread-2 (]: Began running node model.cs329e_xh.city_approval_rate
[0m22:43:12.044416 [info ] [Thread-2 (]: 20 of 31 START sql table model dbt_cs329e_xh_mrt.city_approval_rate ............ [RUN]
[0m22:43:12.045367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.approval_rate_by_month, now model.cs329e_xh.city_approval_rate)
[0m22:43:12.046207 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.city_approval_rate
[0m22:43:12.052391 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.city_approval_rate"
[0m22:43:12.053675 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.city_approval_rate
[0m22:43:12.057863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:12.188848 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.city_approval_rate"
[0m22:43:12.190230 [debug] [Thread-2 (]: On model.cs329e_xh.city_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.city_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`city_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_city AS city,
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_city, lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m22:43:12.535085 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:75a8adbf-bba5-4b33-ba24-18715b80110b&page=queryresults
[0m22:43:15.694735 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f81af3d0>]}
[0m22:43:15.695916 [info ] [Thread-2 (]: 20 of 31 OK created sql table model dbt_cs329e_xh_mrt.city_approval_rate ....... [[32mCREATE TABLE (20.1k rows, 50.1 MiB processed)[0m in 3.65s]
[0m22:43:15.697002 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.city_approval_rate
[0m22:43:15.697866 [debug] [Thread-2 (]: Began running node model.cs329e_xh.major_wage_level
[0m22:43:15.698807 [info ] [Thread-2 (]: 21 of 31 START sql table model dbt_cs329e_xh_mrt.major_wage_level .............. [RUN]
[0m22:43:15.700753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.city_approval_rate, now model.cs329e_xh.major_wage_level)
[0m22:43:15.703127 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.major_wage_level
[0m22:43:15.708516 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.major_wage_level"
[0m22:43:15.709617 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.major_wage_level
[0m22:43:15.714124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:15.841043 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.major_wage_level"
[0m22:43:15.842275 [debug] [Thread-2 (]: On model.cs329e_xh.major_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.major_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`major_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH salary_by_field AS (
    SELECT 
        a.appx_a_field_of_study AS field_of_study,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE a.appx_a_field_of_study IS NOT NULL
)

SELECT 
    field_of_study,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM salary_by_field
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY field_of_study, wage_unit_of_pay
ORDER BY field_of_study, wage_unit_of_pay
    );
  
[0m22:43:16.150092 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:560b3134-f4e3-47cc-bab1-17be60244be7&page=queryresults
[0m22:43:18.389503 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f8195180>]}
[0m22:43:18.390836 [info ] [Thread-2 (]: 21 of 31 OK created sql table model dbt_cs329e_xh_mrt.major_wage_level ......... [[32mCREATE TABLE (87.0 rows, 19.6 MiB processed)[0m in 2.69s]
[0m22:43:18.392438 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.major_wage_level
[0m22:43:18.393201 [debug] [Thread-2 (]: Began running node model.cs329e_xh.soc_wage_level
[0m22:43:18.394066 [info ] [Thread-2 (]: 22 of 31 START sql table model dbt_cs329e_xh_mrt.soc_wage_level ................ [RUN]
[0m22:43:18.395342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.major_wage_level, now model.cs329e_xh.soc_wage_level)
[0m22:43:18.395970 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.soc_wage_level
[0m22:43:18.401551 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.soc_wage_level"
[0m22:43:18.402743 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.soc_wage_level
[0m22:43:18.406912 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:18.533574 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.soc_wage_level"
[0m22:43:18.534873 [debug] [Thread-2 (]: On model.cs329e_xh.soc_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.soc_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`soc_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH job_salary AS (
    SELECT 
        l.soc_code,
        l.soc_title,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE l.soc_code IS NOT NULL AND l.soc_title IS NOT NULL
)

SELECT 
    soc_code,
    soc_title,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM job_salary
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY soc_code, soc_title, wage_unit_of_pay
ORDER BY avg_wage_from DESC
    );
  
[0m22:43:18.884009 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3424cfba-4f59-4121-8954-e3b88a11a05e&page=queryresults
[0m22:43:20.799387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f8148f40>]}
[0m22:43:20.800646 [info ] [Thread-1 (]: 17 of 31 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............ [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 15.47s]
[0m22:43:20.802227 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m22:43:20.803067 [debug] [Thread-1 (]: Began running node model.cs329e_xh.state_approval_rate
[0m22:43:20.804091 [info ] [Thread-1 (]: 23 of 31 START sql table model dbt_cs329e_xh_mrt.state_approval_rate ........... [RUN]
[0m22:43:20.805171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.state_approval_rate)
[0m22:43:20.805793 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.state_approval_rate
[0m22:43:20.810999 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.state_approval_rate"
[0m22:43:20.812027 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.state_approval_rate
[0m22:43:20.816243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:20.946415 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.state_approval_rate"
[0m22:43:20.947616 [debug] [Thread-1 (]: On model.cs329e_xh.state_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m22:43:21.166462 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f81b7fd0>]}
[0m22:43:21.167715 [info ] [Thread-2 (]: 22 of 31 OK created sql table model dbt_cs329e_xh_mrt.soc_wage_level ........... [[32mCREATE TABLE (55.0 rows, 41.3 MiB processed)[0m in 2.77s]
[0m22:43:21.168844 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.soc_wage_level
[0m22:43:21.169865 [debug] [Thread-2 (]: Began running node model.cs329e_xh.state_wage_level
[0m22:43:21.170888 [info ] [Thread-2 (]: 24 of 31 START sql table model dbt_cs329e_xh_mrt.state_wage_level .............. [RUN]
[0m22:43:21.171928 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.soc_wage_level, now model.cs329e_xh.state_wage_level)
[0m22:43:21.172579 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.state_wage_level
[0m22:43:21.177704 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.state_wage_level"
[0m22:43:21.178750 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.state_wage_level
[0m22:43:21.182730 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:21.304148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ca08744e-458c-468e-9105-cf7dd53d397b&page=queryresults
[0m22:43:21.501829 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.state_wage_level"
[0m22:43:21.503144 [debug] [Thread-2 (]: On model.cs329e_xh.state_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_wage_level`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  ROUND(AVG(ld.prevailing_wage), 2) AS avg_wage,
  ROUND(MAX(ld.prevailing_wage), 2) AS max_wage,
  ROUND(MIN(ld.prevailing_wage), 2) AS min_wage,
  COUNT(ld.case_number) AS total_cases
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
WHERE ld.prevailing_wage IS NOT NULL
AND LOWER(ld.pw_unit_of_pay) != 'hour'  -- Exclude hourly wage records
GROUP BY lw.worksite_state
ORDER BY avg_wage DESC
    );
  
[0m22:43:21.770036 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6718b9da-43f2-45dd-85fe-5235663ba511&page=queryresults
[0m22:43:24.446694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fb56ba90>]}
[0m22:43:24.625811 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f8163100>]}
[0m22:43:24.792063 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m22:43:24.793237 [info ] [Thread-2 (]: 24 of 31 OK created sql table model dbt_cs329e_xh_mrt.state_wage_level ......... [[32mCREATE TABLE (55.0 rows, 42.8 MiB processed)[0m in 3.45s]
[0m22:43:24.794910 [info ] [Thread-1 (]: 23 of 31 OK created sql table model dbt_cs329e_xh_mrt.state_approval_rate ...... [[32mCREATE TABLE (55.0 rows, 41.5 MiB processed)[0m in 3.64s]
[0m22:43:24.796165 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.state_wage_level
[0m22:43:24.797169 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.state_approval_rate
[0m22:43:24.798114 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m22:43:24.799632 [info ] [Thread-2 (]: 25 of 31 START sql table model dbt_cs329e_xh_int.temp_employer_details ......... [RUN]
[0m22:43:24.800792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_wage_level, now model.cs329e_xh.temp_employer_details)
[0m22:43:24.801461 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m22:43:24.806751 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m22:43:24.807768 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_employer_details
[0m22:43:24.814224 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_employer_details"
[0m22:43:24.815364 [debug] [Thread-2 (]: On model.cs329e_xh.temp_employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_employer_details`
      
    
    

    OPTIONS()
    as (
      WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp` as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched
    );
  
[0m22:43:24.816102 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:25.124534 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:cb44a925-b652-4129-b35b-1af804d2583c&page=queryresults
[0m22:43:29.839730 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f8045900>]}
[0m22:43:29.841247 [info ] [Thread-2 (]: 25 of 31 OK created sql table model dbt_cs329e_xh_int.temp_employer_details .... [[32mCREATE TABLE (589.3k rows, 4.9 MiB processed)[0m in 5.04s]
[0m22:43:29.842646 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m22:43:29.844267 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m22:43:29.845263 [info ] [Thread-1 (]: 26 of 31 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m22:43:29.846218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_approval_rate, now model.cs329e_xh.matching)
[0m22:43:29.846896 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m22:43:29.880824 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m22:43:29.881984 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m22:43:29.895955 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m22:43:29.897539 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


import pandas as pd
import os
import json
#from google.oauth2 import service_account
#import json
#import vertexai
#from vertexai.generative_models import GenerativeModel
service_account_info = {
  "type": "service_account",
  "project_id": "silken-fortress-448205-p9",
  "private_key_id": "71d77d1a2073bafb0db6992cdad7614a88a21bdc",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQClBzwnVW9yrimb\npB0X8ELIvXkaJfNWlUJM8HB+JvUhPcyKH1/vnTlAm+kJkbvNr4xQBCFdDkJri+2y\nIEdCCaPN7eUxrL5E5zYE5SXlMqw5eAj7Xlngb2s3CdlBfuM/oN2Rro4AhrKGpLlG\n8GjxNRUxwFoXulIJ4jxIfuWLyUgTFS6t+2I8BaMtpP31XzV4tKU/mwfLVAwMwrUT\nuWgVyC+nJico3h0Ymr7YkEMqjnVTmgzupnssRTyCSmnnXwTrwzOig5Z0pRIIVtGD\nOnpfuTSdPFip/e74BqCoysTXe8HaUfamp6Rbm4o67GgZVzhN2AwNimIA7jnIaLvq\nkrh+Gp/TAgMBAAECggEADKJwqwxB85Q88EMQzSfiXQ8Qif1002CrCkvwOOBPrSNX\nmQ2M4UH2w6kMHuTu7XDuu6ONUFwKnsRARv5spjQpu9bmULbKfGj9PEO08oa+I8o6\nWdBf7ixpl3WkEf0edd0hiYlFKuolGeTboIBAcJMhU8VHwIBNzp7pAZ3hgiG/aGJ7\nxIOigdLUyNR6D/piKok/EFiuAQx5biZ7OdwdV0+SYo1deiV5urH9/SXE4wxAPlIJ\nGz21qdicyDmC4zEeVDhHqDU6dLP+UW3TYEDB1VwIRRwxHPh7eQGTiiM9Pmb74U7B\n2kPDN1mWQT5eq4+nMRl/HeXz4JZ4yGFwbaxgFDHTRQKBgQDYOXqMqG6SdkypEMH8\new4Ibo8jaXHkcXk5MfHCIzPXxMdvbXlFr31H5ulSzt4D7nIW/eNdSqSSxax4ZI4q\nzc/QZVpHKR5SUuV5xyL+fAorvwQVEoy7WscXIxE+JLaCpUYWCUHHe6M3VC0vG8eF\nqDTLa+olP00G/ZC3vB/X8OpztwKBgQDDYs3GBGGW3moEGlesTagp4tcrSl0Xh0qJ\nQfag84ceZvzH1CRHub4/zuSy1e31vbcN1HRlQeqcrwE5sinVEvm/AGaT/7YLbbME\naajqhf1fFkTNzOHcHPPLJoevLTXWNzu6MdA3yhD8wqSYBXqJW5iT9GeW6L7MJRBa\njhKp09UMxQKBgQCJY2xU96jac0SeoEFCVkZCYU2eKJ/vkZJ/HxcITingze4TBTJr\nbuhhyX0z2rIDOX1Q0p2nZ4hOoj/Gd85FsGR9fAjy8lOL55Rb3oaDwPkNdt/3K8Q0\nP6gFMYkBPX6iYLW5xsP/JrY8r8XOCw6qBIkXQEiUxjYBXRiZRnXNVg0C3QKBgQC3\nbYytN/O+RXPWAj0Iv6b+G73RIHEg45xwG4NEOxxAyILLvzeINrKLCNrfocNSjxbJ\nXwke/rEZA5rs5XwsUzIvxFqI2um29Pe5TtCLy9rAaBGT+6KWmH+v2q5LIPCH+TaT\naKyHk6Y7BSisp4gQZ/NoA2002bA1yx39RZ/z27EJ2QKBgBVqwuio4R70L6g3bP6u\n+/R25uFNFJs4xRYa2Vz7smLrcqnhu58CdO+Z3eq6Hg4Y/z9PCXN+3J6yOu+RfkuS\nKqLAPjAvh25G8WRlKNFnSSggiaWcpJkfNW7VY56qMjWGCjrGWxt0n5OBUKCHYNYO\n0ZkQ9KkdQESzZ33WkYGKGoN3\n-----END PRIVATE KEY-----\n",
  "client_email": "auth1-970@silken-fortress-448205-p9.iam.gserviceaccount.com",
  "client_id": "106644715728790824750",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/auth1-970%40silken-fortress-448205-p9.iam.gserviceaccount.com",
  "universe_domain": "googleapis.com"
}
credentials = service_account.Credentials.from_service_account_info(service_account_info)
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    '''
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })

    json_result = json.dumps(result, indent=4, ensure_ascii=False)
    region = "us-central1"
    model_name = "gemini-2.0-flash-001"
    vertexai.init(project=project_id, location=region)
    model = GenerativeModel(model_name)
    data = json_result

    # Prepare Prompt
    prompt = """Here is a list of company names and candidate company names with FEINs.
    Match each original name to the most appropriate candidate based on similarity.
    Return a JSON object per line with the following fields:
    - tax_id
    - original_name
    - matched_candidate_name
    - matched_fein
    Return only one match per original_name. If no match is found, return null for matched_candidate_name and matched_fein.
    Do not return explanations.
    """

    # Set batch size
    batch_size = 5  

    # Prepare Batches
    records = []
    record_counter = 0
    batches = []
    for entry in data:
        tax_id = entry.get("tax_id", "Unknown")
        original_names = entry.get("original_names", [])
        candidate_name_fein = entry.get("candidate_name_fein", [])

        for original_name in original_names:
            candidate_str = "\n".join([f"{list(c.keys())[0]}: {list(c.values())[0]}" for c in candidate_name_fein])
            record = f"tax_id: {tax_id}\noriginal_name: {original_name}\ncandidates:\n{candidate_str}"
            records.append(record)
            record_counter += 1

            if record_counter == batch_size:
                batches.append("\n---\n".join(records))
                records = []
                record_counter = 0

    if records:
        batches.append("\n---\n".join(records))

    print(f"{len(batches)} total batches will be sent to Gemini.")

    # Function to send batch to Gemini with retry on API limit
    def send_batch_to_gemini(batch_data):
        max_retries = 5
        wait_time = 5  

        for attempt in range(max_retries):
            try:
                resp = model.generate_content([batch_data, prompt])
                resp_text = resp.text.replace("```json", "").replace("```", "")
                json_lines = resp_text.strip().split("\n")
                results = []
                for line in json_lines:
                    if line:
                        try:
                            results.append(json.loads(line))
                        except Exception as e:
                            print(f"Error converting line to JSON: {line}, Error: {e}")
                return results  
            except Exception as e:
                if "Resource exhausted" in str(e):  
                    print(f"API Limit Exceeded. Waiting {wait_time} seconds before retrying. Attempt {attempt+1} of {max_retries}.")
                    time.sleep(wait_time)  
                    wait_time *= 2  
                else:
                    print(f"API Error: {e}")
                    return []  

        print("Max retries reached. Skipping batch.")
        return []  

    # Process all batches with retry mechanism
    all_results = []
    for i, batch in enumerate(batches):
        print(f"Processing batch {i + 1} of {len(batches)}.")
        batch_results = send_batch_to_gemini(batch)
        all_results.extend(batch_results)
        time.sleep(1)  

    # Convert to DataFrame
    df_final = pd.DataFrame(all_results)

    # Remove duplicates
    df_final.drop_duplicates(subset=["tax_id", "original_name", "matched_candidate_name", "matched_fein"], inplace=True)
    matching = df_final

    '''
    
    matching = session.read_csv("gs://cs329e-h1b-project/matched_results_full.csv")
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "silken-fortress-448205-p9.dbt_cs329e_xh_int.temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m22:43:29.918016 [debug] [Thread-1 (]: BigQuery adapter: Submitting batch job with id: 29153501-7f31-47f2-8698-f0ef359393b7
[0m22:47:52.228462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:52.230368 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
409 Job failed with message [NameError: name 'service_account' is not defined. Did you mean: 'service_account_info'?]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/29153501-7f31-47f2-8698-f0ef359393b7?project=silken-fortress-448205-p9
gcloud dataproc batches wait '29153501-7f31-47f2-8698-f0ef359393b7' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/driveroutput.* 10: Job failed with message [NameError: name 'service_account' is not defined. Did you mean: 'service_account_info'?]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/29153501-7f31-47f2-8698-f0ef359393b7?project=silken-fortress-448205-p9
gcloud dataproc batches wait '29153501-7f31-47f2-8698-f0ef359393b7' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/driveroutput.*
[0m22:47:52.238564 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1683, in submit_python_job
    submission_result = job_helper.submit(compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 120, in submit
    response: Batch = operation.result(polling=self._polling_retry)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Aborted: 409 Job failed with message [NameError: name 'service_account' is not defined. Did you mean: 'service_account_info'?]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/29153501-7f31-47f2-8698-f0ef359393b7?project=silken-fortress-448205-p9
gcloud dataproc batches wait '29153501-7f31-47f2-8698-f0ef359393b7' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/driveroutput.* 10: Job failed with message [NameError: name 'service_account' is not defined. Did you mean: 'service_account_info'?]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/29153501-7f31-47f2-8698-f0ef359393b7?project=silken-fortress-448205-p9
gcloud dataproc batches wait '29153501-7f31-47f2-8698-f0ef359393b7' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/driveroutput.*

[0m22:47:52.240014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b2431d-0058-40fd-a828-a4b608730f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f807fd00>]}
[0m22:47:52.241201 [error] [Thread-1 (]: 26 of 31 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 262.39s]
[0m22:47:52.242482 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m22:47:52.243494 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: 409 Job failed with message [NameError: name 'service_account' is not defined. Did you mean: 'service_account_info'?]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/29153501-7f31-47f2-8698-f0ef359393b7?project=silken-fortress-448205-p9
gcloud dataproc batches wait '29153501-7f31-47f2-8698-f0ef359393b7' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/driveroutput.* 10: Job failed with message [NameError: name 'service_account' is not defined. Did you mean: 'service_account_info'?]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/29153501-7f31-47f2-8698-f0ef359393b7?project=silken-fortress-448205-p9
gcloud dataproc batches wait '29153501-7f31-47f2-8698-f0ef359393b7' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/driveroutput.*.
[0m22:47:52.245565 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m22:47:52.246562 [info ] [Thread-2 (]: 27 of 31 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m22:47:52.247419 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m22:47:52.249696 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_approval_rate
[0m22:47:52.250441 [debug] [Thread-2 (]: Began running node model.cs329e_xh.company_wage_level
[0m22:47:52.251452 [info ] [Thread-1 (]: 28 of 31 SKIP relation dbt_cs329e_xh_mrt.company_approval_rate ................. [[33mSKIP[0m]
[0m22:47:52.252565 [info ] [Thread-2 (]: 29 of 31 SKIP relation dbt_cs329e_xh_mrt.company_wage_level .................... [[33mSKIP[0m]
[0m22:47:52.253488 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_approval_rate
[0m22:47:52.254307 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.company_wage_level
[0m22:47:52.255072 [debug] [Thread-1 (]: Began running node model.cs329e_xh.industry_approval_rate
[0m22:47:52.256022 [debug] [Thread-2 (]: Began running node model.cs329e_xh.wage_level_by_industry
[0m22:47:52.256983 [info ] [Thread-1 (]: 30 of 31 SKIP relation dbt_cs329e_xh_mrt.industry_approval_rate ................ [[33mSKIP[0m]
[0m22:47:52.257905 [info ] [Thread-2 (]: 31 of 31 SKIP relation dbt_cs329e_xh_mrt.wage_level_by_industry ................ [[33mSKIP[0m]
[0m22:47:52.258902 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.industry_approval_rate
[0m22:47:52.259740 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.wage_level_by_industry
[0m22:47:52.262499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:52.263593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:52.264138 [debug] [MainThread]: Connection 'model.cs329e_xh.temp_employer_details' was properly closed.
[0m22:47:52.264646 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m22:47:52.265443 [info ] [MainThread]: 
[0m22:47:52.266192 [info ] [MainThread]: Finished running 31 table models in 0 hours 5 minutes and 36.21 seconds (336.21s).
[0m22:47:52.272854 [debug] [MainThread]: Command end result
[0m22:47:52.335315 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m22:47:52.338431 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m22:47:52.349594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m22:47:52.350349 [info ] [MainThread]: 
[0m22:47:52.351100 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:47:52.351935 [info ] [MainThread]: 
[0m22:47:52.352711 [error] [MainThread]:   409 Job failed with message [NameError: name 'service_account' is not defined. Did you mean: 'service_account_info'?]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/29153501-7f31-47f2-8698-f0ef359393b7?project=silken-fortress-448205-p9
gcloud dataproc batches wait '29153501-7f31-47f2-8698-f0ef359393b7' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/driveroutput.* 10: Job failed with message [NameError: name 'service_account' is not defined. Did you mean: 'service_account_info'?]. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/29153501-7f31-47f2-8698-f0ef359393b7?project=silken-fortress-448205-p9
gcloud dataproc batches wait '29153501-7f31-47f2-8698-f0ef359393b7' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/9b6fdbdd-fcdc-4a1c-a624-02497aa5285c/jobs/srvls-batch-45e4b266-9ada-4e5e-9690-03062d6799c8/driveroutput.*
[0m22:47:52.353595 [info ] [MainThread]: 
[0m22:47:52.354234 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=1 SKIP=5 TOTAL=31
[0m22:47:52.355307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 339.76224, "process_in_blocks": "192", "process_kernel_time": 0.638425, "process_mem_max_rss": "284888", "process_out_blocks": "5272", "process_user_time": 7.368035}
[0m22:47:52.355980 [debug] [MainThread]: Command `dbt run` failed at 22:47:52.355839 after 339.76 seconds
[0m22:47:52.356655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38172a14e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381753ace0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38178b8940>]}
[0m22:47:52.357304 [debug] [MainThread]: Flushing usage events
[0m22:47:52.717322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:16.954824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03650bd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036426a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036426a380>]}


============================== 22:53:16.959076 | 07df4b8a-85b1-4c7b-bcf8-57f39d942f66 ==============================
[0m22:53:16.959076 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:53:16.960941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jupyter/cs329e_xh/logs', 'profiles_dir': '/home/jupyter/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:18.966255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036489df00>]}
[0m22:53:19.067674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0349929bd0>]}
[0m22:53:19.068854 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:53:19.263166 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:53:19.565213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:53:19.566517 [debug] [MainThread]: Partial parsing: added file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m22:53:19.567506 [debug] [MainThread]: Partial parsing: updated file: cs329e_xh://models/int/Employer_Details/matching.py
[0m22:53:20.091240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348ef5a20>]}
[0m22:53:20.304985 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m22:53:20.308046 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m22:53:20.336077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348e1f790>]}
[0m22:53:20.337079 [info ] [MainThread]: Found 32 models, 1 seed, 25 data tests, 19 sources, 494 macros
[0m22:53:20.337849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348e1ff10>]}
[0m22:53:20.343258 [info ] [MainThread]: 
[0m22:53:20.344279 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:53:20.345085 [info ] [MainThread]: 
[0m22:53:20.346121 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:53:20.357258 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m22:53:20.358110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:20.361225 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m22:53:20.363266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:20.679075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:20.960589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m22:53:20.961979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m22:53:20.962810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:20.963765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:21.092615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m22:53:21.093433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:21.119626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m22:53:21.120518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:21.250643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348f592d0>]}
[0m22:53:21.251636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:21.256491 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_data
[0m22:53:21.257430 [debug] [Thread-2 (]: Began running node model.cs329e_xh.employer_details
[0m22:53:21.258650 [info ] [Thread-1 (]: 1 of 32 START sql table model dbt_cs329e_xh_stg.company_data ................... [RUN]
[0m22:53:21.259990 [info ] [Thread-2 (]: 2 of 32 START sql table model dbt_cs329e_xh_stg.employer_details ............... [RUN]
[0m22:53:21.261359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now model.cs329e_xh.company_data)
[0m22:53:21.262738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now model.cs329e_xh.employer_details)
[0m22:53:21.263586 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_data
[0m22:53:21.264356 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.employer_details
[0m22:53:21.285227 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_data"
[0m22:53:21.286479 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.employer_details"
[0m22:53:21.287794 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.employer_details
[0m22:53:21.306483 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_data
[0m22:53:21.326326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:21.335286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:21.523197 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_data"
[0m22:53:21.524675 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.employer_details"
[0m22:53:21.525774 [debug] [Thread-1 (]: On model.cs329e_xh.company_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
      
    
    

    OPTIONS()
    as (
      
with stg_company_data as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`company_data`
)
select * from stg_company_data
    );
  
[0m22:53:21.529735 [debug] [Thread-2 (]: On model.cs329e_xh.employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details`
      
    
    

    OPTIONS()
    as (
      
with stg_employer_details_1 as (
select
    * except (`tax id`,`line by line` ),
    lpad(cast(cast(`tax id` as int64) as string), 4, '0') as tax_id,
    CAST(REPLACE(`line by line`, ',', '') AS INT64) AS employer_no
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`employer_details`
),
stg_employer_details as (
    select
    employer_no,
    `fiscal year   ` as fiscal_year,
    `employer petitioner name` as employer_petitioner_name,
    tax_id as tax_id,
    `industry naics code` as naics_code,
    `petitioner city` as petitioner_city,
    `petitioner state` as petitioner_state,
    `petitioner zip code` as petitioner_zip_code,
    `initial approval` as initial_approval,
    `initial denial` as initial_denial,
    `continuing approval` as continuing_approval,
    `continuing denial` as continuing_denial,
    _data_source, _load_time
from stg_employer_details_1
) 
select * from stg_employer_details
    );
  
[0m22:53:21.882350 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:afdcb1c3-221f-44f2-a2b8-4a2beb5033f1&page=queryresults
[0m22:53:21.948473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4dcd32de-32a1-44a7-9d64-e6756f146482&page=queryresults
[0m22:53:23.937268 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03642dd8a0>]}
[0m22:53:23.938709 [info ] [Thread-2 (]: 2 of 32 OK created sql table model dbt_cs329e_xh_stg.employer_details .......... [[32mCREATE TABLE (61.5k rows, 9.3 MiB processed)[0m in 2.67s]
[0m22:53:23.942720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348c20400>]}
[0m22:53:23.943872 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.employer_details
[0m22:53:23.945244 [info ] [Thread-1 (]: 1 of 32 OK created sql table model dbt_cs329e_xh_stg.company_data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.68s]
[0m22:53:23.946771 [debug] [Thread-2 (]: Began running node model.cs329e_xh.h1b_sentiment_analysis
[0m22:53:23.948302 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_data
[0m22:53:23.950363 [info ] [Thread-2 (]: 3 of 32 START sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis ......... [RUN]
[0m22:53:23.952366 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_appendix
[0m22:53:23.954527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.employer_details, now model.cs329e_xh.h1b_sentiment_analysis)
[0m22:53:23.956239 [info ] [Thread-1 (]: 4 of 32 START sql table model dbt_cs329e_xh_stg.lca_appendix ................... [RUN]
[0m22:53:23.957647 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.h1b_sentiment_analysis
[0m22:53:23.958817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_data, now model.cs329e_xh.lca_appendix)
[0m22:53:23.964714 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m22:53:23.966085 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_appendix
[0m22:53:23.975870 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_appendix"
[0m22:53:23.977098 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.h1b_sentiment_analysis
[0m22:53:23.981515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:23.984552 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_appendix
[0m22:53:23.988887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:24.099793 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_appendix"
[0m22:53:24.101402 [debug] [Thread-1 (]: On model.cs329e_xh.lca_appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_appendix as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_appendix`
)
select * from stg_lca_appendix
    );
  
[0m22:53:24.176667 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m22:53:24.177990 [debug] [Thread-2 (]: On model.cs329e_xh.h1b_sentiment_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.h1b_sentiment_analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
      
    
    

    OPTIONS()
    as (
      
with stg_senti as (
select * 
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`h1b_sentiment_analysis`
)
select * from stg_senti
    );
  
[0m22:53:24.449218 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0c1b4411-1867-48fa-8bf0-a83678e4cd30&page=queryresults
[0m22:53:24.519884 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:17b88c8b-66a3-468b-8f63-9c1aa46c6ef2&page=queryresults
[0m22:53:26.187051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034826c1f0>]}
[0m22:53:26.188540 [info ] [Thread-1 (]: 4 of 32 OK created sql table model dbt_cs329e_xh_stg.lca_appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.23s]
[0m22:53:26.189738 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_appendix
[0m22:53:26.190952 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_disclosure
[0m22:53:26.192613 [info ] [Thread-1 (]: 5 of 32 START sql table model dbt_cs329e_xh_stg.lca_disclosure ................. [RUN]
[0m22:53:26.193549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_appendix, now model.cs329e_xh.lca_disclosure)
[0m22:53:26.194517 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_disclosure
[0m22:53:26.201158 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_disclosure"
[0m22:53:26.202331 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_disclosure
[0m22:53:26.211465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:26.357327 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_disclosure"
[0m22:53:26.358608 [debug] [Thread-1 (]: On model.cs329e_xh.lca_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
      
    
    

    OPTIONS()
    as (
      
with s as (
SELECT
    * EXCEPT (received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage, total_worksite_locations),
    SAFE_CAST(received_date AS DATETIME) AS received_date,
    SAFE_CAST(decision_date AS DATETIME) AS decision_date,
    SAFE_CAST(original_cert_date AS DATETIME) AS original_cert_date,
    
    SAFE_CAST(total_worker_positions AS INT64) AS total_worker_positions,
    SAFE_CAST(new_employment AS INT64) AS new_employment,
    SAFE_CAST(continued_employment AS INT64) AS continued_employment,
    SAFE_CAST(change_previous_employment AS INT64) AS change_previous_employment,
    SAFE_CAST(new_concurrent_employment AS INT64) AS new_concurrent_employment,
    SAFE_CAST(change_employer AS INT64) AS change_employer,
    SAFE_CAST(amended_petition AS INT64) AS amended_petition,
    SAFE_CAST(worksite_workers AS INT64) AS worksite_workers,
    SAFE_CAST(total_worksite_locations AS INT64) AS total_worksite_locations,

    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_from, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_from,
    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_to, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_to,
    SAFE_CAST(REGEXP_REPLACE(prevailing_wage, r'[\$,]', '') AS FLOAT64) AS prevailing_wage

FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_disclosure`
    )
select * from s
    );
  
[0m22:53:26.486394 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0341f8bd00>]}
[0m22:53:26.487910 [info ] [Thread-2 (]: 3 of 32 OK created sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis .... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.53s]
[0m22:53:26.489766 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.h1b_sentiment_analysis
[0m22:53:26.490639 [debug] [Thread-2 (]: Began running node model.cs329e_xh.lca_worksites
[0m22:53:26.491530 [info ] [Thread-2 (]: 6 of 32 START sql table model dbt_cs329e_xh_stg.lca_worksites .................. [RUN]
[0m22:53:26.492770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.h1b_sentiment_analysis, now model.cs329e_xh.lca_worksites)
[0m22:53:26.494489 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.lca_worksites
[0m22:53:26.659850 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.lca_worksites"
[0m22:53:26.660971 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.lca_worksites
[0m22:53:26.665330 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:26.724445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ab9b05d1-bf06-4460-8f66-fe86bcde768e&page=queryresults
[0m22:53:26.789248 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.lca_worksites"
[0m22:53:26.791087 [debug] [Thread-2 (]: On model.cs329e_xh.lca_worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_worksites as (
select * except(worksite_workers, pw_other_year),
        cast(worksite_workers as int64) as worksite_workers,
        cast(pw_other_year as int64) as pw_other_year
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_worksites`
)
select * from stg_lca_worksites
    );
  
[0m22:53:27.156601 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:599f09b3-dee4-4d7c-9367-fbd82961b3d2&page=queryresults
[0m22:53:32.639856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0341f8bd00>]}
[0m22:53:32.641080 [info ] [Thread-2 (]: 6 of 32 OK created sql table model dbt_cs329e_xh_stg.lca_worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 6.15s]
[0m22:53:32.642360 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.lca_worksites
[0m22:53:32.643415 [debug] [Thread-2 (]: Began running node model.cs329e_xh.pw_disclosure
[0m22:53:32.645277 [info ] [Thread-2 (]: 7 of 32 START sql table model dbt_cs329e_xh_stg.pw_disclosure .................. [RUN]
[0m22:53:32.647169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_worksites, now model.cs329e_xh.pw_disclosure)
[0m22:53:32.648120 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.pw_disclosure
[0m22:53:32.655012 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.pw_disclosure"
[0m22:53:32.656233 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.pw_disclosure
[0m22:53:32.660512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:32.774724 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.pw_disclosure"
[0m22:53:32.776037 [debug] [Thread-2 (]: On model.cs329e_xh.pw_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.pw_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
      
    
    

    OPTIONS()
    as (
      
with temp as (
select 
    * except(required_experience_months, required_training_months, alt_training_months, alt_experience_months),
    cast(required_training_months as int64) as required_training_months,
    cast(required_experience_months as int64) as required_experience_months,
    cast(alt_training_months as int64) as alt_training_months,
    cast(alt_experience_months as int64) as alt_experience_months
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`pw_disclosure`
),
stg_pw_disclosure as (
    select 
    * except(bls_area),
    SPLIT(bls_area, ',')[SAFE_OFFSET(0)] AS bls_city,
    IFNULL(SPLIT(bls_area, ',')[SAFE_OFFSET(1)], '') AS bls_state
from temp)
select * from stg_pw_disclosure
    );
  
[0m22:53:33.083661 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:020cfac1-b110-4ac8-abfb-4a563e4bb8ea&page=queryresults
[0m22:53:36.075906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348c20400>]}
[0m22:53:36.077175 [info ] [Thread-1 (]: 5 of 32 OK created sql table model dbt_cs329e_xh_stg.lca_disclosure ............ [[32mCREATE TABLE (561.0k rows, 485.1 MiB processed)[0m in 9.88s]
[0m22:53:36.078726 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_disclosure
[0m22:53:36.079514 [debug] [Thread-1 (]: Began running node model.cs329e_xh.single_registrations
[0m22:53:36.081083 [info ] [Thread-1 (]: 8 of 32 START sql table model dbt_cs329e_xh_stg.single_registrations ........... [RUN]
[0m22:53:36.082331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_disclosure, now model.cs329e_xh.single_registrations)
[0m22:53:36.083035 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.single_registrations
[0m22:53:36.089416 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.single_registrations"
[0m22:53:36.091356 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.single_registrations
[0m22:53:36.098110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:36.243116 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.single_registrations"
[0m22:53:36.244417 [debug] [Thread-1 (]: On model.cs329e_xh.single_registrations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.single_registrations"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
      
    
    

    OPTIONS()
    as (
      
with t1 as (
select
    case bcn when '(b)(6)' THEN NULL ELSE bcn END AS bcn,
    case receipt_number when '(b)(6)' THEN NULL ELSE receipt_number END AS receipt_number,
    case ben_date_of_birth when '(b)(6)' THEN NULL ELSE ben_date_of_birth END AS ben_date_of_birth,
    case dol_eta_case_number when '(b)(6)' THEN NULL ELSE dol_eta_case_number END AS dol_eta_case_number,
    *
EXCEPT (bcn, receipt_number, ben_date_of_birth, dol_eta_case_number)
FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`single_registrations`
WHERE bcn != '(b)(3) (b)(6) (b)(7)(c)'
)
, t2 as (select * except(bcn, receipt_number, ben_date_of_birth, dol_eta_case_number, t_u_vawa_flag)
FROM t1)
select * from t2
    );
  
[0m22:53:36.575593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:53d7b461-2414-4bb7-acaa-29acb305d5ed&page=queryresults
[0m22:53:42.063565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348ecda50>]}
[0m22:53:42.064796 [info ] [Thread-1 (]: 8 of 32 OK created sql table model dbt_cs329e_xh_stg.single_registrations ...... [[32mCREATE TABLE (350.1k rows, 78.4 MiB processed)[0m in 5.98s]
[0m22:53:42.065996 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.single_registrations
[0m22:53:42.067545 [debug] [Thread-1 (]: Began running node model.cs329e_xh.wage_summary
[0m22:53:42.069204 [info ] [Thread-1 (]: 9 of 32 START sql table model dbt_cs329e_xh_stg.wage_summary ................... [RUN]
[0m22:53:42.070585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.single_registrations, now model.cs329e_xh.wage_summary)
[0m22:53:42.071274 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.wage_summary
[0m22:53:42.077390 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.wage_summary"
[0m22:53:42.078580 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.wage_summary
[0m22:53:42.083635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:42.191679 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.wage_summary"
[0m22:53:42.192915 [debug] [Thread-1 (]: On model.cs329e_xh.wage_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
      
    
    

    OPTIONS()
    as (
      
with stg_wage_summary as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`wage_summary`
)
select * from stg_wage_summary
    );
  
[0m22:53:42.515149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:17264cd7-6e68-4f5c-8d6a-3f8be1ec5259&page=queryresults
[0m22:53:44.509408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348ecd840>]}
[0m22:53:44.510714 [info ] [Thread-1 (]: 9 of 32 OK created sql table model dbt_cs329e_xh_stg.wage_summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.44s]
[0m22:53:44.511904 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.wage_summary
[0m22:53:44.513075 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m22:53:44.514772 [info ] [Thread-1 (]: 10 of 32 START sql table model dbt_cs329e_xh_int.Company_Data .................. [RUN]
[0m22:53:44.515913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.wage_summary, now model.cs329e_xh.Company_Data)
[0m22:53:44.516604 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m22:53:44.521585 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m22:53:44.522823 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m22:53:44.527247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:44.676055 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:45.078424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ecf95e17-6f95-4ef3-a592-31127f6adca0&page=queryresults
[0m22:53:45.193891 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as int64)
 as count, 
      
    cast(null as string)
 as employer_url, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:45.487827 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bd3bafc4-699b-45e5-a432-2e8f5f94e009&page=queryresults
[0m22:53:45.638595 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:53:45.649629 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m22:53:45.650915 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
        
  (
    employer_name string primary key not enforced,
    count int64,
    employer_url string,
    _data_source string,
    _load_time datetime
    
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_name, count, employer_url, _data_source, _load_time
    from (
        with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    ) as model_subq
    );
  
[0m22:53:45.989632 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:358be2b9-5bb3-4407-ba48-814279903b5b&page=queryresults
[0m22:53:47.586611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348f09cc0>]}
[0m22:53:47.587857 [info ] [Thread-2 (]: 7 of 32 OK created sql table model dbt_cs329e_xh_stg.pw_disclosure ............. [[32mCREATE TABLE (237.9k rows, 372.8 MiB processed)[0m in 14.94s]
[0m22:53:47.588973 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.pw_disclosure
[0m22:53:47.589776 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m22:53:47.591778 [info ] [Thread-2 (]: 11 of 32 START sql table model dbt_cs329e_xh_int.LCA_Appendix .................. [RUN]
[0m22:53:47.592864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.pw_disclosure, now model.cs329e_xh.LCA_Appendix)
[0m22:53:47.593544 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m22:53:47.598647 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m22:53:47.599706 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m22:53:47.604185 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:47.735444 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:47.741880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348eea290>]}
[0m22:53:47.743169 [info ] [Thread-1 (]: 10 of 32 OK created sql table model dbt_cs329e_xh_int.Company_Data ............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 3.23s]
[0m22:53:47.744310 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m22:53:47.745336 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m22:53:47.746561 [info ] [Thread-1 (]: 12 of 32 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............ [RUN]
[0m22:53:47.747507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.Sentiment_Analysis)
[0m22:53:47.748191 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m22:53:47.753052 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m22:53:47.754125 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m22:53:47.758332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:47.891093 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:48.158528 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:f5f05251-782a-4d33-a817-41a6a687c53b&page=queryresults
[0m22:53:48.206516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b0893e9b-bb63-4928-9ad7-3f0c6b5e97bc&page=queryresults
[0m22:53:48.269002 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as datetime)
 as appx_a_date_of_degree, 
      
    cast(null as string)
 as appx_a_name_of_institution, 
      
    cast(null as int64)
 as appx_a_no_of_exempt_workers, 
      
    cast(null as string)
 as appx_a_field_of_study, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:48.318434 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        select
    
      
    cast(null as datetime)
 as publication_date, 
      
    cast(null as string)
 as text_summary, 
      
    cast(null as string)
 as sentiment, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:48.538843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fe670145-3d07-440d-915b-4eddbe77d724&page=queryresults
[0m22:53:48.546220 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:34e9150a-4c90-4dd5-98d3-37369207d735&page=queryresults
[0m22:53:48.655009 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:53:48.659994 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m22:53:48.661199 [debug] [Thread-1 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
        
  (
    publication_date datetime primary key not enforced,
    text_summary string,
    sentiment string,
    _data_source string,
    _load_time datetime
    
    )

      
    
    

    OPTIONS()
    as (
      
    select publication_date, text_summary, sentiment, _data_source, _load_time
    from (
        with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    ) as model_subq
    );
  
[0m22:53:48.681737 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:53:48.683992 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m22:53:48.685222 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
        
  (
    case_number string,
    appx_a_date_of_degree datetime,
    appx_a_name_of_institution string,
    appx_a_no_of_exempt_workers int64,
    appx_a_field_of_study string,
    _data_source string,
    _load_time datetime,
    
    primary key (case_number, appx_a_date_of_degree) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select case_number, appx_a_date_of_degree, appx_a_name_of_institution, appx_a_no_of_exempt_workers, appx_a_field_of_study, _data_source, _load_time
    from (
        with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    ) as model_subq
    );
  
[0m22:53:48.937913 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6d3763a9-95da-4250-975d-38dc2182c4d9&page=queryresults
[0m22:53:49.086797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eff4519b-057b-457e-b539-a279c9ee45d2&page=queryresults
[0m22:53:50.929101 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03647343d0>]}
[0m22:53:50.930506 [info ] [Thread-2 (]: 11 of 32 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix ............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 3.34s]
[0m22:53:50.933174 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m22:53:50.934557 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m22:53:50.936252 [info ] [Thread-2 (]: 13 of 32 START sql table model dbt_cs329e_xh_int.LCA_Worksites ................. [RUN]
[0m22:53:50.941058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Worksites)
[0m22:53:50.942596 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m22:53:50.948545 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m22:53:50.949625 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m22:53:50.955449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:51.048682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0349148850>]}
[0m22:53:51.050425 [info ] [Thread-1 (]: 12 of 32 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ....... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 3.30s]
[0m22:53:51.051753 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m22:53:51.052816 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m22:53:51.054418 [info ] [Thread-1 (]: 14 of 32 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................ [RUN]
[0m22:53:51.055986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.LCA_Disclosure)
[0m22:53:51.057069 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m22:53:51.062477 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m22:53:51.063543 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m22:53:51.068045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:51.099200 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:51.201109 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:51.429041 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4d5682b2-0ee5-487b-b42c-68fa51e5ab70&page=queryresults
[0m22:53:51.556994 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        select
    
      
    cast(null as string)
 as row_id, 
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as float64)
 as prevailing_wage, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as pw_other_year
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:51.595842 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:73cced7d-78d8-4743-8a78-0d80ad65e17d&page=queryresults
[0m22:53:51.732823 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as case_status, 
      
    cast(null as string)
 as visa_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as soc_code, 
      
    cast(null as string)
 as soc_title, 
      
    cast(null as string)
 as full_time_position, 
      
    cast(null as string)
 as begin_date, 
      
    cast(null as string)
 as end_date, 
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as trade_name_dba, 
      
    cast(null as string)
 as employer_address1, 
      
    cast(null as string)
 as employer_address2, 
      
    cast(null as string)
 as employer_city, 
      
    cast(null as string)
 as employer_state, 
      
    cast(null as string)
 as employer_postal_code, 
      
    cast(null as string)
 as employer_country, 
      
    cast(null as string)
 as employer_province, 
      
    cast(null as string)
 as employer_phone, 
      
    cast(null as string)
 as employer_phone_ext, 
      
    cast(null as string)
 as employer_fein, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as employer_poc_last_name, 
      
    cast(null as string)
 as employer_poc_first_name, 
      
    cast(null as string)
 as employer_poc_middle_name, 
      
    cast(null as string)
 as employer_poc_job_title, 
      
    cast(null as string)
 as employer_poc_address1, 
      
    cast(null as string)
 as employer_poc_address2, 
      
    cast(null as string)
 as employer_poc_city, 
      
    cast(null as string)
 as employer_poc_state, 
      
    cast(null as string)
 as employer_poc_postal_code, 
      
    cast(null as string)
 as employer_poc_country, 
      
    cast(null as string)
 as employer_poc_province, 
      
    cast(null as string)
 as employer_poc_phone, 
      
    cast(null as string)
 as employer_poc_phone_ext, 
      
    cast(null as string)
 as employer_poc_email, 
      
    cast(null as string)
 as agent_representing_employer, 
      
    cast(null as string)
 as agent_attorney_last_name, 
      
    cast(null as string)
 as agent_attorney_first_name, 
      
    cast(null as string)
 as agent_attorney_middle_name, 
      
    cast(null as string)
 as agent_attorney_address1, 
      
    cast(null as string)
 as agent_attorney_address2, 
      
    cast(null as string)
 as agent_attorney_city, 
      
    cast(null as string)
 as agent_attorney_state, 
      
    cast(null as string)
 as agent_attorney_postal_code, 
      
    cast(null as string)
 as agent_attorney_country, 
      
    cast(null as string)
 as agent_attorney_province, 
      
    cast(null as string)
 as agent_attorney_phone, 
      
    cast(null as string)
 as agent_attorney_phone_ext, 
      
    cast(null as string)
 as agent_attorney_email_address, 
      
    cast(null as string)
 as lawfirm_name_business_name, 
      
    cast(null as string)
 as state_of_highest_court, 
      
    cast(null as string)
 as name_of_highest_state_court, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_other_year, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as agree_to_lc_statement, 
      
    cast(null as string)
 as h_1b_dependent, 
      
    cast(null as string)
 as willful_violator, 
      
    cast(null as string)
 as support_h1b, 
      
    cast(null as string)
 as statutory_basis, 
      
    cast(null as string)
 as appendix_a_attached, 
      
    cast(null as string)
 as public_disclosure, 
      
    cast(null as string)
 as preparer_last_name, 
      
    cast(null as string)
 as preparer_first_name, 
      
    cast(null as string)
 as preparer_middle_initial, 
      
    cast(null as string)
 as preparer_business_name, 
      
    cast(null as string)
 as preparer_email, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time, 
      
    cast(null as datetime)
 as received_date, 
      
    cast(null as datetime)
 as decision_date, 
      
    cast(null as datetime)
 as original_cert_date, 
      
    cast(null as int64)
 as total_worker_positions, 
      
    cast(null as int64)
 as new_employment, 
      
    cast(null as int64)
 as continued_employment, 
      
    cast(null as int64)
 as change_previous_employment, 
      
    cast(null as int64)
 as new_concurrent_employment, 
      
    cast(null as int64)
 as change_employer, 
      
    cast(null as int64)
 as amended_petition, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as total_worksite_locations, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as float64)
 as prevailing_wage
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:53:51.887544 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7fd81498-3701-4df0-871a-074457fec6fd&page=queryresults
[0m22:53:51.998284 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:53:52.000863 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m22:53:52.002531 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
        
  (
    row_id string primary key not enforced,
    case_number string,
    secondary_entity string,
    secondary_entity_business_name string,
    worksite_address1 string,
    worksite_address2 string,
    worksite_city string,
    worksite_county string,
    worksite_state string,
    worksite_postal_code string,
    wage_rate_of_pay_from float64,
    wage_rate_of_pay_to float64,
    wage_unit_of_pay string,
    prevailing_wage float64,
    pw_unit_of_pay string,
    pw_tracking_number string,
    pw_wage_level string,
    pw_oes_year string,
    pw_other_source string,
    pw_survey_publisher string,
    pw_survey_name string,
    _data_source string,
    _load_time datetime,
    worksite_workers int64,
    pw_other_year int64
    
    )

      
    
    

    OPTIONS()
    as (
      
    select row_id, case_number, secondary_entity, secondary_entity_business_name, worksite_address1, worksite_address2, worksite_city, worksite_county, worksite_state, worksite_postal_code, wage_rate_of_pay_from, wage_rate_of_pay_to, wage_unit_of_pay, prevailing_wage, pw_unit_of_pay, pw_tracking_number, pw_wage_level, pw_oes_year, pw_other_source, pw_survey_publisher, pw_survey_name, _data_source, _load_time, worksite_workers, pw_other_year
    from (
        with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    ) as model_subq
    );
  
[0m22:53:52.070107 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9a39ac89-96a0-4a2e-ad85-df49432b2440&page=queryresults
[0m22:53:52.213844 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:53:52.218585 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m22:53:52.220065 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
        
  (
    case_number string,
    case_status string,
    visa_class string,
    job_title string,
    soc_code string,
    soc_title string,
    full_time_position string,
    begin_date string,
    end_date string,
    employer_name string,
    trade_name_dba string,
    employer_address1 string,
    employer_address2 string,
    employer_city string,
    employer_state string,
    employer_postal_code string,
    employer_country string,
    employer_province string,
    employer_phone string,
    employer_phone_ext string,
    employer_fein string,
    naics_code string,
    employer_poc_last_name string,
    employer_poc_first_name string,
    employer_poc_middle_name string,
    employer_poc_job_title string,
    employer_poc_address1 string,
    employer_poc_address2 string,
    employer_poc_city string,
    employer_poc_state string,
    employer_poc_postal_code string,
    employer_poc_country string,
    employer_poc_province string,
    employer_poc_phone string,
    employer_poc_phone_ext string,
    employer_poc_email string,
    agent_representing_employer string,
    agent_attorney_last_name string,
    agent_attorney_first_name string,
    agent_attorney_middle_name string,
    agent_attorney_address1 string,
    agent_attorney_address2 string,
    agent_attorney_city string,
    agent_attorney_state string,
    agent_attorney_postal_code string,
    agent_attorney_country string,
    agent_attorney_province string,
    agent_attorney_phone string,
    agent_attorney_phone_ext string,
    agent_attorney_email_address string,
    lawfirm_name_business_name string,
    state_of_highest_court string,
    name_of_highest_state_court string,
    secondary_entity string,
    secondary_entity_business_name string,
    worksite_address1 string,
    worksite_address2 string,
    worksite_city string,
    worksite_county string,
    worksite_state string,
    worksite_postal_code string,
    wage_unit_of_pay string,
    pw_unit_of_pay string,
    pw_tracking_number string,
    pw_wage_level string,
    pw_oes_year string,
    pw_other_source string,
    pw_other_year string,
    pw_survey_publisher string,
    pw_survey_name string,
    agree_to_lc_statement string,
    h_1b_dependent string,
    willful_violator string,
    support_h1b string,
    statutory_basis string,
    appendix_a_attached string,
    public_disclosure string,
    preparer_last_name string,
    preparer_first_name string,
    preparer_middle_initial string,
    preparer_business_name string,
    preparer_email string,
    _data_source string,
    _load_time datetime,
    received_date datetime,
    decision_date datetime,
    original_cert_date datetime,
    total_worker_positions int64,
    new_employment int64,
    continued_employment int64,
    change_previous_employment int64,
    new_concurrent_employment int64,
    change_employer int64,
    amended_petition int64,
    worksite_workers int64,
    total_worksite_locations int64,
    wage_rate_of_pay_from float64,
    wage_rate_of_pay_to float64,
    prevailing_wage float64,
    
    primary key (case_number, employer_name) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select case_number, case_status, visa_class, job_title, soc_code, soc_title, full_time_position, begin_date, end_date, employer_name, trade_name_dba, employer_address1, employer_address2, employer_city, employer_state, employer_postal_code, employer_country, employer_province, employer_phone, employer_phone_ext, employer_fein, naics_code, employer_poc_last_name, employer_poc_first_name, employer_poc_middle_name, employer_poc_job_title, employer_poc_address1, employer_poc_address2, employer_poc_city, employer_poc_state, employer_poc_postal_code, employer_poc_country, employer_poc_province, employer_poc_phone, employer_poc_phone_ext, employer_poc_email, agent_representing_employer, agent_attorney_last_name, agent_attorney_first_name, agent_attorney_middle_name, agent_attorney_address1, agent_attorney_address2, agent_attorney_city, agent_attorney_state, agent_attorney_postal_code, agent_attorney_country, agent_attorney_province, agent_attorney_phone, agent_attorney_phone_ext, agent_attorney_email_address, lawfirm_name_business_name, state_of_highest_court, name_of_highest_state_court, secondary_entity, secondary_entity_business_name, worksite_address1, worksite_address2, worksite_city, worksite_county, worksite_state, worksite_postal_code, wage_unit_of_pay, pw_unit_of_pay, pw_tracking_number, pw_wage_level, pw_oes_year, pw_other_source, pw_other_year, pw_survey_publisher, pw_survey_name, agree_to_lc_statement, h_1b_dependent, willful_violator, support_h1b, statutory_basis, appendix_a_attached, public_disclosure, preparer_last_name, preparer_first_name, preparer_middle_initial, preparer_business_name, preparer_email, _data_source, _load_time, received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, total_worksite_locations, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage
    from (
        with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    ) as model_subq
    );
  
[0m22:53:52.455630 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4c283a3f-0bca-4160-b88a-cdfc1e0d0f1c&page=queryresults
[0m22:53:52.516640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:93ec4383-1d15-4ba5-87dd-7b9b071ef440&page=queryresults
[0m22:54:01.484311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0341e72dd0>]}
[0m22:54:01.485714 [info ] [Thread-1 (]: 14 of 32 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ........... [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.43s]
[0m22:54:01.487364 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m22:54:01.488594 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m22:54:01.489664 [info ] [Thread-1 (]: 15 of 32 START sql table model dbt_cs329e_xh_int.Single_Registration ........... [RUN]
[0m22:54:01.490740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Single_Registration)
[0m22:54:01.491437 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m22:54:01.499419 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m22:54:01.500767 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m22:54:01.506433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:01.617980 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: select * from (
        with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:54:02.073588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a1e2ad2b-3257-4f8a-9df9-86d35cdec7bf&page=queryresults
[0m22:54:02.170431 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as ben_year_of_birth, 
      
    cast(null as string)
 as gender, 
      
    cast(null as string)
 as agent_first_name, 
      
    cast(null as string)
 as agent_last_name, 
      
    cast(null as string)
 as mail_addr, 
      
    cast(null as string)
 as country_of_birth, 
      
    cast(null as string)
 as country_of_nationality, 
      
    cast(null as string)
 as fein, 
      
    cast(null as string)
 as city, 
      
    cast(null as string)
 as state, 
      
    cast(null as string)
 as zip, 
      
    cast(null as string)
 as lottery_year, 
      
    cast(null as string)
 as status_type, 
      
    cast(null as string)
 as ben_multi_reg_ind, 
      
    cast(null as string)
 as rec_date, 
      
    cast(null as string)
 as first_decision, 
      
    cast(null as string)
 as first_decision_date, 
      
    cast(null as string)
 as i129_employer_name, 
      
    cast(null as string)
 as pet_street, 
      
    cast(null as string)
 as pet_city, 
      
    cast(null as string)
 as pet_state, 
      
    cast(null as string)
 as pet_zip, 
      
    cast(null as string)
 as requested_class, 
      
    cast(null as string)
 as basis_for_classification, 
      
    cast(null as string)
 as requested_action, 
      
    cast(null as string)
 as number_of_beneficiaries, 
      
    cast(null as string)
 as ben_sex, 
      
    cast(null as string)
 as ben_country_of_birth, 
      
    cast(null as string)
 as ben_current_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as worksite_street, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_zip, 
      
    cast(null as string)
 as full_time_ind, 
      
    cast(null as string)
 as wage_amt, 
      
    cast(null as string)
 as wage_unit, 
      
    cast(null as string)
 as valid_from, 
      
    cast(null as string)
 as valid_to, 
      
    cast(null as string)
 as num_of_emp_in_us, 
      
    cast(null as string)
 as s1q1a, 
      
    cast(null as string)
 as s1q1b, 
      
    cast(null as string)
 as ben_education_code, 
      
    cast(null as string)
 as ed_level_definition, 
      
    cast(null as string)
 as ben_pfield_of_study, 
      
    cast(null as string)
 as ben_comp_paid, 
      
    cast(null as string)
 as dot_code, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as s3q1, 
      
    cast(null as string)
 as s4q1, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:54:02.433913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4b65bad2-25c9-4e2e-856b-3b9ac92bfd5c&page=queryresults
[0m22:54:02.552786 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:54:02.556880 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m22:54:02.563312 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
        
  (
    employer_name string,
    ben_year_of_birth string,
    gender string,
    agent_first_name string,
    agent_last_name string,
    mail_addr string,
    country_of_birth string,
    country_of_nationality string,
    fein string,
    city string,
    state string,
    zip string,
    lottery_year string,
    status_type string,
    ben_multi_reg_ind string,
    rec_date string,
    first_decision string,
    first_decision_date string,
    i129_employer_name string,
    pet_street string,
    pet_city string,
    pet_state string,
    pet_zip string,
    requested_class string,
    basis_for_classification string,
    requested_action string,
    number_of_beneficiaries string,
    ben_sex string,
    ben_country_of_birth string,
    ben_current_class string,
    job_title string,
    worksite_street string,
    worksite_city string,
    worksite_state string,
    worksite_zip string,
    full_time_ind string,
    wage_amt string,
    wage_unit string,
    valid_from string,
    valid_to string,
    num_of_emp_in_us string,
    s1q1a string,
    s1q1b string,
    ben_education_code string,
    ed_level_definition string,
    ben_pfield_of_study string,
    ben_comp_paid string,
    dot_code string,
    naics_code string,
    s3q1 string,
    s4q1 string,
    _data_source string,
    _load_time datetime,
    
    primary key (employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr, country_of_birth, country_of_nationality, fein, city, state, zip, lottery_year, status_type, ben_multi_reg_ind, rec_date, first_decision, first_decision_date, i129_employer_name, pet_street, pet_city, pet_state, pet_zip, requested_class, basis_for_classification, requested_action, number_of_beneficiaries, ben_sex, ben_country_of_birth, ben_current_class, job_title, worksite_street, worksite_city, worksite_state, worksite_zip, full_time_ind, wage_amt, wage_unit, valid_from, valid_to, num_of_emp_in_us, s1q1a, s1q1b, ben_education_code, ed_level_definition, ben_pfield_of_study, ben_comp_paid, dot_code, naics_code, s3q1, s4q1, _data_source, _load_time
    from (
        with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
    ) as model_subq
    );
  
[0m22:54:02.702931 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348c67850>]}
[0m22:54:02.704827 [info ] [Thread-2 (]: 13 of 32 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............ [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 11.76s]
[0m22:54:02.706590 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m22:54:02.707774 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m22:54:02.709116 [info ] [Thread-2 (]: 16 of 32 START sql table model dbt_cs329e_xh_int.Wage_Summary .................. [RUN]
[0m22:54:02.710720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Wage_Summary)
[0m22:54:02.712287 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m22:54:02.723575 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m22:54:02.725229 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m22:54:02.732627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:54:02.881552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4b9f01d7-75a4-451c-bf96-5668ade10a33&page=queryresults
[0m22:54:03.320947 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: select * from (
        with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:54:03.687779 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:dc8bf0ad-74e4-4446-97f3-67813a2bed4f&page=queryresults
[0m22:54:03.768365 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: select * from (
        select
    
      
    cast(null as string)
 as company_name, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as int64)
 as min_wage, 
      
    cast(null as int64)
 as max_wage, 
      
    cast(null as float64)
 as average_wage, 
      
    cast(null as int64)
 as job_count, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:54:04.070224 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c1f33749-2e65-4468-b07a-d41b61651988&page=queryresults
[0m22:54:04.191640 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:54:04.194838 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m22:54:04.196788 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
        
  (
    company_name string,
    job_title string,
    min_wage int64,
    max_wage int64,
    average_wage float64,
    job_count int64,
    _data_source string,
    _load_time datetime,
    
    primary key (company_name, job_title) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select company_name, job_title, min_wage, max_wage, average_wage, job_count, _data_source, _load_time
    from (
        with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    ) as model_subq
    );
  
[0m22:54:04.531628 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6d9e474b-9698-426f-a304-6d689b2f4a55&page=queryresults
[0m22:54:06.790325 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348c67850>]}
[0m22:54:06.791715 [info ] [Thread-2 (]: 16 of 32 OK created sql table model dbt_cs329e_xh_int.Wage_Summary ............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 4.08s]
[0m22:54:06.793798 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m22:54:06.795036 [debug] [Thread-2 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m22:54:06.796416 [info ] [Thread-2 (]: 17 of 32 START sql table model dbt_cs329e_xh_int.PW_Disclosure ................. [RUN]
[0m22:54:06.797930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.PW_Disclosure)
[0m22:54:06.798704 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m22:54:06.803854 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m22:54:06.804973 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m22:54:06.811279 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:54:06.925530 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m22:54:06.926883 [debug] [Thread-2 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m22:54:07.332129 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ba398905-91bd-40af-a82f-75f92ad65f43&page=queryresults
[0m22:54:09.000425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0364f70460>]}
[0m22:54:09.001898 [info ] [Thread-1 (]: 15 of 32 OK created sql table model dbt_cs329e_xh_int.Single_Registration ...... [[32mCREATE TABLE (237.8k rows, 75.7 MiB processed)[0m in 7.51s]
[0m22:54:09.003281 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m22:54:09.004175 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m22:54:09.005253 [info ] [Thread-1 (]: 18 of 32 START sql table model dbt_cs329e_xh_int.temp_emp ...................... [RUN]
[0m22:54:09.006282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.temp_emp)
[0m22:54:09.006972 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m22:54:09.013227 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m22:54:09.014624 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_emp
[0m22:54:09.021504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:09.144931 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m22:54:09.146218 [debug] [Thread-1 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw),
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m22:54:09.451661 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9c2d18ed-068d-4c27-ad9f-367b66c2b136&page=queryresults
[0m22:54:12.568452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348c67820>]}
[0m22:54:12.569958 [info ] [Thread-1 (]: 18 of 32 OK created sql table model dbt_cs329e_xh_int.temp_emp ................. [[32mCREATE TABLE (90.2k rows, 19.9 MiB processed)[0m in 3.56s]
[0m22:54:12.571886 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m22:54:12.572716 [debug] [Thread-1 (]: Began running node model.cs329e_xh.approval_rate_by_month
[0m22:54:12.574418 [info ] [Thread-1 (]: 19 of 32 START sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ........ [RUN]
[0m22:54:12.575694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.approval_rate_by_month)
[0m22:54:12.576911 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.approval_rate_by_month
[0m22:54:12.583644 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.approval_rate_by_month"
[0m22:54:12.584775 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.approval_rate_by_month
[0m22:54:12.589087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:12.823995 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.approval_rate_by_month"
[0m22:54:12.825276 [debug] [Thread-1 (]: On model.cs329e_xh.approval_rate_by_month: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.approval_rate_by_month"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`approval_rate_by_month`
      
    
    

    OPTIONS()
    as (
      WITH monthly_windows AS (
    SELECT 
        EXTRACT (YEAR FROM publication_date) AS year,
        EXTRACT(MONTH FROM publication_date) AS month,
        MAX(publication_date) AS latest_date
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
    GROUP BY year, month
),
approval_rate_monthly AS (

    SELECT 
        EXTRACT(YEAR FROM decision_date) AS year,
        EXTRACT(MONTH FROM decision_date) AS month,
        COUNT(CASE WHEN case_status = 'Certified' THEN 1 END) AS approved_count,
        COUNT(CASE WHEN case_status != 'Certified' THEN 1 END) AS denied_count,
        COUNT(*) AS total_applications
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    WHERE decision_date IS NOT NULL
    GROUP BY year, month
)
SELECT 
    a.month,
    m.latest_date,
    a.approved_count,
    a.denied_count,
    a.total_applications,
    ROUND(100.0 * a.approved_count / a.total_applications, 2) AS approval_rate
FROM approval_rate_monthly a
LEFT JOIN monthly_windows m
    ON a.month = m.month
ORDER BY a.month
    );
  
[0m22:54:13.217311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0de55ff9-bb87-4992-a33e-71fa0fa3c849&page=queryresults
[0m22:54:15.485460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348ed7c40>]}
[0m22:54:15.486884 [info ] [Thread-1 (]: 19 of 32 OK created sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ... [[32mCREATE TABLE (12.0 rows, 10.5 MiB processed)[0m in 2.91s]
[0m22:54:15.488441 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.approval_rate_by_month
[0m22:54:15.489515 [debug] [Thread-1 (]: Began running node model.cs329e_xh.major_wage_level
[0m22:54:15.490781 [info ] [Thread-1 (]: 20 of 32 START sql table model dbt_cs329e_xh_mrt.major_wage_level .............. [RUN]
[0m22:54:15.491736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.approval_rate_by_month, now model.cs329e_xh.major_wage_level)
[0m22:54:15.492484 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.major_wage_level
[0m22:54:15.499835 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.major_wage_level"
[0m22:54:15.501367 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.major_wage_level
[0m22:54:15.507219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:15.635213 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.major_wage_level"
[0m22:54:15.636477 [debug] [Thread-1 (]: On model.cs329e_xh.major_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.major_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`major_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH salary_by_field AS (
    SELECT 
        a.appx_a_field_of_study AS field_of_study,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE a.appx_a_field_of_study IS NOT NULL
)

SELECT 
    field_of_study,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM salary_by_field
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY field_of_study, wage_unit_of_pay
ORDER BY field_of_study, wage_unit_of_pay
    );
  
[0m22:54:15.926584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:72da564b-0d92-4a0b-8147-322dc227faf2&page=queryresults
[0m22:54:18.172221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348c67820>]}
[0m22:54:18.173742 [info ] [Thread-1 (]: 20 of 32 OK created sql table model dbt_cs329e_xh_mrt.major_wage_level ......... [[32mCREATE TABLE (87.0 rows, 19.6 MiB processed)[0m in 2.68s]
[0m22:54:18.175688 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.major_wage_level
[0m22:54:18.176550 [debug] [Thread-1 (]: Began running node model.cs329e_xh.soc_wage_level
[0m22:54:18.178395 [info ] [Thread-1 (]: 21 of 32 START sql table model dbt_cs329e_xh_mrt.soc_wage_level ................ [RUN]
[0m22:54:18.179507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.major_wage_level, now model.cs329e_xh.soc_wage_level)
[0m22:54:18.180332 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.soc_wage_level
[0m22:54:18.186053 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.soc_wage_level"
[0m22:54:18.187179 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.soc_wage_level
[0m22:54:18.193336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:18.306877 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.soc_wage_level"
[0m22:54:18.308123 [debug] [Thread-1 (]: On model.cs329e_xh.soc_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.soc_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`soc_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH job_salary AS (
    SELECT 
        l.soc_code,
        l.soc_title,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE l.soc_code IS NOT NULL AND l.soc_title IS NOT NULL
)

SELECT 
    soc_code,
    soc_title,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM job_salary
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY soc_code, soc_title, wage_unit_of_pay
ORDER BY avg_wage_from DESC
    );
  
[0m22:54:18.625146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9205aff8-55b5-430f-9d8b-a15c64d953fd&page=queryresults
[0m22:54:20.608865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0341d0cc10>]}
[0m22:54:20.610086 [info ] [Thread-1 (]: 21 of 32 OK created sql table model dbt_cs329e_xh_mrt.soc_wage_level ........... [[32mCREATE TABLE (55.0 rows, 41.3 MiB processed)[0m in 2.43s]
[0m22:54:20.611757 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.soc_wage_level
[0m22:54:20.612633 [debug] [Thread-1 (]: Began running node model.cs329e_xh.city_approval_rate
[0m22:54:20.613555 [info ] [Thread-1 (]: 22 of 32 START sql table model dbt_cs329e_xh_mrt.city_approval_rate ............ [RUN]
[0m22:54:20.614832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.soc_wage_level, now model.cs329e_xh.city_approval_rate)
[0m22:54:20.615538 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.city_approval_rate
[0m22:54:20.621117 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.city_approval_rate"
[0m22:54:20.622808 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.city_approval_rate
[0m22:54:20.628398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:20.766023 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.city_approval_rate"
[0m22:54:20.767405 [debug] [Thread-1 (]: On model.cs329e_xh.city_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.city_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`city_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_city AS city,
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_city, lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m22:54:21.077441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c31ca4db-6ddb-4c7e-a98f-85f6512a83c9&page=queryresults
[0m22:54:21.648099 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0365387c70>]}
[0m22:54:21.649354 [info ] [Thread-2 (]: 17 of 32 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............ [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 14.85s]
[0m22:54:21.650731 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m22:54:21.651528 [debug] [Thread-2 (]: Began running node model.cs329e_xh.state_approval_rate
[0m22:54:21.652402 [info ] [Thread-2 (]: 23 of 32 START sql table model dbt_cs329e_xh_mrt.state_approval_rate ........... [RUN]
[0m22:54:21.653558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.state_approval_rate)
[0m22:54:21.654557 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.state_approval_rate
[0m22:54:21.661547 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.state_approval_rate"
[0m22:54:21.662788 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.state_approval_rate
[0m22:54:21.667116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:54:21.812635 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.state_approval_rate"
[0m22:54:21.814138 [debug] [Thread-2 (]: On model.cs329e_xh.state_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m22:54:22.114733 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6e4554a8-6099-40f2-b9c2-283add7b07b9&page=queryresults
[0m22:54:24.197559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0341d0cb20>]}
[0m22:54:24.199537 [info ] [Thread-1 (]: 22 of 32 OK created sql table model dbt_cs329e_xh_mrt.city_approval_rate ....... [[32mCREATE TABLE (20.1k rows, 50.1 MiB processed)[0m in 3.58s]
[0m22:54:24.200805 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.city_approval_rate
[0m22:54:24.202012 [debug] [Thread-1 (]: Began running node model.cs329e_xh.state_wage_level
[0m22:54:24.203361 [info ] [Thread-1 (]: 24 of 32 START sql table model dbt_cs329e_xh_mrt.state_wage_level .............. [RUN]
[0m22:54:24.204398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.city_approval_rate, now model.cs329e_xh.state_wage_level)
[0m22:54:24.205131 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.state_wage_level
[0m22:54:24.214254 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.state_wage_level"
[0m22:54:24.215380 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.state_wage_level
[0m22:54:24.220248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:24.356493 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.state_wage_level"
[0m22:54:24.357790 [debug] [Thread-1 (]: On model.cs329e_xh.state_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_wage_level`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  ROUND(AVG(ld.prevailing_wage), 2) AS avg_wage,
  ROUND(MAX(ld.prevailing_wage), 2) AS max_wage,
  ROUND(MIN(ld.prevailing_wage), 2) AS min_wage,
  COUNT(ld.case_number) AS total_cases
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
WHERE ld.prevailing_wage IS NOT NULL
AND LOWER(ld.pw_unit_of_pay) != 'hour'  -- Exclude hourly wage records
GROUP BY lw.worksite_state
ORDER BY avg_wage DESC
    );
  
[0m22:54:24.683058 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:95e573a2-d4a7-4270-bc7a-48b3f1665300&page=queryresults
[0m22:54:25.258624 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348c67850>]}
[0m22:54:25.609269 [debug] [Thread-2 (]: An error was encountered while trying to send an event
[0m22:54:25.610887 [info ] [Thread-2 (]: 23 of 32 OK created sql table model dbt_cs329e_xh_mrt.state_approval_rate ...... [[32mCREATE TABLE (55.0 rows, 41.5 MiB processed)[0m in 3.60s]
[0m22:54:25.612104 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.state_approval_rate
[0m22:54:25.613004 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m22:54:25.613926 [info ] [Thread-2 (]: 25 of 32 START sql table model dbt_cs329e_xh_int.temp_employer_details ......... [RUN]
[0m22:54:25.615130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_approval_rate, now model.cs329e_xh.temp_employer_details)
[0m22:54:25.615875 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m22:54:25.622550 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m22:54:25.623708 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_employer_details
[0m22:54:25.627890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:54:25.767012 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_employer_details"
[0m22:54:25.768261 [debug] [Thread-2 (]: On model.cs329e_xh.temp_employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_employer_details`
      
    
    

    OPTIONS()
    as (
      WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp` as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched
    );
  
[0m22:54:26.082520 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:07ebce92-14d1-4867-8752-21ca50f531c6&page=queryresults
[0m22:54:27.561510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348c67820>]}
[0m22:54:27.562875 [info ] [Thread-1 (]: 24 of 32 OK created sql table model dbt_cs329e_xh_mrt.state_wage_level ......... [[32mCREATE TABLE (55.0 rows, 42.8 MiB processed)[0m in 3.36s]
[0m22:54:27.564040 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.state_wage_level
[0m22:54:31.591906 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df4b8a-85b1-4c7b-bcf8-57f39d942f66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0341d3c6a0>]}
[0m22:54:31.593338 [info ] [Thread-2 (]: 25 of 32 OK created sql table model dbt_cs329e_xh_int.temp_employer_details .... [[32mCREATE TABLE (589.3k rows, 4.9 MiB processed)[0m in 5.98s]
[0m22:54:31.595390 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m22:54:31.598019 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m22:54:31.599282 [debug] [Thread-2 (]: Began running node model.cs329e_xh.matching-checkpoint
[0m22:54:31.600595 [info ] [Thread-1 (]: 26 of 32 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m22:54:31.603731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_wage_level, now model.cs329e_xh.matching)
[0m22:54:31.605121 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m22:54:31.602539 [info ] [Thread-2 (]: 27 of 32 START python table model dbt_cs329e_xh_int.matching-checkpoint ........ [RUN]
[0m22:54:31.617630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_employer_details, now model.cs329e_xh.matching-checkpoint)
[0m22:54:31.619620 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.matching-checkpoint
[0m22:54:31.694531 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.matching-checkpoint"
[0m22:54:31.693101 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m22:54:31.696881 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.matching-checkpoint
[0m22:54:31.703266 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m22:54:31.720954 [debug] [Thread-2 (]: Writing runtime python for node "model.cs329e_xh.matching-checkpoint"
[0m22:54:31.732532 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m22:54:31.734955 [debug] [Thread-2 (]: On model.cs329e_xh.matching-checkpoint: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


import pandas as pd
import os
import json
from google.oauth2 import service_account
#import json
#import vertexai
#from vertexai.generative_models import GenerativeModel
service_account_info = {
  "type": "service_account",
  "project_id": "silken-fortress-448205-p9",
  "private_key_id": "71d77d1a2073bafb0db6992cdad7614a88a21bdc",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQClBzwnVW9yrimb\npB0X8ELIvXkaJfNWlUJM8HB+JvUhPcyKH1/vnTlAm+kJkbvNr4xQBCFdDkJri+2y\nIEdCCaPN7eUxrL5E5zYE5SXlMqw5eAj7Xlngb2s3CdlBfuM/oN2Rro4AhrKGpLlG\n8GjxNRUxwFoXulIJ4jxIfuWLyUgTFS6t+2I8BaMtpP31XzV4tKU/mwfLVAwMwrUT\nuWgVyC+nJico3h0Ymr7YkEMqjnVTmgzupnssRTyCSmnnXwTrwzOig5Z0pRIIVtGD\nOnpfuTSdPFip/e74BqCoysTXe8HaUfamp6Rbm4o67GgZVzhN2AwNimIA7jnIaLvq\nkrh+Gp/TAgMBAAECggEADKJwqwxB85Q88EMQzSfiXQ8Qif1002CrCkvwOOBPrSNX\nmQ2M4UH2w6kMHuTu7XDuu6ONUFwKnsRARv5spjQpu9bmULbKfGj9PEO08oa+I8o6\nWdBf7ixpl3WkEf0edd0hiYlFKuolGeTboIBAcJMhU8VHwIBNzp7pAZ3hgiG/aGJ7\nxIOigdLUyNR6D/piKok/EFiuAQx5biZ7OdwdV0+SYo1deiV5urH9/SXE4wxAPlIJ\nGz21qdicyDmC4zEeVDhHqDU6dLP+UW3TYEDB1VwIRRwxHPh7eQGTiiM9Pmb74U7B\n2kPDN1mWQT5eq4+nMRl/HeXz4JZ4yGFwbaxgFDHTRQKBgQDYOXqMqG6SdkypEMH8\new4Ibo8jaXHkcXk5MfHCIzPXxMdvbXlFr31H5ulSzt4D7nIW/eNdSqSSxax4ZI4q\nzc/QZVpHKR5SUuV5xyL+fAorvwQVEoy7WscXIxE+JLaCpUYWCUHHe6M3VC0vG8eF\nqDTLa+olP00G/ZC3vB/X8OpztwKBgQDDYs3GBGGW3moEGlesTagp4tcrSl0Xh0qJ\nQfag84ceZvzH1CRHub4/zuSy1e31vbcN1HRlQeqcrwE5sinVEvm/AGaT/7YLbbME\naajqhf1fFkTNzOHcHPPLJoevLTXWNzu6MdA3yhD8wqSYBXqJW5iT9GeW6L7MJRBa\njhKp09UMxQKBgQCJY2xU96jac0SeoEFCVkZCYU2eKJ/vkZJ/HxcITingze4TBTJr\nbuhhyX0z2rIDOX1Q0p2nZ4hOoj/Gd85FsGR9fAjy8lOL55Rb3oaDwPkNdt/3K8Q0\nP6gFMYkBPX6iYLW5xsP/JrY8r8XOCw6qBIkXQEiUxjYBXRiZRnXNVg0C3QKBgQC3\nbYytN/O+RXPWAj0Iv6b+G73RIHEg45xwG4NEOxxAyILLvzeINrKLCNrfocNSjxbJ\nXwke/rEZA5rs5XwsUzIvxFqI2um29Pe5TtCLy9rAaBGT+6KWmH+v2q5LIPCH+TaT\naKyHk6Y7BSisp4gQZ/NoA2002bA1yx39RZ/z27EJ2QKBgBVqwuio4R70L6g3bP6u\n+/R25uFNFJs4xRYa2Vz7smLrcqnhu58CdO+Z3eq6Hg4Y/z9PCXN+3J6yOu+RfkuS\nKqLAPjAvh25G8WRlKNFnSSggiaWcpJkfNW7VY56qMjWGCjrGWxt0n5OBUKCHYNYO\n0ZkQ9KkdQESzZ33WkYGKGoN3\n-----END PRIVATE KEY-----\n",
  "client_email": "auth1-970@silken-fortress-448205-p9.iam.gserviceaccount.com",
  "client_id": "106644715728790824750",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/auth1-970%40silken-fortress-448205-p9.iam.gserviceaccount.com",
  "universe_domain": "googleapis.com"
}
credentials = service_account.Credentials.from_service_account_info(service_account_info)
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    '''
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })

    json_result = json.dumps(result, indent=4, ensure_ascii=False)
    region = "us-central1"
    model_name = "gemini-2.0-flash-001"
    vertexai.init(project=project_id, location=region)
    model = GenerativeModel(model_name)
    data = json_result

    # Prepare Prompt
    prompt = """Here is a list of company names and candidate company names with FEINs.
    Match each original name to the most appropriate candidate based on similarity.
    Return a JSON object per line with the following fields:
    - tax_id
    - original_name
    - matched_candidate_name
    - matched_fein
    Return only one match per original_name. If no match is found, return null for matched_candidate_name and matched_fein.
    Do not return explanations.
    """

    # Set batch size
    batch_size = 5  

    # Prepare Batches
    records = []
    record_counter = 0
    batches = []
    for entry in data:
        tax_id = entry.get("tax_id", "Unknown")
        original_names = entry.get("original_names", [])
        candidate_name_fein = entry.get("candidate_name_fein", [])

        for original_name in original_names:
            candidate_str = "\n".join([f"{list(c.keys())[0]}: {list(c.values())[0]}" for c in candidate_name_fein])
            record = f"tax_id: {tax_id}\noriginal_name: {original_name}\ncandidates:\n{candidate_str}"
            records.append(record)
            record_counter += 1

            if record_counter == batch_size:
                batches.append("\n---\n".join(records))
                records = []
                record_counter = 0

    if records:
        batches.append("\n---\n".join(records))

    print(f"{len(batches)} total batches will be sent to Gemini.")

    # Function to send batch to Gemini with retry on API limit
    def send_batch_to_gemini(batch_data):
        max_retries = 5
        wait_time = 5  

        for attempt in range(max_retries):
            try:
                resp = model.generate_content([batch_data, prompt])
                resp_text = resp.text.replace("```json", "").replace("```", "")
                json_lines = resp_text.strip().split("\n")
                results = []
                for line in json_lines:
                    if line:
                        try:
                            results.append(json.loads(line))
                        except Exception as e:
                            print(f"Error converting line to JSON: {line}, Error: {e}")
                return results  
            except Exception as e:
                if "Resource exhausted" in str(e):  
                    print(f"API Limit Exceeded. Waiting {wait_time} seconds before retrying. Attempt {attempt+1} of {max_retries}.")
                    time.sleep(wait_time)  
                    wait_time *= 2  
                else:
                    print(f"API Error: {e}")
                    return []  

        print("Max retries reached. Skipping batch.")
        return []  

    # Process all batches with retry mechanism
    all_results = []
    for i, batch in enumerate(batches):
        print(f"Processing batch {i + 1} of {len(batches)}.")
        batch_results = send_batch_to_gemini(batch)
        all_results.extend(batch_results)
        time.sleep(1)  

    # Convert to DataFrame
    df_final = pd.DataFrame(all_results)

    # Remove duplicates
    df_final.drop_duplicates(subset=["tax_id", "original_name", "matched_candidate_name", "matched_fein"], inplace=True)
    matching = df_final

    '''
    
    matching = session.read_csv("gs://cs329e-h1b-project/matched_results_full.csv")
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "silken-fortress-448205-p9.dbt_cs329e_xh_int.temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching-checkpoint"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching-checkpoint'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching-checkpoint")

  
[0m22:54:31.736851 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


import pandas as pd
import os
import json
from google.oauth2 import service_account
#import json
#import vertexai
#from vertexai.generative_models import GenerativeModel
service_account_info = {
  "type": "service_account",
  "project_id": "silken-fortress-448205-p9",
  "private_key_id": "71d77d1a2073bafb0db6992cdad7614a88a21bdc",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQClBzwnVW9yrimb\npB0X8ELIvXkaJfNWlUJM8HB+JvUhPcyKH1/vnTlAm+kJkbvNr4xQBCFdDkJri+2y\nIEdCCaPN7eUxrL5E5zYE5SXlMqw5eAj7Xlngb2s3CdlBfuM/oN2Rro4AhrKGpLlG\n8GjxNRUxwFoXulIJ4jxIfuWLyUgTFS6t+2I8BaMtpP31XzV4tKU/mwfLVAwMwrUT\nuWgVyC+nJico3h0Ymr7YkEMqjnVTmgzupnssRTyCSmnnXwTrwzOig5Z0pRIIVtGD\nOnpfuTSdPFip/e74BqCoysTXe8HaUfamp6Rbm4o67GgZVzhN2AwNimIA7jnIaLvq\nkrh+Gp/TAgMBAAECggEADKJwqwxB85Q88EMQzSfiXQ8Qif1002CrCkvwOOBPrSNX\nmQ2M4UH2w6kMHuTu7XDuu6ONUFwKnsRARv5spjQpu9bmULbKfGj9PEO08oa+I8o6\nWdBf7ixpl3WkEf0edd0hiYlFKuolGeTboIBAcJMhU8VHwIBNzp7pAZ3hgiG/aGJ7\nxIOigdLUyNR6D/piKok/EFiuAQx5biZ7OdwdV0+SYo1deiV5urH9/SXE4wxAPlIJ\nGz21qdicyDmC4zEeVDhHqDU6dLP+UW3TYEDB1VwIRRwxHPh7eQGTiiM9Pmb74U7B\n2kPDN1mWQT5eq4+nMRl/HeXz4JZ4yGFwbaxgFDHTRQKBgQDYOXqMqG6SdkypEMH8\new4Ibo8jaXHkcXk5MfHCIzPXxMdvbXlFr31H5ulSzt4D7nIW/eNdSqSSxax4ZI4q\nzc/QZVpHKR5SUuV5xyL+fAorvwQVEoy7WscXIxE+JLaCpUYWCUHHe6M3VC0vG8eF\nqDTLa+olP00G/ZC3vB/X8OpztwKBgQDDYs3GBGGW3moEGlesTagp4tcrSl0Xh0qJ\nQfag84ceZvzH1CRHub4/zuSy1e31vbcN1HRlQeqcrwE5sinVEvm/AGaT/7YLbbME\naajqhf1fFkTNzOHcHPPLJoevLTXWNzu6MdA3yhD8wqSYBXqJW5iT9GeW6L7MJRBa\njhKp09UMxQKBgQCJY2xU96jac0SeoEFCVkZCYU2eKJ/vkZJ/HxcITingze4TBTJr\nbuhhyX0z2rIDOX1Q0p2nZ4hOoj/Gd85FsGR9fAjy8lOL55Rb3oaDwPkNdt/3K8Q0\nP6gFMYkBPX6iYLW5xsP/JrY8r8XOCw6qBIkXQEiUxjYBXRiZRnXNVg0C3QKBgQC3\nbYytN/O+RXPWAj0Iv6b+G73RIHEg45xwG4NEOxxAyILLvzeINrKLCNrfocNSjxbJ\nXwke/rEZA5rs5XwsUzIvxFqI2um29Pe5TtCLy9rAaBGT+6KWmH+v2q5LIPCH+TaT\naKyHk6Y7BSisp4gQZ/NoA2002bA1yx39RZ/z27EJ2QKBgBVqwuio4R70L6g3bP6u\n+/R25uFNFJs4xRYa2Vz7smLrcqnhu58CdO+Z3eq6Hg4Y/z9PCXN+3J6yOu+RfkuS\nKqLAPjAvh25G8WRlKNFnSSggiaWcpJkfNW7VY56qMjWGCjrGWxt0n5OBUKCHYNYO\n0ZkQ9KkdQESzZ33WkYGKGoN3\n-----END PRIVATE KEY-----\n",
  "client_email": "auth1-970@silken-fortress-448205-p9.iam.gserviceaccount.com",
  "client_id": "106644715728790824750",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/auth1-970%40silken-fortress-448205-p9.iam.gserviceaccount.com",
  "universe_domain": "googleapis.com"
}
credentials = service_account.Credentials.from_service_account_info(service_account_info)
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    '''
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })

    json_result = json.dumps(result, indent=4, ensure_ascii=False)
    region = "us-central1"
    model_name = "gemini-2.0-flash-001"
    vertexai.init(project=project_id, location=region)
    model = GenerativeModel(model_name)
    data = json_result

    # Prepare Prompt
    prompt = """Here is a list of company names and candidate company names with FEINs.
    Match each original name to the most appropriate candidate based on similarity.
    Return a JSON object per line with the following fields:
    - tax_id
    - original_name
    - matched_candidate_name
    - matched_fein
    Return only one match per original_name. If no match is found, return null for matched_candidate_name and matched_fein.
    Do not return explanations.
    """

    # Set batch size
    batch_size = 5  

    # Prepare Batches
    records = []
    record_counter = 0
    batches = []
    for entry in data:
        tax_id = entry.get("tax_id", "Unknown")
        original_names = entry.get("original_names", [])
        candidate_name_fein = entry.get("candidate_name_fein", [])

        for original_name in original_names:
            candidate_str = "\n".join([f"{list(c.keys())[0]}: {list(c.values())[0]}" for c in candidate_name_fein])
            record = f"tax_id: {tax_id}\noriginal_name: {original_name}\ncandidates:\n{candidate_str}"
            records.append(record)
            record_counter += 1

            if record_counter == batch_size:
                batches.append("\n---\n".join(records))
                records = []
                record_counter = 0

    if records:
        batches.append("\n---\n".join(records))

    print(f"{len(batches)} total batches will be sent to Gemini.")

    # Function to send batch to Gemini with retry on API limit
    def send_batch_to_gemini(batch_data):
        max_retries = 5
        wait_time = 5  

        for attempt in range(max_retries):
            try:
                resp = model.generate_content([batch_data, prompt])
                resp_text = resp.text.replace("```json", "").replace("```", "")
                json_lines = resp_text.strip().split("\n")
                results = []
                for line in json_lines:
                    if line:
                        try:
                            results.append(json.loads(line))
                        except Exception as e:
                            print(f"Error converting line to JSON: {line}, Error: {e}")
                return results  
            except Exception as e:
                if "Resource exhausted" in str(e):  
                    print(f"API Limit Exceeded. Waiting {wait_time} seconds before retrying. Attempt {attempt+1} of {max_retries}.")
                    time.sleep(wait_time)  
                    wait_time *= 2  
                else:
                    print(f"API Error: {e}")
                    return []  

        print("Max retries reached. Skipping batch.")
        return []  

    # Process all batches with retry mechanism
    all_results = []
    for i, batch in enumerate(batches):
        print(f"Processing batch {i + 1} of {len(batches)}.")
        batch_results = send_batch_to_gemini(batch)
        all_results.extend(batch_results)
        time.sleep(1)  

    # Convert to DataFrame
    df_final = pd.DataFrame(all_results)

    # Remove duplicates
    df_final.drop_duplicates(subset=["tax_id", "original_name", "matched_candidate_name", "matched_fein"], inplace=True)
    matching = df_final

    '''
    
    matching = session.read_csv("gs://cs329e-h1b-project/matched_results_full.csv")
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "silken-fortress-448205-p9.dbt_cs329e_xh_int.temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m22:54:31.761910 [debug] [Thread-1 (]: BigQuery adapter: Submitting batch job with id: d847e5fd-b5aa-4f1d-8ca4-0794ea228574
[0m22:54:31.763588 [debug] [Thread-2 (]: BigQuery adapter: Submitting batch job with id: a4880fbc-bb77-41be-bc3f-a5797a86d6c8
[0m22:58:23.455388 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m22:58:23.457034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:58:25.025455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:58:26.852021 [error] [MainThread]: CANCEL query model.cs329e_xh.matching-checkpoint ............................... [[31mCANCEL[0m]
[0m22:58:26.852979 [error] [MainThread]: CANCEL query model.cs329e_xh.matching .......................................... [[31mCANCEL[0m]
[0m22:58:26.853863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:58:28.269757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:28.270831 [debug] [MainThread]: Connection 'model.cs329e_xh.matching-checkpoint' was properly closed.
[0m22:58:28.271358 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m22:58:28.272225 [info ] [MainThread]: 
[0m22:58:28.272871 [info ] [MainThread]: Finished running 25 table models in 0 hours 5 minutes and 7.93 seconds (307.93s).
[0m22:58:28.273673 [error] [MainThread]: Encountered an error:

[0m22:58:28.284972 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 330, in run_queue
    self.handle_job_queue(pool, callback)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 828, in handle_job_queue
    node = self.job_queue.get()
  File "/opt/conda/lib/python3.10/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/conda/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/conda/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 445, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/runnable.py", line 404, in _cancel_connections
    pool.join()
  File "/opt/conda/lib/python3.10/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/opt/conda/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m22:58:28.286855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 311.42624, "process_in_blocks": "272", "process_kernel_time": 0.773835, "process_mem_max_rss": "286856", "process_out_blocks": "3912", "process_user_time": 7.967132}
[0m22:58:28.287592 [debug] [MainThread]: Command `dbt run` failed at 22:58:28.287439 after 311.43 seconds
[0m22:58:28.288198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03650bd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0348e1d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0341de21d0>]}
[0m22:58:28.288862 [debug] [MainThread]: Flushing usage events
[0m22:58:28.630485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:40.046344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc488bbd630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc487d4a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc487d4a410>]}


============================== 22:58:40.050104 | 1ddd46b1-fad2-465b-a283-3b86deb418e9 ==============================
[0m22:58:40.050104 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:58:40.051191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jupyter/cs329e_xh/logs', 'version_check': 'True', 'profiles_dir': '/home/jupyter/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:58:41.828136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc489d3ef50>]}
[0m22:58:41.913369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46d546fe0>]}
[0m22:58:41.914548 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:58:42.090665 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:58:42.341668 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m22:58:42.342734 [debug] [MainThread]: Partial parsing: deleted file: cs329e_xh://models/int/Employer_Details/.ipynb_checkpoints/matching-checkpoint.py
[0m22:58:42.520854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46c996080>]}
[0m22:58:42.702225 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m22:58:42.705001 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m22:58:42.727748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46c995120>]}
[0m22:58:42.728719 [info ] [MainThread]: Found 31 models, 1 seed, 25 data tests, 19 sources, 494 macros
[0m22:58:42.729441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46c996920>]}
[0m22:58:42.734408 [info ] [MainThread]: 
[0m22:58:42.735155 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:58:42.735806 [info ] [MainThread]: 
[0m22:58:42.736724 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:58:42.746903 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m22:58:42.747708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:42.750006 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silken-fortress-448205-p9'
[0m22:58:42.751283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:42.947508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:43.108831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt)
[0m22:58:43.109627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:43.112400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9, now list_silken-fortress-448205-p9_dbt_cs329e_xh_stg)
[0m22:58:43.113492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:43.222821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_stg, now list_silken-fortress-448205-p9_dbt_cs329e_xh_int)
[0m22:58:43.225747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:43.239395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_mrt, now list_silken-fortress-448205-p9_cs329e_xh_dbt)
[0m22:58:43.242957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:43.406319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46cb06290>]}
[0m22:58:43.407448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:43.410943 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_data
[0m22:58:43.411721 [debug] [Thread-2 (]: Began running node model.cs329e_xh.employer_details
[0m22:58:43.412727 [info ] [Thread-1 (]: 1 of 31 START sql table model dbt_cs329e_xh_stg.company_data ................... [RUN]
[0m22:58:43.413907 [info ] [Thread-2 (]: 2 of 31 START sql table model dbt_cs329e_xh_stg.employer_details ............... [RUN]
[0m22:58:43.414963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_cs329e_xh_dbt, now model.cs329e_xh.company_data)
[0m22:58:43.415882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_silken-fortress-448205-p9_dbt_cs329e_xh_int, now model.cs329e_xh.employer_details)
[0m22:58:43.416619 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.company_data
[0m22:58:43.417532 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.employer_details
[0m22:58:43.434322 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.company_data"
[0m22:58:43.439655 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.employer_details"
[0m22:58:43.441225 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.employer_details
[0m22:58:43.442004 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.company_data
[0m22:58:43.470601 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:58:43.476360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:43.651068 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.company_data"
[0m22:58:43.651989 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.employer_details"
[0m22:58:43.653568 [debug] [Thread-2 (]: On model.cs329e_xh.employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details`
      
    
    

    OPTIONS()
    as (
      
with stg_employer_details_1 as (
select
    * except (`tax id`,`line by line` ),
    lpad(cast(cast(`tax id` as int64) as string), 4, '0') as tax_id,
    CAST(REPLACE(`line by line`, ',', '') AS INT64) AS employer_no
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`employer_details`
),
stg_employer_details as (
    select
    employer_no,
    `fiscal year   ` as fiscal_year,
    `employer petitioner name` as employer_petitioner_name,
    tax_id as tax_id,
    `industry naics code` as naics_code,
    `petitioner city` as petitioner_city,
    `petitioner state` as petitioner_state,
    `petitioner zip code` as petitioner_zip_code,
    `initial approval` as initial_approval,
    `initial denial` as initial_denial,
    `continuing approval` as continuing_approval,
    `continuing denial` as continuing_denial,
    _data_source, _load_time
from stg_employer_details_1
) 
select * from stg_employer_details
    );
  
[0m22:58:43.656086 [debug] [Thread-1 (]: On model.cs329e_xh.company_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.company_data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
      
    
    

    OPTIONS()
    as (
      
with stg_company_data as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`company_data`
)
select * from stg_company_data
    );
  
[0m22:58:43.969779 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:bb027fba-b2ad-4829-bf47-e9d1e8f006b2&page=queryresults
[0m22:58:44.049316 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:281d9811-6dc0-4967-bf8e-52d4293bd188&page=queryresults
[0m22:58:46.118723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46cb105b0>]}
[0m22:58:46.120006 [info ] [Thread-1 (]: 1 of 31 OK created sql table model dbt_cs329e_xh_stg.company_data .............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 2.70s]
[0m22:58:46.121416 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_data
[0m22:58:46.122441 [debug] [Thread-1 (]: Began running node model.cs329e_xh.h1b_sentiment_analysis
[0m22:58:46.123834 [info ] [Thread-1 (]: 3 of 31 START sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis ......... [RUN]
[0m22:58:46.124922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.company_data, now model.cs329e_xh.h1b_sentiment_analysis)
[0m22:58:46.125606 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.h1b_sentiment_analysis
[0m22:58:46.131109 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m22:58:46.132125 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.h1b_sentiment_analysis
[0m22:58:46.135989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:46.281874 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.h1b_sentiment_analysis"
[0m22:58:46.283133 [debug] [Thread-1 (]: On model.cs329e_xh.h1b_sentiment_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.h1b_sentiment_analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
      
    
    

    OPTIONS()
    as (
      
with stg_senti as (
select * 
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`h1b_sentiment_analysis`
)
select * from stg_senti
    );
  
[0m22:58:46.572089 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46cb106a0>]}
[0m22:58:46.573316 [info ] [Thread-2 (]: 2 of 31 OK created sql table model dbt_cs329e_xh_stg.employer_details .......... [[32mCREATE TABLE (61.5k rows, 9.3 MiB processed)[0m in 3.16s]
[0m22:58:46.574536 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.employer_details
[0m22:58:46.575276 [debug] [Thread-2 (]: Began running node model.cs329e_xh.lca_appendix
[0m22:58:46.576297 [info ] [Thread-2 (]: 4 of 31 START sql table model dbt_cs329e_xh_stg.lca_appendix ................... [RUN]
[0m22:58:46.577174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.employer_details, now model.cs329e_xh.lca_appendix)
[0m22:58:46.577813 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.lca_appendix
[0m22:58:46.582908 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.lca_appendix"
[0m22:58:46.583871 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.lca_appendix
[0m22:58:46.587802 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:58:46.666326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9d064987-5d25-46c3-837e-7d703994f052&page=queryresults
[0m22:58:46.708423 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.lca_appendix"
[0m22:58:46.709600 [debug] [Thread-2 (]: On model.cs329e_xh.lca_appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_appendix as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_appendix`
)
select * from stg_lca_appendix
    );
  
[0m22:58:47.110713 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6ff83ffb-8c82-4b8a-a629-8df7a5e2cc06&page=queryresults
[0m22:58:48.661380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc488e8e590>]}
[0m22:58:48.662679 [info ] [Thread-1 (]: 3 of 31 OK created sql table model dbt_cs329e_xh_stg.h1b_sentiment_analysis .... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 2.54s]
[0m22:58:48.663836 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.h1b_sentiment_analysis
[0m22:58:48.664695 [debug] [Thread-1 (]: Began running node model.cs329e_xh.lca_disclosure
[0m22:58:48.665717 [info ] [Thread-1 (]: 5 of 31 START sql table model dbt_cs329e_xh_stg.lca_disclosure ................. [RUN]
[0m22:58:48.667068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.h1b_sentiment_analysis, now model.cs329e_xh.lca_disclosure)
[0m22:58:48.667707 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.lca_disclosure
[0m22:58:48.673247 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.lca_disclosure"
[0m22:58:48.674308 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.lca_disclosure
[0m22:58:48.678192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:48.803160 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.lca_disclosure"
[0m22:58:48.804423 [debug] [Thread-1 (]: On model.cs329e_xh.lca_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
      
    
    

    OPTIONS()
    as (
      
with s as (
SELECT
    * EXCEPT (received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage, total_worksite_locations),
    SAFE_CAST(received_date AS DATETIME) AS received_date,
    SAFE_CAST(decision_date AS DATETIME) AS decision_date,
    SAFE_CAST(original_cert_date AS DATETIME) AS original_cert_date,
    
    SAFE_CAST(total_worker_positions AS INT64) AS total_worker_positions,
    SAFE_CAST(new_employment AS INT64) AS new_employment,
    SAFE_CAST(continued_employment AS INT64) AS continued_employment,
    SAFE_CAST(change_previous_employment AS INT64) AS change_previous_employment,
    SAFE_CAST(new_concurrent_employment AS INT64) AS new_concurrent_employment,
    SAFE_CAST(change_employer AS INT64) AS change_employer,
    SAFE_CAST(amended_petition AS INT64) AS amended_petition,
    SAFE_CAST(worksite_workers AS INT64) AS worksite_workers,
    SAFE_CAST(total_worksite_locations AS INT64) AS total_worksite_locations,

    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_from, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_from,
    SAFE_CAST(REGEXP_REPLACE(wage_rate_of_pay_to, r'[\$,]', '') AS FLOAT64) AS wage_rate_of_pay_to,
    SAFE_CAST(REGEXP_REPLACE(prevailing_wage, r'[\$,]', '') AS FLOAT64) AS prevailing_wage

FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_disclosure`
    )
select * from s
    );
  
[0m22:58:48.849195 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465b64bb0>]}
[0m22:58:48.850501 [info ] [Thread-2 (]: 4 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_appendix .............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 2.27s]
[0m22:58:48.851609 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.lca_appendix
[0m22:58:48.852457 [debug] [Thread-2 (]: Began running node model.cs329e_xh.lca_worksites
[0m22:58:48.853270 [info ] [Thread-2 (]: 6 of 31 START sql table model dbt_cs329e_xh_stg.lca_worksites .................. [RUN]
[0m22:58:48.854288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_appendix, now model.cs329e_xh.lca_worksites)
[0m22:58:48.854934 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.lca_worksites
[0m22:58:48.860524 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.lca_worksites"
[0m22:58:48.861512 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.lca_worksites
[0m22:58:48.865363 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:58:48.983391 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.lca_worksites"
[0m22:58:48.984591 [debug] [Thread-2 (]: On model.cs329e_xh.lca_worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.lca_worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
      
    
    

    OPTIONS()
    as (
      
with stg_lca_worksites as (
select * except(worksite_workers, pw_other_year),
        cast(worksite_workers as int64) as worksite_workers,
        cast(pw_other_year as int64) as pw_other_year
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`lca_worksites`
)
select * from stg_lca_worksites
    );
  
[0m22:58:49.123916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:0e00fd05-1e8e-4beb-993a-c8a5b6980bc2&page=queryresults
[0m22:58:49.318732 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:4ff4a38c-35cd-477a-a1d3-44b1ea535cf3&page=queryresults
[0m22:58:55.881071 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465c367a0>]}
[0m22:58:55.882383 [info ] [Thread-2 (]: 6 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_worksites ............. [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 7.03s]
[0m22:58:55.883641 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.lca_worksites
[0m22:58:55.884362 [debug] [Thread-2 (]: Began running node model.cs329e_xh.pw_disclosure
[0m22:58:55.885239 [info ] [Thread-2 (]: 7 of 31 START sql table model dbt_cs329e_xh_stg.pw_disclosure .................. [RUN]
[0m22:58:55.886607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_worksites, now model.cs329e_xh.pw_disclosure)
[0m22:58:55.887323 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.pw_disclosure
[0m22:58:55.892648 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.pw_disclosure"
[0m22:58:55.893606 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.pw_disclosure
[0m22:58:55.897564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:58:56.023593 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.pw_disclosure"
[0m22:58:56.024813 [debug] [Thread-2 (]: On model.cs329e_xh.pw_disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.pw_disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
      
    
    

    OPTIONS()
    as (
      
with temp as (
select 
    * except(required_experience_months, required_training_months, alt_training_months, alt_experience_months),
    cast(required_training_months as int64) as required_training_months,
    cast(required_experience_months as int64) as required_experience_months,
    cast(alt_training_months as int64) as alt_training_months,
    cast(alt_experience_months as int64) as alt_experience_months
from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`pw_disclosure`
),
stg_pw_disclosure as (
    select 
    * except(bls_area),
    SPLIT(bls_area, ',')[SAFE_OFFSET(0)] AS bls_city,
    IFNULL(SPLIT(bls_area, ',')[SAFE_OFFSET(1)], '') AS bls_state
from temp)
select * from stg_pw_disclosure
    );
  
[0m22:58:56.380400 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c0b2d66e-2689-42b6-a3b5-fda7cc8b3774&page=queryresults
[0m22:58:58.797529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46cb11210>]}
[0m22:58:58.798755 [info ] [Thread-1 (]: 5 of 31 OK created sql table model dbt_cs329e_xh_stg.lca_disclosure ............ [[32mCREATE TABLE (561.0k rows, 485.1 MiB processed)[0m in 10.13s]
[0m22:58:58.799866 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.lca_disclosure
[0m22:58:58.800629 [debug] [Thread-1 (]: Began running node model.cs329e_xh.single_registrations
[0m22:58:58.802228 [info ] [Thread-1 (]: 8 of 31 START sql table model dbt_cs329e_xh_stg.single_registrations ........... [RUN]
[0m22:58:58.803113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.lca_disclosure, now model.cs329e_xh.single_registrations)
[0m22:58:58.803738 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.single_registrations
[0m22:58:58.808837 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.single_registrations"
[0m22:58:58.809810 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.single_registrations
[0m22:58:58.815576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:59.049957 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.single_registrations"
[0m22:58:59.051205 [debug] [Thread-1 (]: On model.cs329e_xh.single_registrations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.single_registrations"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
      
    
    

    OPTIONS()
    as (
      
with t1 as (
select
    case bcn when '(b)(6)' THEN NULL ELSE bcn END AS bcn,
    case receipt_number when '(b)(6)' THEN NULL ELSE receipt_number END AS receipt_number,
    case ben_date_of_birth when '(b)(6)' THEN NULL ELSE ben_date_of_birth END AS ben_date_of_birth,
    case dol_eta_case_number when '(b)(6)' THEN NULL ELSE dol_eta_case_number END AS dol_eta_case_number,
    *
EXCEPT (bcn, receipt_number, ben_date_of_birth, dol_eta_case_number)
FROM `silken-fortress-448205-p9`.`cs329e_xh_raw`.`single_registrations`
WHERE bcn != '(b)(3) (b)(6) (b)(7)(c)'
)
, t2 as (select * except(bcn, receipt_number, ben_date_of_birth, dol_eta_case_number, t_u_vawa_flag)
FROM t1)
select * from t2
    );
  
[0m22:58:59.370186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:52858b5f-9ca6-420a-baf7-c84a496d5d6d&page=queryresults
[0m22:59:03.806237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465b5c310>]}
[0m22:59:03.807972 [info ] [Thread-1 (]: 8 of 31 OK created sql table model dbt_cs329e_xh_stg.single_registrations ...... [[32mCREATE TABLE (350.1k rows, 78.4 MiB processed)[0m in 5.00s]
[0m22:59:03.809675 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.single_registrations
[0m22:59:03.810462 [debug] [Thread-1 (]: Began running node model.cs329e_xh.wage_summary
[0m22:59:03.811732 [info ] [Thread-1 (]: 9 of 31 START sql table model dbt_cs329e_xh_stg.wage_summary ................... [RUN]
[0m22:59:03.812630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.single_registrations, now model.cs329e_xh.wage_summary)
[0m22:59:03.813302 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.wage_summary
[0m22:59:03.818947 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.wage_summary"
[0m22:59:03.819951 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.wage_summary
[0m22:59:03.823839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:03.933649 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.wage_summary"
[0m22:59:03.934902 [debug] [Thread-1 (]: On model.cs329e_xh.wage_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.wage_summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
      
    
    

    OPTIONS()
    as (
      
with stg_wage_summary as (
select * from `silken-fortress-448205-p9`.`cs329e_xh_raw`.`wage_summary`
)
select * from stg_wage_summary
    );
  
[0m22:59:04.242740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3b9af24d-34a8-45b7-9b06-5b1dd069f1ba&page=queryresults
[0m22:59:05.955607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465b82890>]}
[0m22:59:05.956801 [info ] [Thread-1 (]: 9 of 31 OK created sql table model dbt_cs329e_xh_stg.wage_summary .............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 2.14s]
[0m22:59:05.958023 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.wage_summary
[0m22:59:05.958931 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Company_Data
[0m22:59:05.960143 [info ] [Thread-1 (]: 10 of 31 START sql table model dbt_cs329e_xh_int.Company_Data .................. [RUN]
[0m22:59:05.961146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.wage_summary, now model.cs329e_xh.Company_Data)
[0m22:59:05.961777 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Company_Data
[0m22:59:05.966515 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Company_Data"
[0m22:59:05.967455 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Company_Data
[0m22:59:05.971249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:06.106861 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:06.501682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:a8fd1657-6375-4513-a8f3-2f1c764e2433&page=queryresults
[0m22:59:06.629876 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as int64)
 as count, 
      
    cast(null as string)
 as employer_url, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:06.885845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:fcd5d517-8bb8-4a4b-b5e9-3582ad5182d0&page=queryresults
[0m22:59:07.009223 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:59:07.018216 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Company_Data"
[0m22:59:07.019357 [debug] [Thread-1 (]: On model.cs329e_xh.Company_Data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Company_Data"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Company_Data`
        
  (
    employer_name string primary key not enforced,
    count int64,
    employer_url string,
    _data_source string,
    _load_time datetime
    
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_name, count, employer_url, _data_source, _load_time
    from (
        with int_cd AS
(
    SELECT 
    employer_name, 
    count,  
    employer_url, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`company_data`
) select * from int_cd
    ) as model_subq
    );
  
[0m22:59:07.311593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1cc5c2b9-a78e-4a52-a70a-593c1327eab1&page=queryresults
[0m22:59:08.806494 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465b64bb0>]}
[0m22:59:08.808404 [info ] [Thread-2 (]: 7 of 31 OK created sql table model dbt_cs329e_xh_stg.pw_disclosure ............. [[32mCREATE TABLE (237.9k rows, 372.8 MiB processed)[0m in 12.92s]
[0m22:59:08.809906 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.pw_disclosure
[0m22:59:08.810861 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Sentiment_Analysis
[0m22:59:08.812454 [info ] [Thread-2 (]: 11 of 31 START sql table model dbt_cs329e_xh_int.Sentiment_Analysis ............ [RUN]
[0m22:59:08.813760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.pw_disclosure, now model.cs329e_xh.Sentiment_Analysis)
[0m22:59:08.814451 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Sentiment_Analysis
[0m22:59:08.821451 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Sentiment_Analysis"
[0m22:59:08.823044 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Sentiment_Analysis
[0m22:59:08.828840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:08.955488 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:09.032381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46cb10910>]}
[0m22:59:09.033690 [info ] [Thread-1 (]: 10 of 31 OK created sql table model dbt_cs329e_xh_int.Company_Data ............. [[32mCREATE TABLE (4.1k rows, 496.7 KiB processed)[0m in 3.07s]
[0m22:59:09.035085 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Company_Data
[0m22:59:09.035847 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Appendix
[0m22:59:09.036855 [info ] [Thread-1 (]: 12 of 31 START sql table model dbt_cs329e_xh_int.LCA_Appendix .................. [RUN]
[0m22:59:09.037750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Company_Data, now model.cs329e_xh.LCA_Appendix)
[0m22:59:09.038415 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Appendix
[0m22:59:09.043258 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Appendix"
[0m22:59:09.044212 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Appendix
[0m22:59:09.048164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:09.211831 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:09.526258 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:c1702577-d664-4448-ae72-f6e2163c5781&page=queryresults
[0m22:59:09.557322 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2b50edfe-78c7-42bb-a1c8-8c12b2c047ba&page=queryresults
[0m22:59:09.630227 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: select * from (
        select
    
      
    cast(null as datetime)
 as publication_date, 
      
    cast(null as string)
 as text_summary, 
      
    cast(null as string)
 as sentiment, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:09.674259 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as datetime)
 as appx_a_date_of_degree, 
      
    cast(null as string)
 as appx_a_name_of_institution, 
      
    cast(null as int64)
 as appx_a_no_of_exempt_workers, 
      
    cast(null as string)
 as appx_a_field_of_study, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:09.927156 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:dafaee0e-a23b-4205-b849-1607016d2741&page=queryresults
[0m22:59:09.958503 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:3874dbbb-6119-4662-9466-dc725ad2196c&page=queryresults
[0m22:59:10.040999 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:59:10.043348 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Sentiment_Analysis"
[0m22:59:10.044698 [debug] [Thread-2 (]: On model.cs329e_xh.Sentiment_Analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Sentiment_Analysis"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
        
  (
    publication_date datetime primary key not enforced,
    text_summary string,
    sentiment string,
    _data_source string,
    _load_time datetime
    
    )

      
    
    

    OPTIONS()
    as (
      
    select publication_date, text_summary, sentiment, _data_source, _load_time
    from (
        with ints as(
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`h1b_sentiment_analysis`
)
select * from ints
    ) as model_subq
    );
  
[0m22:59:10.062044 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:59:10.063992 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Appendix"
[0m22:59:10.065149 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Appendix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Appendix"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix`
        
  (
    case_number string,
    appx_a_date_of_degree datetime,
    appx_a_name_of_institution string,
    appx_a_no_of_exempt_workers int64,
    appx_a_field_of_study string,
    _data_source string,
    _load_time datetime,
    
    primary key (case_number, appx_a_date_of_degree) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select case_number, appx_a_date_of_degree, appx_a_name_of_institution, appx_a_no_of_exempt_workers, appx_a_field_of_study, _data_source, _load_time
    from (
        with int_lca AS (
SELECT 
    case_number,  
    appx_a_date_of_degree, 
    appx_a_name_of_institution,  
    appx_a_no_of_exempt_workers,  
    appx_a_field_of_study, 
    _data_source, 
    _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_appendix`
)
select * from int_lca
    ) as model_subq
    );
  
[0m22:59:10.346793 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1b29047e-9890-45aa-bbe1-61d1a32ec9aa&page=queryresults
[0m22:59:10.588305 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eb70809f-08f4-426a-aa65-4f800d9436f1&page=queryresults
[0m22:59:12.056076 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46c933370>]}
[0m22:59:12.057225 [info ] [Thread-2 (]: 11 of 31 OK created sql table model dbt_cs329e_xh_int.Sentiment_Analysis ....... [[32mCREATE TABLE (6.0 rows, 2.7 KiB processed)[0m in 3.24s]
[0m22:59:12.058528 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Sentiment_Analysis
[0m22:59:12.059274 [debug] [Thread-2 (]: Began running node model.cs329e_xh.LCA_Worksites
[0m22:59:12.060327 [info ] [Thread-2 (]: 13 of 31 START sql table model dbt_cs329e_xh_int.LCA_Worksites ................. [RUN]
[0m22:59:12.061356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Sentiment_Analysis, now model.cs329e_xh.LCA_Worksites)
[0m22:59:12.061969 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.LCA_Worksites
[0m22:59:12.067258 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Worksites"
[0m22:59:12.068158 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.LCA_Worksites
[0m22:59:12.072167 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:12.164991 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:12.520545 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:28194793-b9ea-4afe-be3b-a04e01dc144a&page=queryresults
[0m22:59:12.549464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46ce5f220>]}
[0m22:59:12.550654 [info ] [Thread-1 (]: 12 of 31 OK created sql table model dbt_cs329e_xh_int.LCA_Appendix ............. [[32mCREATE TABLE (511.0 rows, 60.2 KiB processed)[0m in 3.51s]
[0m22:59:12.551719 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Appendix
[0m22:59:12.552496 [debug] [Thread-1 (]: Began running node model.cs329e_xh.LCA_Disclosure
[0m22:59:12.553489 [info ] [Thread-1 (]: 14 of 31 START sql table model dbt_cs329e_xh_int.LCA_Disclosure ................ [RUN]
[0m22:59:12.554421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Appendix, now model.cs329e_xh.LCA_Disclosure)
[0m22:59:12.555027 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.LCA_Disclosure
[0m22:59:12.560080 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.LCA_Disclosure"
[0m22:59:12.560947 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.LCA_Disclosure
[0m22:59:12.565179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:12.612618 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: select * from (
        select
    
      
    cast(null as string)
 as row_id, 
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as float64)
 as prevailing_wage, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as pw_other_year
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:12.693219 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:12.928823 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1efcc251-293f-42d5-82d4-b7ff0a2d9d74&page=queryresults
[0m22:59:13.015452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ffefa061-4548-42c7-9c0c-d20b643af302&page=queryresults
[0m22:59:13.188028 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:59:13.195753 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Worksites"
[0m22:59:13.206623 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: select * from (
        select
    
      
    cast(null as string)
 as case_number, 
      
    cast(null as string)
 as case_status, 
      
    cast(null as string)
 as visa_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as soc_code, 
      
    cast(null as string)
 as soc_title, 
      
    cast(null as string)
 as full_time_position, 
      
    cast(null as string)
 as begin_date, 
      
    cast(null as string)
 as end_date, 
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as trade_name_dba, 
      
    cast(null as string)
 as employer_address1, 
      
    cast(null as string)
 as employer_address2, 
      
    cast(null as string)
 as employer_city, 
      
    cast(null as string)
 as employer_state, 
      
    cast(null as string)
 as employer_postal_code, 
      
    cast(null as string)
 as employer_country, 
      
    cast(null as string)
 as employer_province, 
      
    cast(null as string)
 as employer_phone, 
      
    cast(null as string)
 as employer_phone_ext, 
      
    cast(null as string)
 as employer_fein, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as employer_poc_last_name, 
      
    cast(null as string)
 as employer_poc_first_name, 
      
    cast(null as string)
 as employer_poc_middle_name, 
      
    cast(null as string)
 as employer_poc_job_title, 
      
    cast(null as string)
 as employer_poc_address1, 
      
    cast(null as string)
 as employer_poc_address2, 
      
    cast(null as string)
 as employer_poc_city, 
      
    cast(null as string)
 as employer_poc_state, 
      
    cast(null as string)
 as employer_poc_postal_code, 
      
    cast(null as string)
 as employer_poc_country, 
      
    cast(null as string)
 as employer_poc_province, 
      
    cast(null as string)
 as employer_poc_phone, 
      
    cast(null as string)
 as employer_poc_phone_ext, 
      
    cast(null as string)
 as employer_poc_email, 
      
    cast(null as string)
 as agent_representing_employer, 
      
    cast(null as string)
 as agent_attorney_last_name, 
      
    cast(null as string)
 as agent_attorney_first_name, 
      
    cast(null as string)
 as agent_attorney_middle_name, 
      
    cast(null as string)
 as agent_attorney_address1, 
      
    cast(null as string)
 as agent_attorney_address2, 
      
    cast(null as string)
 as agent_attorney_city, 
      
    cast(null as string)
 as agent_attorney_state, 
      
    cast(null as string)
 as agent_attorney_postal_code, 
      
    cast(null as string)
 as agent_attorney_country, 
      
    cast(null as string)
 as agent_attorney_province, 
      
    cast(null as string)
 as agent_attorney_phone, 
      
    cast(null as string)
 as agent_attorney_phone_ext, 
      
    cast(null as string)
 as agent_attorney_email_address, 
      
    cast(null as string)
 as lawfirm_name_business_name, 
      
    cast(null as string)
 as state_of_highest_court, 
      
    cast(null as string)
 as name_of_highest_state_court, 
      
    cast(null as string)
 as secondary_entity, 
      
    cast(null as string)
 as secondary_entity_business_name, 
      
    cast(null as string)
 as worksite_address1, 
      
    cast(null as string)
 as worksite_address2, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_county, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_postal_code, 
      
    cast(null as string)
 as wage_unit_of_pay, 
      
    cast(null as string)
 as pw_unit_of_pay, 
      
    cast(null as string)
 as pw_tracking_number, 
      
    cast(null as string)
 as pw_wage_level, 
      
    cast(null as string)
 as pw_oes_year, 
      
    cast(null as string)
 as pw_other_source, 
      
    cast(null as string)
 as pw_other_year, 
      
    cast(null as string)
 as pw_survey_publisher, 
      
    cast(null as string)
 as pw_survey_name, 
      
    cast(null as string)
 as agree_to_lc_statement, 
      
    cast(null as string)
 as h_1b_dependent, 
      
    cast(null as string)
 as willful_violator, 
      
    cast(null as string)
 as support_h1b, 
      
    cast(null as string)
 as statutory_basis, 
      
    cast(null as string)
 as appendix_a_attached, 
      
    cast(null as string)
 as public_disclosure, 
      
    cast(null as string)
 as preparer_last_name, 
      
    cast(null as string)
 as preparer_first_name, 
      
    cast(null as string)
 as preparer_middle_initial, 
      
    cast(null as string)
 as preparer_business_name, 
      
    cast(null as string)
 as preparer_email, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time, 
      
    cast(null as datetime)
 as received_date, 
      
    cast(null as datetime)
 as decision_date, 
      
    cast(null as datetime)
 as original_cert_date, 
      
    cast(null as int64)
 as total_worker_positions, 
      
    cast(null as int64)
 as new_employment, 
      
    cast(null as int64)
 as continued_employment, 
      
    cast(null as int64)
 as change_previous_employment, 
      
    cast(null as int64)
 as new_concurrent_employment, 
      
    cast(null as int64)
 as change_employer, 
      
    cast(null as int64)
 as amended_petition, 
      
    cast(null as int64)
 as worksite_workers, 
      
    cast(null as int64)
 as total_worksite_locations, 
      
    cast(null as float64)
 as wage_rate_of_pay_from, 
      
    cast(null as float64)
 as wage_rate_of_pay_to, 
      
    cast(null as float64)
 as prevailing_wage
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:13.210094 [debug] [Thread-2 (]: On model.cs329e_xh.LCA_Worksites: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Worksites"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites`
        
  (
    row_id string primary key not enforced,
    case_number string,
    secondary_entity string,
    secondary_entity_business_name string,
    worksite_address1 string,
    worksite_address2 string,
    worksite_city string,
    worksite_county string,
    worksite_state string,
    worksite_postal_code string,
    wage_rate_of_pay_from float64,
    wage_rate_of_pay_to float64,
    wage_unit_of_pay string,
    prevailing_wage float64,
    pw_unit_of_pay string,
    pw_tracking_number string,
    pw_wage_level string,
    pw_oes_year string,
    pw_other_source string,
    pw_survey_publisher string,
    pw_survey_name string,
    _data_source string,
    _load_time datetime,
    worksite_workers int64,
    pw_other_year int64
    
    )

      
    
    

    OPTIONS()
    as (
      
    select row_id, case_number, secondary_entity, secondary_entity_business_name, worksite_address1, worksite_address2, worksite_city, worksite_county, worksite_state, worksite_postal_code, wage_rate_of_pay_from, wage_rate_of_pay_to, wage_unit_of_pay, prevailing_wage, pw_unit_of_pay, pw_tracking_number, pw_wage_level, pw_oes_year, pw_other_source, pw_survey_publisher, pw_survey_name, _data_source, _load_time, worksite_workers, pw_other_year
    from (
        with lw as(
    select *
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_worksites`
),
int_lw as(
SELECT 
    GENERATE_UUID() AS row_id,  -- Assign a unique UUID
    lw.*  
FROM lw
)
select * from int_lw
    ) as model_subq
    );
  
[0m22:59:13.457263 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:881ca021-7156-4408-a3ff-92eea256336c&page=queryresults
[0m22:59:13.468152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ce2cf70e-8a72-491c-a450-2c6a7082f9d1&page=queryresults
[0m22:59:13.610688 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:59:13.614242 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.LCA_Disclosure"
[0m22:59:13.615633 [debug] [Thread-1 (]: On model.cs329e_xh.LCA_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.LCA_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
        
  (
    case_number string,
    case_status string,
    visa_class string,
    job_title string,
    soc_code string,
    soc_title string,
    full_time_position string,
    begin_date string,
    end_date string,
    employer_name string,
    trade_name_dba string,
    employer_address1 string,
    employer_address2 string,
    employer_city string,
    employer_state string,
    employer_postal_code string,
    employer_country string,
    employer_province string,
    employer_phone string,
    employer_phone_ext string,
    employer_fein string,
    naics_code string,
    employer_poc_last_name string,
    employer_poc_first_name string,
    employer_poc_middle_name string,
    employer_poc_job_title string,
    employer_poc_address1 string,
    employer_poc_address2 string,
    employer_poc_city string,
    employer_poc_state string,
    employer_poc_postal_code string,
    employer_poc_country string,
    employer_poc_province string,
    employer_poc_phone string,
    employer_poc_phone_ext string,
    employer_poc_email string,
    agent_representing_employer string,
    agent_attorney_last_name string,
    agent_attorney_first_name string,
    agent_attorney_middle_name string,
    agent_attorney_address1 string,
    agent_attorney_address2 string,
    agent_attorney_city string,
    agent_attorney_state string,
    agent_attorney_postal_code string,
    agent_attorney_country string,
    agent_attorney_province string,
    agent_attorney_phone string,
    agent_attorney_phone_ext string,
    agent_attorney_email_address string,
    lawfirm_name_business_name string,
    state_of_highest_court string,
    name_of_highest_state_court string,
    secondary_entity string,
    secondary_entity_business_name string,
    worksite_address1 string,
    worksite_address2 string,
    worksite_city string,
    worksite_county string,
    worksite_state string,
    worksite_postal_code string,
    wage_unit_of_pay string,
    pw_unit_of_pay string,
    pw_tracking_number string,
    pw_wage_level string,
    pw_oes_year string,
    pw_other_source string,
    pw_other_year string,
    pw_survey_publisher string,
    pw_survey_name string,
    agree_to_lc_statement string,
    h_1b_dependent string,
    willful_violator string,
    support_h1b string,
    statutory_basis string,
    appendix_a_attached string,
    public_disclosure string,
    preparer_last_name string,
    preparer_first_name string,
    preparer_middle_initial string,
    preparer_business_name string,
    preparer_email string,
    _data_source string,
    _load_time datetime,
    received_date datetime,
    decision_date datetime,
    original_cert_date datetime,
    total_worker_positions int64,
    new_employment int64,
    continued_employment int64,
    change_previous_employment int64,
    new_concurrent_employment int64,
    change_employer int64,
    amended_petition int64,
    worksite_workers int64,
    total_worksite_locations int64,
    wage_rate_of_pay_from float64,
    wage_rate_of_pay_to float64,
    prevailing_wage float64,
    
    primary key (case_number, employer_name) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select case_number, case_status, visa_class, job_title, soc_code, soc_title, full_time_position, begin_date, end_date, employer_name, trade_name_dba, employer_address1, employer_address2, employer_city, employer_state, employer_postal_code, employer_country, employer_province, employer_phone, employer_phone_ext, employer_fein, naics_code, employer_poc_last_name, employer_poc_first_name, employer_poc_middle_name, employer_poc_job_title, employer_poc_address1, employer_poc_address2, employer_poc_city, employer_poc_state, employer_poc_postal_code, employer_poc_country, employer_poc_province, employer_poc_phone, employer_poc_phone_ext, employer_poc_email, agent_representing_employer, agent_attorney_last_name, agent_attorney_first_name, agent_attorney_middle_name, agent_attorney_address1, agent_attorney_address2, agent_attorney_city, agent_attorney_state, agent_attorney_postal_code, agent_attorney_country, agent_attorney_province, agent_attorney_phone, agent_attorney_phone_ext, agent_attorney_email_address, lawfirm_name_business_name, state_of_highest_court, name_of_highest_state_court, secondary_entity, secondary_entity_business_name, worksite_address1, worksite_address2, worksite_city, worksite_county, worksite_state, worksite_postal_code, wage_unit_of_pay, pw_unit_of_pay, pw_tracking_number, pw_wage_level, pw_oes_year, pw_other_source, pw_other_year, pw_survey_publisher, pw_survey_name, agree_to_lc_statement, h_1b_dependent, willful_violator, support_h1b, statutory_basis, appendix_a_attached, public_disclosure, preparer_last_name, preparer_first_name, preparer_middle_initial, preparer_business_name, preparer_email, _data_source, _load_time, received_date, decision_date, original_cert_date, total_worker_positions, new_employment, continued_employment, change_previous_employment, new_concurrent_employment, change_employer, amended_petition, worksite_workers, total_worksite_locations, wage_rate_of_pay_from, wage_rate_of_pay_to, prevailing_wage
    from (
        with lca_d as (
    select * from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`lca_disclosure`
)
select * from lca_d
    ) as model_subq
    );
  
[0m22:59:13.916291 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:ca599a5a-0a6d-4e19-a880-f3af8dc149d9&page=queryresults
[0m22:59:22.799105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc489c5a9e0>]}
[0m22:59:22.800263 [info ] [Thread-1 (]: 14 of 31 OK created sql table model dbt_cs329e_xh_int.LCA_Disclosure ........... [[32mCREATE TABLE (561.0k rows, 495.2 MiB processed)[0m in 10.24s]
[0m22:59:22.801426 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.LCA_Disclosure
[0m22:59:22.802417 [debug] [Thread-1 (]: Began running node model.cs329e_xh.Single_Registration
[0m22:59:22.803445 [info ] [Thread-1 (]: 15 of 31 START sql table model dbt_cs329e_xh_int.Single_Registration ........... [RUN]
[0m22:59:22.804545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Disclosure, now model.cs329e_xh.Single_Registration)
[0m22:59:22.805276 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.Single_Registration
[0m22:59:22.810742 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.Single_Registration"
[0m22:59:22.811682 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.Single_Registration
[0m22:59:22.816025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:22.948750 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: select * from (
        with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:23.350834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:d8a5b969-cbc6-40e6-b72b-abc87fd4ee27&page=queryresults
[0m22:59:23.453043 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: select * from (
        select
    
      
    cast(null as string)
 as employer_name, 
      
    cast(null as string)
 as ben_year_of_birth, 
      
    cast(null as string)
 as gender, 
      
    cast(null as string)
 as agent_first_name, 
      
    cast(null as string)
 as agent_last_name, 
      
    cast(null as string)
 as mail_addr, 
      
    cast(null as string)
 as country_of_birth, 
      
    cast(null as string)
 as country_of_nationality, 
      
    cast(null as string)
 as fein, 
      
    cast(null as string)
 as city, 
      
    cast(null as string)
 as state, 
      
    cast(null as string)
 as zip, 
      
    cast(null as string)
 as lottery_year, 
      
    cast(null as string)
 as status_type, 
      
    cast(null as string)
 as ben_multi_reg_ind, 
      
    cast(null as string)
 as rec_date, 
      
    cast(null as string)
 as first_decision, 
      
    cast(null as string)
 as first_decision_date, 
      
    cast(null as string)
 as i129_employer_name, 
      
    cast(null as string)
 as pet_street, 
      
    cast(null as string)
 as pet_city, 
      
    cast(null as string)
 as pet_state, 
      
    cast(null as string)
 as pet_zip, 
      
    cast(null as string)
 as requested_class, 
      
    cast(null as string)
 as basis_for_classification, 
      
    cast(null as string)
 as requested_action, 
      
    cast(null as string)
 as number_of_beneficiaries, 
      
    cast(null as string)
 as ben_sex, 
      
    cast(null as string)
 as ben_country_of_birth, 
      
    cast(null as string)
 as ben_current_class, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as string)
 as worksite_street, 
      
    cast(null as string)
 as worksite_city, 
      
    cast(null as string)
 as worksite_state, 
      
    cast(null as string)
 as worksite_zip, 
      
    cast(null as string)
 as full_time_ind, 
      
    cast(null as string)
 as wage_amt, 
      
    cast(null as string)
 as wage_unit, 
      
    cast(null as string)
 as valid_from, 
      
    cast(null as string)
 as valid_to, 
      
    cast(null as string)
 as num_of_emp_in_us, 
      
    cast(null as string)
 as s1q1a, 
      
    cast(null as string)
 as s1q1b, 
      
    cast(null as string)
 as ben_education_code, 
      
    cast(null as string)
 as ed_level_definition, 
      
    cast(null as string)
 as ben_pfield_of_study, 
      
    cast(null as string)
 as ben_comp_paid, 
      
    cast(null as string)
 as dot_code, 
      
    cast(null as string)
 as naics_code, 
      
    cast(null as string)
 as s3q1, 
      
    cast(null as string)
 as s4q1, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:23.583470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46c9ff2b0>]}
[0m22:59:23.584695 [info ] [Thread-2 (]: 13 of 31 OK created sql table model dbt_cs329e_xh_int.LCA_Worksites ............ [[32mCREATE TABLE (841.6k rows, 154.3 MiB processed)[0m in 11.52s]
[0m22:59:23.585968 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.LCA_Worksites
[0m22:59:23.586823 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Wage_Summary
[0m22:59:23.588094 [info ] [Thread-2 (]: 16 of 31 START sql table model dbt_cs329e_xh_int.Wage_Summary .................. [RUN]
[0m22:59:23.589105 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.LCA_Worksites, now model.cs329e_xh.Wage_Summary)
[0m22:59:23.589766 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.Wage_Summary
[0m22:59:23.594916 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.Wage_Summary"
[0m22:59:23.595920 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.Wage_Summary
[0m22:59:23.600059 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:23.756401 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: select * from (
        with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:23.790732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7b137f86-1f48-4e77-be81-bf784df317b9&page=queryresults
[0m22:59:23.884987 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:59:23.888026 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.Single_Registration"
[0m22:59:23.889398 [debug] [Thread-1 (]: On model.cs329e_xh.Single_Registration: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Single_Registration"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Single_Registration`
        
  (
    employer_name string,
    ben_year_of_birth string,
    gender string,
    agent_first_name string,
    agent_last_name string,
    mail_addr string,
    country_of_birth string,
    country_of_nationality string,
    fein string,
    city string,
    state string,
    zip string,
    lottery_year string,
    status_type string,
    ben_multi_reg_ind string,
    rec_date string,
    first_decision string,
    first_decision_date string,
    i129_employer_name string,
    pet_street string,
    pet_city string,
    pet_state string,
    pet_zip string,
    requested_class string,
    basis_for_classification string,
    requested_action string,
    number_of_beneficiaries string,
    ben_sex string,
    ben_country_of_birth string,
    ben_current_class string,
    job_title string,
    worksite_street string,
    worksite_city string,
    worksite_state string,
    worksite_zip string,
    full_time_ind string,
    wage_amt string,
    wage_unit string,
    valid_from string,
    valid_to string,
    num_of_emp_in_us string,
    s1q1a string,
    s1q1b string,
    ben_education_code string,
    ed_level_definition string,
    ben_pfield_of_study string,
    ben_comp_paid string,
    dot_code string,
    naics_code string,
    s3q1 string,
    s4q1 string,
    _data_source string,
    _load_time datetime,
    
    primary key (employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select employer_name, ben_year_of_birth, gender, agent_first_name, agent_last_name, mail_addr, country_of_birth, country_of_nationality, fein, city, state, zip, lottery_year, status_type, ben_multi_reg_ind, rec_date, first_decision, first_decision_date, i129_employer_name, pet_street, pet_city, pet_state, pet_zip, requested_class, basis_for_classification, requested_action, number_of_beneficiaries, ben_sex, ben_country_of_birth, ben_current_class, job_title, worksite_street, worksite_city, worksite_state, worksite_zip, full_time_ind, wage_amt, wage_unit, valid_from, valid_to, num_of_emp_in_us, s1q1a, s1q1b, ben_education_code, ed_level_definition, ben_pfield_of_study, ben_comp_paid, dot_code, naics_code, s3q1, s4q1, _data_source, _load_time
    from (
        with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`)
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
    ) as model_subq
    );
  
[0m22:59:24.076547 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:1c66eb50-7b74-4735-b35e-bc6aa3c8b8cf&page=queryresults
[0m22:59:24.192634 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: select * from (
        select
    
      
    cast(null as string)
 as company_name, 
      
    cast(null as string)
 as job_title, 
      
    cast(null as int64)
 as min_wage, 
      
    cast(null as int64)
 as max_wage, 
      
    cast(null as float64)
 as average_wage, 
      
    cast(null as int64)
 as job_count, 
      
    cast(null as string)
 as _data_source, 
      
    cast(null as datetime)
 as _load_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m22:59:24.221291 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:2f77cacc-8bd3-4ddf-9b91-0d0b1b3b51fe&page=queryresults
[0m22:59:24.453165 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:5ea1ce42-b9e5-496a-9180-90a2de0194af&page=queryresults
[0m22:59:24.554592 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m22:59:24.556604 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.Wage_Summary"
[0m22:59:24.557726 [debug] [Thread-2 (]: On model.cs329e_xh.Wage_Summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.Wage_Summary"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Wage_Summary`
        
  (
    company_name string,
    job_title string,
    min_wage int64,
    max_wage int64,
    average_wage float64,
    job_count int64,
    _data_source string,
    _load_time datetime,
    
    primary key (company_name, job_title) not enforced
    )

      
    
    

    OPTIONS()
    as (
      
    select company_name, job_title, min_wage, max_wage, average_wage, job_count, _data_source, _load_time
    from (
        with ws as(
    select `company name` as `company_name`,
    `job title` as `job_title`,
    `min wage` as `min_wage`,
    `max wage` as `max_wage`,
    `average wage` as `average_wage`,
    `job count` as `job_count`,
    `_data_source`,
    `_load_time`
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`wage_summary`
),
ws2 as(
   WITH Ranked AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY company_name, job_title ORDER BY _load_time DESC) AS row_num
    FROM ws
)
SELECT * EXCEPT(row_num)
FROM Ranked
WHERE row_num = 1
)
select * from ws2
    ) as model_subq
    );
  
[0m22:59:24.850069 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:744da382-30ec-4411-bda0-cee404b247a3&page=queryresults
[0m22:59:26.802981 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46c9ea2f0>]}
[0m22:59:26.804308 [info ] [Thread-2 (]: 16 of 31 OK created sql table model dbt_cs329e_xh_int.Wage_Summary ............. [[32mCREATE TABLE (20.5k rows, 2.0 MiB processed)[0m in 3.21s]
[0m22:59:26.805690 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Wage_Summary
[0m22:59:26.806531 [debug] [Thread-2 (]: Began running node model.cs329e_xh.PW_Disclosure
[0m22:59:26.807780 [info ] [Thread-2 (]: 17 of 31 START sql table model dbt_cs329e_xh_int.PW_Disclosure ................. [RUN]
[0m22:59:26.808717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Wage_Summary, now model.cs329e_xh.PW_Disclosure)
[0m22:59:26.809394 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.PW_Disclosure
[0m22:59:26.814736 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.PW_Disclosure"
[0m22:59:26.815746 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.PW_Disclosure
[0m22:59:26.819741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:26.933313 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.PW_Disclosure"
[0m22:59:26.934585 [debug] [Thread-2 (]: On model.cs329e_xh.PW_Disclosure: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.PW_Disclosure"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`PW_Disclosure`
      
    
    

    OPTIONS()
    as (
      with p1 as (
    select * except(o_net_code_combo, o_net_title_combo),
if(o_net_code_combo is not null, split(o_net_code_combo,';'),null) as o_net_codes,
if(o_net_title_combo is not null, split(o_net_title_combo,';'),null) as o_net_titles,
from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
),
p2 as (select * except(employer_address_1, employer_address_2, employer_city, employer_state, employer_province, employer_postal_code, employer_country),
case
    when employer_poc_address1 = employer_address_1 then null
    else employer_address_1
end as employer_address_1,

case
    when employer_poc_address2 = employer_address_2 then null
    else employer_address_2
end as employer_address_2,

case
    when employer_poc_city = employer_city then null
    else employer_city
end as employer_city,

case
    when employer_poc_state = employer_state then null
    else employer_state
end as employer_state,

case
    when employer_poc_province = employer_province then null
    else employer_province
end as employer_province,

case
    when employer_poc_postal_code = employer_postal_code then null
    else employer_postal_code
end as employer_postal_code,

case
    when employer_poc_country = employer_country then null
    else employer_country
end as employer_country
from p1
)
select * from p2
    );
  
[0m22:59:27.269844 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:e3efb8c9-75c8-4e75-9527-76f6d820cdc6&page=queryresults
[0m22:59:29.669077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465bc0610>]}
[0m22:59:29.670346 [info ] [Thread-1 (]: 15 of 31 OK created sql table model dbt_cs329e_xh_int.Single_Registration ...... [[32mCREATE TABLE (237.8k rows, 75.7 MiB processed)[0m in 6.86s]
[0m22:59:29.671446 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.Single_Registration
[0m22:59:29.672144 [debug] [Thread-1 (]: Began running node model.cs329e_xh.temp_emp
[0m22:59:29.673112 [info ] [Thread-1 (]: 18 of 31 START sql table model dbt_cs329e_xh_int.temp_emp ...................... [RUN]
[0m22:59:29.673964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.Single_Registration, now model.cs329e_xh.temp_emp)
[0m22:59:29.674638 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.temp_emp
[0m22:59:29.679915 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.temp_emp"
[0m22:59:29.680833 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.temp_emp
[0m22:59:29.684833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:29.800062 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.temp_emp"
[0m22:59:29.801287 [debug] [Thread-1 (]: On model.cs329e_xh.temp_emp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_emp"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp`
      
    
    

    OPTIONS()
    as (
      with emp_sing as(
    select
    employer_name, fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`single_registrations`
),
emp_pw as(
    select
    employer_legal_business_name, employer_fein as fein
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`pw_disclosure`
    WHERE employer_legal_business_name is not null
),
des as (
    select distinct
    employer_name,fein
    FROM emp_sing)
, dep as(
    select distinct
    employer_legal_business_name, replace(fein,"-",'') as fein
    FROM emp_pw),
combined as (
    select employer_name, fein from des
  union all
  select  employer_legal_business_name as employer_name, fein from dep
)
SELECT
  ANY_VALUE(employer_name) AS employer_name, fein
FROM combined
GROUP BY fein
    );
  
[0m22:59:30.091525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:6df3aefe-e5b0-4aa0-8710-66e5ccc04846&page=queryresults
[0m22:59:38.614701 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465a7e440>]}
[0m22:59:38.615897 [info ] [Thread-2 (]: 17 of 31 OK created sql table model dbt_cs329e_xh_int.PW_Disclosure ............ [[32mCREATE TABLE (237.9k rows, 373.1 MiB processed)[0m in 11.81s]
[0m22:59:38.617170 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.PW_Disclosure
[0m22:59:38.617946 [debug] [Thread-2 (]: Began running node model.cs329e_xh.approval_rate_by_month
[0m22:59:38.619166 [info ] [Thread-2 (]: 19 of 31 START sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ........ [RUN]
[0m22:59:38.620262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.PW_Disclosure, now model.cs329e_xh.approval_rate_by_month)
[0m22:59:38.620916 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.approval_rate_by_month
[0m22:59:38.626406 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.approval_rate_by_month"
[0m22:59:38.627391 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.approval_rate_by_month
[0m22:59:38.631480 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:38.741373 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.approval_rate_by_month"
[0m22:59:38.742625 [debug] [Thread-2 (]: On model.cs329e_xh.approval_rate_by_month: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.approval_rate_by_month"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`approval_rate_by_month`
      
    
    

    OPTIONS()
    as (
      WITH monthly_windows AS (
    SELECT 
        EXTRACT (YEAR FROM publication_date) AS year,
        EXTRACT(MONTH FROM publication_date) AS month,
        MAX(publication_date) AS latest_date
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`Sentiment_Analysis`
    GROUP BY year, month
),
approval_rate_monthly AS (

    SELECT 
        EXTRACT(YEAR FROM decision_date) AS year,
        EXTRACT(MONTH FROM decision_date) AS month,
        COUNT(CASE WHEN case_status = 'Certified' THEN 1 END) AS approved_count,
        COUNT(CASE WHEN case_status != 'Certified' THEN 1 END) AS denied_count,
        COUNT(*) AS total_applications
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure`
    WHERE decision_date IS NOT NULL
    GROUP BY year, month
)
SELECT 
    a.month,
    m.latest_date,
    a.approved_count,
    a.denied_count,
    a.total_applications,
    ROUND(100.0 * a.approved_count / a.total_applications, 2) AS approval_rate
FROM approval_rate_monthly a
LEFT JOIN monthly_windows m
    ON a.month = m.month
ORDER BY a.month
    );
  
[0m22:59:39.079009 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:7ef0bb15-a8e9-4f37-b823-af57813fa944&page=queryresults
[0m22:59:41.328864 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4881ae470>]}
[0m22:59:41.330065 [info ] [Thread-2 (]: 19 of 31 OK created sql table model dbt_cs329e_xh_mrt.approval_rate_by_month ... [[32mCREATE TABLE (12.0 rows, 10.5 MiB processed)[0m in 2.71s]
[0m22:59:41.331304 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.approval_rate_by_month
[0m22:59:41.332115 [debug] [Thread-2 (]: Began running node model.cs329e_xh.major_wage_level
[0m22:59:41.333109 [info ] [Thread-2 (]: 20 of 31 START sql table model dbt_cs329e_xh_mrt.major_wage_level .............. [RUN]
[0m22:59:41.333978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.approval_rate_by_month, now model.cs329e_xh.major_wage_level)
[0m22:59:41.334681 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.major_wage_level
[0m22:59:41.340122 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.major_wage_level"
[0m22:59:41.341094 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.major_wage_level
[0m22:59:41.344970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:41.475483 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.major_wage_level"
[0m22:59:41.476666 [debug] [Thread-2 (]: On model.cs329e_xh.major_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.major_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`major_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH salary_by_field AS (
    SELECT 
        a.appx_a_field_of_study AS field_of_study,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE a.appx_a_field_of_study IS NOT NULL
)

SELECT 
    field_of_study,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM salary_by_field
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY field_of_study, wage_unit_of_pay
ORDER BY field_of_study, wage_unit_of_pay
    );
  
[0m22:59:41.724707 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:af9c62d6-1675-4602-9b20-b146521619d5&page=queryresults
[0m22:59:43.952764 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46c9abc70>]}
[0m22:59:43.953943 [info ] [Thread-2 (]: 20 of 31 OK created sql table model dbt_cs329e_xh_mrt.major_wage_level ......... [[32mCREATE TABLE (87.0 rows, 19.6 MiB processed)[0m in 2.62s]
[0m22:59:43.955247 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.major_wage_level
[0m22:59:43.956001 [debug] [Thread-2 (]: Began running node model.cs329e_xh.soc_wage_level
[0m22:59:43.956789 [info ] [Thread-2 (]: 21 of 31 START sql table model dbt_cs329e_xh_mrt.soc_wage_level ................ [RUN]
[0m22:59:43.957727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.major_wage_level, now model.cs329e_xh.soc_wage_level)
[0m22:59:43.958601 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.soc_wage_level
[0m22:59:43.963767 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.soc_wage_level"
[0m22:59:43.964684 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.soc_wage_level
[0m22:59:43.970607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:44.149120 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.soc_wage_level"
[0m22:59:44.150363 [debug] [Thread-2 (]: On model.cs329e_xh.soc_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.soc_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`soc_wage_level`
      
    
    

    OPTIONS()
    as (
      WITH job_salary AS (
    SELECT 
        l.soc_code,
        l.soc_title,
        l.wage_unit_of_pay,
        l.wage_rate_of_pay_from AS wage_from,
        l.wage_rate_of_pay_to AS wage_to
    FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` l
    JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Appendix` a 
        ON l.case_number = a.case_number
    WHERE l.soc_code IS NOT NULL AND l.soc_title IS NOT NULL
)

SELECT 
    soc_code,
    soc_title,
    wage_unit_of_pay,
    COUNT(*) AS num_entries,
    ROUND(AVG(wage_from), 2) AS avg_wage_from,
    ROUND(AVG(wage_to), 2) AS avg_wage_to,
    ROUND(MIN(wage_from), 2) AS min_wage,
    ROUND(MAX(wage_to), 2) AS max_wage
FROM job_salary
WHERE wage_from IS NOT NULL AND wage_to IS NOT NULL
GROUP BY soc_code, soc_title, wage_unit_of_pay
ORDER BY avg_wage_from DESC
    );
  
[0m22:59:44.430850 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:9c519fb8-f534-43ff-a177-aca424b30d81&page=queryresults
[0m22:59:46.403794 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465adef20>]}
[0m22:59:46.405001 [info ] [Thread-2 (]: 21 of 31 OK created sql table model dbt_cs329e_xh_mrt.soc_wage_level ........... [[32mCREATE TABLE (55.0 rows, 41.3 MiB processed)[0m in 2.45s]
[0m22:59:46.406102 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.soc_wage_level
[0m22:59:46.406978 [debug] [Thread-2 (]: Began running node model.cs329e_xh.city_approval_rate
[0m22:59:46.407999 [info ] [Thread-2 (]: 22 of 31 START sql table model dbt_cs329e_xh_mrt.city_approval_rate ............ [RUN]
[0m22:59:46.408839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.soc_wage_level, now model.cs329e_xh.city_approval_rate)
[0m22:59:46.409463 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.city_approval_rate
[0m22:59:46.415213 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.city_approval_rate"
[0m22:59:46.416222 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.city_approval_rate
[0m22:59:46.420460 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:46.540319 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.city_approval_rate"
[0m22:59:46.541657 [debug] [Thread-2 (]: On model.cs329e_xh.city_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.city_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`city_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_city AS city,
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_city, lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m22:59:46.826186 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:eaf1b29c-97c5-40f4-a2ac-e67c6a2dd2db&page=queryresults
[0m22:59:49.976036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465a5bbb0>]}
[0m22:59:49.977169 [info ] [Thread-2 (]: 22 of 31 OK created sql table model dbt_cs329e_xh_mrt.city_approval_rate ....... [[32mCREATE TABLE (20.1k rows, 50.1 MiB processed)[0m in 3.57s]
[0m22:59:49.978266 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.city_approval_rate
[0m22:59:49.979079 [debug] [Thread-2 (]: Began running node model.cs329e_xh.state_approval_rate
[0m22:59:49.980100 [info ] [Thread-2 (]: 23 of 31 START sql table model dbt_cs329e_xh_mrt.state_approval_rate ........... [RUN]
[0m22:59:49.980892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.city_approval_rate, now model.cs329e_xh.state_approval_rate)
[0m22:59:49.981512 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.state_approval_rate
[0m22:59:49.986590 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.state_approval_rate"
[0m22:59:49.987509 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.state_approval_rate
[0m22:59:49.991509 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:50.127018 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.state_approval_rate"
[0m22:59:50.128264 [debug] [Thread-2 (]: On model.cs329e_xh.state_approval_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_approval_rate"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_approval_rate`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) AS total_approved,
  COUNT(CASE WHEN ld.case_status = 'Denied' THEN 1 END) AS total_denied,
  COUNT(*) AS total_cases,
  ROUND(
    100 * COUNT(CASE WHEN ld.case_status IN ('Certified', 'Certified - Withdrawn') THEN 1 END) 
    / COUNT(*), 2
  ) AS approval_rate
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
GROUP BY lw.worksite_state
ORDER BY approval_rate DESC
    );
  
[0m22:59:50.480276 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:b0b6ea25-27aa-4cf8-bf47-d9a6abac8060&page=queryresults
[0m22:59:50.844004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465bc0610>]}
[0m22:59:50.845270 [info ] [Thread-1 (]: 18 of 31 OK created sql table model dbt_cs329e_xh_int.temp_emp ................. [[32mCREATE TABLE (90.2k rows, 19.9 MiB processed)[0m in 21.17s]
[0m22:59:50.846814 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.temp_emp
[0m22:59:50.847568 [debug] [Thread-1 (]: Began running node model.cs329e_xh.state_wage_level
[0m22:59:50.849122 [info ] [Thread-1 (]: 24 of 31 START sql table model dbt_cs329e_xh_mrt.state_wage_level .............. [RUN]
[0m22:59:50.850063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.temp_emp, now model.cs329e_xh.state_wage_level)
[0m22:59:50.850756 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.state_wage_level
[0m22:59:50.856014 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.state_wage_level"
[0m22:59:50.856959 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.state_wage_level
[0m22:59:50.863156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:50.991201 [debug] [Thread-1 (]: Writing runtime sql for node "model.cs329e_xh.state_wage_level"
[0m22:59:50.992442 [debug] [Thread-1 (]: On model.cs329e_xh.state_wage_level: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.state_wage_level"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_mrt`.`state_wage_level`
      
    
    

    OPTIONS()
    as (
      SELECT 
  lw.worksite_state AS state,
  ROUND(AVG(ld.prevailing_wage), 2) AS avg_wage,
  ROUND(MAX(ld.prevailing_wage), 2) AS max_wage,
  ROUND(MIN(ld.prevailing_wage), 2) AS min_wage,
  COUNT(ld.case_number) AS total_cases
FROM `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Disclosure` ld
JOIN `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`LCA_Worksites` lw
ON ld.case_number = lw.case_number
WHERE ld.prevailing_wage IS NOT NULL
AND LOWER(ld.pw_unit_of_pay) != 'hour'  -- Exclude hourly wage records
GROUP BY lw.worksite_state
ORDER BY avg_wage DESC
    );
  
[0m22:59:51.416004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:82697a9f-d6b0-436c-b3d9-9e0de0073ba7&page=queryresults
[0m22:59:53.638425 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4880fcbe0>]}
[0m22:59:53.992970 [debug] [Thread-2 (]: An error was encountered while trying to send an event
[0m22:59:53.994488 [info ] [Thread-2 (]: 23 of 31 OK created sql table model dbt_cs329e_xh_mrt.state_approval_rate ...... [[32mCREATE TABLE (55.0 rows, 41.5 MiB processed)[0m in 3.66s]
[0m22:59:53.995848 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.state_approval_rate
[0m22:59:53.996888 [debug] [Thread-2 (]: Began running node model.cs329e_xh.temp_employer_details
[0m22:59:53.998269 [info ] [Thread-2 (]: 25 of 31 START sql table model dbt_cs329e_xh_int.temp_employer_details ......... [RUN]
[0m22:59:53.999536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_approval_rate, now model.cs329e_xh.temp_employer_details)
[0m22:59:54.000212 [debug] [Thread-2 (]: Began compiling node model.cs329e_xh.temp_employer_details
[0m22:59:54.005494 [debug] [Thread-2 (]: Writing injected SQL for node "model.cs329e_xh.temp_employer_details"
[0m22:59:54.006504 [debug] [Thread-2 (]: Began executing node model.cs329e_xh.temp_employer_details
[0m22:59:54.010526 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:54.144403 [debug] [Thread-2 (]: Writing runtime sql for node "model.cs329e_xh.temp_employer_details"
[0m22:59:54.145690 [debug] [Thread-2 (]: On model.cs329e_xh.temp_employer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "cs329e_xh", "target_name": "dev", "node_id": "model.cs329e_xh.temp_employer_details"} */

  
    

    create or replace table `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_employer_details`
      
    
    

    OPTIONS()
    as (
      WITH matched as (
    select
        t.tax_id, t.employer_petitioner_name, 
        m.employer_name,m.fein
    from `silken-fortress-448205-p9`.`dbt_cs329e_xh_stg`.`employer_details` as t
    left join `silken-fortress-448205-p9`.`dbt_cs329e_xh_int`.`temp_emp` as m
    ON SUBSTR(m.fein, -4) = t.tax_id
)
select
    tax_id, employer_petitioner_name as original_name,
    employer_name as candidate_company_names,
    fein as candidate_fein
from matched
    );
  
[0m22:59:54.238754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465bc0610>]}
[0m22:59:54.240008 [info ] [Thread-1 (]: 24 of 31 OK created sql table model dbt_cs329e_xh_mrt.state_wage_level ......... [[32mCREATE TABLE (55.0 rows, 42.8 MiB processed)[0m in 3.39s]
[0m22:59:54.241167 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.state_wage_level
[0m22:59:54.425782 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silken-fortress-448205-p9&j=bq:US:af1d54bb-ac77-48a4-9431-8084a435e0ad&page=queryresults
[0m22:59:59.498013 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc48820f550>]}
[0m22:59:59.499285 [info ] [Thread-2 (]: 25 of 31 OK created sql table model dbt_cs329e_xh_int.temp_employer_details .... [[32mCREATE TABLE (589.3k rows, 4.9 MiB processed)[0m in 5.50s]
[0m22:59:59.500564 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.temp_employer_details
[0m22:59:59.502249 [debug] [Thread-1 (]: Began running node model.cs329e_xh.matching
[0m22:59:59.503147 [info ] [Thread-1 (]: 26 of 31 START python table model dbt_cs329e_xh_int.matching ................... [RUN]
[0m22:59:59.503981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.cs329e_xh.state_wage_level, now model.cs329e_xh.matching)
[0m22:59:59.504633 [debug] [Thread-1 (]: Began compiling node model.cs329e_xh.matching
[0m22:59:59.536920 [debug] [Thread-1 (]: Writing injected SQL for node "model.cs329e_xh.matching"
[0m22:59:59.538323 [debug] [Thread-1 (]: Began executing node model.cs329e_xh.matching
[0m22:59:59.552233 [debug] [Thread-1 (]: Writing runtime python for node "model.cs329e_xh.matching"
[0m22:59:59.553971 [debug] [Thread-1 (]: On model.cs329e_xh.matching: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","dataprocs_329e")
spark.conf.set("enableListInference", "True")


import pandas as pd
import os
import json
from google.oauth2 import service_account
#import json
#import vertexai
#from vertexai.generative_models import GenerativeModel
service_account_info = {
  "type": "service_account",
  "project_id": "silken-fortress-448205-p9",
  "private_key_id": "71d77d1a2073bafb0db6992cdad7614a88a21bdc",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQClBzwnVW9yrimb\npB0X8ELIvXkaJfNWlUJM8HB+JvUhPcyKH1/vnTlAm+kJkbvNr4xQBCFdDkJri+2y\nIEdCCaPN7eUxrL5E5zYE5SXlMqw5eAj7Xlngb2s3CdlBfuM/oN2Rro4AhrKGpLlG\n8GjxNRUxwFoXulIJ4jxIfuWLyUgTFS6t+2I8BaMtpP31XzV4tKU/mwfLVAwMwrUT\nuWgVyC+nJico3h0Ymr7YkEMqjnVTmgzupnssRTyCSmnnXwTrwzOig5Z0pRIIVtGD\nOnpfuTSdPFip/e74BqCoysTXe8HaUfamp6Rbm4o67GgZVzhN2AwNimIA7jnIaLvq\nkrh+Gp/TAgMBAAECggEADKJwqwxB85Q88EMQzSfiXQ8Qif1002CrCkvwOOBPrSNX\nmQ2M4UH2w6kMHuTu7XDuu6ONUFwKnsRARv5spjQpu9bmULbKfGj9PEO08oa+I8o6\nWdBf7ixpl3WkEf0edd0hiYlFKuolGeTboIBAcJMhU8VHwIBNzp7pAZ3hgiG/aGJ7\nxIOigdLUyNR6D/piKok/EFiuAQx5biZ7OdwdV0+SYo1deiV5urH9/SXE4wxAPlIJ\nGz21qdicyDmC4zEeVDhHqDU6dLP+UW3TYEDB1VwIRRwxHPh7eQGTiiM9Pmb74U7B\n2kPDN1mWQT5eq4+nMRl/HeXz4JZ4yGFwbaxgFDHTRQKBgQDYOXqMqG6SdkypEMH8\new4Ibo8jaXHkcXk5MfHCIzPXxMdvbXlFr31H5ulSzt4D7nIW/eNdSqSSxax4ZI4q\nzc/QZVpHKR5SUuV5xyL+fAorvwQVEoy7WscXIxE+JLaCpUYWCUHHe6M3VC0vG8eF\nqDTLa+olP00G/ZC3vB/X8OpztwKBgQDDYs3GBGGW3moEGlesTagp4tcrSl0Xh0qJ\nQfag84ceZvzH1CRHub4/zuSy1e31vbcN1HRlQeqcrwE5sinVEvm/AGaT/7YLbbME\naajqhf1fFkTNzOHcHPPLJoevLTXWNzu6MdA3yhD8wqSYBXqJW5iT9GeW6L7MJRBa\njhKp09UMxQKBgQCJY2xU96jac0SeoEFCVkZCYU2eKJ/vkZJ/HxcITingze4TBTJr\nbuhhyX0z2rIDOX1Q0p2nZ4hOoj/Gd85FsGR9fAjy8lOL55Rb3oaDwPkNdt/3K8Q0\nP6gFMYkBPX6iYLW5xsP/JrY8r8XOCw6qBIkXQEiUxjYBXRiZRnXNVg0C3QKBgQC3\nbYytN/O+RXPWAj0Iv6b+G73RIHEg45xwG4NEOxxAyILLvzeINrKLCNrfocNSjxbJ\nXwke/rEZA5rs5XwsUzIvxFqI2um29Pe5TtCLy9rAaBGT+6KWmH+v2q5LIPCH+TaT\naKyHk6Y7BSisp4gQZ/NoA2002bA1yx39RZ/z27EJ2QKBgBVqwuio4R70L6g3bP6u\n+/R25uFNFJs4xRYa2Vz7smLrcqnhu58CdO+Z3eq6Hg4Y/z9PCXN+3J6yOu+RfkuS\nKqLAPjAvh25G8WRlKNFnSSggiaWcpJkfNW7VY56qMjWGCjrGWxt0n5OBUKCHYNYO\n0ZkQ9KkdQESzZ33WkYGKGoN3\n-----END PRIVATE KEY-----\n",
  "client_email": "auth1-970@silken-fortress-448205-p9.iam.gserviceaccount.com",
  "client_id": "106644715728790824750",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/auth1-970%40silken-fortress-448205-p9.iam.gserviceaccount.com",
  "universe_domain": "googleapis.com"
}
credentials = service_account.Credentials.from_service_account_info(service_account_info)
def model(dbt, session):
    table = dbt.ref("temp_employer_details")
    '''
    df = table.filter(table["tax_id"].isNotNull())
    result = []
    for tax_id, group in df.groupby('tax_id'):
        original_names = group['original_name'].dropna().unique().tolist()
        unique_candidates = group.drop_duplicates(subset=['candidate_company_names', 'candidate_fein'])
        candidate_name_fein = [
            {row['candidate_company_names']: row['candidate_fein']}
            for _, row in unique_candidates.iterrows()
            if pd.notna(row['candidate_company_names']) and pd.notna(row['candidate_fein'])
        ]

        result.append({
            "tax_id": tax_id,
            "original_names": original_names,
            "candidate_name_fein": candidate_name_fein
        })

    json_result = json.dumps(result, indent=4, ensure_ascii=False)
    region = "us-central1"
    model_name = "gemini-2.0-flash-001"
    vertexai.init(project=project_id, location=region)
    model = GenerativeModel(model_name)
    data = json_result

    # Prepare Prompt
    prompt = """Here is a list of company names and candidate company names with FEINs.
    Match each original name to the most appropriate candidate based on similarity.
    Return a JSON object per line with the following fields:
    - tax_id
    - original_name
    - matched_candidate_name
    - matched_fein
    Return only one match per original_name. If no match is found, return null for matched_candidate_name and matched_fein.
    Do not return explanations.
    """

    # Set batch size
    batch_size = 5  

    # Prepare Batches
    records = []
    record_counter = 0
    batches = []
    for entry in data:
        tax_id = entry.get("tax_id", "Unknown")
        original_names = entry.get("original_names", [])
        candidate_name_fein = entry.get("candidate_name_fein", [])

        for original_name in original_names:
            candidate_str = "\n".join([f"{list(c.keys())[0]}: {list(c.values())[0]}" for c in candidate_name_fein])
            record = f"tax_id: {tax_id}\noriginal_name: {original_name}\ncandidates:\n{candidate_str}"
            records.append(record)
            record_counter += 1

            if record_counter == batch_size:
                batches.append("\n---\n".join(records))
                records = []
                record_counter = 0

    if records:
        batches.append("\n---\n".join(records))

    print(f"{len(batches)} total batches will be sent to Gemini.")

    # Function to send batch to Gemini with retry on API limit
    def send_batch_to_gemini(batch_data):
        max_retries = 5
        wait_time = 5  

        for attempt in range(max_retries):
            try:
                resp = model.generate_content([batch_data, prompt])
                resp_text = resp.text.replace("```json", "").replace("```", "")
                json_lines = resp_text.strip().split("\n")
                results = []
                for line in json_lines:
                    if line:
                        try:
                            results.append(json.loads(line))
                        except Exception as e:
                            print(f"Error converting line to JSON: {line}, Error: {e}")
                return results  
            except Exception as e:
                if "Resource exhausted" in str(e):  
                    print(f"API Limit Exceeded. Waiting {wait_time} seconds before retrying. Attempt {attempt+1} of {max_retries}.")
                    time.sleep(wait_time)  
                    wait_time *= 2  
                else:
                    print(f"API Error: {e}")
                    return []  

        print("Max retries reached. Skipping batch.")
        return []  

    # Process all batches with retry mechanism
    all_results = []
    for i, batch in enumerate(batches):
        print(f"Processing batch {i + 1} of {len(batches)}.")
        batch_results = send_batch_to_gemini(batch)
        all_results.extend(batch_results)
        time.sleep(1)  

    # Convert to DataFrame
    df_final = pd.DataFrame(all_results)

    # Remove duplicates
    df_final.drop_duplicates(subset=["tax_id", "original_name", "matched_candidate_name", "matched_fein"], inplace=True)
    matching = df_final

    '''
    
    matching = session.read_csv("gs://cs329e-h1b-project/matched_results_full.csv")
    return matching


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"temp_employer_details": "silken-fortress-448205-p9.dbt_cs329e_xh_int.temp_employer_details"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "silken-fortress-448205-p9"
    schema = "dbt_cs329e_xh_int"
    identifier = "matching"
    
    def __repr__(self):
        return 'silken-fortress-448205-p9.dbt_cs329e_xh_int.matching'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

# For writeMethod we need to use "indirect" if materializing a partitioned table
# otherwise we can use "direct". Note that indirect will fail if the GCS bucket has a retention policy set on it.
      

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "direct") \
  .option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("silken-fortress-448205-p9.dbt_cs329e_xh_int.matching")

  
[0m22:59:59.573861 [debug] [Thread-1 (]: BigQuery adapter: Submitting batch job with id: 64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2
[0m23:04:23.323128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:23.324955 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/cs329e_xh/models/int/Employer_Details/matching.py[0m
409 Job failed with message [AttributeError: 'SparkSession' object has no attribute 'read_csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2?project=silken-fortress-448205-p9
gcloud dataproc batches wait '64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/driveroutput.* 10: Job failed with message [AttributeError: 'SparkSession' object has no attribute 'read_csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2?project=silken-fortress-448205-p9
gcloud dataproc batches wait '64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/driveroutput.*
[0m23:04:23.328307 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 334, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "/opt/conda/lib/python3.10/site-packages/dbt/task/run.py", line 294, in _execute_model
    result = MacroGenerator(
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/opt/conda/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/dbt/context/providers.py", line 1532, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 204, in execution_with_log
    response = code_execution_function(*args)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1683, in submit_python_job
    submission_result = job_helper.submit(compiled_code)
  File "/opt/conda/lib/python3.10/site-packages/dbt/adapters/bigquery/python_submissions.py", line 120, in submit
    response: Batch = operation.result(polling=self._polling_retry)
  File "/opt/conda/lib/python3.10/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Aborted: 409 Job failed with message [AttributeError: 'SparkSession' object has no attribute 'read_csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2?project=silken-fortress-448205-p9
gcloud dataproc batches wait '64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/driveroutput.* 10: Job failed with message [AttributeError: 'SparkSession' object has no attribute 'read_csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2?project=silken-fortress-448205-p9
gcloud dataproc batches wait '64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/driveroutput.*

[0m23:04:23.329659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddd46b1-fad2-465b-a283-3b86deb418e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc48815c340>]}
[0m23:04:23.331084 [error] [Thread-1 (]: 26 of 31 ERROR creating python table model dbt_cs329e_xh_int.matching .......... [[31mERROR[0m in 263.83s]
[0m23:04:23.332488 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.matching
[0m23:04:23.333685 [debug] [Thread-5 (]: Marking all children of 'model.cs329e_xh.matching' to be skipped because of status 'error'.  Reason: 409 Job failed with message [AttributeError: 'SparkSession' object has no attribute 'read_csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2?project=silken-fortress-448205-p9
gcloud dataproc batches wait '64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/driveroutput.* 10: Job failed with message [AttributeError: 'SparkSession' object has no attribute 'read_csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2?project=silken-fortress-448205-p9
gcloud dataproc batches wait '64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/driveroutput.*.
[0m23:04:23.336916 [debug] [Thread-2 (]: Began running node model.cs329e_xh.Employer_Detail
[0m23:04:23.337788 [info ] [Thread-2 (]: 27 of 31 SKIP relation dbt_cs329e_xh_int.Employer_Detail ....................... [[33mSKIP[0m]
[0m23:04:23.338639 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.Employer_Detail
[0m23:04:23.340282 [debug] [Thread-1 (]: Began running node model.cs329e_xh.company_approval_rate
[0m23:04:23.341186 [debug] [Thread-2 (]: Began running node model.cs329e_xh.company_wage_level
[0m23:04:23.342540 [info ] [Thread-1 (]: 28 of 31 SKIP relation dbt_cs329e_xh_mrt.company_approval_rate ................. [[33mSKIP[0m]
[0m23:04:23.343543 [info ] [Thread-2 (]: 29 of 31 SKIP relation dbt_cs329e_xh_mrt.company_wage_level .................... [[33mSKIP[0m]
[0m23:04:23.344779 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.company_approval_rate
[0m23:04:23.345607 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.company_wage_level
[0m23:04:23.346432 [debug] [Thread-1 (]: Began running node model.cs329e_xh.industry_approval_rate
[0m23:04:23.347429 [debug] [Thread-2 (]: Began running node model.cs329e_xh.wage_level_by_industry
[0m23:04:23.348356 [info ] [Thread-1 (]: 30 of 31 SKIP relation dbt_cs329e_xh_mrt.industry_approval_rate ................ [[33mSKIP[0m]
[0m23:04:23.349278 [info ] [Thread-2 (]: 31 of 31 SKIP relation dbt_cs329e_xh_mrt.wage_level_by_industry ................ [[33mSKIP[0m]
[0m23:04:23.350243 [debug] [Thread-1 (]: Finished running node model.cs329e_xh.industry_approval_rate
[0m23:04:23.350995 [debug] [Thread-2 (]: Finished running node model.cs329e_xh.wage_level_by_industry
[0m23:04:23.353422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:23.354607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:23.355205 [debug] [MainThread]: Connection 'model.cs329e_xh.temp_employer_details' was properly closed.
[0m23:04:23.355712 [debug] [MainThread]: Connection 'model.cs329e_xh.matching' was properly closed.
[0m23:04:23.356481 [info ] [MainThread]: 
[0m23:04:23.357094 [info ] [MainThread]: Finished running 31 table models in 0 hours 5 minutes and 40.62 seconds (340.62s).
[0m23:04:23.363567 [debug] [MainThread]: Command end result
[0m23:04:23.424625 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jupyter/cs329e_xh/target/manifest.json
[0m23:04:23.427930 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jupyter/cs329e_xh/target/semantic_manifest.json
[0m23:04:23.441711 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jupyter/cs329e_xh/target/run_results.json
[0m23:04:23.442500 [info ] [MainThread]: 
[0m23:04:23.443201 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:04:23.444079 [info ] [MainThread]: 
[0m23:04:23.445006 [error] [MainThread]:   409 Job failed with message [AttributeError: 'SparkSession' object has no attribute 'read_csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2?project=silken-fortress-448205-p9
gcloud dataproc batches wait '64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/driveroutput.* 10: Job failed with message [AttributeError: 'SparkSession' object has no attribute 'read_csv']. Additional details can be found at:
https://console.cloud.google.com/dataproc/batches/us-central1/64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2?project=silken-fortress-448205-p9
gcloud dataproc batches wait '64ea5d22-8fa7-4c9b-b5f3-c3517135c6f2' --region 'us-central1' --project 'silken-fortress-448205-p9'
https://console.cloud.google.com/storage/browser/dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/
gs://dataproc-staging-us-central1-124580477847-4asghflq/google-cloud-dataproc-metainfo/460dc4ce-5137-45d9-a4f4-ae2204a8325b/jobs/srvls-batch-02be139e-5a34-471f-a359-3b5e481944eb/driveroutput.*
[0m23:04:23.445867 [info ] [MainThread]: 
[0m23:04:23.446631 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=1 SKIP=5 TOTAL=31
[0m23:04:23.447768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 343.48178, "process_in_blocks": "0", "process_kernel_time": 0.625704, "process_mem_max_rss": "275864", "process_out_blocks": "5272", "process_user_time": 6.880302}
[0m23:04:23.448503 [debug] [MainThread]: Command `dbt run` failed at 23:04:23.448345 after 343.48 seconds
[0m23:04:23.449132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc488bbd630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46ce26260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc465b5f6d0>]}
[0m23:04:23.449804 [debug] [MainThread]: Flushing usage events
[0m23:04:23.791878 [debug] [MainThread]: An error was encountered while trying to flush usage events
