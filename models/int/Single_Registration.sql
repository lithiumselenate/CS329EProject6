with sr as(
    SELECT DISTINCT 
       employer_name, 
       ben_year_of_birth, 
       gender, 
       agent_first_name, 
       agent_last_name, 
       mail_addr, 
       country_of_birth, 
       country_of_nationality, 
       fein, 
       city, 
       state, 
       zip, 
       lottery_year, 
       status_type, 
       ben_multi_reg_ind, 
       rec_date, 
       first_decision, 
       first_decision_date, 
       i129_employer_name, 
       pet_street, 
       pet_city, 
       pet_state, 
       pet_zip, 
       requested_class, 
       basis_for_classification, 
       requested_action, 
       number_of_beneficiaries, 
       ben_sex, 
       ben_country_of_birth, 
       ben_current_class, 
       job_title, 
       worksite_street, 
       worksite_city, 
       worksite_state, 
       worksite_zip, 
       full_time_ind, 
       wage_amt, 
       wage_unit, 
       valid_from, 
       valid_to, 
       num_of_emp_in_us, 
       s1q1a, 
       s1q1b, 
       ben_education_code, 
       ed_level_definition, 
       ben_pfield_of_study, 
       ben_comp_paid, 
       dot_code, 
       naics_code, 
       s3q1, 
       s4q1, 
       _data_source, 
       _load_time
FROM {{ ref('single_registrations') }})
select * from sr where agent_first_name is not null and agent_last_name is not null and employer_name is not null
